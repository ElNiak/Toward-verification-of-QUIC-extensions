<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by rfcdiff 1.48: rfcdiff  -->
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux zinfandel 3.2.0-6-amd64 #1 SMP Debian 3.2.102-1 x86_64 GNU/Linux -->
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 -->
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.2 -->
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.1.2 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <meta http-equiv="Content-Style-Type" content="text/css"> 
  <title>Diff: draft-ietf-quic-transport-18.txt - draft-ietf-quic-transport-29.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
    span.hide { display: none; color: #aaa;}    a:hover span { display: inline; }    tr.change { background-color: gray; } 
    tr.change a { text-decoration: none; color: black } 
  </style> 
     <script>
var chunk_index = 0;
var old_chunk = null;

function format_chunk(index) {
    var prefix = "diff";
    var str = index.toString();
    for (x=0; x<(4-str.length); ++x) {
        prefix+='0';
    }
    return prefix + str;
}

function find_chunk(n){
    return document.querySelector('tr[id$="' + n + '"]');
}

function change_chunk(offset) {
    var index = chunk_index + offset;
    var new_str;
    var new_chunk;

    new_str = format_chunk(index);
    new_chunk = find_chunk(new_str);
    if (!new_chunk) {
        return;
    }
    if (old_chunk) {
        old_chunk.style.outline = "";
    }
    old_chunk = new_chunk;
    old_chunk.style.outline = "1px solid red";
    window.location.hash = "#" + new_str;
    window.scrollBy(0,-100);
    chunk_index = index;
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
    case 78:
        change_chunk(1);
        break;
    case 80:
        change_chunk(-1);
        break;
    }
};
   </script> 
</head> 
<body> 
  <table cellspacing="0" cellpadding="0" border="0"> 
  <tbody><tr id="part-1" bgcolor="orange"><th></th><th><a href="https://tools.ietf.org/rfcdiff?url2=draft-ietf-quic-transport-18.txt" style="color:#008; text-decoration:none;">&lt;</a>&nbsp;<a href="https://tools.ietf.org/html/draft-ietf-quic-transport-18.txt" style="color:#008">draft-ietf-quic-transport-18.txt</a>&nbsp;</th><th> </th><th>&nbsp;<a href="https://tools.ietf.org/html/draft-ietf-quic-transport-29.txt" style="color:#008">draft-ietf-quic-transport-29.txt</a>&nbsp;<a href="https://tools.ietf.org/rfcdiff?url1=draft-ietf-quic-transport-29.txt" style="color:#008; text-decoration:none;">&gt;</a></th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">QUIC                                                     J. Iyengar, Ed.</td><td> </td><td class="right">QUIC                                                     J. Iyengar, Ed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Internet-Draft                                                    Fastly</td><td> </td><td class="right">Internet-Draft                                                    Fastly</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Intended status: Standards Track                         M. Thomson, Ed.</td><td> </td><td class="right">Intended status: Standards Track                         M. Thomson, Ed.</td><td class="lineno"></td></tr>
      <tr id="diff0001"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">Expires: <span class="delete">July 27, 2019</span>                                           Mozilla</td><td> </td><td class="rblock">Expires: <span class="insert">12 December 2020</span>                                        Mozilla</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                        <span class="delete">January 23, 2019</span></td><td> </td><td class="rblock">                                                            <span class="insert">10 June 2020</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">           QUIC: A UDP-Based Multiplexed and Secure Transport</td><td> </td><td class="right">           QUIC: A UDP-Based Multiplexed and Secure Transport</td><td class="lineno"></td></tr>
      <tr id="diff0002"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                      draft-ietf-quic-transport-<span class="delete">18</span></td><td> </td><td class="rblock">                      draft-ietf-quic-transport-<span class="insert">29</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Abstract</td><td> </td><td class="right">Abstract</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document defines the core of the QUIC transport protocol.</td><td> </td><td class="right">   This document defines the core of the QUIC transport protocol.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Accompanying documents describe QUIC's loss detection and congestion</td><td> </td><td class="right">   Accompanying documents describe QUIC's loss detection and congestion</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   control and the use of TLS for key negotiation.</td><td> </td><td class="right">   control and the use of TLS for key negotiation.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Note to Readers</td><td> </td><td class="right">Note to Readers</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Discussion of this draft takes place on the QUIC working group</td><td> </td><td class="right">   Discussion of this draft takes place on the QUIC working group</td><td class="lineno"></td></tr>
      <tr id="diff0003"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   mailing list <span class="delete">(quic@ietf.org),</span> which is archived at</td><td> </td><td class="rblock">   mailing list <span class="insert">(quic@ietf.org (mailto:quic@ietf.org)),</span> which is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">&lt;https://mailarchive.ietf.org/arch/search/?email_list=quic&gt;.</span></td><td> </td><td class="rblock">   archived at <span class="insert">https://mailarchive.ietf.org/arch/search/?email_list=quic</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0004"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Working Group information can be found at <span class="delete">&lt;https://github.com/</span></td><td> </td><td class="rblock">   Working Group information can be found at <span class="insert">https://github.com/quicwg;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   quicwg&gt;;</span> source code and issues list for this draft can be found at</td><td> </td><td class="rblock">   source code and issues list for this draft can be found at</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">&lt;https://github.com/quicwg/base-drafts/labels/-transport&gt;.</span></td><td> </td><td class="rblock">   <span class="insert">https://github.com/quicwg/base-drafts/labels/-transport.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Status of This Memo</td><td> </td><td class="right">Status of This Memo</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This Internet-Draft is submitted in full conformance with the</td><td> </td><td class="right">   This Internet-Draft is submitted in full conformance with the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provisions of BCP 78 and BCP 79.</td><td> </td><td class="right">   provisions of BCP 78 and BCP 79.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Internet-Drafts are working documents of the Internet Engineering</td><td> </td><td class="right">   Internet-Drafts are working documents of the Internet Engineering</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Task Force (IETF).  Note that other groups may also distribute</td><td> </td><td class="right">   Task Force (IETF).  Note that other groups may also distribute</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   working documents as Internet-Drafts.  The list of current Internet-</td><td> </td><td class="right">   working documents as Internet-Drafts.  The list of current Internet-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td> </td><td class="right">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Internet-Drafts are draft documents valid for a maximum of six months</td><td> </td><td class="right">   Internet-Drafts are draft documents valid for a maximum of six months</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and may be updated, replaced, or obsoleted by other documents at any</td><td> </td><td class="right">   and may be updated, replaced, or obsoleted by other documents at any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   time.  It is inappropriate to use Internet-Drafts as reference</td><td> </td><td class="right">   time.  It is inappropriate to use Internet-Drafts as reference</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   material or to cite them other than as "work in progress."</td><td> </td><td class="right">   material or to cite them other than as "work in progress."</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0005"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This Internet-Draft will expire on <span class="delete">July 27, 2019</span>.</td><td> </td><td class="rblock">   This Internet-Draft will expire on <span class="insert">12 December 2020</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Copyright Notice</td><td> </td><td class="right">Copyright Notice</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0006"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Copyright (c) 20<span class="delete">19</span> IETF Trust and the persons identified as the</td><td> </td><td class="rblock">   Copyright (c) 20<span class="insert">20</span> IETF Trust and the persons identified as the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   document authors.  All rights reserved.</td><td> </td><td class="right">   document authors.  All rights reserved.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td> </td><td class="right">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td class="lineno"></td></tr>
      <tr id="diff0007"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Provisions Relating to IETF Documents</td><td> </td><td class="rblock">   Provisions Relating to IETF Documents <span class="insert">(https://trustee.ietf.org/</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">(https://trustee.ietf.org/license-info)</span> in effect on the date of</td><td> </td><td class="rblock"><span class="insert">   license-info)</span> in effect on the date of publication of this document.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   publication of this document.  Please review these documents</td><td> </td><td class="rblock">   Please review these documents carefully, as they describe your rights</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   carefully, as they describe your rights and restrictions with respect</td><td> </td><td class="rblock">   and restrictions with respect to this document.  Code Components</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to this document.  Code Components extracted from this document must</td><td> </td><td class="rblock">   extracted from this document must include Simplified BSD License text</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   include Simplified BSD License text as described in Section 4.e of</td><td> </td><td class="rblock">   as described in Section 4.e of the Trust Legal Provisions and are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the Trust Legal Provisions and are provided without warranty as</td><td> </td><td class="rblock">   provided without warranty as described in the Simplified BSD License.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   described in the Simplified BSD License.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Table of Contents</td><td> </td><td class="right">Table of Contents</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0008"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <span class="delete">5</span></td><td> </td><td class="rblock">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <span class="insert">6</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     1.1.  Document Structure  . . . . . . . . . . . . . . . . . . .   <span class="delete">6</span></td><td> </td><td class="rblock">     1.1.  Document Structure  . . . . . . . . . . . . . . . . . . .   <span class="insert">7</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     1.2.  Terms and Definitions . . . . . . . . . . . . . . . . . .   <span class="delete">7</span></td><td> </td><td class="rblock">     1.2.  Terms and Definitions . . . . . . . . . . . . . . . . . .   <span class="insert">8</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     1.3.  Notational Conventions  . . . . . . . . . . . . . . . . .   <span class="delete">8</span></td><td> </td><td class="rblock">     1.3.  Notational Conventions  . . . . . . . . . . . . . . . . .   <span class="insert">9</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   2.  Streams . . . . . . . . . . . . . . . . . . . . . . . . . . .   <span class="delete">8</span></td><td> </td><td class="rblock">   2.  Streams . . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">10</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     2.1.  Stream Types and Identifiers  . . . . . . . . . . . . . .   <span class="delete">9</span></td><td> </td><td class="rblock">     2.1.  Stream Types and Identifiers  . . . . . . . . . . . . . .  <span class="insert">11</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     2.2.  Sending and Receiving Data  . . . . . . . . . . . . . . .  <span class="delete">10</span></td><td> </td><td class="rblock">     2.2.  Sending and Receiving Data  . . . . . . . . . . . . . . .  <span class="insert">12</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     2.3.  Stream Prioritization . . . . . . . . . . . . . . . . . .  <span class="delete">10</span></td><td> </td><td class="rblock">     2.3.  Stream Prioritization . . . . . . . . . . . . . . . . . .  <span class="insert">13</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   3.  Stream States . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">11</span></td><td> </td><td class="rblock"><span class="insert">     2.4.  Required Operations on Streams  . . . . . . . . . . . . .  13</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     3.1.  Sending Stream States . . . . . . . . . . . . . . . . . .  <span class="delete">11</span></td><td> </td><td class="rblock">   3.  Stream States . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">14</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     3.2.  Receiving Stream States . . . . . . . . . . . . . . . . .  <span class="delete">13</span></td><td> </td><td class="rblock">     3.1.  Sending Stream States . . . . . . . . . . . . . . . . . .  <span class="insert">14</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     3.3.  Permitted Frame Types . . . . . . . . . . . . . . . . . .  <span class="delete">16</span></td><td> </td><td class="rblock">     3.2.  Receiving Stream States . . . . . . . . . . . . . . . . .  <span class="insert">17</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     3.4.  Bidirectional Stream States . . . . . . . . . . . . . . .  <span class="delete">16</span></td><td> </td><td class="rblock">     3.3.  Permitted Frame Types . . . . . . . . . . . . . . . . . .  <span class="insert">19</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     3.5.  Solicited State Transitions . . . . . . . . . . . . . . .  <span class="delete">18</span></td><td> </td><td class="rblock">     3.4.  Bidirectional Stream States . . . . . . . . . . . . . . .  <span class="insert">20</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   4.  Flow Control  . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">19</span></td><td> </td><td class="rblock">     3.5.  Solicited State Transitions . . . . . . . . . . . . . . .  <span class="insert">21</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     4.1.  Data Flow Control . . . . . . . . . . . . . . . . . . . .  <span class="delete">19</span></td><td> </td><td class="rblock">   4.  Flow Control  . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">23</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     4.2.  Flow Credit Increments  . . . . . . . . . . . . . . . . .  <span class="delete">20</span></td><td> </td><td class="rblock">     4.1.  Data Flow Control . . . . . . . . . . . . . . . . . . . .  <span class="insert">23</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     4.3.  Handling Stream Cancellation  . . . . . . . . . . . . . .  <span class="delete">21</span></td><td> </td><td class="rblock">     4.2.  Flow Credit Increments  . . . . . . . . . . . . . . . . .  <span class="insert">24</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     4.4.  Stream Final Size . . . . . . . . . . . . . . . . . . . .  <span class="delete">22</span></td><td> </td><td class="rblock">     4.3.  Handling Stream Cancellation  . . . . . . . . . . . . . .  <span class="insert">25</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     4.5.  Controlling Concurrency . . . . . . . . . . . . . . . . .  <span class="delete">22</span></td><td> </td><td class="rblock">     4.4.  Stream Final Size . . . . . . . . . . . . . . . . . . . .  <span class="insert">26</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   5.  Connections . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">23</span></td><td> </td><td class="rblock">     4.5.  Controlling Concurrency . . . . . . . . . . . . . . . . .  <span class="insert">27</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     5.1.  Connection ID . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">23</span></td><td> </td><td class="rblock">   5.  Connections . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">27</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       5.1.1.  Issuing Connection IDs  . . . . . . . . . . . . . . .  <span class="delete">24</span></td><td> </td><td class="rblock">     5.1.  Connection ID . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">28</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       5.1.2.  Consuming and Retiring Connection IDs . . . . . . . .  <span class="delete">25</span></td><td> </td><td class="rblock">       5.1.1.  Issuing Connection IDs  . . . . . . . . . . . . . . .  <span class="insert">29</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     5.2.  Matching Packets to Connections . . . . . . . . . . . . .  <span class="delete">25</span></td><td> </td><td class="rblock">       5.1.2.  Consuming and Retiring Connection IDs . . . . . . . .  <span class="insert">30</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       5.2.1.  Client Packet Handling  . . . . . . . . . . . . . . .  <span class="delete">26</span></td><td> </td><td class="rblock">     5.2.  Matching Packets to Connections . . . . . . . . . . . . .  <span class="insert">31</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       5.2.2.  Server Packet Handling  . . . . . . . . . . . . . . .  <span class="delete">26</span></td><td> </td><td class="rblock">       5.2.1.  Client Packet Handling  . . . . . . . . . . . . . . .  <span class="insert">32</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     5.3.  Life of a QUIC Connection . . . . . . . . . . . . . . . .  <span class="delete">27</span></td><td> </td><td class="rblock">       5.2.2.  Server Packet Handling  . . . . . . . . . . . . . . .  <span class="insert">32</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   6.  Version Negotiation . . . . . . . . . . . . . . . . . . . . .  <span class="delete">27</span></td><td> </td><td class="rblock"><span class="insert">       5.2.3.  Considerations for Simple Load Balancers  . . . . . .  33</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     6.1.  Sending Version Negotiation Packets . . . . . . . . . . .  <span class="delete">28</span></td><td> </td><td class="rblock">     5.3.  Life of a QUIC Connection . . . . . . . . . . . . . . . .  <span class="insert">34</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     6.2.  Handling Version Negotiation Packets  . . . . . . . . . .  <span class="delete">28</span></td><td> </td><td class="rblock"><span class="insert">     5.4.  Required Operations on Connections  . . . . . . . . . . .  35</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     6.3.  Using Reserved Versions . . . . . . . . . . . . . . . . .  <span class="delete">29</span></td><td> </td><td class="rblock">   6.  Version Negotiation . . . . . . . . . . . . . . . . . . . . .  <span class="insert">36</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   7.  Cryptographic and Transport Handshake . . . . . . . . . . . .  <span class="delete">30</span></td><td> </td><td class="rblock">     6.1.  Sending Version Negotiation Packets . . . . . . . . . . .  <span class="insert">36</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     7.1.  Example Handshake Flows . . . . . . . . . . . . . . . . .  <span class="delete">31</span></td><td> </td><td class="rblock">     6.2.  Handling Version Negotiation Packets  . . . . . . . . . .  <span class="insert">36</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     7.2.  Negotiating Connection IDs  . . . . . . . . . . . . . . .  <span class="delete">32</span></td><td> </td><td class="rblock"><span class="insert">       6.2.1.  Version Negotiation Between Draft Versions  . . . . .  37</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     7.3.  Transport Parameters  . . . . . . . . . . . . . . . . . .  <span class="delete">34</span></td><td> </td><td class="rblock">     6.3.  Using Reserved Versions . . . . . . . . . . . . . . . . .  <span class="insert">37</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       7.3.1.</span>  Values of Transport Parameters for 0-RTT  . . . . . .  <span class="delete">34</span></td><td> </td><td class="rblock">   7.  Cryptographic and Transport Handshake . . . . . . . . . . . .  <span class="insert">38</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       7.3.2.</span>  New Transport Parameters  . . . . . . . . . . . . . .  <span class="delete">35</span></td><td> </td><td class="rblock">     7.1.  Example Handshake Flows . . . . . . . . . . . . . . . . .  <span class="insert">39</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       7.3.3.  Version Negotiation Validation</span>  . . . . . . . . . . .  <span class="delete">36</span></td><td> </td><td class="rblock">     7.2.  Negotiating Connection IDs  . . . . . . . . . . . . . . .  <span class="insert">40</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   8.  Address Validation  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">37</span></td><td> </td><td class="rblock">     7.3.  <span class="insert">Authenticating Connection IDs . . . . . . . . . . . . . .  41</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     8.1.  Address Validation During Connection Establishment  . . .  <span class="delete">38</span></td><td> </td><td class="rblock"><span class="insert">     7.4.</span>  Transport Parameters  . . . . . . . . . . . . . . . . . .  <span class="insert">43</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       8.1.1.  Address Validation using Retry Packets  . . . . . . .  <span class="delete">38</span></td><td> </td><td class="rblock"><span class="insert">       7.4.1.</span>  Values of Transport Parameters for 0-RTT  . . . . . .  <span class="insert">44</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       8.1.2.</span>  Address Validation for Future Connections . . . . . .  <span class="delete">39</span></td><td> </td><td class="rblock"><span class="insert">       7.4.2.</span>  New Transport Parameters  . . . . . . . . . . . . . .  <span class="insert">46</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       8.1.3.</span>  Address Validation Token Integrity  . . . . . . . . .  <span class="delete">41</span></td><td> </td><td class="rblock"><span class="insert">     7.5.  Cryptographic Message Buffering</span> . . . . . . . . . . . <span class="insert">. .  46</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     8.2.  Path Validation . . . . . . . . . . . . . . . . . . . . .  <span class="delete">41</span></td><td> </td><td class="rblock">   8.  Address Validation  . . . . . . . . . . . . . . . . . . . . .  <span class="insert">46</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     8.3.  Initiating Path Validation  . . . . . . . . . . . . . . .  <span class="delete">42</span></td><td> </td><td class="rblock">     8.1.  Address Validation During Connection Establishment  . . .  <span class="insert">47</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     8.4.  Path Validation Responses . . . . . . . . . . . . . . . .  <span class="delete">42</span></td><td> </td><td class="rblock">       8.1.1.  <span class="insert">Token Construction  . . . . . . . . . . . . . . . . .  48</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     8.5.  Successful Path Validation  . . . . . . . . . . . . . . .  <span class="delete">43</span></td><td> </td><td class="rblock"><span class="insert">       8.1.2.</span>  Address Validation using Retry Packets  . . . . . . .  <span class="insert">48</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     8.6.  Failed Path Validation  . . . . . . . . . . . . . . . . .  <span class="delete">43</span></td><td> </td><td class="rblock"><span class="insert">       8.1.3.</span>  Address Validation for Future Connections . . . . . .  <span class="insert">49</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   9.  Connection Migration  . . . . . . . . . . . . . . . . . . . .  <span class="delete">44</span></td><td> </td><td class="rblock"><span class="insert">       8.1.4.</span>  Address Validation Token Integrity  . . . . . . . . .  <span class="insert">51</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     9.1.  Probing a New Path  . . . . . . . . . . . . . . . . . . .  <span class="delete">45</span></td><td> </td><td class="rblock">     8.2.  Path Validation . . . . . . . . . . . . . . . . . . . . .  <span class="insert">52</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     9.2.  Initiating Connection Migration . . . . . . . . . . . . .  <span class="delete">45</span></td><td> </td><td class="rblock">     8.3.  Initiating Path Validation  . . . . . . . . . . . . . . .  <span class="insert">53</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     9.3.  Responding to Connection Migration  . . . . . . . . . . .  <span class="delete">46</span></td><td> </td><td class="rblock">     8.4.  Path Validation Responses . . . . . . . . . . . . . . . .  <span class="insert">53</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       9.3.1.  Peer Address Spoofing . . . . . . . . . . . . . . . .  <span class="delete">46</span></td><td> </td><td class="rblock">     8.5.  Successful Path Validation  . . . . . . . . . . . . . . .  <span class="insert">54</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       9.3.2.  On-Path Address Spoofing  . . . . . . . . . . . . . .  <span class="delete">47</span></td><td> </td><td class="rblock">     8.6.  Failed Path Validation  . . . . . . . . . . . . . . . . .  <span class="insert">54</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       9.3.3.  Off-Path Packet Forwarding  . . . . . . . . . . . . .  <span class="delete">47</span></td><td> </td><td class="rblock">   9.  Connection Migration  . . . . . . . . . . . . . . . . . . . .  <span class="insert">54</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     9.4.  Loss Detection and Congestion Control . . . . . . . . . .  <span class="delete">48</span></td><td> </td><td class="rblock">     9.1.  Probing a New Path  . . . . . . . . . . . . . . . . . . .  <span class="insert">55</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     9.5.  Privacy Implications of Connection Migration  . . . . . .  <span class="delete">49</span></td><td> </td><td class="rblock">     9.2.  Initiating Connection Migration . . . . . . . . . . . . .  <span class="insert">56</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     9.6.  Server's Preferred Address  . . . . . . . . . . . . . . .  <span class="delete">50</span></td><td> </td><td class="rblock">     9.3.  Responding to Connection Migration  . . . . . . . . . . .  <span class="insert">56</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       9.6.1.  Communicating <span class="delete">A</span> Preferred Address . . . . . . . . . .  <span class="delete">50</span></td><td> </td><td class="rblock">       9.3.1.  Peer Address Spoofing . . . . . . . . . . . . . . . .  <span class="insert">57</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       9.6.2.  Responding to Connection Migration  . . . . . . . . .  <span class="delete">51</span></td><td> </td><td class="rblock">       9.3.2.  On-Path Address Spoofing  . . . . . . . . . . . . . .  <span class="insert">58</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       9.6.3.  Interaction of Client Migration and Preferred Address  <span class="delete">51</span></td><td> </td><td class="rblock">       9.3.3.  Off-Path Packet Forwarding  . . . . . . . . . . . . .  <span class="insert">58</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   10. Connection Termination  . .</span> . . . . . . . . . . . . . . . . .  <span class="delete">52</span></td><td> </td><td class="rblock">     9.4.  Loss Detection and Congestion Control . . . . . . . . . .  <span class="insert">59</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     10.1.  Closing and Draining Connection States</span> . . . . . . . . .  <span class="delete">52</span></td><td> </td><td class="rblock">     9.5.  Privacy Implications of Connection Migration  . . . . . .  <span class="insert">60</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     10.2.  Idle Timeout</span> . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">53</span></td><td> </td><td class="rblock">     9.6.  Server's Preferred Address  . . . . . . . . . . . . . . .  <span class="insert">62</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     10.3.  Immediate Close</span>  . . . . . . . . . . . . . . . . . . . .  <span class="delete">54</span></td><td> </td><td class="rblock">       9.6.1.  Communicating <span class="insert">a</span> Preferred Address . . . . . . . . . .  <span class="insert">62</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     10.4.  Stateless Reset</span>  . . . . . . . . . . . . . . . . . . . .  <span class="delete">55</span></td><td> </td><td class="rblock">       9.6.2.  Responding to Connection Migration  . . . . . . . . .  <span class="insert">63</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       10.4.1.  Detecting a Stateless Reset</span>  . . . . . . . . . . . .  <span class="delete">57</span></td><td> </td><td class="rblock">       9.6.3.  Interaction of Client Migration and Preferred</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       10.4.2.  Calculating a Stateless Reset Token</span>  . . . . . . . .  <span class="delete">58</span></td><td> </td><td class="rblock">               Address . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">63</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       10.4.3.  Looping</span>  . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">59</span></td><td> </td><td class="rblock"><span class="insert">     9.7.  Use of IPv6 Flow-Label and Migration</span>  . . . . . . . . . .  <span class="insert">64</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   11. Error Handling  . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">59</span></td><td> </td><td class="rblock"><span class="insert">   10. Connection Termination</span>  . . . . . . . . . . . . . . . . . . .  <span class="insert">64</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     11.1.  Connection Errors  . . . . . . . . . . . . . . . . . . .  <span class="delete">60</span></td><td> </td><td class="rblock"><span class="insert">     10.1.  Closing and Draining Connection States</span> . . . . . . . . .  <span class="insert">65</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     11.2.  Stream Errors  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">60</span></td><td> </td><td class="rblock"><span class="insert">     10.2.  Idle Timeout</span> . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">66</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   12. Packets and Frames  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">61</span></td><td> </td><td class="rblock"><span class="insert">       10.2.1.  Liveness Testing</span> . . . . . . . . . . . . . . . . . .  <span class="insert">66</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     12.1.  Protected Packets  . . . . . . . . . . . . . . . . . . .  <span class="delete">61</span></td><td> </td><td class="rblock"><span class="insert">       10.2.2.  Deferring Idle Timeout</span> . . . . . . . . . . . . . . .  <span class="insert">67</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     12.2.  Coalescing Packets . . . . . . . . . . . . . . . . . . .  <span class="delete">62</span></td><td> </td><td class="rblock"><span class="insert">     10.3.  Immediate Close</span>  . . . . . . . . . . . . . . <span class="insert">. . . . . .  67</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     12.3.  Packet Numbers . . . . . . . . . . . . . . . . . . . . .  <span class="delete">62</span></td><td> </td><td class="rblock"><span class="insert">       10.3.1.  Immediate Close During the Handshake . . . . . . . .  69</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     12.4.  Frames and Frame Types . . . . . . . . . . . . . . . . .  <span class="delete">64</span></td><td> </td><td class="rblock"><span class="insert">     10.4.  Stateless Reset  . . . . . . . . . . . . . . . . . . . .  70</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   13. Packetization and Reliability . . . . . . . . . . . . . . . .  <span class="delete">66</span></td><td> </td><td class="rblock"><span class="insert">       10.4.1.  Detecting a Stateless Reset  . . . . . . . . . . . .  73</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     13.1.  Packet Processing <span class="delete">and Acknowledgment</span> . . . . . . . . . .  <span class="delete">67</span></td><td> </td><td class="rblock"><span class="insert">       10.4.2.  Calculating a Stateless Reset Token  . . . . . . . .  74</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       13.1.1.</span>  Sending ACK Frames . . . . . . . . . . . . . . . . .  <span class="delete">67</span></td><td> </td><td class="rblock"><span class="insert">       10.4.3.  Looping  . . . . . . . . . . . . . . . . . . . . . .  75</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       13.1.2.</span>  ACK Frames and Packet Protection . . . . . . . . . .  <span class="delete">68</span></td><td> </td><td class="rblock">   11. Error Handling  . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">75</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     13.2.</span>  Retransmission of Information  . . . . . . . . . . . . .  <span class="delete">68</span></td><td> </td><td class="rblock">     11.1.  Connection Errors  . . . . . . . . . . . . . . . . . . .  <span class="insert">76</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     13.3.</span>  Explicit Congestion Notification . . . . . . . . . . . .  <span class="delete">71</span></td><td> </td><td class="rblock">     11.2.  Stream Errors  . . . . . . . . . . . . . . . . . . . . .  <span class="insert">76</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       13.3.1.  ECN Counts</span> . . . . . . . . . . . . . . . . . . . . .  <span class="delete">71</span></td><td> </td><td class="rblock">   12. Packets and Frames  . . . . . . . . . . . . . . . . . . . . .  <span class="insert">77</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       13.3.2.  ECN Verification</span> . . . . . . . . . . . . . . . . . .  <span class="delete">72</span></td><td> </td><td class="rblock">     12.1.  Protected Packets  . . . . . . . . . . . . . . . . . . .  <span class="insert">77</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   14. Packet Size</span> . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">73</span></td><td> </td><td class="rblock">     12.2.  Coalescing Packets . . . . . . . . . . . . . . . . . . .  <span class="insert">78</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     14.1.  Path Maximum Transmission Unit (PMTU)</span>  . . . . . . . . .  <span class="delete">74</span></td><td> </td><td class="rblock">     12.3.  Packet Numbers . . . . . . . . . . . . . . . . . . . . .  <span class="insert">79</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     14.2.  ICMP Packet Too Big Messages</span> . . . . . . . . . . . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">     12.4.  Frames and Frame Types . . . . . . . . . . . . . . . . .  <span class="insert">80</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     14.3.  Datagram Packetization Layer PMTU Discovery</span>  . . . . . .  <span class="delete">76</span></td><td> </td><td class="rblock">   13. Packetization and Reliability . . . . . . . . . . . . . . . .  <span class="insert">83</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   15. Versions</span>  . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">76</span></td><td> </td><td class="rblock">     13.1.  Packet Processing  . . . . . . . . . . <span class="insert">. . . . . . . . .  84</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   16. Variable-Length Integer Encoding</span>  . . . . . . . . . . . . . .  <span class="delete">77</span></td><td> </td><td class="rblock"><span class="insert">     13.2.  Generating Acknowledgements  . . . . . . . . . . . . . .  84</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   17. Packet Formats</span>  . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">78</span></td><td> </td><td class="rblock"><span class="insert">       13.2.1.</span>  Sending ACK Frames . . . . . . . . . . . . . . . . .  <span class="insert">85</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     17.1.  Packet Number Encoding and Decoding</span>  . . . . . . . . . .  <span class="delete">78</span></td><td> </td><td class="rblock"><span class="insert">       13.2.2.  Acknowledgement Frequency  . . . . . . . . . . . . .  86</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     17.2.  Long Header Packets</span>  . . . . . . . . . . . . . . . . . .  <span class="delete">79</span></td><td> </td><td class="rblock"><span class="insert">       13.2.3.  Managing ACK Ranges  . . . . . . . . . . . . . . . .  86</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       17.2.1.  Version Negotiation Packet</span> . . . . . . . . . . . . .  <span class="delete">82</span></td><td> </td><td class="rblock"><span class="insert">       13.2.4.  Receiver Tracking of ACK Frames  . . . . . . . . . .  87</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       17.2.2.  Initial Packet</span> . . . . . . . . . . . . . . . . . . .  <span class="delete">83</span></td><td> </td><td class="rblock"><span class="insert">       13.2.5.  Limiting ACK Ranges  . . . . . . . . . . . . . . . .  87</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       17.2.3.  0-RTT</span>  . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">86</span></td><td> </td><td class="rblock"><span class="insert">       13.2.6.  Measuring and Reporting Host Delay . . . . . . . . .  88</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       17.2.4.  Handshake Packet</span> . . . . . . . . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock"><span class="insert">       13.2.7.</span>  ACK Frames and Packet Protection . . . . . . . . . .  <span class="insert">88</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       17.2.5.  Retry Packet</span> . . . . . . . . . . . . . . . . . . . .  <span class="delete">88</span></td><td> </td><td class="rblock"><span class="insert">       13.2.8.  PADDING Frames Consume Congestion Window . . . . . .  89</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     17.3.  Short Header Packets</span> . . . . . . . . . . . . . . . . . .  <span class="delete">90</span></td><td> </td><td class="rblock"><span class="insert">     13.3.</span>  Retransmission of Information  . . . . . . . . . . . . .  <span class="insert">89</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   18. Transport Parameter Encoding</span>  . . . . . . . . . . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock"><span class="insert">     13.4.</span>  Explicit Congestion Notification . . . . . . . . . . . .  <span class="insert">92</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     18.1.  Transport Parameter Definitions</span>  . . . . . . . . . . . .  <span class="delete">94</span></td><td> </td><td class="rblock"><span class="insert">       13.4.1.  ECN Counts . . . . . . . . . . . . . . . . . . . . .  92</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   19. Frame Types and Formats</span> . . . . . . . . . . . . . . . . . . .  <span class="delete">97</span></td><td> </td><td class="rblock"><span class="insert">       13.4.2.  ECN Validation . . . . . . . . . . . . . . . . . . .  93</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.1.  PADDING Frame</span>  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">97</span></td><td> </td><td class="rblock"><span class="insert">   14. Packet Size . . . . . . . . . . . . . . . . . . . . . . . . .  95</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.2.  PING</span> Frame . . . . . . . . . . . . . . . . . . <span class="delete">. . . . .  97</span></td><td> </td><td class="rblock"><span class="insert">     14.1.  Initial Packet Size  . . . . . . . . . . . . . . . . . .  95</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.3.  ACK Frames</span> . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">97</span></td><td> </td><td class="rblock"><span class="insert">     14.2.  Path Maximum Transmission Unit (PMTU)  . . . . . . . . .  96</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       19.3.1.  ACK Ranges</span> . . . . . . . . . . . . . . . . . . . . .  <span class="delete">99</span></td><td> </td><td class="rblock"><span class="insert">       14.2.1.  Handling of ICMP Messages by PMTUD . . . . . . . . .  97</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       19.3.2.  ECN Counts</span> . . . . . . . . . . . . . . . . . . . . . <span class="delete">101</span></td><td> </td><td class="rblock"><span class="insert">     14.3.  Datagram Packetization Layer PMTU Discovery  . . . . . .  97</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.4.  RESET_STREAM Frame</span> . . . . . . . . . . . . . . . . . . . <span class="delete">102</span></td><td> </td><td class="rblock"><span class="insert">       14.3.1.  DPLPMTUD and Initial Connectivity  . . . . . . . . .  98</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.5.  STOP_SENDING Frame</span> . . . . . . . . . . . . . . . . . . . <span class="delete">102</span></td><td> </td><td class="rblock"><span class="insert">       14.3.2.  Validating the QUIC Path with DPLPMTUD . . . . . . .  98</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.6.  CRYPTO Frame</span> . . . . . . . . . . . . . . . . . . . . . . <span class="delete">103</span></td><td> </td><td class="rblock"><span class="insert">       14.3.3.  Handling of ICMP Messages by DPLPMTUD  . . . . . . .  98</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.7.  NEW_TOKEN Frame</span>  . . . . . . . . . . . . . . . . . . . . <span class="delete">104</span></td><td> </td><td class="rblock"><span class="insert">     14.4.  Sending QUIC PMTU Probes . . . . . . . . . . . . . . . .  98</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.8.  STREAM Frames</span>  . . . . . . . . . . . . . . . . . . . . . <span class="delete">104</span></td><td> </td><td class="rblock"><span class="insert">       14.4.1.  PMTU Probes Containing Source Connection ID  . . . .  99</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.9.  MAX_DATA Frame</span> . . . . . . . . . . . . . . . . . . . . . <span class="delete">106</span></td><td> </td><td class="rblock"><span class="insert">   15. Versions  . . . . . . . . . . . . . . . . . . . . . . . . . .  99</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.10. MAX_STREAM_DATA Frame</span>  . . . . . . . . . . . . . . . . . <span class="delete">106</span></td><td> </td><td class="rblock"><span class="insert">   16. Variable-Length Integer Encoding  . . . . . . . . . . . . . . 100</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.11. MAX_STREAMS Frames</span> . . . . . . . . . . . . . . . . . . . <span class="delete">107</span></td><td> </td><td class="rblock"><span class="insert">   17. Packet Formats  . . . . . . . . . . . . . . . . . . . . . . . 101</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.12. DATA_BLOCKED Frame</span> . . . . . . . . . . . . . . . . . . . <span class="delete">108</span></td><td> </td><td class="rblock"><span class="insert">     17.1.  Packet Number Encoding and Decoding  . . . . . . . . . . 101</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.13. STREAM_DATA_BLOCKED Frame</span>  . . . . . . . . . . . . . . . <span class="delete">109</span></td><td> </td><td class="rblock"><span class="insert">     17.2.  Long Header Packets  . . . . . . . . . . . . . . . . . . 102</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.14. STREAMS_BLOCKED Frames</span> . . . . . . . . . . . . . . . . . <span class="delete">109</span></td><td> </td><td class="rblock"><span class="insert">       17.2.1.  Version Negotiation Packet . . . . . . . . . . . . . 105</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.15. NEW_CONNECTION_ID Frame</span>  . . . . . . . . . . . . . . . . <span class="delete">110</span></td><td> </td><td class="rblock"><span class="insert">       17.2.2.  Initial Packet . . . . . . . . . . . . . . . . . . . 107</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.16. RETIRE_CONNECTION_ID Frame</span> . . . . . . . . . . . . . . . <span class="delete">111</span></td><td> </td><td class="rblock"><span class="insert">       17.2.3.  0-RTT  . . . . . . . . . . . . . . . . . . . . . . . 109</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.17. PATH_CHALLENGE Frame</span> . . . . . . . . . . . . . . . . . . <span class="delete">112</span></td><td> </td><td class="rblock"><span class="insert">       17.2.4.  Handshake Packet . . . . . . . . . . . . . . . . . . 110</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.18. PATH_RESPONSE Frame</span>  . . . . . . . . . . . . . . . . . . <span class="delete">112</span></td><td> </td><td class="rblock"><span class="insert">       17.2.5.  Retry Packet . . . . . . . . . . . . . . . . . . . . 111</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.19. CONNECTION_CLOSE Frames</span>  . . . . . . . . . . . . . . . . <span class="delete">113</span></td><td> </td><td class="rblock"><span class="insert">     17.3.  Short Header Packets . . . . . . . . . . . . . . . . . . 113</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     19.20. Extension Frames</span> . . . . . . . . . . . . . . . . . . . . <span class="delete">114</span></td><td> </td><td class="rblock"><span class="insert">       17.3.1.  Latency Spin Bit . . . . . . . . . . . . . . . . . . 115</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   20. Transport Error Codes</span> . . . . . . . . . . . . . . . . . . . . <span class="delete">114</span></td><td> </td><td class="rblock"><span class="insert">   18. Transport Parameter Encoding  . . . . . . . . . . . . . . . . 116</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     20.1.  Application Protocol Error Codes</span> . . . . . . . . . . . . <span class="delete">115</span></td><td> </td><td class="rblock"><span class="insert">     18.1.  Reserved Transport Parameters  . . . . . . . . . . . . . 117</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   21. Security Considerations</span> . . . . . . . . . . . . . . . . . . . <span class="delete">116</span></td><td> </td><td class="rblock"><span class="insert">     18.2.  Transport Parameter Definitions  . . . . . . . . . . . . 117</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     21.1.  Handshake Denial of Service</span>  . . . . . . . . . . . . . . <span class="delete">116</span></td><td> </td><td class="rblock"><span class="insert">   19. Frame Types and Formats . . . . .</span> . . . . . . . . . . . . . . <span class="insert">121</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     21.2.  Amplification Attack</span> . . . . . . . . . . . . . . . . . . <span class="delete">117</span></td><td> </td><td class="rblock"><span class="insert">     19.1.  PADDING Frame</span>  . . . . . . . . . . . . . . . . . . . . . <span class="insert">121</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     21.3.  Optimistic ACK Attack</span>  . . . . . . . . . . . . . . . . . <span class="delete">117</span></td><td> </td><td class="rblock"><span class="insert">     19.2.  PING Frame</span> . . . . . . . . . . . . . . . . . . . . . . . <span class="insert">122</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     21.4.  Slowloris Attacks</span>  . . . . . . . . . . . . . . . . . . . <span class="delete">117</span></td><td> </td><td class="rblock"><span class="insert">     19.3.  ACK Frames</span> . . . . . . . . . . . . . . . . . . . . . . . <span class="insert">122</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     21.5.  Stream Fragmentation and Reassembly Attacks</span>  . . . . . . <span class="delete">118</span></td><td> </td><td class="rblock"><span class="insert">       19.3.1.  ACK Ranges</span> . . . . . . . . . . . . . . . . . . . . . <span class="insert">124</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     21.6.  Stream Commitment Attack</span> . . . . . . . . . . . . . . . . <span class="delete">118</span></td><td> </td><td class="rblock"><span class="insert">       19.3.2.  ECN Counts</span> . . . . . . . . . . . . . . . . . . . . . <span class="insert">125</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     21.7.  Explicit Congestion Notification Attacks</span> . . . . . . . . <span class="delete">119</span></td><td> </td><td class="rblock"><span class="insert">     19.4.  RESET_STREAM Frame</span> . . . . . . . . . . . . . . . . . . . <span class="insert">126</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     21.8.  Stateless Reset Oracle</span> . . . . . . . . . . . . . . . . . <span class="delete">119</span></td><td> </td><td class="rblock"><span class="insert">     19.5.  STOP_SENDING Frame</span> . . . . . . . . . . . . . . . . . . . <span class="insert">127</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   22. IANA Considerations</span> . . . . . . . . . . . . . . . . . . . . . <span class="delete">119</span></td><td> </td><td class="rblock"><span class="insert">     19.6.  CRYPTO Frame</span> . . . . . . . . . . . . . . . . . . . . . . <span class="insert">127</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     22.1.  QUIC Transport Parameter Registry</span>  . . . . . . . . . . . <span class="delete">119</span></td><td> </td><td class="rblock"><span class="insert">     19.7.  NEW_TOKEN Frame</span>  . . . . . . . . . . . . . . . . . . . . <span class="insert">128</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     22.2.  QUIC Frame Type Registry</span> . . . . . . . . . . . . . . . . <span class="delete">121</span></td><td> </td><td class="rblock"><span class="insert">     19.8.  STREAM Frames</span>  . . . . . . . . . . . . . . . . . . . . . <span class="insert">129</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     22.3.  QUIC Transport Error Codes Registry</span>  . . . . . . . . . . <span class="delete">122</span></td><td> </td><td class="rblock"><span class="insert">     19.9.  MAX_DATA Frame</span> . . . . . . . . . . . . . . . . . . . . . <span class="insert">131</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   23. References</span>  . . . . . . . . . . . . . . . . . . . . . . . . . <span class="delete">125</span></td><td> </td><td class="rblock"><span class="insert">     19.10. MAX_STREAM_DATA Frame</span>  . . . . . . . . . . . . . . . . . <span class="insert">131</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     23.1.  Normative References</span> . . . . . . . . . . . . . . . . . . <span class="delete">125</span></td><td> </td><td class="rblock"><span class="insert">     19.11. MAX_STREAMS Frames</span> . . . . . . . . . . . . . . . . . . . <span class="insert">132</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     23.2.  Informative References</span> . . . . . . . . . . . . . . . . . <span class="delete">126</span></td><td> </td><td class="rblock"><span class="insert">     19.12. DATA_BLOCKED Frame</span> . . . . . . . . . . . . . . . . . . . <span class="insert">133</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Appendix A.  Sample Packet Number Decoding Algorithm</span>  . . . . . . <span class="delete">128</span></td><td> </td><td class="rblock"><span class="insert">     19.13. STREAM_DATA_BLOCKED Frame</span>  . . . . . . . . . . . . . . . <span class="insert">134</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Appendix B.  Change Log</span> . . . . . . . . . . . . . . . . . . . . . <span class="delete">128</span></td><td> </td><td class="rblock"><span class="insert">     19.14. STREAMS_BLOCKED Frames</span> . . . . . . . . . . . . . . . . . <span class="insert">134</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.1.</span>  Since draft-ietf-quic-transport-17  . . . . . . . . . . . <span class="delete">128</span></td><td> </td><td class="rblock"><span class="insert">     19.15. NEW_CONNECTION_ID Frame</span>  . . . . . . . . . . . . . . . . <span class="insert">135</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.2.</span>  Since draft-ietf-quic-transport-16  . . . . . . . . . . . <span class="delete">129</span></td><td> </td><td class="rblock"><span class="insert">     19.16. RETIRE_CONNECTION_ID Frame</span> . . . . . . . . . . . . . . . <span class="insert">136</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.3.</span>  Since draft-ietf-quic-transport-15  . . . . . . . . . . . <span class="delete">130</span></td><td> </td><td class="rblock"><span class="insert">     19.17. PATH_CHALLENGE</span> Frame . . . . . . . . . . . . . . . . . . <span class="insert">137</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.4.</span>  Since draft-ietf-quic-transport-14  . . . . . . . . . . . <span class="delete">130</span></td><td> </td><td class="rblock"><span class="insert">     19.18. PATH_RESPONSE Frame</span>  . . . . . . . . . . . . . . . . . . <span class="insert">138</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.5.</span>  Since draft-ietf-quic-transport-13  . . . . . . . . . . . <span class="delete">131</span></td><td> </td><td class="rblock"><span class="insert">     19.19. CONNECTION_CLOSE Frames</span>  . . . . . . . . . . . . . . . . <span class="insert">138</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.6.</span>  Since draft-ietf-quic-transport-12  . . . . . . . . . . . <span class="delete">132</span></td><td> </td><td class="rblock"><span class="insert">     19.20. HANDSHAKE_DONE frame</span> . . . . . . . . . . . . . . . . . . <span class="insert">139</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.7.</span>  Since draft-ietf-quic-transport-11  . . . . . . . . . . . <span class="delete">133</span></td><td> </td><td class="rblock"><span class="insert">     19.21. Extension Frames</span> . . . . . . . . . . . . . . . . . . . . <span class="insert">140</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.8.</span>  Since draft-ietf-quic-transport-10  . . . . . . . . . . . <span class="delete">133</span></td><td> </td><td class="rblock"><span class="insert">   20. Transport Error Codes</span> . . . . . . . . . . . . . . . . . . . . <span class="insert">140</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.9.</span>  Since draft-ietf-quic-transport-09  . . . . . . . . . . . <span class="delete">134</span></td><td> </td><td class="rblock"><span class="insert">     20.1.  Application Protocol Error Codes</span> . . . . . . . . . . . . <span class="insert">142</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.10.</span> Since draft-ietf-quic-transport-08  . . . . . . . . . . . <span class="delete">134</span></td><td> </td><td class="rblock"><span class="insert">   21. Security Considerations</span> . . . . . . . . . . . . . . . . . . . <span class="insert">142</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.11.</span> Since draft-ietf-quic-transport-07  . . . . . . . . . . . <span class="delete">135</span></td><td> </td><td class="rblock"><span class="insert">     21.1.  Handshake Denial of Service</span>  . . . . . . . . . . . . . . <span class="insert">142</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.12.</span> Since draft-ietf-quic-transport-06  . . . . . . . . . . . <span class="delete">136</span></td><td> </td><td class="rblock"><span class="insert">     21.2.  Amplification Attack</span> . . . . . . . . . . . . . . . . . . <span class="insert">143</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.13.</span> Since draft-ietf-quic-transport-05  . . . . . . . . . . . <span class="delete">136</span></td><td> </td><td class="rblock"><span class="insert">     21.3.  Optimistic ACK Attack</span>  . . . . . . . . . . . . . . . . . <span class="insert">144</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.14.</span> Since draft-ietf-quic-transport-04  . . . . . . . . . . . <span class="delete">136</span></td><td> </td><td class="rblock"><span class="insert">     21.4.  Slowloris Attacks</span>  . . . . . . . . . . . . . . . . . . . <span class="insert">144</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.15.</span> Since draft-ietf-quic-transport-03  . . . . . . . . . . . <span class="delete">137</span></td><td> </td><td class="rblock"><span class="insert">     21.5.  Stream Fragmentation and Reassembly Attacks</span>  . . . . . . <span class="insert">144</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.16.</span> Since draft-ietf-quic-transport-02  . . . . . . . . . . . <span class="delete">137</span></td><td> </td><td class="rblock"><span class="insert">     21.6.  Stream Commitment Attack</span> . . . . . . . . . . . . . . . . <span class="insert">145</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.17.</span> Since draft-ietf-quic-transport-01  . . . . . . . . . . . <span class="delete">138</span></td><td> </td><td class="rblock"><span class="insert">     21.7.  Peer Denial of Service</span> . . . . . . . . . . . . . . . . . <span class="insert">145</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.18.</span> Since draft-ietf-quic-transport-00  . . . . . . . . . . . <span class="delete">140</span></td><td> </td><td class="rblock"><span class="insert">     21.8.  Explicit Congestion Notification Attacks</span> . . . . . . . . <span class="insert">146</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     B.19.</span> Since draft-hamilton-quic-transport-protocol-01 . . . . . <span class="delete">140</span></td><td> </td><td class="rblock"><span class="insert">     21.9.  Stateless Reset Oracle</span> . . . . . . . . . . . . . . . . . <span class="insert">146</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . . 141</span></td><td> </td><td class="rblock"><span class="insert">     21.10. Version Downgrade</span>  . . . . . . . . . . . . . . . . . . . <span class="insert">147</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Contributors  . . . . . . . . . . . . . . . . . . . . . . . . . . <span class="delete">141</span></td><td> </td><td class="rblock"><span class="insert">     21.11. Targeted Attacks by Routing</span>  . . . . . . . . . . . . . . <span class="insert">147</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . . <span class="delete">141</span></td><td> </td><td class="rblock"><span class="insert">     21.12. Overview of Security Properties</span>  . . . . . . . . . . . . <span class="insert">147</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       21.12.1.  Handshake</span> . . . . . . . . . . . . . . . . . . . . . <span class="insert">148</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       21.12.2.  Protected Packets</span> . . . . . . . . . . . . . . . . . <span class="insert">149</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       21.12.3.  Connection Migration</span>  . . . . . . . . . . . . . . . <span class="insert">150</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   22. IANA Considerations</span> . . . . . . . . . . . . . . . . . . . . . <span class="insert">154</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     22.1.  Registration Policies for QUIC Registries</span>  . . . . . . . <span class="insert">154</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       22.1.1.  Provisional Registrations</span>  . . . . . . . . . . . . . <span class="insert">154</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       22.1.2.  Selecting Codepoints</span> . . . . . . . . . . . . . . . . <span class="insert">155</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       22.1.3.  Reclaiming Provisional Codepoints</span>  . . . . . . . . . <span class="insert">156</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       22.1.4.  Permanent Registrations</span>  . . . . . . . . . . . . . . <span class="insert">157</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     22.2.  QUIC Transport Parameter Registry</span>  . . . . . . . . . . . <span class="insert">157</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     22.3.  QUIC Frame Type Registry</span> . . . . . . . . . . . . . . . . <span class="insert">158</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     22.4.  QUIC Transport Error Codes Registry</span>  . . . . . . . . . . <span class="insert">159</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   23. References</span>  . . . . . . . . . . . . . . . . . . . . . . . . . <span class="insert">161</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     23.1.  Normative References</span> . . . . . . . . . . . . . . . . . . <span class="insert">161</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     23.2.  Informative References</span> . . . . . . . . . . . . . . . . . <span class="insert">162</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Appendix A.  Sample Packet Number Decoding Algorithm</span>  . . . . . . <span class="insert">164</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Appendix B.  Sample ECN Validation Algorithm</span>  . . . . . . . . . . <span class="insert">165</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Appendix C.  Change Log</span> . . . . . . . . . . . . . . . . . . . . . <span class="insert">166</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.1.  Since draft-ietf-quic-transport-28</span>  . . . . . . . . . . . <span class="insert">166</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.2.  Since draft-ietf-quic-transport-27</span>  . . . . . . . . . . . <span class="insert">166</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.3.  Since draft-ietf-quic-transport-26</span>  . . . . . . . . . . . <span class="insert">168</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.4.  Since draft-ietf-quic-transport-25</span>  . . . . . . . . . . . <span class="insert">168</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.5.  Since draft-ietf-quic-transport-24</span>  . . . . . . . . . . . <span class="insert">168</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.6.  Since draft-ietf-quic-transport-23</span>  . . . . . . . . . . . <span class="insert">169</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.7.  Since draft-ietf-quic-transport-22</span>  . . . . . . . . . . . <span class="insert">170</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.8.  Since draft-ietf-quic-transport-21</span>  . . . . . . . . . . . <span class="insert">171</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.9.  Since draft-ietf-quic-transport-20</span>  . . . . . . . . . . . <span class="insert">171</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.10. Since draft-ietf-quic-transport-19</span>  . . . . . . . . . . . <span class="insert">172</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.11. Since draft-ietf-quic-transport-18</span>  . . . . . . . . . . . <span class="insert">172</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.12.</span> Since draft-ietf-quic-transport-17  . . . . . . . . . . . <span class="insert">173</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.13.</span> Since draft-ietf-quic-transport-16  . . . . . . . . . . . <span class="insert">174</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.14.</span> Since draft-ietf-quic-transport-15  . . . . . . . . . . . <span class="insert">175</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.15.</span> Since draft-ietf-quic-transport-14  . . . . . . . . . . . <span class="insert">175</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.16.</span> Since draft-ietf-quic-transport-13  . . . . . . . . . . . <span class="insert">175</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.17.</span> Since draft-ietf-quic-transport-12  . . . . . . . . . . . <span class="insert">176</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.18.</span> Since draft-ietf-quic-transport-11  . . . . . . . . . . . <span class="insert">177</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.19.</span> Since draft-ietf-quic-transport-10  . . . . . . . . . . . <span class="insert">177</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.20.</span> Since draft-ietf-quic-transport-09  . . . . . . . . . . . <span class="insert">178</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.21.</span> Since draft-ietf-quic-transport-08  . . . . . . . . . . . <span class="insert">179</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.22.</span> Since draft-ietf-quic-transport-07  . . . . . . . . . . . <span class="insert">179</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.23.</span> Since draft-ietf-quic-transport-06  . . . . . . . . . . . <span class="insert">180</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.24.</span> Since draft-ietf-quic-transport-05  . . . . . . . . . . . <span class="insert">180</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.25.</span> Since draft-ietf-quic-transport-04  . . . . . . . . . . . <span class="insert">181</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.26.</span> Since draft-ietf-quic-transport-03  . . . . . . . . . . . <span class="insert">181</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.27.</span> Since draft-ietf-quic-transport-02  . . . . . . . . . . . <span class="insert">182</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.28.</span> Since draft-ietf-quic-transport-01  . . . . . . . . . . . <span class="insert">182</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.29.</span> Since draft-ietf-quic-transport-00  . . . . . . . . . . . <span class="insert">184</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     C.30.</span> Since draft-hamilton-quic-transport-protocol-01 . . . . . <span class="insert">185</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Contributors  . . . . . . . . . . . . . . . . . . . . . . . . . . <span class="insert">185</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . . <span class="insert">186</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC is a multiplexed and secure general-purpose transport protocol</td><td> </td><td class="right">   QUIC is a multiplexed and secure general-purpose transport protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that provides:</td><td> </td><td class="right">   that provides:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0009"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Stream multiplexing</td><td> </td><td class="rblock">   <span class="insert">*</span>  Stream multiplexing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0010"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Stream and connection-level flow control</td><td> </td><td class="rblock">   <span class="insert">*</span>  Stream and connection-level flow control</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0011"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Low-latency connection establishment</td><td> </td><td class="rblock">   <span class="insert">*</span>  Low-latency connection establishment</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Connection migration and resilience to NAT rebinding</td><td> </td><td class="rblock">   <span class="insert">*</span>  Connection migration and resilience to NAT rebinding</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0012"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Authenticated and encrypted header and payload</td><td> </td><td class="rblock">   <span class="insert">*</span>  Authenticated and encrypted header and payload</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC uses UDP as a substrate to avoid requiring changes to legacy</td><td> </td><td class="right">   QUIC uses UDP as a substrate to avoid requiring changes to legacy</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   client operating systems and middleboxes.  QUIC authenticates all of</td><td> </td><td class="right">   client operating systems and middleboxes.  QUIC authenticates all of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   its headers and encrypts most of the data it exchanges, including its</td><td> </td><td class="right">   its headers and encrypts most of the data it exchanges, including its</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   signaling, to avoid incurring a dependency on middleboxes.</td><td> </td><td class="right">   signaling, to avoid incurring a dependency on middleboxes.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">1.1.  Document Structure</td><td> </td><td class="right">1.1.  Document Structure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document describes the core QUIC protocol and is structured as</td><td> </td><td class="right">   This document describes the core QUIC protocol and is structured as</td><td class="lineno"></td></tr>
      <tr id="diff0013"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   follows<span class="delete">.</span></td><td> </td><td class="rblock">   follows<span class="insert">:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0014"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Streams are the basic service abstraction that QUIC provides.</td><td> </td><td class="rblock">   <span class="insert">*</span>  Streams are the basic service abstraction that QUIC provides.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0015"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 2 describes core concepts related to streams,</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 2 describes core concepts related to streams,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0016"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 3 provides a reference model for stream states, and</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 3 provides a reference model for stream states, and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0017"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 4 outlines the operation of flow control.</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 4 outlines the operation of flow control.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0018"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Connections are the context in which QUIC endpoints communicate.</td><td> </td><td class="rblock">   <span class="insert">*</span>  Connections are the context in which QUIC endpoints communicate.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0019"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 5 describes core concepts related to connections,</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 5 describes core concepts related to connections,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0020"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 6 describes version negotiation,</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 6 describes version negotiation,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0021"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 7 details the process for establishing connections,</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 7 details the process for establishing connections,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0022"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 8 specifies critical denial of service mitigation</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 8 specifies critical denial of service mitigation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         mechanisms,</td><td> </td><td class="right">         mechanisms,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0023"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 9 describes how endpoints migrate a connection to a new</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 9 describes how endpoints migrate a connection to a new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         network path,</td><td> </td><td class="right">         network path,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0024"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 10 lists the options for terminating an open</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 10 lists the options for terminating an open</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         connection, and</td><td> </td><td class="right">         connection, and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0025"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 11 provides general guidance for error handling.</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 11 provides general guidance for error handling.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0026"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Packets and frames are the basic unit used by QUIC to communicate.</td><td> </td><td class="rblock">   <span class="insert">*</span>  Packets and frames are the basic unit used by QUIC to communicate.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0027"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 12 describes concepts related to packets and frames,</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 12 describes concepts related to packets and frames,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0028"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 13 defines models for the transmission, retransmission,</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 13 defines models for the transmission, retransmission,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         and acknowledgement of data, and</td><td> </td><td class="right">         and acknowledgement of data, and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0029"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 14 specifies rules for managing the size of packets.</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 14 specifies rules for managing the size of packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0030"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Finally, encoding details of QUIC protocol elements are described</td><td> </td><td class="rblock">   <span class="insert">*</span>  Finally, encoding details of QUIC protocol elements are described</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      in:</td><td> </td><td class="right">      in:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0031"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 15 (Versions),</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 15 (Versions),</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0032"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 16 (Integer Encoding),</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 16 (Integer Encoding),</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0033"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 17 (Packet Headers),</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 17 (Packet Headers),</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0034"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 18 (Transport Parameters),</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 18 (Transport Parameters),</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0035"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 19 (Frames), and</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 19 (Frames), and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0036"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Section 20 (Errors).</td><td> </td><td class="rblock">      <span class="insert">-</span>  Section 20 (Errors).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Accompanying documents describe QUIC's loss detection and congestion</td><td> </td><td class="right">   Accompanying documents describe QUIC's loss detection and congestion</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   control [QUIC-RECOVERY], and the use of TLS for key negotiation</td><td> </td><td class="right">   control [QUIC-RECOVERY], and the use of TLS for key negotiation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [QUIC-TLS].</td><td> </td><td class="right">   [QUIC-TLS].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document defines QUIC version 1, which conforms to the protocol</td><td> </td><td class="right">   This document defines QUIC version 1, which conforms to the protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   invariants in [QUIC-INVARIANTS].</td><td> </td><td class="right">   invariants in [QUIC-INVARIANTS].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0037"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">To refer to QUIC version 1, cite this document.  References to the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   limited set of version-independent properties of QUIC can cite</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [QUIC-INVARIANTS].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">1.2.  Terms and Definitions</td><td> </td><td class="right">1.2.  Terms and Definitions</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0038"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td> </td><td class="rblock">   The key<span class="insert"> </span>words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td> </td><td class="right">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td class="lineno"></td></tr>
      <tr id="diff0039"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   "OPTIONAL" in this document are to be interpreted as described in BCP</td><td> </td><td class="rblock">   "OPTIONAL" in this document are to be interpreted as described in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td> </td><td class="rblock">   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   capitals, as shown here.</td><td> </td><td class="right">   capitals, as shown here.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Commonly used terms in the document are described below.</td><td> </td><td class="right">   Commonly used terms in the document are described below.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC:  The transport protocol described by this document.  QUIC is a</td><td> </td><td class="right">   QUIC:  The transport protocol described by this document.  QUIC is a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      name, not an acronym.</td><td> </td><td class="right">      name, not an acronym.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0040"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   QUIC packet:  <span class="delete">The smallest</span> unit of QUIC that can be encapsulated in a</td><td> </td><td class="rblock">   QUIC packet:  <span class="insert">A complete processable</span> unit of QUIC that can be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      UDP datagram.  Multiple QUIC packets can be encapsulated in a</td><td> </td><td class="rblock">      encapsulated in a UDP datagram.  Multiple QUIC packets can be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      single UDP datagram.</td><td> </td><td class="rblock">      encapsulated in a single UDP datagram.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Ack-eliciting Packet:  A QUIC packet that contains frames other than</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      ACK, PADDING, and CONNECTION_CLOSE.  These cause a recipient to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      send an acknowledgment; see Section 13.2.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Out-of-order packet:  A packet that does not increase the largest</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      received packet number for its packet number space (Section 12.3)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      by exactly one.  A packet can arrive out of order if it is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      delayed, if earlier packets are lost or delayed, or if the sender</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      intentionally skips a packet number.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Endpoint:  An entity that can participate in a QUIC connection by</td><td> </td><td class="right">   Endpoint:  An entity that can participate in a QUIC connection by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      generating, receiving, and processing QUIC packets.  There are</td><td> </td><td class="right">      generating, receiving, and processing QUIC packets.  There are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      only two types of endpoint in QUIC: client and server.</td><td> </td><td class="right">      only two types of endpoint in QUIC: client and server.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Client:  The endpoint initiating a QUIC connection.</td><td> </td><td class="right">   Client:  The endpoint initiating a QUIC connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Server:  The endpoint accepting incoming QUIC connections.</td><td> </td><td class="right">   Server:  The endpoint accepting incoming QUIC connections.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0041"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Address:  When used without qualification, the tuple of IP version,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      IP address, UDP protocol, and UDP port number that represents one</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      end of a network path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Connection ID:  An opaque identifier that is used to identify a QUIC</td><td> </td><td class="right">   Connection ID:  An opaque identifier that is used to identify a QUIC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      connection at an endpoint.  Each endpoint sets a value for its</td><td> </td><td class="right">      connection at an endpoint.  Each endpoint sets a value for its</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      peer to include in packets sent towards the endpoint.</td><td> </td><td class="right">      peer to include in packets sent towards the endpoint.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stream:  A unidirectional or bidirectional channel of ordered bytes</td><td> </td><td class="right">   Stream:  A unidirectional or bidirectional channel of ordered bytes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      within a QUIC connection.  A QUIC connection can carry multiple</td><td> </td><td class="right">      within a QUIC connection.  A QUIC connection can carry multiple</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      simultaneous streams.</td><td> </td><td class="right">      simultaneous streams.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Application:  An entity that uses QUIC to send and receive data.</td><td> </td><td class="right">   Application:  An entity that uses QUIC to send and receive data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">1.3.  Notational Conventions</td><td> </td><td class="right">1.3.  Notational Conventions</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0042"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Packet and frame diagrams in this document use <span class="delete">the format described</span></td><td> </td><td class="rblock">   Packet and frame diagrams in this document use <span class="insert">a bespoke format.  The</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   in Section 3.1</span> of <span class="delete">[RFC2360], with</span> the <span class="delete">following additional</span></td><td> </td><td class="rblock"><span class="insert">   purpose</span> of <span class="insert">this format is to summarize, not define, protocol</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   conventions:</span></td><td> </td><td class="rblock"><span class="insert">   elements.  Prose defines</span> the <span class="insert">complete semantics and details of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   structures.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0043"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">[x]:  Indicates that x</span> is <span class="delete">optional</span></td><td> </td><td class="rblock">   <span class="insert">Complex fields are named and then followed by a list of fields</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   surrounded by a pair of matching braces.  Each field in this list</span> is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">separated by commas.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0044"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">x (A):  Indicates that x is A bits long</span></td><td> </td><td class="rblock">   <span class="insert">Individual fields include length information, plus indications about</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   fixed value, optionality, or repetitions.  Individual fields use the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   following notational conventions, with all lengths in bits:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0045"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   x (A<span class="delete">/B/C) ...:  Indicates that x is one of A, B, or C</span> bits long</td><td> </td><td class="rblock">   x (A<span class="insert">):  Indicates that x is A</span> bits long</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0046"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   x (i)<span class="delete"> ...</span>:  Indicates that x uses the variable-length encoding in</td><td> </td><td class="rblock">   x (i):  Indicates that x uses the variable-length encoding in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Section 16</td><td> </td><td class="right">      Section 16</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0047"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   x <span class="delete">(*)</span> ...:  Indicates that x is <span class="delete">variable-length</span></td><td> </td><td class="rblock">   x <span class="insert">(A..B):  Indicates that x can be any length from A to B; A can be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      omitted to indicate a minimum of zero bits and B can be omitted to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      indicate no set upper limit; values in this format always end on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      an octet boundary</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   x (?) = C:  Indicates that x has a fixed value of C</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   x (?) = C..D:  Indicates that x has a value in the range from C to D,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      inclusive</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [x (E)]:  Indicates that x is optional (and has length of E)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   x (E)</span> ...:  Indicates that x is <span class="insert">repeated zero or more times (and that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      each instance is length E)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This document uses network byte order (that is, big endian) values.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Fields are placed starting from the high-order bits of each byte.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   By convention, individual fields reference a complex field by using</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the name of the complex field.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   For example:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Example Structure {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     One-bit Field (1),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     7-bit Field with Fixed Value (7) = 61,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Field with Variable-Length Integer (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Arbitrary-Length Field (..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Variable-Length Field (8..24),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Field With Minimum Length (16..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Field With Maximum Length (..128),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     [Optional Field (64)],</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Repeated Field (8) ...,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                          Figure 1: Example Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">2.  Streams</td><td> </td><td class="right">2.  Streams</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Streams in QUIC provide a lightweight, ordered byte-stream</td><td> </td><td class="right">   Streams in QUIC provide a lightweight, ordered byte-stream</td><td class="lineno"></td></tr>
      <tr id="diff0048"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   abstraction to an application.  An alternative view of QUIC streams</td><td> </td><td class="rblock">   abstraction to an application.  <span class="insert">Streams can be unidirectional or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   is <span class="delete">as an elastic</span> "message" <span class="delete">abstraction.</span></td><td> </td><td class="rblock"><span class="insert">   bidirectional.</span>  An alternative view of QUIC <span class="insert">unidirectional</span> streams is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">a</span> "message" <span class="insert">abstraction of practically unlimited length.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Streams can be created by sending data.  Other processes associated</td><td> </td><td class="right">   Streams can be created by sending data.  Other processes associated</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   with stream management - ending, cancelling, and managing flow</td><td> </td><td class="right">   with stream management - ending, cancelling, and managing flow</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   control - are all designed to impose minimal overheads.  For</td><td> </td><td class="right">   control - are all designed to impose minimal overheads.  For</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   instance, a single STREAM frame (Section 19.8) can open, carry data</td><td> </td><td class="right">   instance, a single STREAM frame (Section 19.8) can open, carry data</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   for, and close a stream.  Streams can also be long-lived and can last</td><td> </td><td class="right">   for, and close a stream.  Streams can also be long-lived and can last</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the entire duration of a connection.</td><td> </td><td class="right">   the entire duration of a connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Streams can be created by either endpoint, can concurrently send data</td><td> </td><td class="right">   Streams can be created by either endpoint, can concurrently send data</td><td class="lineno"></td></tr>
      <tr id="diff0049"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   interleaved with other streams, and can be cancelled.  <span class="delete">Any stream can</span></td><td> </td><td class="rblock">   interleaved with other streams, and can be cancelled.  QUIC does not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   be initiated by either endpoint.</span>  QUIC does not provide any means of</td><td> </td><td class="rblock">   provide any means of ensuring ordering between bytes on different</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   ensuring ordering between bytes on different streams.</td><td> </td><td class="rblock">   streams.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC allows for an arbitrary number of streams to operate</td><td> </td><td class="right">   QUIC allows for an arbitrary number of streams to operate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   concurrently and for an arbitrary amount of data to be sent on any</td><td> </td><td class="right">   concurrently and for an arbitrary amount of data to be sent on any</td><td class="lineno"></td></tr>
      <tr id="diff0050"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   stream, subject to flow control constraints <span class="delete">(see Section 4)</span> and</td><td> </td><td class="rblock">   stream, subject to flow control constraints and stream <span class="insert">limits; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   stream <span class="delete">limits.</span></td><td> </td><td class="rblock"><span class="insert">   Section 4.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">2.1.  Stream Types and Identifiers</td><td> </td><td class="right">2.1.  Stream Types and Identifiers</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Streams can be unidirectional or bidirectional.  Unidirectional</td><td> </td><td class="right">   Streams can be unidirectional or bidirectional.  Unidirectional</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   streams carry data in one direction: from the initiator of the stream</td><td> </td><td class="right">   streams carry data in one direction: from the initiator of the stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to its peer.  Bidirectional streams allow for data to be sent in both</td><td> </td><td class="right">   to its peer.  Bidirectional streams allow for data to be sent in both</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   directions.</td><td> </td><td class="right">   directions.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Streams are identified within a connection by a numeric value,</td><td> </td><td class="right">   Streams are identified within a connection by a numeric value,</td><td class="lineno"></td></tr>
      <tr id="diff0051"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   referred to as the stream ID.  Stream IDs are <span class="delete">unique to a stream.</span>  A</td><td> </td><td class="rblock">   referred to as the stream ID.  <span class="insert">A stream ID is a 62-bit integer (0 to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   QUIC endpoint MUST NOT reuse a stream ID within a connection.  <span class="delete">Stream</span></td><td> </td><td class="rblock"><span class="insert">   2^62-1) that is unique for all streams on a connection.</span>  Stream IDs</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   IDs are encoded as variable-length integers (see Section 16).</span></td><td> </td><td class="rblock">   are <span class="insert">encoded as variable-length integers; see Section 16.</span>  A QUIC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   endpoint MUST NOT reuse a stream ID within a connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The least significant bit (0x1) of the stream ID identifies the</td><td> </td><td class="right">   The least significant bit (0x1) of the stream ID identifies the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   initiator of the stream.  Client-initiated streams have even-numbered</td><td> </td><td class="right">   initiator of the stream.  Client-initiated streams have even-numbered</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream IDs (with the bit set to 0), and server-initiated streams have</td><td> </td><td class="right">   stream IDs (with the bit set to 0), and server-initiated streams have</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   odd-numbered stream IDs (with the bit set to 1).</td><td> </td><td class="right">   odd-numbered stream IDs (with the bit set to 1).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The second least significant bit (0x2) of the stream ID distinguishes</td><td> </td><td class="right">   The second least significant bit (0x2) of the stream ID distinguishes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   between bidirectional streams (with the bit set to 0) and</td><td> </td><td class="right">   between bidirectional streams (with the bit set to 0) and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   unidirectional streams (with the bit set to 1).</td><td> </td><td class="right">   unidirectional streams (with the bit set to 1).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The least significant two bits from a stream ID therefore identify a</td><td> </td><td class="right">   The least significant two bits from a stream ID therefore identify a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream as one of four types, as summarized in Table 1.</td><td> </td><td class="right">   stream as one of four types, as summarized in Table 1.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                +------+----------------------------------+</td><td> </td><td class="right">                +------+----------------------------------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                | Bits | Stream Type                      |</td><td> </td><td class="right">                | Bits | Stream Type                      |</td><td class="lineno"></td></tr>
      <tr id="diff0052"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                +<span class="delete">------+----------------------------------</span>+</td><td> </td><td class="rblock">                +<span class="insert">======+==================================</span>+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                | 0x0  | Client-Initiated, Bidirectional  |</td><td> </td><td class="right">                | 0x0  | Client-Initiated, Bidirectional  |</td><td class="lineno"></td></tr>
      <tr id="diff0053"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                <span class="delete">|      |                                  |</span></td><td> </td><td class="rblock">                <span class="insert">+------+----------------------------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                | 0x1  | Server-Initiated, Bidirectional  |</td><td> </td><td class="right">                | 0x1  | Server-Initiated, Bidirectional  |</td><td class="lineno"></td></tr>
      <tr id="diff0054"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                <span class="delete">|      |                                  |</span></td><td> </td><td class="rblock">                <span class="insert">+------+----------------------------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                | 0x2  | Client-Initiated, Unidirectional |</td><td> </td><td class="right">                | 0x2  | Client-Initiated, Unidirectional |</td><td class="lineno"></td></tr>
      <tr id="diff0055"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                <span class="delete">|      |                                  |</span></td><td> </td><td class="rblock">                <span class="insert">+------+----------------------------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                | 0x3  | Server-Initiated, Unidirectional |</td><td> </td><td class="right">                | 0x3  | Server-Initiated, Unidirectional |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                +------+----------------------------------+</td><td> </td><td class="right">                +------+----------------------------------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0056"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                         Table 1: Stream ID Types</td><td> </td><td class="rblock">                         <span class="insert"> </span>Table 1: Stream ID Types</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Within each type, streams are created with numerically increasing</td><td> </td><td class="right">   Within each type, streams are created with numerically increasing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream IDs.  A stream ID that is used out of order results in all</td><td> </td><td class="right">   stream IDs.  A stream ID that is used out of order results in all</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   streams of that type with lower-numbered stream IDs also being</td><td> </td><td class="right">   streams of that type with lower-numbered stream IDs also being</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   opened.</td><td> </td><td class="right">   opened.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The first bidirectional stream opened by the client has a stream ID</td><td> </td><td class="right">   The first bidirectional stream opened by the client has a stream ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   of 0.</td><td> </td><td class="right">   of 0.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">2.2.  Sending and Receiving Data</td><td> </td><td class="right">2.2.  Sending and Receiving Data</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-2" class="change"><td></td><th><small>skipping to change at</small><a href="#part-2"><em> page 10, line 28<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-2"><em> page 12, line 50<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   deliver data out of order to a receiving application.</td><td> </td><td class="right">   deliver data out of order to a receiving application.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint could receive data for a stream at the same stream offset</td><td> </td><td class="right">   An endpoint could receive data for a stream at the same stream offset</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   multiple times.  Data that has already been received can be</td><td> </td><td class="right">   multiple times.  Data that has already been received can be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   discarded.  The data at a given offset MUST NOT change if it is sent</td><td> </td><td class="right">   discarded.  The data at a given offset MUST NOT change if it is sent</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   multiple times; an endpoint MAY treat receipt of different data at</td><td> </td><td class="right">   multiple times; an endpoint MAY treat receipt of different data at</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the same offset within a stream as a connection error of type</td><td> </td><td class="right">   the same offset within a stream as a connection error of type</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   PROTOCOL_VIOLATION.</td><td> </td><td class="right">   PROTOCOL_VIOLATION.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Streams are an ordered byte-stream abstraction with no other</td><td> </td><td class="right">   Streams are an ordered byte-stream abstraction with no other</td><td class="lineno"></td></tr>
      <tr id="diff0057"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   structure <span class="delete">that is</span> visible to QUIC.  STREAM frame boundaries are not</td><td> </td><td class="rblock">   structure visible to QUIC.  STREAM frame boundaries are not expected</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   expected to be preserved when data is transmitted, <span class="delete">when data is</span></td><td> </td><td class="rblock">   to be preserved when data is transmitted, retransmitted after packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   retransmitted after packet loss, or <span class="delete">when data is</span> delivered to the</td><td> </td><td class="rblock">   loss, or delivered to the application at a receiver.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   application at a receiver.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MUST NOT send data on any stream without ensuring that it</td><td> </td><td class="right">   An endpoint MUST NOT send data on any stream without ensuring that it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   is within the flow control limits set by its peer.  Flow control is</td><td> </td><td class="right">   is within the flow control limits set by its peer.  Flow control is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   described in detail in Section 4.</td><td> </td><td class="right">   described in detail in Section 4.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">2.3.  Stream Prioritization</td><td> </td><td class="right">2.3.  Stream Prioritization</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stream multiplexing can have a significant effect on application</td><td> </td><td class="right">   Stream multiplexing can have a significant effect on application</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   performance if resources allocated to streams are correctly</td><td> </td><td class="right">   performance if resources allocated to streams are correctly</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   prioritized.</td><td> </td><td class="right">   prioritized.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0058"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   QUIC does not provide <span class="delete">frames</span> for exchanging prioritization</td><td> </td><td class="rblock">   QUIC does not provide <span class="insert">a mechanism</span> for exchanging prioritization</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   information.  <span class="delete">Instead</span> it relies on receiving priority information</td><td> </td><td class="rblock">   information.  <span class="insert">Instead,</span> it relies on receiving priority information</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   from the application that uses QUIC.</td><td> </td><td class="right">   from the application that uses QUIC.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A QUIC implementation SHOULD provide ways in which an application can</td><td> </td><td class="right">   A QUIC implementation SHOULD provide ways in which an application can</td><td class="lineno"></td></tr>
      <tr id="diff0059"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   indicate the relative priority of streams.  When deciding <span class="delete">which</span></td><td> </td><td class="rblock">   indicate the relative priority of streams.  When deciding <span class="insert">the</span> streams</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   streams to <span class="delete">dedicate</span> resources <span class="delete">to,</span> the implementation SHOULD use the</td><td> </td><td class="rblock">   to <span class="insert">which</span> resources <span class="insert">are dedicated,</span> the implementation SHOULD use the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   information provided by the application.</td><td> </td><td class="right">   information provided by the application.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0060"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">2.4.  Required Operations on Streams</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   There are certain operations that an application MUST be able to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   perform when interacting with QUIC streams.  This document does not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   specify an API, but any implementation of this version of QUIC MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   expose the ability to perform the operations described in this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   section on a QUIC stream.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   On the sending part of a stream, application protocols need to be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   able to:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  write data, understanding when stream flow control credit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (Section 4.1) has successfully been reserved to send the written</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      data;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  end the stream (clean termination), resulting in a STREAM frame</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (Section 19.8) with the FIN bit set; and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  reset the stream (abrupt termination), resulting in a RESET_STREAM</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      frame (Section 19.4), if the stream was not already in a terminal</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      state.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   On the receiving part of a stream, application protocols need to be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   able to:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  read data; and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  abort reading of the stream and request closure, possibly</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      resulting in a STOP_SENDING frame (Section 19.5).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Applications also need to be informed of state changes on streams,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   including when the peer has opened or reset a stream, when a peer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   aborts reading on a stream, when new data is available, and when data</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   can or cannot be written to the stream due to flow control.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">3.  Stream States</td><td> </td><td class="right">3.  Stream States</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This section describes streams in terms of their send or receive</td><td> </td><td class="right">   This section describes streams in terms of their send or receive</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   components.  Two state machines are described: one for the streams on</td><td> </td><td class="right">   components.  Two state machines are described: one for the streams on</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   which an endpoint transmits data (Section 3.1), and another for</td><td> </td><td class="right">   which an endpoint transmits data (Section 3.1), and another for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   streams on which an endpoint receives data (Section 3.2).</td><td> </td><td class="right">   streams on which an endpoint receives data (Section 3.2).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Unidirectional streams use the applicable state machine directly.</td><td> </td><td class="right">   Unidirectional streams use the applicable state machine directly.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Bidirectional streams use both state machines.  For the most part,</td><td> </td><td class="right">   Bidirectional streams use both state machines.  For the most part,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the use of these state machines is the same whether the stream is</td><td> </td><td class="right">   the use of these state machines is the same whether the stream is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   unidirectional or bidirectional.  The conditions for opening a stream</td><td> </td><td class="right">   unidirectional or bidirectional.  The conditions for opening a stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are slightly more complex for a bidirectional stream because the</td><td> </td><td class="right">   are slightly more complex for a bidirectional stream because the</td><td class="lineno"></td></tr>
      <tr id="diff0061"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   opening of either send or receive <span class="delete">sides</span> causes the stream to open in</td><td> </td><td class="rblock">   opening of either <span class="insert">the</span> send or receive <span class="insert">side</span> causes the stream to open</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   both directions.</td><td> </td><td class="rblock">   in both directions.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MUST open streams of the same type in increasing order of</td><td> </td><td class="right">   An endpoint MUST open streams of the same type in increasing order of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream ID.</td><td> </td><td class="right">   stream ID.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Note:  These states are largely informative.  This document uses</td><td> </td><td class="right">   Note:  These states are largely informative.  This document uses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      stream states to describe rules for when and how different types</td><td> </td><td class="right">      stream states to describe rules for when and how different types</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of frames can be sent and the reactions that are expected when</td><td> </td><td class="right">      of frames can be sent and the reactions that are expected when</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      different types of frames are received.  Though these state</td><td> </td><td class="right">      different types of frames are received.  Though these state</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      machines are intended to be useful in implementing QUIC, these</td><td> </td><td class="right">      machines are intended to be useful in implementing QUIC, these</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      states aren't intended to constrain implementations.  An</td><td> </td><td class="right">      states aren't intended to constrain implementations.  An</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      implementation can define a different state machine as long as its</td><td> </td><td class="right">      implementation can define a different state machine as long as its</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      behavior is consistent with an implementation that implements</td><td> </td><td class="right">      behavior is consistent with an implementation that implements</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      these states.</td><td> </td><td class="right">      these states.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">3.1.  Sending Stream States</td><td> </td><td class="right">3.1.  Sending Stream States</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0062"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Figure <span class="delete">1</span> shows the states for the part of a stream that sends data to</td><td> </td><td class="rblock">   Figure <span class="insert">2</span> shows the states for the part of a stream that sends data to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a peer.</td><td> </td><td class="right">   a peer.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          o</td><td> </td><td class="right">          o</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | Create Stream (Sending)</td><td> </td><td class="right">          | Create Stream (Sending)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | Peer Creates Bidirectional Stream</td><td> </td><td class="right">          | Peer Creates Bidirectional Stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          v</td><td> </td><td class="right">          v</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      +-------+</td><td> </td><td class="right">      +-------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      | Ready | Send RESET_STREAM</td><td> </td><td class="right">      | Ready | Send RESET_STREAM</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      |       |-----------------------.</td><td> </td><td class="right">      |       |-----------------------.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      +-------+                       |</td><td> </td><td class="right">      +-------+                       |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-3" class="change"><td></td><th><small>skipping to change at</small><a href="#part-3"><em> page 12, line 39<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-3"><em> page 15, line 39<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">      | Sent  |------------------&gt;| Sent  |</td><td> </td><td class="right">      | Sent  |------------------&gt;| Sent  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      +-------+                   +-------+</td><td> </td><td class="right">      +-------+                   +-------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          |                           |</td><td> </td><td class="right">          |                           |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | Recv All ACKs             | Recv ACK</td><td> </td><td class="right">          | Recv All ACKs             | Recv ACK</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          v                           v</td><td> </td><td class="right">          v                           v</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      +-------+                   +-------+</td><td> </td><td class="right">      +-------+                   +-------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      | Data  |                   | Reset |</td><td> </td><td class="right">      | Data  |                   | Reset |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      | Recvd |                   | Recvd |</td><td> </td><td class="right">      | Recvd |                   | Recvd |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      +-------+                   +-------+</td><td> </td><td class="right">      +-------+                   +-------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0063"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">               Figure <span class="delete">1</span>: States for Sending Parts of Streams</td><td> </td><td class="rblock">               Figure <span class="insert">2</span>: States for Sending Parts of Streams</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0064"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The sending part of stream that the endpoint initiates (types 0 and 2</td><td> </td><td class="rblock">   The sending part of <span class="insert">a</span> stream that the endpoint initiates (types 0 and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   for clients, 1 and 3 for servers) is opened by the application.  The</td><td> </td><td class="rblock">   2 for clients, 1 and 3 for servers) is opened by the application.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   "Ready" state represents a newly created stream that is able to</td><td> </td><td class="rblock">   The "Ready" state represents a newly created stream that is able to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   accept data from the application.  Stream data might be buffered in</td><td> </td><td class="right">   accept data from the application.  Stream data might be buffered in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   this state in preparation for sending.</td><td> </td><td class="right">   this state in preparation for sending.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Sending the first STREAM or STREAM_DATA_BLOCKED frame causes a</td><td> </td><td class="right">   Sending the first STREAM or STREAM_DATA_BLOCKED frame causes a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sending part of a stream to enter the "Send" state.  An</td><td> </td><td class="right">   sending part of a stream to enter the "Send" state.  An</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   implementation might choose to defer allocating a stream ID to a</td><td> </td><td class="right">   implementation might choose to defer allocating a stream ID to a</td><td class="lineno"></td></tr>
      <tr id="diff0065"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   stream until it sends the first frame and enters this state, which</td><td> </td><td class="rblock">   stream until it sends the first <span class="insert">STREAM</span> frame and enters this state,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   can allow for better stream prioritization.</td><td> </td><td class="rblock">   which can allow for better stream prioritization.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The sending part of a bidirectional stream initiated by a peer (type</td><td> </td><td class="right">   The sending part of a bidirectional stream initiated by a peer (type</td><td class="lineno"></td></tr>
      <tr id="diff0066"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   0 for a server, type 1 for a client) <span class="delete">enters</span> the "Ready" state <span class="delete">then</span></td><td> </td><td class="rblock">   0 for a server, type 1 for a client) <span class="insert">starts in</span> the "Ready" state <span class="insert">when</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   immediately transitions to the "Send" state if</span> the receiving part</td><td> </td><td class="rblock">   the receiving part <span class="insert">is created.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">enters the "Recv" state (Section 3.2).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   In the "Send" state, an endpoint transmits - and retransmits as</td><td> </td><td class="right">   In the "Send" state, an endpoint transmits - and retransmits as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   necessary - stream data in STREAM frames.  The endpoint respects the</td><td> </td><td class="right">   necessary - stream data in STREAM frames.  The endpoint respects the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   flow control limits set by its peer, and continues to accept and</td><td> </td><td class="right">   flow control limits set by its peer, and continues to accept and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   process MAX_STREAM_DATA frames.  An endpoint in the "Send" state</td><td> </td><td class="right">   process MAX_STREAM_DATA frames.  An endpoint in the "Send" state</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   generates STREAM_DATA_BLOCKED frames if it is blocked from sending by</td><td> </td><td class="right">   generates STREAM_DATA_BLOCKED frames if it is blocked from sending by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream or connection flow control limits Section 4.1.</td><td> </td><td class="right">   stream or connection flow control limits Section 4.1.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   After the application indicates that all stream data has been sent</td><td> </td><td class="right">   After the application indicates that all stream data has been sent</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and a STREAM frame containing the FIN bit is sent, the sending part</td><td> </td><td class="right">   and a STREAM frame containing the FIN bit is sent, the sending part</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-4" class="change"><td></td><th><small>skipping to change at</small><a href="#part-4"><em> page 13, line 49<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-4"><em> page 17, line 7<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MAY send a RESET_STREAM as the first frame that mentions</td><td> </td><td class="right">   An endpoint MAY send a RESET_STREAM as the first frame that mentions</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a stream; this causes the sending part of that stream to open and</td><td> </td><td class="right">   a stream; this causes the sending part of that stream to open and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   then immediately transition to the "Reset Sent" state.</td><td> </td><td class="right">   then immediately transition to the "Reset Sent" state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Once a packet containing a RESET_STREAM has been acknowledged, the</td><td> </td><td class="right">   Once a packet containing a RESET_STREAM has been acknowledged, the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sending part of the stream enters the "Reset Recvd" state, which is a</td><td> </td><td class="right">   sending part of the stream enters the "Reset Recvd" state, which is a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   terminal state.</td><td> </td><td class="right">   terminal state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">3.2.  Receiving Stream States</td><td> </td><td class="right">3.2.  Receiving Stream States</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0067"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Figure <span class="delete">2</span> shows the states for the part of a stream that receives data</td><td> </td><td class="rblock">   Figure <span class="insert">3</span> shows the states for the part of a stream that receives data</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   from a peer.  The states for a receiving part of a stream mirror only</td><td> </td><td class="right">   from a peer.  The states for a receiving part of a stream mirror only</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   some of the states of the sending part of the stream at the peer.</td><td> </td><td class="right">   some of the states of the sending part of the stream at the peer.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The receiving part of a stream does not track states on the sending</td><td> </td><td class="right">   The receiving part of a stream does not track states on the sending</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   part that cannot be observed, such as the "Ready" state.  Instead,</td><td> </td><td class="right">   part that cannot be observed, such as the "Ready" state.  Instead,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the receiving part of a stream tracks the delivery of data to the</td><td> </td><td class="right">   the receiving part of a stream tracks the delivery of data to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   application, some of which cannot be observed by the sender.</td><td> </td><td class="right">   application, some of which cannot be observed by the sender.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          o</td><td> </td><td class="right">          o</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | Recv STREAM / STREAM_DATA_BLOCKED / RESET_STREAM</td><td> </td><td class="right">          | Recv STREAM / STREAM_DATA_BLOCKED / RESET_STREAM</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | Create Bidirectional Stream (Sending)</td><td> </td><td class="right">          | Create Bidirectional Stream (Sending)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-5" class="change"><td></td><th><small>skipping to change at</small><a href="#part-5"><em> page 14, line 40<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-5"><em> page 17, line 47<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">      | Recvd |  Recv All Data    | Recvd |</td><td> </td><td class="right">      | Recvd |  Recv All Data    | Recvd |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      +-------+&lt;-- (optional) ----+-------+</td><td> </td><td class="right">      +-------+&lt;-- (optional) ----+-------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          |                           |</td><td> </td><td class="right">          |                           |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | App Read All Data         | App Read RST</td><td> </td><td class="right">          | App Read All Data         | App Read RST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          v                           v</td><td> </td><td class="right">          v                           v</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      +-------+                   +-------+</td><td> </td><td class="right">      +-------+                   +-------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      | Data  |                   | Reset |</td><td> </td><td class="right">      | Data  |                   | Reset |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      | Read  |                   | Read  |</td><td> </td><td class="right">      | Read  |                   | Read  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      +-------+                   +-------+</td><td> </td><td class="right">      +-------+                   +-------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0068"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              Figure <span class="delete">2</span>: States for Receiving Parts of Streams</td><td> </td><td class="rblock">              Figure <span class="insert">3</span>: States for Receiving Parts of Streams</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The receiving part of a stream initiated by a peer (types 1 and 3 for</td><td> </td><td class="right">   The receiving part of a stream initiated by a peer (types 1 and 3 for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a client, or 0 and 2 for a server) is created when the first STREAM,</td><td> </td><td class="right">   a client, or 0 and 2 for a server) is created when the first STREAM,</td><td class="lineno"></td></tr>
      <tr id="diff0069"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   STREAM_DATA_BLOCKED, or RESET_STREAM is received for that stream.</td><td> </td><td class="rblock">   STREAM_DATA_BLOCKED, or RESET_STREAM <span class="insert">frame</span> is received for that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   For bidirectional streams initiated by a peer, receipt of a</td><td> </td><td class="rblock">   stream.  For bidirectional streams initiated by a peer, receipt of a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MAX_STREAM_DATA or STOP_SENDING frame for the sending part of the</td><td> </td><td class="right">   MAX_STREAM_DATA or STOP_SENDING frame for the sending part of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream also creates the receiving part.  The initial state for the</td><td> </td><td class="right">   stream also creates the receiving part.  The initial state for the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   receiving part of stream is "Recv".</td><td> </td><td class="right">   receiving part of stream is "Recv".</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The receiving part of a stream enters the "Recv" state when the</td><td> </td><td class="right">   The receiving part of a stream enters the "Recv" state when the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sending part of a bidirectional stream initiated by the endpoint</td><td> </td><td class="right">   sending part of a bidirectional stream initiated by the endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (type 0 for a client, type 1 for a server) enters the "Ready" state.</td><td> </td><td class="right">   (type 0 for a client, type 1 for a server) enters the "Ready" state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint opens a bidirectional stream when a MAX_STREAM_DATA or</td><td> </td><td class="right">   An endpoint opens a bidirectional stream when a MAX_STREAM_DATA or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STOP_SENDING frame is received from the peer for that stream.</td><td> </td><td class="right">   STOP_SENDING frame is received from the peer for that stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Receiving a MAX_STREAM_DATA frame for an unopened stream indicates</td><td> </td><td class="right">   Receiving a MAX_STREAM_DATA frame for an unopened stream indicates</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that the remote peer has opened the stream and is providing flow</td><td> </td><td class="right">   that the remote peer has opened the stream and is providing flow</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   control credit.  Receiving a STOP_SENDING frame for an unopened</td><td> </td><td class="right">   control credit.  Receiving a STOP_SENDING frame for an unopened</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream indicates that the remote peer no longer wishes to receive</td><td> </td><td class="right">   stream indicates that the remote peer no longer wishes to receive</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   data on this stream.  Either frame might arrive before a STREAM or</td><td> </td><td class="right">   data on this stream.  Either frame might arrive before a STREAM or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STREAM_DATA_BLOCKED frame if packets are lost or reordered.</td><td> </td><td class="right">   STREAM_DATA_BLOCKED frame if packets are lost or reordered.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0070"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Before <span class="delete">creating a stream</span>, all streams of the same type with lower-</td><td> </td><td class="rblock">   Before <span class="insert">a stream is created</span>, all streams of the same type with lower-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   numbered stream IDs MUST be created.  This ensures that the creation</td><td> </td><td class="right">   numbered stream IDs MUST be created.  This ensures that the creation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   order for streams is consistent on both endpoints.</td><td> </td><td class="right">   order for streams is consistent on both endpoints.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   In the "Recv" state, the endpoint receives STREAM and</td><td> </td><td class="right">   In the "Recv" state, the endpoint receives STREAM and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STREAM_DATA_BLOCKED frames.  Incoming data is buffered and can be</td><td> </td><td class="right">   STREAM_DATA_BLOCKED frames.  Incoming data is buffered and can be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   reassembled into the correct order for delivery to the application.</td><td> </td><td class="right">   reassembled into the correct order for delivery to the application.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   As data is consumed by the application and buffer space becomes</td><td> </td><td class="right">   As data is consumed by the application and buffer space becomes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   available, the endpoint sends MAX_STREAM_DATA frames to allow the</td><td> </td><td class="right">   available, the endpoint sends MAX_STREAM_DATA frames to allow the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   peer to send more data.</td><td> </td><td class="right">   peer to send more data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   When a STREAM frame with a FIN bit is received, the final size of the</td><td> </td><td class="right">   When a STREAM frame with a FIN bit is received, the final size of the</td><td class="lineno"></td></tr>
      <tr id="diff0071"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   stream is known<span class="delete"> (see Section 4.4)</span>.  The receiving part of the stream</td><td> </td><td class="rblock">   stream is known<span class="insert">; see Section 4.4</span>.  The receiving part of the stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   then enters the "Size Known" state.  In this state, the endpoint no</td><td> </td><td class="right">   then enters the "Size Known" state.  In this state, the endpoint no</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   longer needs to send MAX_STREAM_DATA frames, it only receives any</td><td> </td><td class="right">   longer needs to send MAX_STREAM_DATA frames, it only receives any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   retransmissions of stream data.</td><td> </td><td class="right">   retransmissions of stream data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Once all data for the stream has been received, the receiving part</td><td> </td><td class="right">   Once all data for the stream has been received, the receiving part</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   enters the "Data Recvd" state.  This might happen as a result of</td><td> </td><td class="right">   enters the "Data Recvd" state.  This might happen as a result of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   receiving the same STREAM frame that causes the transition to "Size</td><td> </td><td class="right">   receiving the same STREAM frame that causes the transition to "Size</td><td class="lineno"></td></tr>
      <tr id="diff0072"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Known".  <span class="delete">In this state, the endpoint has</span> all <span class="delete">stream data.  Any</span> STREAM</td><td> </td><td class="rblock">   Known".  <span class="insert">After</span> all <span class="insert">data has been received, any</span> STREAM or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   or STREAM_DATA_BLOCKED frames <span class="delete">it receives</span> for the stream can be</td><td> </td><td class="rblock">   STREAM_DATA_BLOCKED frames for the stream can be discarded.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   discarded.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The "Data Recvd" state persists until stream data has been delivered</td><td> </td><td class="right">   The "Data Recvd" state persists until stream data has been delivered</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to the application.  Once stream data has been delivered, the stream</td><td> </td><td class="right">   to the application.  Once stream data has been delivered, the stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   enters the "Data Read" state, which is a terminal state.</td><td> </td><td class="right">   enters the "Data Read" state, which is a terminal state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Receiving a RESET_STREAM frame in the "Recv" or "Size Known" states</td><td> </td><td class="right">   Receiving a RESET_STREAM frame in the "Recv" or "Size Known" states</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   causes the stream to enter the "Reset Recvd" state.  This might cause</td><td> </td><td class="right">   causes the stream to enter the "Reset Recvd" state.  This might cause</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the delivery of stream data to the application to be interrupted.</td><td> </td><td class="right">   the delivery of stream data to the application to be interrupted.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   It is possible that all stream data is received when a RESET_STREAM</td><td> </td><td class="right">   It is possible that all stream data is received when a RESET_STREAM</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   is received (that is, from the "Data Recvd" state).  Similarly, it is</td><td> </td><td class="right">   is received (that is, from the "Data Recvd" state).  Similarly, it is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   possible for remaining stream data to arrive after receiving a</td><td> </td><td class="right">   possible for remaining stream data to arrive after receiving a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   RESET_STREAM frame (the "Reset Recvd" state).  An implementation is</td><td> </td><td class="right">   RESET_STREAM frame (the "Reset Recvd" state).  An implementation is</td><td class="lineno"></td></tr>
      <tr id="diff0073"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   free to manage this situation as it chooses.  <span class="delete">Sending RESET_STREAM</span></td><td> </td><td class="rblock">   free to manage this situation as it chooses.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   means that an endpoint cannot guarantee delivery of stream data;</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   however there is no requirement that stream data not be delivered if</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   a RESET_STREAM is received.  An implementation MAY interrupt delivery</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   of stream data, discard any data that was not consumed, and signal</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the receipt of the RESET_STREAM immediately.  Alternatively, the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   RESET_STREAM signal might be suppressed or withheld if stream data is</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   completely received and is buffered to be read by the application.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   In the latter case, the receiving part of the stream transitions from</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   "Reset Recvd" to "Data Recvd".</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0074"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Once the application <span class="delete">has been delivered</span> the signal indicating that</td><td> </td><td class="rblock">   <span class="insert">Sending RESET_STREAM means that an endpoint cannot guarantee delivery</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the stream was reset, the receiving part of the stream transitions to</td><td> </td><td class="rblock"><span class="insert">   of stream data; however there is no requirement that stream data not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the "Reset Read" state, which is a terminal state.</td><td> </td><td class="rblock"><span class="insert">   be delivered if a RESET_STREAM is received.  An implementation MAY</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   interrupt delivery of stream data, discard any data that was not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   consumed, and signal the receipt of the RESET_STREAM.  A RESET_STREAM</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   signal might be suppressed or withheld if stream data is completely</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   received and is buffered to be read by the application.  If the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   RESET_STREAM is suppressed, the receiving part of the stream remains</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in "Data Recvd".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Once the application <span class="insert">receives</span> the signal indicating that the stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   was reset, the receiving part of the stream transitions to the "Reset</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Read" state, which is a terminal state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">3.3.  Permitted Frame Types</td><td> </td><td class="right">3.3.  Permitted Frame Types</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The sender of a stream sends just three frame types that affect the</td><td> </td><td class="right">   The sender of a stream sends just three frame types that affect the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   state of a stream at either sender or receiver: STREAM</td><td> </td><td class="right">   state of a stream at either sender or receiver: STREAM</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 19.8), STREAM_DATA_BLOCKED (Section 19.13), and RESET_STREAM</td><td> </td><td class="right">   (Section 19.8), STREAM_DATA_BLOCKED (Section 19.13), and RESET_STREAM</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 19.4).</td><td> </td><td class="right">   (Section 19.4).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A sender MUST NOT send any of these frames from a terminal state</td><td> </td><td class="right">   A sender MUST NOT send any of these frames from a terminal state</td><td class="lineno"></td></tr>
      <tr id="diff0075"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   ("Data Recvd" or "Reset Recvd").  A sender MUST NOT send STREAM or</td><td> </td><td class="rblock">   ("Data Recvd" or "Reset Recvd").  A sender MUST NOT send <span class="insert">a</span> STREAM or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   STREAM_DATA_BLOCKED <span class="delete">after sending</span> a <span class="delete">RESET_STREAM; that is, in the</span></td><td> </td><td class="rblock">   STREAM_DATA_BLOCKED <span class="insert">frame for</span> a <span class="insert">stream</span> in the "Reset Sent" <span class="insert">state or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   terminal states and</span> in the "Reset Sent" <span class="delete">state.</span>  A receiver could</td><td> </td><td class="rblock"><span class="insert">   any terminal state, that is, after sending a RESET_STREAM frame.</span>  A</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   receive any of these three frames in any state, due to the</td><td> </td><td class="rblock">   receiver could receive any of these three frames in any state, due to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   possibility of delayed delivery of packets carrying them.</td><td> </td><td class="rblock">   the possibility of delayed delivery of packets carrying them.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The receiver of a stream sends MAX_STREAM_DATA (Section 19.10) and</td><td> </td><td class="right">   The receiver of a stream sends MAX_STREAM_DATA (Section 19.10) and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STOP_SENDING frames (Section 19.5).</td><td> </td><td class="right">   STOP_SENDING frames (Section 19.5).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The receiver only sends MAX_STREAM_DATA in the "Recv" state.  A</td><td> </td><td class="right">   The receiver only sends MAX_STREAM_DATA in the "Recv" state.  A</td><td class="lineno"></td></tr>
      <tr id="diff0076"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   receiver <span class="delete">can</span> send STOP_SENDING in any state where it has not received</td><td> </td><td class="rblock">   receiver <span class="insert">MAY</span> send STOP_SENDING in any state where it has not received</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a RESET_STREAM frame; that is states other than "Reset Recvd" or</td><td> </td><td class="right">   a RESET_STREAM frame; that is states other than "Reset Recvd" or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   "Reset Read".  However there is little value in sending a</td><td> </td><td class="right">   "Reset Read".  However there is little value in sending a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STOP_SENDING frame in the "Data Recvd" state, since all stream data</td><td> </td><td class="right">   STOP_SENDING frame in the "Data Recvd" state, since all stream data</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   has been received.  A sender could receive either of these two frames</td><td> </td><td class="right">   has been received.  A sender could receive either of these two frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   in any state as a result of delayed delivery of packets.</td><td> </td><td class="right">   in any state as a result of delayed delivery of packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">3.4.  Bidirectional Stream States</td><td> </td><td class="right">3.4.  Bidirectional Stream States</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A bidirectional stream is composed of sending and receiving parts.</td><td> </td><td class="right">   A bidirectional stream is composed of sending and receiving parts.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Implementations may represent states of the bidirectional stream as</td><td> </td><td class="right">   Implementations may represent states of the bidirectional stream as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-6" class="change"><td></td><th><small>skipping to change at</small><a href="#part-6"><em> page 17, line 15<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-6"><em> page 21, line 5<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   receiving streams are in terminal states.</td><td> </td><td class="right">   receiving streams are in terminal states.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Table 2 shows a more complex mapping of bidirectional stream states</td><td> </td><td class="right">   Table 2 shows a more complex mapping of bidirectional stream states</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that loosely correspond to the stream states in HTTP/2 [HTTP2].  This</td><td> </td><td class="right">   that loosely correspond to the stream states in HTTP/2 [HTTP2].  This</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   shows that multiple states on sending or receiving parts of streams</td><td> </td><td class="right">   shows that multiple states on sending or receiving parts of streams</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are mapped to the same composite state.  Note that this is just one</td><td> </td><td class="right">   are mapped to the same composite state.  Note that this is just one</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   possibility for such a mapping; this mapping requires that data is</td><td> </td><td class="right">   possibility for such a mapping; this mapping requires that data is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   acknowledged before the transition to a "closed" or "half-closed"</td><td> </td><td class="right">   acknowledged before the transition to a "closed" or "half-closed"</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   state.</td><td> </td><td class="right">   state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0077"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">+-----------------------+---------------------+---------------------+</span></td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Sending Part          | Receiving Part      | Composite State     |</td><td> </td><td class="rblock">     | Sending Part         | Receiving Part       | Composite State |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">+-----------------------+---------------------+---------------------+</span></td><td> </td><td class="rblock">     <span class="insert">+======================+======================+=================+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | No Stream/Ready       | No Stream/Recv *1   | idle                |</td><td> </td><td class="rblock">     | No Stream/Ready      | No Stream/Recv *1    | idle            |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|                       |                     |                     |</span></td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Ready/Send/Data Sent  | Recv/Size Known     | open                |</td><td> </td><td class="rblock">     | Ready/Send/Data Sent | Recv/Size Known      | open            |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|                       |                     |                     |</span></td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Ready/Send/Data Sent  | Data Recvd/Data     | half-closed         |</td><td> </td><td class="rblock">     | Ready/Send/Data Sent | Data Recvd/Data <span class="insert">Read</span> | half-closed     |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   |                       | <span class="delete">Read</span>                | (remote)            |</td><td> </td><td class="rblock">     |                      |                      | (remote)        |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|                       |                     |                     |</span></td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Ready/Send/Data Sent  | Reset Recvd/Reset   | half-closed         |</td><td> </td><td class="rblock">     | Ready/Send/Data Sent | Reset Recvd/Reset    | half-closed     |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   |                       | Read                | (remote)            |</td><td> </td><td class="rblock">     |                      | Read                 | (remote)        |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|                       |                     |                     |</span></td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Data Recvd            | Recv/Size Known     | half-closed <span class="delete">(local)</span> |</td><td> </td><td class="rblock">     | Data Recvd           | Recv/Size Known      | half-closed     |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   |                       |                     |                     |</td><td> </td><td class="rblock">     |                      |                      | <span class="insert">(local)</span>         |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Reset Sent/Reset      | Recv/Size Known     | half-closed <span class="delete">(local)</span> |</td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Recvd                 |                     |                     |</td><td> </td><td class="rblock">     | Reset Sent/Reset     | Recv/Size Known      | half-closed     |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|                       |                     |                     |</span></td><td> </td><td class="rblock">     | Recvd                |                      | <span class="insert">(local)</span>         |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Reset Sent/Reset      | Data Recvd/Data     | closed              |</td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Recvd                 | <span class="delete">Read                |                     |</span></td><td> </td><td class="rblock">     | Reset Sent/Reset     | Data Recvd/Data <span class="insert">Read</span> | closed          |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                       |</span>                     |                     |</td><td> </td><td class="rblock">     | Recvd                |                      |                 |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Reset Sent/Reset      | Reset Recvd/Reset   | closed              |</td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Recvd                 | Read                |                     |</td><td> </td><td class="rblock">     | Reset Sent/Reset     | Reset Recvd/Reset    | closed          |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|                       |                     |                     |</span></td><td> </td><td class="rblock">     | Recvd                | Read                 |                 |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Data Recvd            | Data Recvd/Data     <span class="delete">| closed              |</span></td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                       |</span> Read                |                     |</td><td> </td><td class="rblock">     | Data Recvd           | Data Recvd/Data Read | <span class="insert">closed</span>          |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|                       |                     |                     |</span></td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | Data Recvd            | Reset Recvd/Reset   | closed              |</td><td> </td><td class="rblock">     | Data Recvd           | Reset Recvd/Reset    | closed          |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   |                       | Read                |                     |</td><td> </td><td class="rblock">     |                      | Read                 |                 |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">+-----------------------+---------------------+---------------------+</span></td><td> </td><td class="rblock">     <span class="insert">+----------------------+----------------------+-----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0078"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">           Table 2: Possible Mapping of Stream States to HTTP/2</td><td> </td><td class="rblock">           <span class="insert"> </span>Table 2: Possible Mapping of Stream States to HTTP/2</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Note (*1):  A stream is considered "idle" if it has not yet been</td><td> </td><td class="right">   Note (*1):  A stream is considered "idle" if it has not yet been</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      created, or if the receiving part of the stream is in the "Recv"</td><td> </td><td class="right">      created, or if the receiving part of the stream is in the "Recv"</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      state without yet having received any frames.</td><td> </td><td class="right">      state without yet having received any frames.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">3.5.  Solicited State Transitions</td><td> </td><td class="right">3.5.  Solicited State Transitions</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0079"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   If an <span class="delete">endpoint</span> is no longer interested in the data it is receiving on</td><td> </td><td class="rblock">   If an <span class="insert">application</span> is no longer interested in the data it is receiving</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a stream, it <span class="delete">MAY send a STOP_SENDING frame identifying that stream to</span></td><td> </td><td class="rblock">   on a stream, it <span class="insert">can abort reading</span> the stream <span class="insert">and specify an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   prompt closure of</span> the stream <span class="delete">in the opposite direction.  This</span></td><td> </td><td class="rblock">   application <span class="insert">error code.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   typically indicates that the receiving</span> application <span class="delete">is no longer</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   reading data it receives from the stream, but it is not a guarantee</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that incoming data will be ignored.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0080"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   STREAM frames received after sending STOP_SENDING are still counted</td><td> </td><td class="rblock">   <span class="insert">If the stream is in the "Recv" or "Size Known" states, the transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   toward connection and stream flow control, even though these frames</td><td> </td><td class="rblock"><span class="insert">   SHOULD signal this by sending a STOP_SENDING frame to prompt closure</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">will</span> be discarded upon receipt.</td><td> </td><td class="rblock"><span class="insert">   of the stream in the opposite direction.  This typically indicates</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that the receiving application is no longer reading data it receives</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   from the stream, but it is not a guarantee that incoming data will be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ignored.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   STREAM frames received after sending <span class="insert">a</span> STOP_SENDING <span class="insert">frame</span> are still</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   counted toward connection and stream flow control, even though these</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   frames <span class="insert">can</span> be discarded upon receipt.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A STOP_SENDING frame requests that the receiving endpoint send a</td><td> </td><td class="right">   A STOP_SENDING frame requests that the receiving endpoint send a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   RESET_STREAM frame.  An endpoint that receives a STOP_SENDING frame</td><td> </td><td class="right">   RESET_STREAM frame.  An endpoint that receives a STOP_SENDING frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MUST send a RESET_STREAM frame if the stream is in the Ready or Send</td><td> </td><td class="right">   MUST send a RESET_STREAM frame if the stream is in the Ready or Send</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   state.  If the stream is in the Data Sent state and any outstanding</td><td> </td><td class="right">   state.  If the stream is in the Data Sent state and any outstanding</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   data is declared lost, an endpoint SHOULD send a RESET_STREAM frame</td><td> </td><td class="right">   data is declared lost, an endpoint SHOULD send a RESET_STREAM frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   in lieu of a retransmission.</td><td> </td><td class="right">   in lieu of a retransmission.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint SHOULD copy the error code from the STOP_SENDING frame to</td><td> </td><td class="right">   An endpoint SHOULD copy the error code from the STOP_SENDING frame to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the RESET_STREAM frame it sends, but MAY use any application error</td><td> </td><td class="right">   the RESET_STREAM frame it sends, but MAY use any application error</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-7" class="change"><td></td><th><small>skipping to change at</small><a href="#part-7"><em> page 18, line 47<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-7"><em> page 22, line 45<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   or "Size Known" states.</td><td> </td><td class="right">   or "Size Known" states.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint is expected to send another STOP_SENDING frame if a</td><td> </td><td class="right">   An endpoint is expected to send another STOP_SENDING frame if a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet containing a previous STOP_SENDING is lost.  However, once</td><td> </td><td class="right">   packet containing a previous STOP_SENDING is lost.  However, once</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   either all stream data or a RESET_STREAM frame has been received for</td><td> </td><td class="right">   either all stream data or a RESET_STREAM frame has been received for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the stream - that is, the stream is in any state other than "Recv" or</td><td> </td><td class="right">   the stream - that is, the stream is in any state other than "Recv" or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   "Size Known" - sending a STOP_SENDING frame is unnecessary.</td><td> </td><td class="right">   "Size Known" - sending a STOP_SENDING frame is unnecessary.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint that wishes to terminate both directions of a</td><td> </td><td class="right">   An endpoint that wishes to terminate both directions of a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   bidirectional stream can terminate one direction by sending a</td><td> </td><td class="right">   bidirectional stream can terminate one direction by sending a</td><td class="lineno"></td></tr>
      <tr id="diff0081"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">RESET_STREAM,</span> and it can encourage prompt termination in the opposite</td><td> </td><td class="rblock">   <span class="insert">RESET_STREAM frame,</span> and it can encourage prompt termination in the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   direction by sending a STOP_SENDING frame.</td><td> </td><td class="rblock">   opposite direction by sending a STOP_SENDING frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">4.  Flow Control</td><td> </td><td class="right">4.  Flow Control</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   It is necessary to limit the amount of data that a receiver could</td><td> </td><td class="right">   It is necessary to limit the amount of data that a receiver could</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   buffer, to prevent a fast sender from overwhelming a slow receiver,</td><td> </td><td class="right">   buffer, to prevent a fast sender from overwhelming a slow receiver,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   or to prevent a malicious sender from consuming a large amount of</td><td> </td><td class="right">   or to prevent a malicious sender from consuming a large amount of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   memory at a receiver.  To enable a receiver to limit memory</td><td> </td><td class="right">   memory at a receiver.  To enable a receiver to limit memory</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   commitment to a connection and to apply back pressure on the sender,</td><td> </td><td class="right">   commitment to a connection and to apply back pressure on the sender,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   streams are flow controlled both individually and as an aggregate.  A</td><td> </td><td class="right">   streams are flow controlled both individually and as an aggregate.  A</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC receiver controls the maximum amount of data the sender can send</td><td> </td><td class="right">   QUIC receiver controls the maximum amount of data the sender can send</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   on a stream at any time, as described in Section 4.1 and Section 4.2</td><td> </td><td class="right">   on a stream at any time, as described in Section 4.1 and Section 4.2</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Similarly, to limit concurrency within a connection, a QUIC endpoint</td><td> </td><td class="right">   Similarly, to limit concurrency within a connection, a QUIC endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   controls the maximum cumulative number of streams that its peer can</td><td> </td><td class="right">   controls the maximum cumulative number of streams that its peer can</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   initiate, as described in Section 4.5.</td><td> </td><td class="right">   initiate, as described in Section 4.5.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Data sent in CRYPTO frames is not flow controlled in the same way as</td><td> </td><td class="right">   Data sent in CRYPTO frames is not flow controlled in the same way as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream data.  QUIC relies on the cryptographic protocol</td><td> </td><td class="right">   stream data.  QUIC relies on the cryptographic protocol</td><td class="lineno"></td></tr>
      <tr id="diff0082"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   implementation to avoid excessive buffering of data<span class="delete">,</span> see [QUIC-TLS].</td><td> </td><td class="rblock">   implementation to avoid excessive buffering of data<span class="insert">;</span> see [QUIC-TLS].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The implementation SHOULD provide an interface to QUIC to tell it</td><td> </td><td class="right">   The implementation SHOULD provide an interface to QUIC to tell it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   about its buffering limits so that there is not excessive buffering</td><td> </td><td class="right">   about its buffering limits so that there is not excessive buffering</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   at multiple layers.</td><td> </td><td class="right">   at multiple layers.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">4.1.  Data Flow Control</td><td> </td><td class="right">4.1.  Data Flow Control</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC employs a credit-based flow-control scheme similar to that in</td><td> </td><td class="right">   QUIC employs a credit-based flow-control scheme similar to that in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   HTTP/2 [HTTP2], where a receiver advertises the number of bytes it is</td><td> </td><td class="right">   HTTP/2 [HTTP2], where a receiver advertises the number of bytes it is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   prepared to receive on a given stream and for the entire connection.</td><td> </td><td class="right">   prepared to receive on a given stream and for the entire connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This leads to two levels of data flow control in QUIC:</td><td> </td><td class="right">   This leads to two levels of data flow control in QUIC:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0083"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Stream flow control, which prevents a single stream from consuming</td><td> </td><td class="rblock">   <span class="insert">*</span>  Stream flow control, which prevents a single stream from consuming</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the entire receive buffer for a connection by limiting the amount</td><td> </td><td class="right">      the entire receive buffer for a connection by limiting the amount</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of data that can be sent on any stream.</td><td> </td><td class="right">      of data that can be sent on any stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0084"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Connection flow control, which prevents senders from exceeding a</td><td> </td><td class="rblock">   <span class="insert">*</span>  Connection flow control, which prevents senders from exceeding a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      receiver's buffer capacity for the connection, by limiting the</td><td> </td><td class="right">      receiver's buffer capacity for the connection, by limiting the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      total bytes of stream data sent in STREAM frames on all streams.</td><td> </td><td class="right">      total bytes of stream data sent in STREAM frames on all streams.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A receiver sets initial credits for all streams by sending transport</td><td> </td><td class="right">   A receiver sets initial credits for all streams by sending transport</td><td class="lineno"></td></tr>
      <tr id="diff0085"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   parameters during the handshake (Section 7.<span class="delete">3</span>).  A receiver sends</td><td> </td><td class="rblock">   parameters during the handshake (Section 7.<span class="insert">4</span>).  A receiver sends</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MAX_STREAM_DATA (Section 19.10) or MAX_DATA (Section 19.9) frames to</td><td> </td><td class="right">   MAX_STREAM_DATA (Section 19.10) or MAX_DATA (Section 19.9) frames to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the sender to advertise additional credit.</td><td> </td><td class="right">   the sender to advertise additional credit.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A receiver advertises credit for a stream by sending a</td><td> </td><td class="right">   A receiver advertises credit for a stream by sending a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MAX_STREAM_DATA frame with the Stream ID field set appropriately.  A</td><td> </td><td class="right">   MAX_STREAM_DATA frame with the Stream ID field set appropriately.  A</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MAX_STREAM_DATA frame indicates the maximum absolute byte offset of a</td><td> </td><td class="right">   MAX_STREAM_DATA frame indicates the maximum absolute byte offset of a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream.  A receiver could use the current offset of data consumed to</td><td> </td><td class="right">   stream.  A receiver could use the current offset of data consumed to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   determine the flow control offset to be advertised.  A receiver MAY</td><td> </td><td class="right">   determine the flow control offset to be advertised.  A receiver MAY</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   send MAX_STREAM_DATA frames in multiple packets in order to make sure</td><td> </td><td class="right">   send MAX_STREAM_DATA frames in multiple packets in order to make sure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that the sender receives an update before running out of flow control</td><td> </td><td class="right">   that the sender receives an update before running out of flow control</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   credit, even if one of the packets is lost.</td><td> </td><td class="right">   credit, even if one of the packets is lost.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A receiver advertises credit for a connection by sending a MAX_DATA</td><td> </td><td class="right">   A receiver advertises credit for a connection by sending a MAX_DATA</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame, which indicates the maximum of the sum of the absolute byte</td><td> </td><td class="right">   frame, which indicates the maximum of the sum of the absolute byte</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   offsets of all streams.  A receiver maintains a cumulative sum of</td><td> </td><td class="right">   offsets of all streams.  A receiver maintains a cumulative sum of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   bytes received on all streams, which is used to check for flow</td><td> </td><td class="right">   bytes received on all streams, which is used to check for flow</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   control violations.  A receiver might use a sum of bytes consumed on</td><td> </td><td class="right">   control violations.  A receiver might use a sum of bytes consumed on</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   all streams to determine the maximum data limit to be advertised.</td><td> </td><td class="right">   all streams to determine the maximum data limit to be advertised.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A receiver can advertise a larger offset by sending MAX_STREAM_DATA</td><td> </td><td class="right">   A receiver can advertise a larger offset by sending MAX_STREAM_DATA</td><td class="lineno"></td></tr>
      <tr id="diff0086"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   or MAX_DATA <span class="delete">frames at any time during the connection.  A receiver</span></td><td> </td><td class="rblock">   or MAX_DATA <span class="insert">frames.  Once</span> a receiver advertises an offset, it MAY</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   cannot renege on an advertisement however.  That is, once</span> a receiver</td><td> </td><td class="rblock">   advertise a smaller offset, but this has no effect.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   advertises an offset, it MAY advertise a smaller offset, but this has</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   no effect.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A receiver MUST close the connection with a FLOW_CONTROL_ERROR error</td><td> </td><td class="right">   A receiver MUST close the connection with a FLOW_CONTROL_ERROR error</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 11) if the sender violates the advertised connection or</td><td> </td><td class="right">   (Section 11) if the sender violates the advertised connection or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream data limits.</td><td> </td><td class="right">   stream data limits.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A sender MUST ignore any MAX_STREAM_DATA or MAX_DATA frames that do</td><td> </td><td class="right">   A sender MUST ignore any MAX_STREAM_DATA or MAX_DATA frames that do</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   not increase flow control limits.</td><td> </td><td class="right">   not increase flow control limits.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If a sender runs out of flow control credit, it will be unable to</td><td> </td><td class="right">   If a sender runs out of flow control credit, it will be unable to</td><td class="lineno"></td></tr>
      <tr id="diff0087"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   send new data and is considered blocked.  A sender SHOULD send</td><td> </td><td class="rblock">   send new data and is considered blocked.  A sender SHOULD send <span class="insert">a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   STREAM_DATA_BLOCKED or DATA_BLOCKED <span class="delete">frames</span> to indicate it has data to</td><td> </td><td class="rblock">   STREAM_DATA_BLOCKED or DATA_BLOCKED <span class="insert">frame</span> to indicate it has data to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   write but is blocked by flow control limits.  <span class="delete">These frames are</span></td><td> </td><td class="rblock">   write but is blocked by flow control limits.  <span class="insert">If</span> a sender <span class="insert">is blocked</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   expected to be sent infrequently in common cases, but they are</span></td><td> </td><td class="rblock">   for <span class="insert">a period longer than</span> the <span class="insert">idle timeout (Section 10.2), the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   considered useful for debugging and monitoring purposes.</span></td><td> </td><td class="rblock"><span class="insert">   connection might be closed even when</span> data <span class="insert">is available for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">   transmission.  To keep</span> the <span class="insert">connection from closing, a sender that</span> is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   A sender sends a single STREAM_DATA_BLOCKED or DATA_BLOCKED frame</span></td><td> </td><td class="rblock">   <span class="insert">flow control limited SHOULD periodically send a</span> STREAM_DATA_BLOCKED</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   only once when it reaches</span> a <span class="delete">data limit.  A</span> sender <span class="delete">SHOULD NOT send</span></td><td> </td><td class="rblock">   or DATA_BLOCKED frame <span class="insert">when it has no ack-eliciting packets in flight.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   multiple STREAM_DATA_BLOCKED or DATA_BLOCKED frames</span> for the <span class="delete">same</span> data</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">limit, unless</span> the <span class="delete">original frame</span> is <span class="delete">determined to be lost.  Another</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   STREAM_DATA_BLOCKED or DATA_BLOCKED frame <span class="delete">can be sent after the data</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   limit is increased.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">4.2.  Flow Credit Increments</td><td> </td><td class="right">4.2.  Flow Credit Increments</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0088"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">This document leaves</span> when and how <span class="delete">many bytes</span> to advertise in <span class="delete">a</span></td><td> </td><td class="rblock">   <span class="insert">Implementations decide</span> when and how <span class="insert">much credit</span> to advertise in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   MAX_STREAM_DATA <span class="delete">or</span> MAX_DATA <span class="delete">frame to implementations,</span> but offers a</td><td> </td><td class="rblock">   MAX_STREAM_DATA <span class="insert">and</span> MAX_DATA <span class="insert">frames,</span> but <span class="insert">this section</span> offers a few</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   few considerations.  <span class="delete">These</span> frames contribute to connection overhead.</td><td> </td><td class="rblock">   considerations.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Therefore</span> frequently sending frames with small changes is</td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   undesirable.  <span class="delete">At</span> the <span class="delete">same time,</span> larger increments to limits are</td><td> </td><td class="rblock">   <span class="insert">To avoid blocking a sender, a receiver can send a MAX_STREAM_DATA or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   necessary to avoid blocking <span class="delete">if updates are less frequent,</span> requiring</td><td> </td><td class="rblock"><span class="insert">   MAX_DATA frame multiple times within a round trip or send it early</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   larger resource commitments at the receiver.  <span class="delete">Thus there</span> is a <span class="delete">trade-</span></td><td> </td><td class="rblock"><span class="insert">   enough to allow for recovery from loss of the frame.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   off</span> between resource commitment and overhead when determining how</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   large a limit is advertised.</td><td> </td><td class="rblock"><span class="insert">   Control</span> frames contribute to connection overhead.  <span class="insert">Therefore,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   frequently sending <span class="insert">MAX_STREAM_DATA and MAX_DATA</span> frames with small</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   changes is undesirable.  <span class="insert">On</span> the <span class="insert">other hand, if updates are less</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frequent,</span> larger increments to limits are necessary to avoid blocking</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">a sender,</span> requiring larger resource commitments at the receiver.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">There</span> is a <span class="insert">trade-off</span> between resource commitment and overhead when</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   determining how large a limit is advertised.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A receiver can use an autotuning mechanism to tune the frequency and</td><td> </td><td class="right">   A receiver can use an autotuning mechanism to tune the frequency and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   amount of advertised additional credit based on a round-trip time</td><td> </td><td class="right">   amount of advertised additional credit based on a round-trip time</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   estimate and the rate at which the receiving application consumes</td><td> </td><td class="right">   estimate and the rate at which the receiving application consumes</td><td class="lineno"></td></tr>
      <tr id="diff0089"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   data, similar to common TCP implementations.  As an optimization,</td><td> </td><td class="rblock">   data, similar to common TCP implementations.  As an optimization, <span class="insert">an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">sending</span> frames related to flow control only when there are other</td><td> </td><td class="rblock"><span class="insert">   endpoint could send</span> frames related to flow control only when there</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   frames to send or when a peer is <span class="delete">blocked ensures</span> that flow control</td><td> </td><td class="rblock">   are other frames to send or when a peer is <span class="insert">blocked, ensuring</span> that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">doesn't</span> cause extra packets to be sent.</td><td> </td><td class="rblock">   flow control <span class="insert">does not</span> cause extra packets to be sent.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0090"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If a</span> sender <span class="delete">runs out of flow control credit, it will be unable to</span></td><td> </td><td class="rblock">   <span class="insert">A blocked</span> sender is not <span class="insert">required</span> to <span class="insert">send STREAM_DATA_BLOCKED or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   send new data and is considered blocked.  It</span> is <span class="delete">generally considered</span></td><td> </td><td class="rblock"><span class="insert">   DATA_BLOCKED frames.  Therefore,</span> a receiver <span class="insert">MUST NOT wait for</span> a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   best to</span> not <span class="delete">let the sender become blocked.  To avoid blocking a</span></td><td> </td><td class="rblock">   <span class="insert">STREAM_DATA_BLOCKED</span> or <span class="insert">DATA_BLOCKED</span> frame before <span class="insert">sending a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   sender, and</span> to <span class="delete">reasonably account for the possibility of loss,</span> a</td><td> </td><td class="rblock"><span class="insert">   MAX_STREAM_DATA or MAX_DATA frame; doing so could result in</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   receiver <span class="delete">should send</span> a <span class="delete">MAX_DATA</span> or <span class="delete">MAX_STREAM_DATA</span> frame <span class="delete">at least two</span></td><td> </td><td class="rblock">   sender <span class="insert">being blocked for the rest of the connection.  Even if the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   round trips</span> before <span class="delete">it expects</span> the sender <span class="delete">to get blocked.</span></td><td> </td><td class="rblock"><span class="insert">   sender sends these frames, waiting for them will result in the sender</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   being blocked for at least an entire round trip.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0091"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A receiver MUST NOT wait for a STREAM_DATA_BLOCKED or DATA_BLOCKED</span></td><td> </td><td class="rblock">   <span class="insert">When</span> a sender <span class="insert">receives credit after being blocked, it might</span> be <span class="insert">able</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   frame before sending MAX_STREAM_DATA or MAX_DATA, since doing so will</span></td><td> </td><td class="rblock">   to send <span class="insert">a large amount of data in response, resulting in short-term</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   mean that</span> a sender <span class="delete">will</span> be <span class="delete">blocked for at least an entire round trip,</span></td><td> </td><td class="rblock"><span class="insert">   congestion; see Section 6.9 in [QUIC-RECOVERY] for a discussion of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   and potentially for longer if the peer chooses</span> to <span class="delete">not</span> send</td><td> </td><td class="rblock"><span class="insert">   how a sender can avoid this congestion.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">STREAM_DATA_BLOCKED or DATA_BLOCKED frames.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">4.3.  Handling Stream Cancellation</td><td> </td><td class="right">4.3.  Handling Stream Cancellation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Endpoints need to eventually agree on the amount of flow control</td><td> </td><td class="right">   Endpoints need to eventually agree on the amount of flow control</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   credit that has been consumed, to avoid either exceeding flow control</td><td> </td><td class="right">   credit that has been consumed, to avoid either exceeding flow control</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   limits or deadlocking.</td><td> </td><td class="right">   limits or deadlocking.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   On receipt of a RESET_STREAM frame, an endpoint will tear down state</td><td> </td><td class="right">   On receipt of a RESET_STREAM frame, an endpoint will tear down state</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   for the matching stream and ignore further data arriving on that</td><td> </td><td class="right">   for the matching stream and ignore further data arriving on that</td><td class="lineno"></td></tr>
      <tr id="diff0092"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   stream.  <span class="delete">If a RESET_STREAM frame is reordered with stream data for</span></td><td> </td><td class="rblock">   stream.  <span class="insert">Without</span> the <span class="insert">offset included in RESET_STREAM,</span> the two</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the <span class="delete">same stream, the receiver's estimate of the number of bytes</span></td><td> </td><td class="rblock">   endpoints could disagree on the number of bytes that count towards</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   received on that stream can be lower than the sender's estimate of</span></td><td> </td><td class="rblock">   connection flow control.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the number sent.  As a result,</span> the two endpoints could disagree on</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the number of bytes that count towards connection flow control.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   To remedy this issue, a RESET_STREAM frame (Section 19.4) includes</td><td> </td><td class="right">   To remedy this issue, a RESET_STREAM frame (Section 19.4) includes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the final size of data sent on the stream.  On receiving a</td><td> </td><td class="right">   the final size of data sent on the stream.  On receiving a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   RESET_STREAM frame, a receiver definitively knows how many bytes were</td><td> </td><td class="right">   RESET_STREAM frame, a receiver definitively knows how many bytes were</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sent on that stream before the RESET_STREAM frame, and the receiver</td><td> </td><td class="right">   sent on that stream before the RESET_STREAM frame, and the receiver</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MUST use the final size of the stream to account for all bytes sent</td><td> </td><td class="right">   MUST use the final size of the stream to account for all bytes sent</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   on the stream in its connection level flow controller.</td><td> </td><td class="right">   on the stream in its connection level flow controller.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   RESET_STREAM terminates one direction of a stream abruptly.  For a</td><td> </td><td class="right">   RESET_STREAM terminates one direction of a stream abruptly.  For a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   bidirectional stream, RESET_STREAM has no effect on data flow in the</td><td> </td><td class="right">   bidirectional stream, RESET_STREAM has no effect on data flow in the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   opposite direction.  Both endpoints MUST maintain flow control state</td><td> </td><td class="right">   opposite direction.  Both endpoints MUST maintain flow control state</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   for the stream in the unterminated direction until that direction</td><td> </td><td class="right">   for the stream in the unterminated direction until that direction</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   enters a terminal state, or until one of the endpoints sends</td><td> </td><td class="right">   enters a terminal state, or until one of the endpoints sends</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   CONNECTION_CLOSE.</td><td> </td><td class="right">   CONNECTION_CLOSE.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">4.4.  Stream Final Size</td><td> </td><td class="right">4.4.  Stream Final Size</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The final size is the amount of flow control credit that is consumed</td><td> </td><td class="right">   The final size is the amount of flow control credit that is consumed</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   by a stream.  Assuming that every contiguous byte on the stream was</td><td> </td><td class="right">   by a stream.  Assuming that every contiguous byte on the stream was</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sent once, the final size is the number of bytes sent.  More</td><td> </td><td class="right">   sent once, the final size is the number of bytes sent.  More</td><td class="lineno"></td></tr>
      <tr id="diff0093"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   generally, this is one higher than the <span class="delete">largest</span> byte offset sent on</td><td> </td><td class="rblock">   generally, this is one higher than the <span class="insert">offset of the</span> byte <span class="insert">with the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the <span class="delete">stream.</span></td><td> </td><td class="rblock"><span class="insert">   largest</span> offset sent on the <span class="insert">stream, or zero if no bytes were sent.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0094"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">For a stream that is reset, the</span> final size <span class="delete">is carried explicitly in</span> a</td><td> </td><td class="rblock">   <span class="insert">The</span> final size <span class="insert">of</span> a <span class="insert">stream is always signaled to</span> the <span class="insert">recipient.  The</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">RESET_STREAM frame.  Otherwise,</span> the final size is the <span class="delete">offset plus</span> the</td><td> </td><td class="rblock">   final size is the <span class="insert">sum of</span> the <span class="insert">Offset and Length fields</span> of a STREAM</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">length</span> of a STREAM frame <span class="delete">marked</span> with a FIN flag, <span class="delete">or 0</span> in the <span class="delete">case</span> of</td><td> </td><td class="rblock">   frame with a FIN flag, <span class="insert">noting that these fields might be implicit.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">incoming unidirectional streams.</span></td><td> </td><td class="rblock"><span class="insert">   Alternatively, the Final Size field of a RESET_STREAM frame carries</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   this value.  This ensures that all ways that a stream can be closed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   result</span> in the <span class="insert">number</span> of <span class="insert">bytes on the stream being reliably</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transmitted.  This guarantees that both endpoints agree on how much</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   flow control credit was consumed by the stream.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint will know the final size for a stream when the receiving</td><td> </td><td class="right">   An endpoint will know the final size for a stream when the receiving</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   part of the stream enters the "Size Known" or "Reset Recvd" state</td><td> </td><td class="right">   part of the stream enters the "Size Known" or "Reset Recvd" state</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 3).</td><td> </td><td class="right">   (Section 3).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MUST NOT send data on a stream at or beyond the final</td><td> </td><td class="right">   An endpoint MUST NOT send data on a stream at or beyond the final</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   size.</td><td> </td><td class="right">   size.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Once a final size for a stream is known, it cannot change.  If a</td><td> </td><td class="right">   Once a final size for a stream is known, it cannot change.  If a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   RESET_STREAM or STREAM frame is received indicating a change in the</td><td> </td><td class="right">   RESET_STREAM or STREAM frame is received indicating a change in the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   final size for the stream, an endpoint SHOULD respond with a</td><td> </td><td class="right">   final size for the stream, an endpoint SHOULD respond with a</td><td class="lineno"></td></tr>
      <tr id="diff0095"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   FINAL_SIZE_ERROR error<span class="delete"> (see Section 11)</span>.  A receiver SHOULD treat</td><td> </td><td class="rblock">   FINAL_SIZE_ERROR error<span class="insert">; see Section 11</span>.  A receiver SHOULD treat</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   receipt of data at or beyond the final size as a FINAL_SIZE_ERROR</td><td> </td><td class="right">   receipt of data at or beyond the final size as a FINAL_SIZE_ERROR</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   error, even after a stream is closed.  Generating these errors is not</td><td> </td><td class="right">   error, even after a stream is closed.  Generating these errors is not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   mandatory, but only because requiring that an endpoint generate these</td><td> </td><td class="right">   mandatory, but only because requiring that an endpoint generate these</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   errors also means that the endpoint needs to maintain the final size</td><td> </td><td class="right">   errors also means that the endpoint needs to maintain the final size</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   state for closed streams, which could mean a significant state</td><td> </td><td class="right">   state for closed streams, which could mean a significant state</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   commitment.</td><td> </td><td class="right">   commitment.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">4.5.  Controlling Concurrency</td><td> </td><td class="right">4.5.  Controlling Concurrency</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint limits the cumulative number of incoming streams a peer</td><td> </td><td class="right">   An endpoint limits the cumulative number of incoming streams a peer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   can open.  Only streams with a stream ID less than (max_stream * 4 +</td><td> </td><td class="right">   can open.  Only streams with a stream ID less than (max_stream * 4 +</td><td class="lineno"></td></tr>
      <tr id="diff0096"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   initial_stream_id_for_type) can be <span class="delete">opened (see</span> Table <span class="delete">5).</span>  Initial</td><td> </td><td class="rblock">   initial_stream_id_for_type) can be <span class="insert">opened; see</span> Table <span class="insert">5.</span>  Initial</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   limits are set in the transport parameters (see Section <span class="delete">18.1)</span> and</td><td> </td><td class="rblock">   limits are set in the transport parameters (see Section <span class="insert">18.2)</span> and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   subsequently limits are advertised using MAX_STREAMS frames</td><td> </td><td class="right">   subsequently limits are advertised using MAX_STREAMS frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 19.11).  Separate limits apply to unidirectional and</td><td> </td><td class="right">   (Section 19.11).  Separate limits apply to unidirectional and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   bidirectional streams.</td><td> </td><td class="right">   bidirectional streams.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0097"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">If a max_streams transport parameter or MAX_STREAMS frame is received</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   with a value greater than 2^60, this would allow a maximum stream ID</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that cannot be expressed as a variable-length integer; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 16.  If either is received, the connection MUST be closed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   immediately with a connection error of type STREAM_LIMIT_ERROR; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 10.3.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Endpoints MUST NOT exceed the limit set by their peer.  An endpoint</td><td> </td><td class="right">   Endpoints MUST NOT exceed the limit set by their peer.  An endpoint</td><td class="lineno"></td></tr>
      <tr id="diff0098"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that receives a <span class="delete">STREAM</span> frame with a stream ID exceeding the limit it</td><td> </td><td class="rblock">   that receives a frame with a stream ID exceeding the limit it has</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   has sent MUST treat this as a <span class="delete">stream</span> error of type STREAM_LIMIT_ERROR</td><td> </td><td class="rblock">   sent MUST treat this as a <span class="insert">connection</span> error of type STREAM_LIMIT_ERROR</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 11).</td><td> </td><td class="right">   (Section 11).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0099"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A receiver cannot renege on an advertisement.  That is, once</span> a</td><td> </td><td class="rblock">   <span class="insert">Once</span> a receiver advertises a stream limit using the MAX_STREAMS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   receiver advertises a stream limit using the MAX_STREAMS frame,</td><td> </td><td class="rblock">   frame, advertising a smaller limit has no effect.  A receiver MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   advertising a smaller limit has no effect.  A receiver MUST ignore</td><td> </td><td class="rblock">   ignore any MAX_STREAMS frame that does not increase the stream limit.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   any MAX_STREAMS frame that does not increase the stream limit.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   As with stream and connection flow control, this document leaves when</td><td> </td><td class="right">   As with stream and connection flow control, this document leaves when</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and how many streams to advertise to a peer via MAX_STREAMS to</td><td> </td><td class="right">   and how many streams to advertise to a peer via MAX_STREAMS to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   implementations.  Implementations might choose to increase limits as</td><td> </td><td class="right">   implementations.  Implementations might choose to increase limits as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   streams close to keep the number of streams available to peers</td><td> </td><td class="right">   streams close to keep the number of streams available to peers</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   roughly consistent.</td><td> </td><td class="right">   roughly consistent.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint that is unable to open a new stream due to the peer's</td><td> </td><td class="right">   An endpoint that is unable to open a new stream due to the peer's</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   limits SHOULD send a STREAMS_BLOCKED frame (Section 19.14).  This</td><td> </td><td class="right">   limits SHOULD send a STREAMS_BLOCKED frame (Section 19.14).  This</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   signal is considered useful for debugging.  An endpoint MUST NOT wait</td><td> </td><td class="right">   signal is considered useful for debugging.  An endpoint MUST NOT wait</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-8" class="change"><td></td><th><small>skipping to change at</small><a href="#part-8"><em> page 23, line 42<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-8"><em> page 28, line 17<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   Each connection possesses a set of connection identifiers, or</td><td> </td><td class="right">   Each connection possesses a set of connection identifiers, or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection IDs, each of which can identify the connection.</td><td> </td><td class="right">   connection IDs, each of which can identify the connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Connection IDs are independently selected by endpoints; each endpoint</td><td> </td><td class="right">   Connection IDs are independently selected by endpoints; each endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   selects the connection IDs that its peer uses.</td><td> </td><td class="right">   selects the connection IDs that its peer uses.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The primary function of a connection ID is to ensure that changes in</td><td> </td><td class="right">   The primary function of a connection ID is to ensure that changes in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   addressing at lower protocol layers (UDP, IP) don't cause packets for</td><td> </td><td class="right">   addressing at lower protocol layers (UDP, IP) don't cause packets for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a QUIC connection to be delivered to the wrong endpoint.  Each</td><td> </td><td class="right">   a QUIC connection to be delivered to the wrong endpoint.  Each</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint selects connection IDs using an implementation-specific (and</td><td> </td><td class="right">   endpoint selects connection IDs using an implementation-specific (and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   perhaps deployment-specific) method which will allow packets with</td><td> </td><td class="right">   perhaps deployment-specific) method which will allow packets with</td><td class="lineno"></td></tr>
      <tr id="diff0100"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that connection ID to be routed back to the endpoint and identified</td><td> </td><td class="rblock">   that connection ID to be routed back to the endpoint and <span class="insert">to be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   by the endpoint upon receipt.</td><td> </td><td class="rblock">   identified by the endpoint upon receipt.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Connection IDs MUST NOT contain any information that can be used by</td><td> </td><td class="right">   Connection IDs MUST NOT contain any information that can be used by</td><td class="lineno"></td></tr>
      <tr id="diff0101"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   an external observer to correlate them with other connection IDs for</td><td> </td><td class="rblock">   an external observer <span class="insert">(that is, one that does not cooperate with the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the same connection.  As a trivial example, this means the same</td><td> </td><td class="rblock"><span class="insert">   issuer)</span> to correlate them with other connection IDs for the same</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection ID MUST NOT be issued more than once on the same</td><td> </td><td class="rblock">   connection.  As a trivial example, this means the same connection ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection.</td><td> </td><td class="rblock">   MUST NOT be issued more than once on the same connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packets with long headers include Source Connection ID and</td><td> </td><td class="right">   Packets with long headers include Source Connection ID and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Destination Connection ID fields.  These fields are used to set the</td><td> </td><td class="right">   Destination Connection ID fields.  These fields are used to set the</td><td class="lineno"></td></tr>
      <tr id="diff0102"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection IDs for new connections<span class="delete">,</span> see Section 7.2 for details.</td><td> </td><td class="rblock">   connection IDs for new connections<span class="insert">;</span> see Section 7.2 for details.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packets with short headers (Section 17.3) only include the</td><td> </td><td class="right">   Packets with short headers (Section 17.3) only include the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Destination Connection ID and omit the explicit length.  The length</td><td> </td><td class="right">   Destination Connection ID and omit the explicit length.  The length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   of the Destination Connection ID field is expected to be known to</td><td> </td><td class="right">   of the Destination Connection ID field is expected to be known to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoints.  Endpoints using a load balancer that routes based on</td><td> </td><td class="right">   endpoints.  Endpoints using a load balancer that routes based on</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection ID could agree with the load balancer on a fixed length</td><td> </td><td class="right">   connection ID could agree with the load balancer on a fixed length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   for connection IDs, or agree on an encoding scheme.  A fixed portion</td><td> </td><td class="right">   for connection IDs, or agree on an encoding scheme.  A fixed portion</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   could encode an explicit length, which allows the entire connection</td><td> </td><td class="right">   could encode an explicit length, which allows the entire connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ID to vary in length and still be used by the load balancer.</td><td> </td><td class="right">   ID to vary in length and still be used by the load balancer.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A Version Negotiation (Section 17.2.1) packet echoes the connection</td><td> </td><td class="right">   A Version Negotiation (Section 17.2.1) packet echoes the connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   IDs selected by the client, both to ensure correct routing toward the</td><td> </td><td class="right">   IDs selected by the client, both to ensure correct routing toward the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   client and to allow the client to validate that the packet is in</td><td> </td><td class="right">   client and to allow the client to validate that the packet is in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   response to an Initial packet.</td><td> </td><td class="right">   response to an Initial packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0103"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A zero-length connection ID <span class="delete">MAY</span> be used when <span class="delete">the</span> connection ID is not</td><td> </td><td class="rblock">   A zero-length connection ID <span class="insert">can</span> be used when <span class="insert">a</span> connection ID is not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   needed <span class="delete">for routing and the address/port tuple of packets is</span></td><td> </td><td class="rblock">   needed to <span class="insert">route</span> to <span class="insert">the correct endpoint.  However, multiplexing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   sufficient</span> to <span class="delete">identify a connection.  An endpoint whose peer has</span></td><td> </td><td class="rblock"><span class="insert">   connections on the same local IP address and port while using</span> zero-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   selected a zero-length connection ID MUST continue</span> to <span class="delete">use a</span> zero-</td><td> </td><td class="rblock">   length connection <span class="insert">IDs will cause failures in</span> the <span class="insert">presence</span> of <span class="insert">peer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   length connection <span class="delete">ID for</span> the <span class="delete">lifetime</span> of <span class="delete">the</span> connection and MUST NOT</td><td> </td><td class="rblock">   connection <span class="insert">migration, NAT rebinding,</span> and <span class="insert">client port reuse; and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">send packets from any other local address.</span></td><td> </td><td class="rblock"><span class="insert">   therefore</span> MUST NOT <span class="insert">be done unless an endpoint is certain that those</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   protocol features are not in use.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0104"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   When an endpoint <span class="delete">has requested</span> a non-zero-length connection ID, it</td><td> </td><td class="rblock">   When an endpoint <span class="insert">uses</span> a non-zero-length connection ID, it needs to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   needs to ensure that the peer has a supply of connection IDs from</td><td> </td><td class="rblock">   ensure that the peer has a supply of connection IDs from which to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   which to choose for packets sent to the endpoint.  These connection</td><td> </td><td class="rblock">   choose for packets sent to the endpoint.  These connection IDs are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   IDs are supplied by the endpoint using the NEW_CONNECTION_ID frame</td><td> </td><td class="rblock">   supplied by the endpoint using the NEW_CONNECTION_ID frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 19.15).</td><td> </td><td class="right">   (Section 19.15).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">5.1.1.  Issuing Connection IDs</td><td> </td><td class="right">5.1.1.  Issuing Connection IDs</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Each Connection ID has an associated sequence number to assist in</td><td> </td><td class="right">   Each Connection ID has an associated sequence number to assist in</td><td class="lineno"></td></tr>
      <tr id="diff0105"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">deduplicating messages.</span>  The initial connection ID issued by an</td><td> </td><td class="rblock">   <span class="insert">detecting when NEW_CONNECTION_ID or RETIRE_CONNECTION_ID frames refer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   endpoint is sent in the Source Connection ID field of the long packet</td><td> </td><td class="rblock"><span class="insert">   to the same value.</span>  The initial connection ID issued by an endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   header (Section 17.2) during the handshake.  The sequence number of</td><td> </td><td class="rblock">   is sent in the Source Connection ID field of the long packet header</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the initial connection ID is 0.  If the preferred_address transport</td><td> </td><td class="rblock">   (Section 17.2) during the handshake.  The sequence number of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   initial connection ID is 0.  If the preferred_address transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   parameter is sent, the sequence number of the supplied connection ID</td><td> </td><td class="right">   parameter is sent, the sequence number of the supplied connection ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   is 1.</td><td> </td><td class="right">   is 1.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Additional connection IDs are communicated to the peer using</td><td> </td><td class="right">   Additional connection IDs are communicated to the peer using</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   NEW_CONNECTION_ID frames (Section 19.15).  The sequence number on</td><td> </td><td class="right">   NEW_CONNECTION_ID frames (Section 19.15).  The sequence number on</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   each newly-issued connection ID MUST increase by 1.  The connection</td><td> </td><td class="right">   each newly-issued connection ID MUST increase by 1.  The connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ID randomly selected by the client in the Initial packet and any</td><td> </td><td class="right">   ID randomly selected by the client in the Initial packet and any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection ID provided by a Retry packet are not assigned sequence</td><td> </td><td class="right">   connection ID provided by a Retry packet are not assigned sequence</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   numbers unless a server opts to retain them as its initial connection</td><td> </td><td class="right">   numbers unless a server opts to retain them as its initial connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ID.</td><td> </td><td class="right">   ID.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   When an endpoint issues a connection ID, it MUST accept packets that</td><td> </td><td class="right">   When an endpoint issues a connection ID, it MUST accept packets that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   carry this connection ID for the duration of the connection or until</td><td> </td><td class="right">   carry this connection ID for the duration of the connection or until</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   its peer invalidates the connection ID via a RETIRE_CONNECTION_ID</td><td> </td><td class="right">   its peer invalidates the connection ID via a RETIRE_CONNECTION_ID</td><td class="lineno"></td></tr>
      <tr id="diff0106"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   frame (Section 19.16).</td><td> </td><td class="rblock">   frame (Section 19.16).  <span class="insert">Connection</span> IDs that <span class="insert">are issued</span> and <span class="insert">not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"><span class="insert">   retired are considered active; any active connection ID is valid for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Endpoints store received connection</span> IDs <span class="delete">for future use.  An endpoint</span></td><td> </td><td class="rblock">   use <span class="insert">with the current connection at any time, in any packet type.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that <span class="delete">receives excessive connection IDs MAY discard those it cannot</span></td><td> </td><td class="rblock"><span class="insert">   This includes the</span> connection <span class="insert">ID issued by the server via the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   store without sending a RETIRE_CONNECTION_ID frame.  An endpoint that</span></td><td> </td><td class="rblock"><span class="insert">   preferred_address transport parameter.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   issues connection IDs cannot expect its peer to store</span> and use <span class="delete">all</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   issued</span> connection <span class="delete">IDs.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint SHOULD ensure that its peer has a sufficient number of</td><td> </td><td class="right">   An endpoint SHOULD ensure that its peer has a sufficient number of</td><td class="lineno"></td></tr>
      <tr id="diff0107"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   available and unused connection IDs.  <span class="delete">While each endpoint</span></td><td> </td><td class="rblock">   available and unused connection IDs.  <span class="insert">Endpoints advertise the number</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   independently chooses how many</span> connection IDs to <span class="delete">issue, endpoints</span></td><td> </td><td class="rblock"><span class="insert">   of active</span> connection IDs <span class="insert">they are willing</span> to <span class="insert">maintain using the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   SHOULD</span> provide and <span class="delete">maintain at least eight</span> connection <span class="delete">IDs.  The</span></td><td> </td><td class="rblock"><span class="insert">   active_connection_id_limit transport parameter.  An endpoint MUST NOT</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   endpoint SHOULD <span class="delete">do this by always supplying</span> a new connection ID when</td><td> </td><td class="rblock">   provide <span class="insert">more connection IDs than the peer's limit.  An endpoint MAY</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a connection ID <span class="delete">is retired by its peer or</span> when <span class="delete">the endpoint</span> receives</td><td> </td><td class="rblock"><span class="insert">   send connection IDs that temporarily exceed a peer's limit if the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a packet with a previously unused connection ID.  <span class="delete">Endpoints</span> that</td><td> </td><td class="rblock"><span class="insert">   NEW_CONNECTION_ID frame also requires the retirement of any excess,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">initiate</span> migration and <span class="delete">require</span> non-zero-length connection IDs SHOULD</td><td> </td><td class="rblock"><span class="insert">   by including a sufficiently large value in the Retire Prior To field.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">provide their peers with new</span> connection IDs <span class="delete">before</span> migration, <span class="delete">or risk</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the peer <span class="delete">closing</span> the <span class="delete">connection.</span></td><td> </td><td class="rblock"><span class="insert">   A NEW_CONNECTION_ID frame might cause an endpoint to add some active</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection IDs</span> and <span class="insert">retire others based on the value of the Retire</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Prior To field.  After processing a NEW_CONNECTION_ID frame and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   adding and retiring active</span> connection <span class="insert">IDs, if the number of active</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection IDs exceeds the value advertised in its</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   active_connection_id_limit transport parameter, an endpoint MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   close the connection with an error of type CONNECTION_ID_LIMIT_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An</span> endpoint SHOULD <span class="insert">supply</span> a new connection ID when <span class="insert">the peer retires</span> a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   connection <span class="insert">ID.  If an endpoint provided fewer connection IDs than the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   peer's active_connection_id_limit, it MAY supply a new connection</span> ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   when <span class="insert">it</span> receives a packet with a previously unused connection ID.  <span class="insert">An</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   endpoint MAY limit the frequency or the total number of connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   IDs issued for each connection to avoid the risk of running out of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection IDs; see Section 10.4.2.  An endpoint MAY also limit the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   issuance of connection IDs to reduce the amount of per-path state it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   maintains, such as path validation status, as its peer might interact</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   with it over as many paths as there are issued connection IDs.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint</span> that <span class="insert">initiates</span> migration and <span class="insert">requires</span> non-zero-length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   connection IDs SHOULD <span class="insert">ensure that the pool of</span> connection IDs</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">available to its peer allows the peer to use a new connection ID on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   migration, <span class="insert">as</span> the peer <span class="insert">will close</span> the <span class="insert">connection if the pool is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   exhausted.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">5.1.2.  Consuming and Retiring Connection IDs</td><td> </td><td class="right">5.1.2.  Consuming and Retiring Connection IDs</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint can change the connection ID it uses for a peer to</td><td> </td><td class="right">   An endpoint can change the connection ID it uses for a peer to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   another available one at any time during the connection.  An endpoint</td><td> </td><td class="right">   another available one at any time during the connection.  An endpoint</td><td class="lineno"></td></tr>
      <tr id="diff0108"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   consumes connection IDs in response to a migrating peer<span class="delete">,</span> see</td><td> </td><td class="rblock">   consumes connection IDs in response to a migrating peer<span class="insert">;</span> see</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Section 9.5 for more.</td><td> </td><td class="right">   Section 9.5 for more.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint maintains a set of connection IDs received from its peer,</td><td> </td><td class="right">   An endpoint maintains a set of connection IDs received from its peer,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   any of which it can use when sending packets.  When the endpoint</td><td> </td><td class="right">   any of which it can use when sending packets.  When the endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   wishes to remove a connection ID from use, it sends a</td><td> </td><td class="right">   wishes to remove a connection ID from use, it sends a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   RETIRE_CONNECTION_ID frame to its peer.  Sending a</td><td> </td><td class="right">   RETIRE_CONNECTION_ID frame to its peer.  Sending a</td><td class="lineno"></td></tr>
      <tr id="diff0109"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   RETIRE_CONNECTION_ID frame indicates that the connection ID <span class="delete">won't</span> be</td><td> </td><td class="rblock">   RETIRE_CONNECTION_ID frame indicates that the connection ID <span class="insert">will not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   used again and requests that the peer replace it with a new</td><td> </td><td class="rblock">   be used again and requests that the peer replace it with a new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection ID using a NEW_CONNECTION_ID frame.</td><td> </td><td class="right">   connection ID using a NEW_CONNECTION_ID frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0110"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   As discussed in Section 9.5, <span class="delete">each</span> connection ID <span class="delete">MUST be used on</span></td><td> </td><td class="rblock">   As discussed in Section 9.5, <span class="insert">endpoints limit the use of a</span> connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets sent from <span class="delete">only one</span> local address.  An endpoint <span class="delete">that migrates</span></td><td> </td><td class="rblock">   ID <span class="insert">to</span> packets sent from <span class="insert">a single</span> local <span class="insert">address to a single</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   away from</span> a <span class="delete">local address</span> SHOULD retire all connection IDs <span class="delete">used on</span></td><td> </td><td class="rblock"><span class="insert">   destination</span> address.  <span class="insert">Endpoints SHOULD retire connection IDs when</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that address once it</span> no <span class="delete">longer plans</span> to <span class="delete">use</span> that <span class="delete">address.</span></td><td> </td><td class="rblock"><span class="insert">   they are no longer actively using either the local or destination</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   address for which the connection ID was used.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   An endpoint <span class="insert">might need to stop accepting previously issued connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   IDs in certain circumstances.  Such an endpoint can cause its peer to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   retire connection IDs by sending</span> a <span class="insert">NEW_CONNECTION_ID frame with an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   increased Retire Prior To field.  The endpoint</span> SHOULD <span class="insert">continue to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   accept the previously issued connection IDs until they are retired by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the peer.  If the endpoint can no longer process the indicated</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection IDs, it MAY close the connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Upon receipt of an increased Retire Prior To field, the peer MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   stop using the corresponding connection IDs and</span> retire <span class="insert">them with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   RETIRE_CONNECTION_ID frames before adding the newly provided</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection ID to the set of active connection IDs.  This ordering</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   allows an endpoint to replace</span> all <span class="insert">active</span> connection IDs <span class="insert">without the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   possibility of a peer having</span> no <span class="insert">available connection IDs and without</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   exceeding the limit the peer sets in the active_connection_id_limit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transport parameter; see Section 18.2.  Failure</span> to <span class="insert">cease using the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection IDs when requested can result in connection failures, as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the issuing endpoint might be unable to continue using the connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   IDs with the active connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint SHOULD limit the number of connection IDs it has retired</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   locally and have not yet been acknowledged.  An endpoint SHOULD allow</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   for sending and tracking a number of RETIRE_CONNECTION_ID frames of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   at least twice the active_connection_id limit.  An endpoint MUST NOT</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   forget a connection ID without retiring it, though it MAY choose to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   treat having connection IDs in need of retirement</span> that <span class="insert">exceed this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   limit as a connection error of type CONNECTION_ID_LIMIT_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Endpoints SHOULD NOT issue updates of the Retire Prior To field</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   before receiving RETIRE_CONNECTION_ID frames that retire all</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection IDs indicated by the previous Retire Prior To value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">5.2.  Matching Packets to Connections</td><td> </td><td class="right">5.2.  Matching Packets to Connections</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Incoming packets are classified on receipt.  Packets can either be</td><td> </td><td class="right">   Incoming packets are classified on receipt.  Packets can either be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   associated with an existing connection, or - for servers -</td><td> </td><td class="right">   associated with an existing connection, or - for servers -</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   potentially create a new connection.</td><td> </td><td class="right">   potentially create a new connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0111"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Hosts</span> try to associate a packet with an existing connection.  If the</td><td> </td><td class="rblock">   <span class="insert">Endpoints</span> try to associate a packet with an existing connection.  If</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet has a Destination Connection ID corresponding to an existing</td><td> </td><td class="rblock">   the packet has a <span class="insert">non-zero-length</span> Destination Connection ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection, QUIC processes that packet accordingly.  Note that more</td><td> </td><td class="rblock">   corresponding to an existing connection, QUIC processes that packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   than one connection ID can be associated with a connection; see</td><td> </td><td class="rblock">   accordingly.  Note that more than one connection ID can be associated</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section 5.1.</td><td> </td><td class="rblock">   with a connection; see Section 5.1.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0112"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   If the Destination Connection ID is zero length and the packet</td><td> </td><td class="rblock">   If the Destination Connection ID is zero length and the <span class="insert">addressing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   matches the <span class="delete">address/port tuple of</span> a connection <span class="delete">where the host did not</span></td><td> </td><td class="rblock"><span class="insert">   information in the</span> packet matches the <span class="insert">addressing information the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   require</span> connection <span class="delete">IDs,</span> QUIC processes the packet as part of that</td><td> </td><td class="rblock"><span class="insert">   endpoint uses to identify</span> a connection <span class="insert">with a zero-length</span> connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection.  <span class="delete">Endpoints SHOULD either reject connection attempts that</span></td><td> </td><td class="rblock">   <span class="insert">ID,</span> QUIC processes the packet as part of that connection.  <span class="insert">An</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   use <span class="delete">the same</span> addresses as <span class="delete">existing connections, or use a non-zero-</span></td><td> </td><td class="rblock"><span class="insert">   endpoint can</span> use <span class="insert">just destination IP and port or both source and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   length Destination Connection ID so that packets can be correctly</span></td><td> </td><td class="rblock"><span class="insert">   destination</span> addresses <span class="insert">for identification, though this makes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   attributed to connections.</span></td><td> </td><td class="rblock"><span class="insert">   connections fragile</span> as <span class="insert">described in Section 5.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Endpoints can send a Stateless Reset (Section 10.4) for any packets</td><td> </td><td class="right">   Endpoints can send a Stateless Reset (Section 10.4) for any packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that cannot be attributed to an existing connection.  A stateless</td><td> </td><td class="right">   that cannot be attributed to an existing connection.  A stateless</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   reset allows a peer to more quickly identify when a connection</td><td> </td><td class="right">   reset allows a peer to more quickly identify when a connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   becomes unusable.</td><td> </td><td class="right">   becomes unusable.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0113"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Packets that are matched to an existing connection, <span class="delete">but for which</span> the</td><td> </td><td class="rblock">   Packets that are matched to an existing <span class="insert">connection are discarded if</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">endpoint cannot remove</span> packet <span class="delete">protection,</span> are <span class="delete">discarded.</span></td><td> </td><td class="rblock"><span class="insert">   the packets are inconsistent with the state of that connection.  For</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   example, packets are discarded if they indicate a different protocol</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   version than that of the</span> connection, <span class="insert">or if</span> the <span class="insert">removal of</span> packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">protection is unsuccessful once the expected keys</span> are <span class="insert">available.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Invalid packets without packet protection, such as Initial, Retry, or</td><td> </td><td class="right">   Invalid packets without packet protection, such as Initial, Retry, or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Version Negotiation, MAY be discarded.  An endpoint MUST generate a</td><td> </td><td class="right">   Version Negotiation, MAY be discarded.  An endpoint MUST generate a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection error if it commits changes to state before discovering an</td><td> </td><td class="right">   connection error if it commits changes to state before discovering an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   error.</td><td> </td><td class="right">   error.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">5.2.1.  Client Packet Handling</td><td> </td><td class="right">5.2.1.  Client Packet Handling</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Valid packets sent to clients always include a Destination Connection</td><td> </td><td class="right">   Valid packets sent to clients always include a Destination Connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ID that matches a value the client selects.  Clients that choose to</td><td> </td><td class="right">   ID that matches a value the client selects.  Clients that choose to</td><td class="lineno"></td></tr>
      <tr id="diff0114"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   receive zero-length connection IDs can use the <span class="delete">address/port tuple</span> to</td><td> </td><td class="rblock">   receive zero-length connection IDs can use the <span class="insert">local address and port</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   identify a connection.  Packets that don't match an existing</td><td> </td><td class="rblock">   to identify a connection.  Packets that don't match an existing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection are discarded.</td><td> </td><td class="right">   connection are discarded.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0115"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Due to packet reordering or loss, <span class="delete">clients</span> might receive packets for a</td><td> </td><td class="rblock">   Due to packet reordering or loss, <span class="insert">a client</span> might receive packets for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection that are encrypted with a key it has not yet computed.</td><td> </td><td class="rblock">   a connection that are encrypted with a key it has not yet computed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Clients</span> MAY drop these packets, or MAY buffer them in anticipation of</td><td> </td><td class="rblock">   <span class="insert">The client</span> MAY drop these packets, or MAY buffer them in anticipation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   later packets that allow it to compute the key.</td><td> </td><td class="rblock">   of later packets that allow it to compute the key.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If a client receives a packet that has an unsupported version, it</td><td> </td><td class="right">   If a client receives a packet that has an unsupported version, it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MUST discard that packet.</td><td> </td><td class="right">   MUST discard that packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">5.2.2.  Server Packet Handling</td><td> </td><td class="right">5.2.2.  Server Packet Handling</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0116"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   If a server receives a packet that <span class="delete">has</span> an unsupported <span class="delete">version,</span> but</td><td> </td><td class="rblock">   If a server receives a packet that <span class="insert">indicates</span> an unsupported <span class="insert">version</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">the packet</span> is <span class="delete">sufficiently</span> large to initiate a new connection for any</td><td> </td><td class="rblock">   but is large <span class="insert">enough</span> to initiate a new connection for any <span class="insert">one</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">version</span> supported <span class="delete">by</span> the <span class="delete">server, it</span> SHOULD send a Version Negotiation</td><td> </td><td class="rblock">   supported <span class="insert">version,</span> the <span class="insert">server</span> SHOULD send a Version Negotiation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet as described in Section 6.1.  Servers MAY <span class="delete">rate control these</span></td><td> </td><td class="rblock">   packet as described in Section 6.1.  Servers MAY <span class="insert">limit the number of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets to <span class="delete">avoid storms of</span> Version Negotiation <span class="delete">packets.</span></td><td> </td><td class="rblock">   packets <span class="insert">that it responds</span> to <span class="insert">with a</span> Version Negotiation <span class="insert">packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Servers MUST drop smaller packets that specify unsupported versions.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The first packet for an unsupported version can use different</td><td> </td><td class="right">   The first packet for an unsupported version can use different</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   semantics and encodings for any version-specific field.  In</td><td> </td><td class="right">   semantics and encodings for any version-specific field.  In</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   particular, different packet protection keys might be used for</td><td> </td><td class="right">   particular, different packet protection keys might be used for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   different versions.  Servers that do not support a particular version</td><td> </td><td class="right">   different versions.  Servers that do not support a particular version</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are unlikely to be able to decrypt the payload of the packet.</td><td> </td><td class="right">   are unlikely to be able to decrypt the payload of the packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Servers SHOULD NOT attempt to decode or decrypt a packet from an</td><td> </td><td class="right">   Servers SHOULD NOT attempt to decode or decrypt a packet from an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   unknown version, but instead send a Version Negotiation packet,</td><td> </td><td class="right">   unknown version, but instead send a Version Negotiation packet,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provided that the packet is sufficiently long.</td><td> </td><td class="right">   provided that the packet is sufficiently long.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0117"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Servers MUST drop other packets that contain unsupported versions.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packets with a supported version, or no version field, are matched to</td><td> </td><td class="right">   Packets with a supported version, or no version field, are matched to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a connection using the connection ID or - for packets with zero-</td><td> </td><td class="right">   a connection using the connection ID or - for packets with zero-</td><td class="lineno"></td></tr>
      <tr id="diff0118"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   length connection IDs - the address <span class="delete">tuple.</span>  If the packet doesn't</td><td> </td><td class="rblock">   length connection IDs - the <span class="insert">local</span> address <span class="insert">and port.</span>  If the packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   match an existing connection, the server continues below.</td><td> </td><td class="rblock">   doesn't match an existing connection, the server continues below.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If the packet is an Initial packet fully conforming with the</td><td> </td><td class="right">   If the packet is an Initial packet fully conforming with the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   specification, the server proceeds with the handshake (Section 7).</td><td> </td><td class="right">   specification, the server proceeds with the handshake (Section 7).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This commits the server to the version that the client selected.</td><td> </td><td class="right">   This commits the server to the version that the client selected.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0119"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   If a server <span class="delete">isn't currently accepting any</span> new <span class="delete">connections,</span> it SHOULD</td><td> </td><td class="rblock">   If a server <span class="insert">refuses to accept a</span> new <span class="insert">connection,</span> it SHOULD send an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   send an Initial packet containing a CONNECTION_CLOSE frame with error</td><td> </td><td class="rblock">   Initial packet containing a CONNECTION_CLOSE frame with error code</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   code <span class="delete">SERVER_BUSY.</span></td><td> </td><td class="rblock">   <span class="insert">CONNECTION_REFUSED.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If the packet is a 0-RTT packet, the server MAY buffer a limited</td><td> </td><td class="right">   If the packet is a 0-RTT packet, the server MAY buffer a limited</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   number of these packets in anticipation of a late-arriving Initial</td><td> </td><td class="right">   number of these packets in anticipation of a late-arriving Initial</td><td class="lineno"></td></tr>
      <tr id="diff0120"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Packet.</span>  Clients are <span class="delete">forbidden from sending</span> Handshake packets prior</td><td> </td><td class="rblock">   <span class="insert">packet.</span>  Clients are <span class="insert">not able to send</span> Handshake packets prior to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to receiving a server response, so servers SHOULD ignore any such</td><td> </td><td class="rblock">   receiving a server response, so servers SHOULD ignore any such</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets.</td><td> </td><td class="right">   packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Servers MUST drop incoming packets under all other circumstances.</td><td> </td><td class="right">   Servers MUST drop incoming packets under all other circumstances.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0121"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">5.2.3.  Considerations for Simple Load Balancers</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A server deployment could load balance among servers using only</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   source and destination IP addresses and ports.  Changes to the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client's IP address or port could result in packets being forwarded</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to the wrong server.  Such a server deployment could use one of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   following methods for connection continuity when a client's address</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   changes.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Servers could use an out-of-band mechanism to forward packets to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      the correct server based on Connection ID.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  If servers can use a dedicated server IP address or port, other</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      than the one that the client initially connects to, they could use</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      the preferred_address transport parameter to request that clients</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      move connections to that dedicated address.  Note that clients</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      could choose not to use the preferred address.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A server in a deployment that does not implement a solution to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   maintain connection continuity when the client address changes SHOULD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   indicate migration is not supported using the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   disable_active_migration transport parameter.  The</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   disable_active_migration transport parameter does not prohibit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection migration after a client has acted on a preferred_address</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transport parameter.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Server deployments that use this simple form of load balancing MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   avoid the creation of a stateless reset oracle; see Section 21.9.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">5.3.  Life of a QUIC Connection</td><td> </td><td class="right">5.3.  Life of a QUIC Connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0122"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">TBD.</span></td><td> </td><td class="rblock">   <span class="insert">A QUIC connection is a stateful interaction between a client and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server, the primary purpose of which is to support the exchange of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   data by an application protocol.  Streams (Section 2) are the primary</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   means by which an application protocol exchanges information.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0123"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">6.  Version Negotiation</span></td><td> </td><td class="rblock">   <span class="insert">Each connection starts with a handshake phase, during which client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   and server establish a shared secret using the cryptographic</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   handshake protocol [QUIC-TLS] and negotiate the application protocol.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The handshake (Section 7) confirms that both endpoints are willing to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   communicate (Section 8.1) and establishes parameters for the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection (Section 7.4).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0124"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Version negotiation ensures that client and server agree</span> to a <span class="delete">QUIC</span></td><td> </td><td class="rblock">   <span class="insert">An application protocol can also operate in a limited fashion during</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   version that</span> is <span class="delete">mutually supported.  A server sends a Version</span></td><td> </td><td class="rblock"><span class="insert">   the handshake phase.  0-RTT allows application data</span> to <span class="insert">be sent by</span> a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Negotiation packet</span> in <span class="delete">response</span> to <span class="delete">each packet that might initiate</span> a</td><td> </td><td class="rblock">   <span class="insert">client before receiving any response from the server.  However, 0-RTT</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">new connection, see Section 5.2</span> for <span class="delete">details.</span></td><td> </td><td class="rblock"><span class="insert">   lacks certain key security guarantees.  In particular, there</span> is <span class="insert">no</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   protection against replay attacks</span> in <span class="insert">0-RTT; see [QUIC-TLS].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Separately, a server can also send application data</span> to a <span class="insert">client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   before it receives the final cryptographic handshake messages that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   allow it to confirm the identity and liveness of the client.  These</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   capabilities allow an application protocol to offer the option to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   trade some security guarantees</span> for <span class="insert">reduced latency.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0125"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">first few messages</span> of <span class="delete">an exchange between a client attempting</span> to</td><td> </td><td class="rblock">   The <span class="insert">use</span> of <span class="insert">connection IDs (Section 5.1) allows connections to migrate</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">create</span> a new <span class="delete">connection with server is shown in Figure 3.  After</span></td><td> </td><td class="rblock">   to a new <span class="insert">network path, both</span> as <span class="insert">a direct choice of an endpoint and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   version negotiation completes, connection establishment can proceed,</span></td><td> </td><td class="rblock"><span class="insert">   when forced by a change</span> in <span class="insert">a middlebox.</span>  Section <span class="insert">9 describes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   for example</span> as <span class="delete">shown</span> in Section <span class="delete">7.1.</span></td><td> </td><td class="rblock"><span class="insert">   mitigations for the security and privacy issues associated with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   migration.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0126"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Client                                                  Server</span></td><td> </td><td class="rblock">   <span class="insert">For connections that are no longer needed or desired, there are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   several ways for a client and server to terminate a connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (Section 10).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0127"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Packet (v=X) -&gt;</span></td><td> </td><td class="rblock"><span class="insert">5.4.  Required Operations on Connections</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0128"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                           <span class="delete">&lt;- Version Negotiation (supported=Y,Z)</span></td><td> </td><td class="rblock">   <span class="insert">There are certain operations that an application MUST be able to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   perform when interacting with the QUIC transport.  This document does</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   not specify an API, but any implementation of this version of QUIC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   MUST expose the ability to perform the operations described in this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   section on a QUIC connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0129"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Packet (v=Y) -&gt;</span></td><td> </td><td class="rblock">   <span class="insert">When implementing the client role, applications need to be able to:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0130"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                               <span class="delete">&lt;- Packet(s) (v=Y)</span></td><td> </td><td class="rblock">   <span class="insert">*  open a connection, which begins the exchange described in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Section 7;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0131"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              <span class="delete">Figure 3: Example</span> Version Negotiation <span class="delete">Exchange</span></td><td> </td><td class="rblock">   <span class="insert">*  enable 0-RTT when available; and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  be informed when 0-RTT has been accepted or rejected by a server.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   When implementing the server role, applications need to be able to:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  listen for incoming connections, which prepares for the exchange</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      described in Section 7;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  if Early Data is supported, embed application-controlled data in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      the TLS resumption ticket sent to the client; and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  if Early Data is supported, retrieve application-controlled data</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      from the client's resumption ticket and enable rejecting Early</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Data based on that information.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In either role, applications need to be able to:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  configure minimum values for the initial number of permitted</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      streams of each type, as communicated in the transport parameters</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (Section 7.4);</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  control resource allocation of various types, including flow</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      control and the number of permitted streams of each type;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  identify whether the handshake has completed successfully or is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      still ongoing;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  keep a connection from silently closing, either by generating PING</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      frames (Section 19.2) or by requesting that the transport send</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      additional frames before the idle timeout expires (Section 10.2);</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  immediately close (Section 10.3) the connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">6.</span>  Version Negotiation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Version negotiation ensures that client and server agree to a QUIC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   version that is mutually supported.  A server sends a Version</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Negotiation packet in response to each packet that might initiate a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   new connection; see Section 5.2 for details.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The size of the first packet sent by a client will determine whether</td><td> </td><td class="right">   The size of the first packet sent by a client will determine whether</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a server sends a Version Negotiation packet.  Clients that support</td><td> </td><td class="right">   a server sends a Version Negotiation packet.  Clients that support</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   multiple QUIC versions SHOULD pad the first packet they send to the</td><td> </td><td class="right">   multiple QUIC versions SHOULD pad the first packet they send to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   largest of the minimum packet sizes across all versions they support.</td><td> </td><td class="right">   largest of the minimum packet sizes across all versions they support.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This ensures that the server responds if there is a mutually</td><td> </td><td class="right">   This ensures that the server responds if there is a mutually</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   supported version.</td><td> </td><td class="right">   supported version.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">6.1.  Sending Version Negotiation Packets</td><td> </td><td class="right">6.1.  Sending Version Negotiation Packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If the version selected by the client is not acceptable to the</td><td> </td><td class="right">   If the version selected by the client is not acceptable to the</td><td class="lineno"></td></tr>
      <tr id="diff0132"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   server, the server responds with a Version Negotiation <span class="delete">packet (see</span></td><td> </td><td class="rblock">   server, the server responds with a Version Negotiation <span class="insert">packet; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">17.2.1).</span>  This includes a list of versions that the server</td><td> </td><td class="rblock">   Section <span class="insert">17.2.1.</span>  This includes a list of versions that the server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   will accept.  An endpoint MUST NOT send a Version Negotiation packet</td><td> </td><td class="right">   will accept.  An endpoint MUST NOT send a Version Negotiation packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   in response to receiving a Version Negotiation packet.</td><td> </td><td class="right">   in response to receiving a Version Negotiation packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This system allows a server to process packets with unsupported</td><td> </td><td class="right">   This system allows a server to process packets with unsupported</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   versions without retaining state.  Though either the Initial packet</td><td> </td><td class="right">   versions without retaining state.  Though either the Initial packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   or the Version Negotiation packet that is sent in response could be</td><td> </td><td class="right">   or the Version Negotiation packet that is sent in response could be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   lost, the client will send new packets until it successfully receives</td><td> </td><td class="right">   lost, the client will send new packets until it successfully receives</td><td class="lineno"></td></tr>
      <tr id="diff0133"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a response or it abandons the connection attempt.</td><td> </td><td class="rblock">   a response or it abandons the connection attempt.  <span class="insert">As a result, the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client discards all state for the connection and does not send any</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   more packets on the connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server MAY limit the number of Version Negotiation packets it</td><td> </td><td class="right">   A server MAY limit the number of Version Negotiation packets it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sends.  For instance, a server that is able to recognize packets as</td><td> </td><td class="right">   sends.  For instance, a server that is able to recognize packets as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0-RTT might choose not to send Version Negotiation packets in</td><td> </td><td class="right">   0-RTT might choose not to send Version Negotiation packets in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   response to 0-RTT packets with the expectation that it will</td><td> </td><td class="right">   response to 0-RTT packets with the expectation that it will</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   eventually receive an Initial packet.</td><td> </td><td class="right">   eventually receive an Initial packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">6.2.  Handling Version Negotiation Packets</td><td> </td><td class="right">6.2.  Handling Version Negotiation Packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0134"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">When the client receives a</span> Version Negotiation <span class="delete">packet, it first</span></td><td> </td><td class="rblock">   Version Negotiation <span class="insert">packets are designed to allow future versions of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   checks that</span> the <span class="delete">Destination and Source Connection ID fields match the</span></td><td> </td><td class="rblock"><span class="insert">   QUIC to negotiate</span> the <span class="insert">version</span> in <span class="insert">use between endpoints.  Future</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Source and Destination Connection ID fields</span> in <span class="delete">a packet</span> that <span class="delete">the</span></td><td> </td><td class="rblock"><span class="insert">   versions of QUIC might change how implementations</span> that <span class="insert">support</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   client sent.  If</span> this <span class="delete">check fails, the packet MUST be discarded.</span></td><td> </td><td class="rblock"><span class="insert">   multiple versions of QUIC react to Version Negotiation packets when</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attempting to establish a connection using</span> this <span class="insert">version.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0135"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Once the Version Negotiation packet is determined to be valid, the</span></td><td> </td><td class="rblock">   <span class="insert">A</span> client that <span class="insert">supports only this version</span> of <span class="insert">QUIC MUST abandon</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   client then selects an acceptable protocol version from the list</span></td><td> </td><td class="rblock">   <span class="insert">current connection attempt if it receives</span> a <span class="insert">Version Negotiation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   provided by the server.  The</span> client <span class="delete">then attempts to create a</span></td><td> </td><td class="rblock"><span class="insert">   packet, with the following two exceptions.  A</span> client MUST <span class="insert">discard any</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   connection using</span> that <span class="delete">version.  Though the content</span> of the <span class="delete">Initial</span></td><td> </td><td class="rblock"><span class="insert">   Version Negotiation</span> packet <span class="insert">if</span> it <span class="insert">has received</span> and <span class="insert">successfully</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet the client sends might not change in response to version</span></td><td> </td><td class="rblock"><span class="insert">   processed any other packet, including an earlier Version Negotiation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   negotiation,</span> a client MUST <span class="delete">increase the packet number it uses on</span></td><td> </td><td class="rblock"><span class="insert">   packet.  A client</span> MUST <span class="insert">discard a Version Negotiation packet that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   every</span> packet it <span class="delete">sends.  Packets MUST continue to use long headers</span></td><td> </td><td class="rblock"><span class="insert">   lists the QUIC version selected by</span> the <span class="insert">client.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   (Section 17.2)</span> and MUST <span class="delete">include</span> the <span class="delete">new negotiated protocol version.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0136"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The client MUST use the long header format and include its selected</span></td><td> </td><td class="rblock">   <span class="insert">How to perform</span> version <span class="insert">negotiation</span> is <span class="insert">left as future work defined by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   version <span class="delete">on all packets until it has 1-RTT keys and it has received a</span></td><td> </td><td class="rblock"><span class="insert">   future versions of QUIC.  In particular, that future work will ensure</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet from the server which</span> is <span class="delete">not a Version Negotiation packet.</span></td><td> </td><td class="rblock"><span class="insert">   robustness against version downgrade attacks; see Section 21.10.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0137"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A client MUST NOT change the version it uses unless it is in response</span></td><td> </td><td class="rblock"><span class="insert">6.2.1.</span>  Version Negotiation <span class="insert">Between Draft Versions</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   to a</span> Version Negotiation <span class="delete">packet from the server.  Once a client</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   receives a packet from the server which is not a Version Negotiation</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet, it MUST discard other Version Negotiation packets on the same</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   connection.  Similarly, a client MUST ignore a Version Negotiation</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet if it has already received and acted on a Version Negotiation</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0138"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A client MUST ignore a Version Negotiation packet that lists the</span></td><td> </td><td class="rblock">   <span class="insert">[[RFC editor: please remove this section before publication.]]</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   client's chosen version.  If the client does not support any of the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   versions the server offers, it aborts the connection attempt.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0139"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A client MAY attempt 0-RTT after receiving</span> a Version Negotiation</td><td> </td><td class="rblock">   <span class="insert">When a draft implementation receives</span> a Version Negotiation <span class="insert">packet, it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">packet.  A client that sends additional 0-RTT packets MUST NOT reset</span></td><td> </td><td class="rblock"><span class="insert">   MAY use it</span> to <span class="insert">attempt</span> a <span class="insert">new connection with one of the versions</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the packet number</span> to <span class="delete">0 as</span> a <span class="delete">result,</span> see Section <span class="delete">17.2.3.</span></td><td> </td><td class="rblock"><span class="insert">   listed in the packet, instead of abandoning the current connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attempt;</span> see Section <span class="insert">6.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0140"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Version negotiation packets have no cryptographic protection.</span>  The</td><td> </td><td class="rblock">   The <span class="insert">client MUST check that the Destination and Source Connection ID</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">result of</span> the <span class="delete">negotiation</span> MUST be <span class="delete">revalidated as part of the</span></td><td> </td><td class="rblock"><span class="insert">   fields match the Source and Destination Connection ID fields in a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   cryptographic handshake (see Section 7.3.3).</span></td><td> </td><td class="rblock"><span class="insert">   packet that</span> the <span class="insert">client sent.  If this check fails, the packet</span> MUST be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">discarded.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0141"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">6.3.  Using Reserved Versions</span></td><td> </td><td class="rblock">   <span class="insert">Once the Version Negotiation packet is determined to be valid, the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client then selects an acceptable protocol version from the list</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provided by the server.  The client then attempts to create a new</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection using that version.  The new connection MUST use a new</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   random Destination Connection ID different from the one it had</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   previously sent.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0142"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">For a server to use a new version in the future, clients must</span></td><td> </td><td class="rblock">   <span class="insert">Note that this mechanism does not protect against downgrade attacks</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   correctly handle unsupported versions.  To help ensure this, a server</span></td><td> </td><td class="rblock"><span class="insert">   and MUST NOT be used outside of draft implementations.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   SHOULD include a reserved version (see Section 15) while generating a</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Version Negotiation packet.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0143"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The design of version negotiation permits a server to avoid</span></td><td> </td><td class="rblock"><span class="insert">6.3.  Using Reserved Versions</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   maintaining state for packets that it rejects in this fashion.  The</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   validation of version negotiation (see Section 7.3.3) only validates</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the result of version negotiation, which is the same no matter which</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   reserved version was sent.  A server MAY therefore send different</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   reserved version numbers in the Version Negotiation Packet and in its</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   transport parameters.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0144"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A client MAY send</span> a <span class="delete">packet using</span> a reserved version <span class="delete">number.  This can</span></td><td> </td><td class="rblock">   <span class="insert">For</span> a <span class="insert">server to use</span> a <span class="insert">new version in the future, clients need to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   be used</span> to <span class="delete">solicit a list of supported</span> versions <span class="delete">from</span> a <span class="delete">server.</span></td><td> </td><td class="rblock"><span class="insert">   correctly handle unsupported versions.  Some version numbers</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (0x?a?a?a?a as defined in Section 15) are</span> reserved <span class="insert">for inclusion in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   fields that contain</span> version <span class="insert">numbers.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Endpoints MAY add reserved versions</span> to <span class="insert">any field where unknown or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   unsupported</span> versions <span class="insert">are ignored to test that a peer correctly</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ignores the value.  For instance, an endpoint could include a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   reserved version in a Version Negotiation packet; see Section 17.2.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Endpoints MAY send packets with a reserved version to test that</span> a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">peer correctly discards the packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">7.  Cryptographic and Transport Handshake</td><td> </td><td class="right">7.  Cryptographic and Transport Handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC relies on a combined cryptographic and transport handshake to</td><td> </td><td class="right">   QUIC relies on a combined cryptographic and transport handshake to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   minimize connection establishment latency.  QUIC uses the CRYPTO</td><td> </td><td class="right">   minimize connection establishment latency.  QUIC uses the CRYPTO</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame Section 19.6 to transmit the cryptographic handshake.  Version</td><td> </td><td class="right">   frame Section 19.6 to transmit the cryptographic handshake.  Version</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0x00000001 of QUIC uses TLS as described in [QUIC-TLS]; a different</td><td> </td><td class="right">   0x00000001 of QUIC uses TLS as described in [QUIC-TLS]; a different</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC version number could indicate that a different cryptographic</td><td> </td><td class="right">   QUIC version number could indicate that a different cryptographic</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   handshake protocol is in use.</td><td> </td><td class="right">   handshake protocol is in use.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC provides reliable, ordered delivery of the cryptographic</td><td> </td><td class="right">   QUIC provides reliable, ordered delivery of the cryptographic</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   handshake data.  QUIC packet protection is used to encrypt as much of</td><td> </td><td class="right">   handshake data.  QUIC packet protection is used to encrypt as much of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the handshake protocol as possible.  The cryptographic handshake MUST</td><td> </td><td class="right">   the handshake protocol as possible.  The cryptographic handshake MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provide the following properties:</td><td> </td><td class="right">   provide the following properties:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0145"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  authenticated key exchange, where</td><td> </td><td class="rblock">   <span class="insert">*</span>  authenticated key exchange, where</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0146"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  a server is always authenticated,</td><td> </td><td class="rblock">      <span class="insert">-</span>  a server is always authenticated,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0147"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  a client is optionally authenticated,</td><td> </td><td class="rblock">      <span class="insert">-</span>  a client is optionally authenticated,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0148"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  every connection produces distinct and unrelated keys,</td><td> </td><td class="rblock">      <span class="insert">-</span>  every connection produces distinct and unrelated keys,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0149"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  keying material is usable for packet protection for both 0-RTT</td><td> </td><td class="rblock">      <span class="insert">-</span>  keying material is usable for packet protection for both 0-RTT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         and 1-RTT packets, and</td><td> </td><td class="right">         and 1-RTT packets, and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0150"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  1-RTT keys have forward secrecy</td><td> </td><td class="rblock">      <span class="insert">-</span>  1-RTT keys have forward secrecy</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  authenticated values for the transport parameters of the peer (see</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Section 7.3)</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0151"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  authenticated <span class="delete">confirmation</span> of <span class="delete">version negotiation</span> (see</td><td> </td><td class="rblock">   <span class="insert">*</span>  authenticated <span class="insert">values for transport parameters</span> of <span class="insert">both endpoints,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      Section <span class="delete">7.3.3)</span></td><td> </td><td class="rblock"><span class="insert">      and confidentiality protection for server transport parameters</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      (see Section <span class="insert">7.4)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0152"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  authenticated negotiation of an application protocol (TLS uses</td><td> </td><td class="rblock">   <span class="insert">*</span>  authenticated negotiation of an application protocol (TLS uses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      ALPN [RFC7301] for this purpose)</td><td> </td><td class="right">      ALPN [RFC7301] for this purpose)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0153"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The first CRYPTO frame from a client MUST be sent in a single packet.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Any second attempt that is triggered by address validation (see</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Section 8.1) MUST also be sent within a single packet.  This avoids</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   having to reassemble a message from multiple packets.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   The first client packet of the cryptographic handshake protocol MUST</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   fit within a 1232 byte QUIC packet payload.  This includes overheads</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that reduce the space available to the cryptographic handshake</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   protocol.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint can verify support for Explicit Congestion Notification</td><td> </td><td class="right">   An endpoint can verify support for Explicit Congestion Notification</td><td class="lineno"></td></tr>
      <tr id="diff0154"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   (ECN) in the first packets it sends, as described in Section 13.<span class="delete">3</span>.2.</td><td> </td><td class="rblock">   (ECN) in the first packets it sends, as described in Section 13.<span class="insert">4</span>.2.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0155"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The CRYPTO frame can be sent in different packet number <span class="delete">spaces.</span>  The</td><td> </td><td class="rblock">   The CRYPTO frame can be sent in different packet number <span class="insert">spaces</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">sequence numbers</span> used by CRYPTO frames to ensure ordered delivery of</td><td> </td><td class="rblock"><span class="insert">   (Section 12.3).</span>  The <span class="insert">offsets</span> used by CRYPTO frames to ensure ordered</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   cryptographic handshake data start from zero in each packet number</td><td> </td><td class="rblock">   delivery of cryptographic handshake data start from zero in each</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   space.</td><td> </td><td class="rblock">   packet number space.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Endpoints MUST explicitly negotiate an application protocol.  This</td><td> </td><td class="right">   Endpoints MUST explicitly negotiate an application protocol.  This</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   avoids situations where there is a disagreement about the protocol</td><td> </td><td class="right">   avoids situations where there is a disagreement about the protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that is in use.</td><td> </td><td class="right">   that is in use.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">7.1.  Example Handshake Flows</td><td> </td><td class="right">7.1.  Example Handshake Flows</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Details of how TLS is integrated with QUIC are provided in</td><td> </td><td class="right">   Details of how TLS is integrated with QUIC are provided in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [QUIC-TLS], but some examples are provided here.  An extension of</td><td> </td><td class="right">   [QUIC-TLS], but some examples are provided here.  An extension of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   this exchange to support client address validation is shown in</td><td> </td><td class="right">   this exchange to support client address validation is shown in</td><td class="lineno"></td></tr>
      <tr id="diff0156"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section 8.1.<span class="delete">1</span>.</td><td> </td><td class="rblock">   Section 8.1.<span class="insert">2</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0157"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Once any <span class="delete">version negotiation and</span> address validation exchanges are</td><td> </td><td class="rblock">   Once any address validation exchanges are complete, the cryptographic</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   complete, the cryptographic handshake is used to agree on</td><td> </td><td class="rblock">   handshake is used to agree on cryptographic keys.  The cryptographic</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   cryptographic keys.  The cryptographic handshake is carried in</td><td> </td><td class="rblock">   handshake is carried in Initial (Section 17.2.2) and Handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Initial (Section 17.2.2) and Handshake (Section 17.2.4) packets.</td><td> </td><td class="rblock">   (Section 17.2.4) packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Figure 4 provides an overview of the 1-RTT handshake.  Each line</td><td> </td><td class="right">   Figure 4 provides an overview of the 1-RTT handshake.  Each line</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   shows a QUIC packet with the packet type and packet number shown</td><td> </td><td class="right">   shows a QUIC packet with the packet type and packet number shown</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   first, followed by the frames that are typically contained in those</td><td> </td><td class="right">   first, followed by the frames that are typically contained in those</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets.  So, for instance the first packet is of type Initial, with</td><td> </td><td class="right">   packets.  So, for instance the first packet is of type Initial, with</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet number 0, and contains a CRYPTO frame carrying the</td><td> </td><td class="right">   packet number 0, and contains a CRYPTO frame carrying the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ClientHello.</td><td> </td><td class="right">   ClientHello.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0158"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Note that multiple</span> QUIC packets - even of different <span class="delete">encryption levels</span></td><td> </td><td class="rblock">   <span class="insert">Multiple</span> QUIC packets - even of different <span class="insert">packet types</span> - <span class="insert">can</span> be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   - <span class="delete">may</span> be coalesced into a single UDP <span class="delete">datagram (see</span> Section <span class="delete">12.2), and</span></td><td> </td><td class="rblock">   coalesced into a single UDP <span class="insert">datagram; see</span> Section <span class="insert">12.2.  As a result,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   so</span> this handshake may consist of as few as 4 UDP datagrams, or any</td><td> </td><td class="rblock">   this handshake may consist of as few as 4 UDP datagrams, or any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   number <span class="delete">more.</span>  For instance, the server's first flight contains</td><td> </td><td class="rblock">   number <span class="insert">more (subject to limits inherent to the protocol, such as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">packets from the</span> Initial <span class="delete">encryption level (obfuscation), the</span></td><td> </td><td class="rblock"><span class="insert">   congestion control or anti-amplification).</span>  For instance, the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Handshake <span class="delete">level,</span> and "0.5-RTT data" <span class="delete">from the server at the</span> 1-RTT</td><td> </td><td class="rblock">   server's first flight contains Initial <span class="insert">packets,</span> Handshake <span class="insert">packets,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">encryption level.</span></td><td> </td><td class="rblock">   and "0.5-RTT data" <span class="insert">in</span> 1-RTT <span class="insert">packets with a short header.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Client                                                  Server</td><td> </td><td class="right">   Client                                                  Server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial[0]: CRYPTO[CH] -&gt;</td><td> </td><td class="right">   Initial[0]: CRYPTO[CH] -&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                    Initial[0]: CRYPTO[SH] ACK[0]</td><td> </td><td class="right">                                    Initial[0]: CRYPTO[SH] ACK[0]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                          Handshake[0]: CRYPTO[EE, CERT, CV, FIN]</td><td> </td><td class="right">                          Handshake[0]: CRYPTO[EE, CERT, CV, FIN]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                    &lt;- 1-RTT[0]: STREAM[1, "..."]</td><td> </td><td class="right">                                    &lt;- 1-RTT[0]: STREAM[1, "..."]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial[1]: ACK[0]</td><td> </td><td class="right">   Initial[1]: ACK[0]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Handshake[0]: CRYPTO[FIN], ACK[0]</td><td> </td><td class="right">   Handshake[0]: CRYPTO[FIN], ACK[0]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   1-RTT[0]: STREAM[0, "..."], ACK[0] -&gt;</td><td> </td><td class="right">   1-RTT[0]: STREAM[0, "..."], ACK[0] -&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0159"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                              <span class="delete">1-RTT[1]: STREAM[55, "..."],</span> ACK[0]</td><td> </td><td class="rblock">                                             <span class="insert">Handshake[1]:</span> ACK[0]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                          &lt;- <span class="delete">Handshake[1]:</span> ACK[0]</td><td> </td><td class="rblock">                            &lt;- <span class="insert">1-RTT[1]: STREAM[3, "..."],</span> ACK[0]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                     Figure 4: Example 1-RTT Handshake</td><td> </td><td class="right">                     Figure 4: Example 1-RTT Handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Figure 5 shows an example of a connection with a 0-RTT handshake and</td><td> </td><td class="right">   Figure 5 shows an example of a connection with a 0-RTT handshake and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a single packet of 0-RTT data.  Note that as described in</td><td> </td><td class="right">   a single packet of 0-RTT data.  Note that as described in</td><td class="lineno"></td></tr>
      <tr id="diff0160"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section 12.3, the server acknowledges 0-RTT data <span class="delete">at the</span> 1-RTT</td><td> </td><td class="rblock">   Section 12.3, the server acknowledges 0-RTT data <span class="insert">in</span> 1-RTT <span class="insert">packets,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">encryption level,</span> and the client sends 1-RTT packets in the same</td><td> </td><td class="rblock">   and the client sends 1-RTT packets in the same packet number space.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet number space.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Client                                                  Server</td><td> </td><td class="right">   Client                                                  Server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial[0]: CRYPTO[CH]</td><td> </td><td class="right">   Initial[0]: CRYPTO[CH]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0-RTT[0]: STREAM[0, "..."] -&gt;</td><td> </td><td class="right">   0-RTT[0]: STREAM[0, "..."] -&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                    Initial[0]: CRYPTO[SH] ACK[0]</td><td> </td><td class="right">                                    Initial[0]: CRYPTO[SH] ACK[0]</td><td class="lineno"></td></tr>
      <tr id="diff0161"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                           <span class="delete">Handshake[0] CRYPTO[EE, CERT, CV</span>, FIN]</td><td> </td><td class="rblock">                           <span class="insert">          Handshake[0] CRYPTO[EE</span>, FIN]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                             &lt;- 1-RTT[0]: STREAM[1, "..."] ACK[0]</td><td> </td><td class="right">                             &lt;- 1-RTT[0]: STREAM[1, "..."] ACK[0]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial[1]: ACK[0]</td><td> </td><td class="right">   Initial[1]: ACK[0]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Handshake[0]: CRYPTO[FIN], ACK[0]</td><td> </td><td class="right">   Handshake[0]: CRYPTO[FIN], ACK[0]</td><td class="lineno"></td></tr>
      <tr id="diff0162"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   1-RTT[<span class="delete">2</span>]: STREAM[0, "..."] ACK[0] -&gt;</td><td> </td><td class="rblock">   1-RTT[<span class="insert">1</span>]: STREAM[0, "..."] ACK[0] -&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0163"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                            <span class="delete">1-RTT[1]: STREAM[55, "..."], ACK[1,2]</span></td><td> </td><td class="rblock">                                             Handshake[1]: ACK[0]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                                          &lt;-</span> Handshake[1]: ACK[0]</td><td> </td><td class="rblock">                            <span class="insert">&lt;- 1-RTT[1]: STREAM[3, "..."], ACK[1]</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                     Figure 5: Example 0-RTT Handshake</td><td> </td><td class="right">                     Figure 5: Example 0-RTT Handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">7.2.  Negotiating Connection IDs</td><td> </td><td class="right">7.2.  Negotiating Connection IDs</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A connection ID is used to ensure consistent routing of packets, as</td><td> </td><td class="right">   A connection ID is used to ensure consistent routing of packets, as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   described in Section 5.1.  The long header contains two connection</td><td> </td><td class="right">   described in Section 5.1.  The long header contains two connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   IDs: the Destination Connection ID is chosen by the recipient of the</td><td> </td><td class="right">   IDs: the Destination Connection ID is chosen by the recipient of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet and is used to provide consistent routing; the Source</td><td> </td><td class="right">   packet and is used to provide consistent routing; the Source</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Connection ID is used to set the Destination Connection ID used by</td><td> </td><td class="right">   Connection ID is used to set the Destination Connection ID used by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the peer.</td><td> </td><td class="right">   the peer.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   During the handshake, packets with the long header (Section 17.2) are</td><td> </td><td class="right">   During the handshake, packets with the long header (Section 17.2) are</td><td class="lineno"></td></tr>
      <tr id="diff0164"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   used to establish the connection ID<span class="delete"> that each endpoint uses</span>.  Each</td><td> </td><td class="rblock">   used to establish the connection ID<span class="insert">s in each direction</span>.  Each</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint uses the Source Connection ID field to specify the</td><td> </td><td class="right">   endpoint uses the Source Connection ID field to specify the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection ID that is used in the Destination Connection ID field of</td><td> </td><td class="right">   connection ID that is used in the Destination Connection ID field of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets being sent to them.  Upon receiving a packet, each endpoint</td><td> </td><td class="right">   packets being sent to them.  Upon receiving a packet, each endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sets the Destination Connection ID it sends to match the value of the</td><td> </td><td class="right">   sets the Destination Connection ID it sends to match the value of the</td><td class="lineno"></td></tr>
      <tr id="diff0165"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Source Connection ID that <span class="delete">they receive.</span></td><td> </td><td class="rblock">   Source Connection ID that it <span class="insert">receives.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   When an Initial packet is sent by a client which has not previously</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   received a Retry packet from the server,</span> it <span class="delete">populates the Destination</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Connection ID field with an unpredictable value.  This MUST be at</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   least 8 bytes in length.  Until a packet is received from the server,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the client MUST use the same value unless it abandons the connection</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   attempt and starts a new one.  The initial Destination Connection ID</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   is used to determine packet protection keys for Initial packets.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0166"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The final version used for</span> a <span class="delete">connection might be different</span> from the</td><td> </td><td class="rblock">   <span class="insert">When an Initial packet is sent by</span> a <span class="insert">client that has not previously</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">version of</span> the <span class="delete">first Initial</span> from the <span class="delete">client.  To enable consistent</span></td><td> </td><td class="rblock"><span class="insert">   received an Initial or Retry packet</span> from the <span class="insert">server,</span> the <span class="insert">client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   routing through</span> the <span class="delete">handshake, a</span> client <span class="delete">SHOULD select an initial</span></td><td> </td><td class="rblock"><span class="insert">   populates the Destination Connection ID field with an unpredictable</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Destination Connection ID <span class="delete">length long enough</span> to <span class="delete">fulfill the minimum</span></td><td> </td><td class="rblock"><span class="insert">   value.  This Destination Connection ID MUST be at least 8 bytes in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   size</span> for <span class="delete">every QUIC version it supports.</span></td><td> </td><td class="rblock"><span class="insert">   length.  Until a packet is received</span> from the <span class="insert">server,</span> the client <span class="insert">MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   use the same Destination Connection ID value on all packets in this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection.  This</span> Destination Connection ID <span class="insert">is used</span> to <span class="insert">determine</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet protection keys</span> for <span class="insert">Initial packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The client populates the Source Connection ID field with a value of</td><td> </td><td class="right">   The client populates the Source Connection ID field with a value of</td><td class="lineno"></td></tr>
      <tr id="diff0167"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   its choosing and sets the <span class="delete">SCIL</span> field to <span class="delete">match.</span></td><td> </td><td class="rblock">   its choosing and sets the <span class="insert">Source Connection ID Length</span> field to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">indicate the length.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0168"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">Destination Connection ID field in the server's Initial packet</span></td><td> </td><td class="rblock">   The <span class="insert">first flight</span> of <span class="insert">0-RTT packets use</span> the <span class="insert">same Destination</span> Connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   contains a connection ID that is chosen by the recipient</span> of the</td><td> </td><td class="rblock">   ID <span class="insert">and</span> Source Connection <span class="insert">ID values as</span> the <span class="insert">client's first Initial</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">packet (i.e., the client); the Source</span> Connection ID <span class="delete">includes the</span></td><td> </td><td class="rblock"><span class="insert">   packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   connection ID that the sender of the packet wishes to use (see</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Section 5.1).  The server MUST use consistent</span> Source Connection <span class="delete">IDs</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   during</span> the <span class="delete">handshake.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0169"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">O</span>n first receiving an Initial or Retry packet from the server, the</td><td> </td><td class="rblock">   <span class="insert">Upo</span>n first receiving an Initial or Retry packet from the server, the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   client uses the Source Connection ID supplied by the server as the</td><td> </td><td class="right">   client uses the Source Connection ID supplied by the server as the</td><td class="lineno"></td></tr>
      <tr id="diff0170"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Destination Connection ID for subsequent packets.  <span class="delete">That</span> means that a</td><td> </td><td class="rblock">   Destination Connection ID for subsequent <span class="insert">packets, including any 0-RTT</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   client might change the Destination Connection ID twice during</td><td> </td><td class="rblock">   packets.  <span class="insert">This</span> means that a client might <span class="insert">have to</span> change the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection <span class="delete">establishment,</span> once in response to a <span class="delete">Retry</span> and once in</td><td> </td><td class="rblock">   <span class="insert">connection ID it sets in the</span> Destination Connection ID <span class="insert">field</span> twice</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   response to <span class="delete">the first</span> Initial packet from the server.  Once a client</td><td> </td><td class="rblock">   during connection <span class="insert">establishment:</span> once in response to a <span class="insert">Retry,</span> and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   has received <span class="delete">an</span> Initial packet from the server, it MUST discard any</td><td> </td><td class="rblock">   once in response to <span class="insert">an</span> Initial packet from the server.  Once a client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet it receives with a different Source Connection ID.</td><td> </td><td class="rblock">   has received <span class="insert">a valid</span> Initial packet from the server, it MUST discard</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   any <span class="insert">subsequent</span> packet it receives with a different Source Connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   ID.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0171"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A client MUST <span class="delete">only</span> change the <span class="delete">value it sends in the</span> Destination</td><td> </td><td class="rblock">   A client MUST change the Destination Connection ID <span class="insert">it uses for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Connection ID in response to the first <span class="delete">packet of each type it</span></td><td> </td><td class="rblock"><span class="insert">   sending packets</span> in response to <span class="insert">only</span> the first <span class="insert">received Initial</span> or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   receives from the server (Retry</span> or <span class="delete">Initial); a</span> server MUST set <span class="delete">its</span></td><td> </td><td class="rblock">   <span class="insert">Retry packet.  A</span> server MUST set <span class="insert">the Destination Connection ID it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   value</span> based on the Initial packet.  Any <span class="delete">additional</span> changes are <span class="delete">not</span></td><td> </td><td class="rblock"><span class="insert">   uses for sending packets</span> based on the <span class="insert">first received</span> Initial packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   permitted;</span> if subsequent packets <span class="delete">of those types</span> include a different</td><td> </td><td class="rblock">   Any <span class="insert">further</span> changes <span class="insert">to the Destination Connection ID</span> are <span class="insert">only</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Source Connection ID, they MUST be discarded.  This avoids <span class="delete">problems</span></td><td> </td><td class="rblock"><span class="insert">   permitted if the values are taken from any received NEW_CONNECTION_ID</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that might <span class="delete">arise</span> from stateless processing of multiple Initial</td><td> </td><td class="rblock"><span class="insert">   frames;</span> if subsequent <span class="insert">Initial</span> packets include a different Source</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets <span class="delete">producing</span> different <span class="delete">connection</span> IDs.</td><td> </td><td class="rblock">   Connection ID, they MUST be discarded.  This avoids <span class="insert">unpredictable</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   outcomes</span> that might <span class="insert">otherwise result</span> from stateless processing of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   multiple Initial packets <span class="insert">with</span> different <span class="insert">Source Connection</span> IDs.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0172"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">connection</span> ID can change over the lifetime of a connection,</td><td> </td><td class="rblock">   The <span class="insert">Destination Connection</span> ID <span class="insert">that an endpoint sends</span> can change over</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   especially in response to connection migration (Section <span class="delete">9),</span> see</td><td> </td><td class="rblock">   the lifetime of a connection, especially in response to connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section 5.1.1 for details.</td><td> </td><td class="rblock">   migration (Section <span class="insert">9);</span> see Section 5.1.1 for details.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0173"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">7.3.  Transport Parameters</td><td> </td><td class="rblock">7.3.  <span class="insert">Authenticating Connection IDs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The choice each endpoint makes about connection IDs during the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   handshake is authenticated by including all values in transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   parameters; see Section 7.4.  This ensures that all connection IDs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   used for the handshake are also authenticated by the cryptographic</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   handshake.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Each endpoint includes the value of the Source Connection ID field</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   from the first Initial packet it sent in the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   initial_source_connection_id transport parameter; see Section 18.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A server includes the Destination Connection ID field from the first</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Initial packet it received from the client in the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   original_destination_connection_id transport parameter; if the server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   sent a Retry packet this refers to the first Initial packet received</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   before sending the Retry packet.  If it sends a Retry packet, a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server also includes the Source Connection ID field from the Retry</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet in the retry_source_connection_id transport parameter.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The values provided by a peer for these transport parameters MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   match the values that an endpoint used in the Destination and Source</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Connection ID fields of Initial packets that it sent.  Including</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection ID values in transport parameters and verifying them</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ensures that that an attacker cannot influence the choice of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection ID for a successful connection by injecting packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   carrying attacker-chosen connection IDs during the handshake.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint MUST treat absence of the initial_source_connection_id</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transport parameter from either endpoint or absence of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   original_destination_connection_id transport parameter from the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server as a connection error of type TRANSPORT_PARAMETER_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint MUST treat the following as a connection error of type</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   TRANSPORT_PARAMETER_ERROR or PROTOCOL_VIOLATION:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  absence of the retry_source_connection_id transport parameter from</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      the server after receiving a Retry packet,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  presence of the retry_source_connection_id transport parameter</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      when no Retry packet was received, or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  a mismatch between values received from a peer in these transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      parameters and the value sent in the corresponding Destination or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Source Connection ID fields of Initial packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If a zero-length connection ID is selected, the corresponding</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transport parameter is included with a zero-length value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Figure 6 shows the connection IDs (with DCID=Destination Connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ID, SCID=Source Connection ID) that are used in a complete handshake.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The exchange of Initial packets is shown, plus the later exchange of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1-RTT packets that includes the connection ID established during the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   handshake.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Client                                                  Server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Initial: DCID=S1, SCID=C1 -&gt;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                     &lt;- Initial: DCID=C1, SCID=S3</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                ...</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1-RTT: DCID=S3 -&gt;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                &lt;- 1-RTT: DCID=C1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">               Figure 6: Use of Connection IDs in a Handshake</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Figure 7 shows a similar handshake that includes a Retry packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Client                                                  Server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Initial: DCID=S1, SCID=C1 -&gt;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       &lt;- Retry: DCID=C1, SCID=S2</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Initial: DCID=S2, SCID=C1 -&gt;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                     &lt;- Initial: DCID=C1, SCID=S3</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                ...</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1-RTT: DCID=S3 -&gt;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                &lt;- 1-RTT: DCID=C1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">         Figure 7: Use of Connection IDs in a Handshake with Retry</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In both cases (Figure 6 and Figure 7), the client sets the value of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the initial_source_connection_id transport parameter to "C1".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   When the handshake does not include a Retry (Figure 6), the server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   sets original_destination_connection_id to "S1" and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   initial_source_connection_id to "S3".  In this case, the server does</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   not include a retry_source_connection_id transport parameter.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   When the handshake includes a Retry (Figure 7), the server sets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   original_destination_connection_id to "S1",</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   retry_source_connection_id to "S2", and initial_source_connection_id</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to "S3".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Each endpoint validates transport parameters set by the peer.  The</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client confirms that the retry_source_connection_id transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   parameter is absent if it did not process a Retry packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">7.4.</span>  Transport Parameters</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   During connection establishment, both endpoints make authenticated</td><td> </td><td class="right">   During connection establishment, both endpoints make authenticated</td><td class="lineno"></td></tr>
      <tr id="diff0174"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   declarations of their transport parameters.  <span class="delete">These declarations are</span></td><td> </td><td class="rblock">   declarations of their transport parameters.  Endpoints are required</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   made unilaterally by each endpoint.</span>  Endpoints are required to comply</td><td> </td><td class="rblock">   to comply with the restrictions <span class="insert">that each parameter defines;</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   with the restrictions <span class="delete">implied by these parameters;</span> the description of</td><td> </td><td class="rblock">   description of each parameter includes rules for its handling.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   each parameter includes rules for its handling.</td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Transport parameters are declarations that are made unilaterally by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   each endpoint.  Each endpoint can choose values for transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   parameters independent of the values chosen by its peer.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The encoding of the transport parameters is detailed in Section 18.</td><td> </td><td class="right">   The encoding of the transport parameters is detailed in Section 18.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC includes the encoded transport parameters in the cryptographic</td><td> </td><td class="right">   QUIC includes the encoded transport parameters in the cryptographic</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   handshake.  Once the handshake completes, the transport parameters</td><td> </td><td class="right">   handshake.  Once the handshake completes, the transport parameters</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   declared by the peer are available.  Each endpoint validates the</td><td> </td><td class="right">   declared by the peer are available.  Each endpoint validates the</td><td class="lineno"></td></tr>
      <tr id="diff0175"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   value provided by its peer.  <span class="delete">In particular, version negotiation MUST</span></td><td> </td><td class="rblock">   value provided by its peer.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   be validated (see Section 7.3.3) before the connection establishment</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   is considered properly complete.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Definitions for each of the defined transport parameters are included</td><td> </td><td class="right">   Definitions for each of the defined transport parameters are included</td><td class="lineno"></td></tr>
      <tr id="diff0176"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   in Section <span class="delete">18.1.  An endpoint MUST treat receipt of a transport</span></td><td> </td><td class="rblock">   in Section <span class="insert">18.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   parameter with an invalid value as a connection error of type</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   TRANSPORT_PARAMETER_ERROR.  Any given parameter MUST appear at most</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   once in a given transport parameters extension.  An endpoint MUST</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   treat receipt of duplicate transport parameters as a connection error</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   of type TRANSPORT_PARAMETER_ERROR.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0177"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A server</span> MUST <span class="delete">include the original_connection_id</span> transport parameter</td><td> </td><td class="rblock">   <span class="insert">An endpoint</span> MUST <span class="insert">treat receipt of a</span> transport parameter <span class="insert">with an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">(Section 18.1) if it sent</span> a <span class="delete">Retry packet to enable validation</span> of <span class="delete">the</span></td><td> </td><td class="rblock"><span class="insert">   invalid value as</span> a <span class="insert">connection error</span> of <span class="insert">type</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Retry, as described in Section 17.2.5.</span></td><td> </td><td class="rblock"><span class="insert">   TRANSPORT_PARAMETER_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0178"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.3.1.  Values</span> of <span class="delete">Transport Parameters for 0-RTT</span></td><td> </td><td class="rblock">   <span class="insert">An endpoint MUST NOT send a parameter more than once in a given</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transport parameters extension.  An endpoint SHOULD treat receipt</span> of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">duplicate transport parameters as a connection error of type</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   TRANSPORT_PARAMETER_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0179"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A client that attempts to send 0-RTT data MUST remember the transport</span></td><td> </td><td class="rblock">   <span class="insert">Endpoints use</span> transport parameters to <span class="insert">authenticate</span> the <span class="insert">negotiation of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   parameters used by the server.  The</span> transport parameters <span class="delete">that the</span></td><td> </td><td class="rblock">   connection <span class="insert">IDs during</span> the <span class="insert">handshake; see Section 7.3.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   server advertises during connection establishment apply</span> to <span class="delete">all</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   connections that are resumed using</span> the <span class="delete">keying material established</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   during that handshake.  Remembered transport parameters apply to the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   new</span> connection <span class="delete">until the handshake completes and new transport</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   parameters from</span> the <span class="delete">server can be provided.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0180"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A server can remember the transport parameters that it advertised, or</span></td><td> </td><td class="rblock"><span class="insert">7.4.1.  Values</span> of <span class="insert">Transport Parameters for</span> 0-RTT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   store an integrity-protected copy</span> of <span class="delete">the values in the ticket and</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   recover the information when accepting</span> 0-RTT <span class="delete">data.  A server uses the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   transport parameters in determining whether to accept 0-RTT data.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0181"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A</span> server <span class="delete">MAY accept 0-RTT</span> and <span class="delete">subsequently provide different values</span></td><td> </td><td class="rblock">   <span class="insert">Both endpoints store the value of the</span> server <span class="insert">transport parameters</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   for transport parameters <span class="delete">for use in</span> the new <span class="delete">connection.  If 0-RTT</span></td><td> </td><td class="rblock"><span class="insert">   from a connection</span> and <span class="insert">apply them to any 0-RTT packets that are sent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   data is accepted by</span> the <span class="delete">server,</span> the <span class="delete">server MUST NOT reduce any limits</span></td><td> </td><td class="rblock"><span class="insert">   in subsequent connections to that peer, except</span> for transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   or alter any values that might be violated by</span> the client <span class="delete">with its</span></td><td> </td><td class="rblock">   parameters <span class="insert">that are explicitly excluded.  Remembered transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   0-RTT data.  In particular, a server that accepts 0-RTT data MUST NOT</span></td><td> </td><td class="rblock"><span class="insert">   parameters apply to</span> the new <span class="insert">connection until</span> the <span class="insert">handshake completes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   set values for</span> the <span class="delete">following</span> parameters <span class="delete">(Section 18.1) that are</span></td><td> </td><td class="rblock"><span class="insert">   and</span> the <span class="insert">client starts sending 1-RTT packets.  Once the handshake</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   smaller than</span> the <span class="delete">remembered value of those parameters.</span></td><td> </td><td class="rblock"><span class="insert">   completes,</span> the client <span class="insert">uses</span> the <span class="insert">transport</span> parameters <span class="insert">established in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   the <span class="insert">handshake.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0182"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  initial_max_data</span></td><td> </td><td class="rblock">   <span class="insert">The definition of new transport parameters (Section 7.4.2) MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   specify whether they MUST, MAY, or MUST NOT be stored for 0-RTT.  A</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client need not store a transport parameter it cannot process.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0183"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  initial_max_stream_data_bidi_local</span></td><td> </td><td class="rblock">   <span class="insert">A client MUST NOT use remembered values for the following parameters:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ack_delay_exponent, max_ack_delay, initial_source_connection_id,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   original_destination_connection_id, preferred_address,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   retry_source_connection_id, and stateless_reset_token.  The client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   MUST use the server's new values in the handshake instead, and absent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   new values from the server, the default value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0184"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  initial_max_stream_data_bidi_remote</span></td><td> </td><td class="rblock">   <span class="insert">A client that attempts to send 0-RTT data MUST remember all other</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transport parameters used by the server.  The server can remember</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   these transport parameters, or store an integrity-protected copy of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the values in the ticket and recover the information when accepting</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   0-RTT data.  A server uses the transport parameters in determining</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   whether to accept 0-RTT data.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0185"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  initial_max_stream_data_uni</span></td><td> </td><td class="rblock">   <span class="insert">If 0-RTT data is accepted by the server, the server MUST NOT reduce</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   any limits or alter any values that might be violated by the client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   with its 0-RTT data.  In particular, a server that accepts 0-RTT data</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   MUST NOT set values for the following parameters (Section 18.2) that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   are smaller than the remembered value of the parameters.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0186"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  initial_max_streams_bidi</span></td><td> </td><td class="rblock">   <span class="insert">*  active_connection_id_limit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0187"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  initial_max_streams_uni</td><td> </td><td class="rblock">   <span class="insert">*  initial_max_data</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  initial_max_stream_data_bidi_local</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  initial_max_stream_data_bidi_remote</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  initial_max_stream_data_uni</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  initial_max_streams_bidi</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  initial_max_streams_uni</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Omitting or setting a zero value for certain transport parameters can</td><td> </td><td class="right">   Omitting or setting a zero value for certain transport parameters can</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   result in 0-RTT data being enabled, but not usable.  The applicable</td><td> </td><td class="right">   result in 0-RTT data being enabled, but not usable.  The applicable</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   subset of transport parameters that permit sending of application</td><td> </td><td class="right">   subset of transport parameters that permit sending of application</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   data SHOULD be set to non-zero values for 0-RTT.  This includes</td><td> </td><td class="right">   data SHOULD be set to non-zero values for 0-RTT.  This includes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   initial_max_data and either initial_max_streams_bidi and</td><td> </td><td class="right">   initial_max_data and either initial_max_streams_bidi and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   initial_max_stream_data_bidi_remote, or initial_max_streams_uni and</td><td> </td><td class="right">   initial_max_stream_data_bidi_remote, or initial_max_streams_uni and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   initial_max_stream_data_uni.</td><td> </td><td class="right">   initial_max_stream_data_uni.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0188"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The value of the server's previous preferred_address MUST NOT be used</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   when establishing a new connection; rather, the client should wait to</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   observe the server's new preferred_address value in the handshake.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server MUST either reject 0-RTT data or abort a handshake if the</td><td> </td><td class="right">   A server MUST either reject 0-RTT data or abort a handshake if the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   implied values for transport parameters cannot be supported.</td><td> </td><td class="right">   implied values for transport parameters cannot be supported.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0189"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.3.2.</span>  New Transport Parameters</td><td> </td><td class="rblock">   <span class="insert">When sending frames in 0-RTT packets, a client MUST only use</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   remembered transport parameters; importantly, it MUST NOT use updated</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   values that it learns from the server's updated transport parameters</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   or from frames received in 1-RTT packets.  Updated values of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transport parameters from the handshake apply only to 1-RTT packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   For instance, flow control limits from remembered transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   parameters apply to all 0-RTT packets even if those values are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   increased by the handshake or by frames sent in 1-RTT packets.  A</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server MAY treat use of updated transport parameters in 0-RTT as a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection error of type PROTOCOL_VIOLATION.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">7.4.2.</span>  New Transport Parameters</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   New transport parameters can be used to negotiate new protocol</td><td> </td><td class="right">   New transport parameters can be used to negotiate new protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   behavior.  An endpoint MUST ignore transport parameters that it does</td><td> </td><td class="right">   behavior.  An endpoint MUST ignore transport parameters that it does</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   not support.  Absence of a transport parameter therefore disables any</td><td> </td><td class="right">   not support.  Absence of a transport parameter therefore disables any</td><td class="lineno"></td></tr>
      <tr id="diff0190"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   optional protocol feature that is negotiated using the parameter.</td><td> </td><td class="rblock">   optional protocol feature that is negotiated using the parameter.  <span class="insert">As</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   described in Section 18.1, some identifiers are reserved in order to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   exercise this requirement.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   New transport parameters can be registered according to the rules in</td><td> </td><td class="right">   New transport parameters can be registered according to the rules in</td><td class="lineno"></td></tr>
      <tr id="diff0191"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">22.1.</span></td><td> </td><td class="rblock">   Section <span class="insert">22.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.3.3.  Version Negotiation Validation</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Though the cryptographic handshake has integrity protection, two</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   forms of QUIC version downgrade are possible.  In the first, an</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   attacker replaces the QUIC version in the Initial packet.  In the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   second, a fake Version Negotiation packet is sent by an attacker.  To</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   protect against these attacks, the transport parameters include three</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   fields that encode version information.  These parameters are used to</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   retroactively authenticate the choice of version (see Section 6).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   The cryptographic handshake provides integrity protection for the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   negotiated version as part of the transport parameters (see</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Section 18.1).  As a result, attacks on version negotiation by an</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   attacker can be detected.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   The client includes the initial_version field in its transport</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   parameters.  The initial_version is the version that the client</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   initially attempted to use.  If the server did not send a Version</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Negotiation packet Section 17.2.1, this will be identical to the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   negotiated_version field in the server transport parameters.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   A server that processes all packets in a stateful fashion can</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   remember how version negotiation was performed and validate the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   initial_version value.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   A server that does not maintain state for every packet it receives</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   (i.e., a stateless server) uses a different process.  If the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   initial_version matches the version of QUIC that is in use, a</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   stateless server can accept the value.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   If the initial_version is different from the version of QUIC that is</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   in use, a stateless server MUST check that it would have sent a</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Version Negotiation packet if it had received a packet with the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   indicated initial_version.  If a server would have accepted the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   version included in the initial_version and the value differs from</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the QUIC version that is in use, the server MUST terminate the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   connection with a VERSION_NEGOTIATION_ERROR error.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0192"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The server includes both the version of QUIC that is in use and a</span></td><td> </td><td class="rblock"><span class="insert">7.5.  Cryptographic Message Buffering</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   list of the QUIC versions that the server supports (see</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Section 18.1).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0193"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The negotiated_version field is the version that is in use.  This</span></td><td> </td><td class="rblock">   <span class="insert">Implementations need</span> to <span class="insert">maintain</span> a <span class="insert">buffer of CRYPTO data received out</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   MUST be set by the server</span> to <span class="delete">the value that is on the Initial packet</span></td><td> </td><td class="rblock">   of <span class="insert">order.  Because there</span> is <span class="insert">no flow control of CRYPTO frames, an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that it accepts (not an Initial packet that triggers a Retry or</span></td><td> </td><td class="rblock"><span class="insert">   endpoint could potentially force its peer to buffer an unbounded</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Version Negotiation packet).  A client that receives</span> a</td><td> </td><td class="rblock"><span class="insert">   amount of data.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">negotiated_version that does not match the version</span> of <span class="delete">QUIC that</span> is <span class="delete">in</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   use MUST terminate the connection with a VERSION_NEGOTIATION_ERROR</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   error code.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0194"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The server includes a list</span> of <span class="delete">versions that it would send in any</span></td><td> </td><td class="rblock">   <span class="insert">Implementations MUST support buffering at least 4096 bytes</span> of <span class="insert">data</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   version negotiation packet (Section 17.2.1)</span> in the <span class="delete">supported_versions</span></td><td> </td><td class="rblock"><span class="insert">   received</span> in <span class="insert">out of order CRYPTO frames.  Endpoints MAY choose to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   field.  The server populates this field even if it did</span> not <span class="delete">send a</span></td><td> </td><td class="rblock"><span class="insert">   allow more data to be buffered during the handshake.  A larger limit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   version negotiation packet.</span></td><td> </td><td class="rblock"><span class="insert">   during</span> the <span class="insert">handshake could allow for larger keys or credentials to be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   exchanged.  An endpoint's buffer size does</span> not <span class="insert">need to remain</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   constant during the life of the connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0195"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The client validates that the negotiated_version</span> is <span class="delete">included in</span> the</td><td> </td><td class="rblock">   <span class="insert">Being unable to buffer CRYPTO frames during the handshake can lead to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">supported_versions list and - if version negotiation was performed -</span></td><td> </td><td class="rblock"><span class="insert">   a connection failure.  If an endpoint's buffer</span> is <span class="insert">exceeded during</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that</span> it <span class="delete">would have selected the negotiated version.  A client</span> MUST</td><td> </td><td class="rblock">   <span class="insert">handshake, it can expand its buffer temporarily to complete the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">terminate</span> the connection with a <span class="delete">VERSION_NEGOTIATION_ERROR error code</span></td><td> </td><td class="rblock"><span class="insert">   handshake.  If an endpoint does not expand its buffer,</span> it MUST <span class="insert">close</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   if the current QUIC version is not listed in the supported_versions</span></td><td> </td><td class="rblock">   the connection with a <span class="insert">CRYPTO_BUFFER_EXCEEDED</span> error <span class="insert">code.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   list.  A client MUST terminate with a VERSION_NEGOTIATION_ERROR</span> error</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">code if version negotiation occurred but it would have selected a</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   different version based on the value of the supported_versions list.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0196"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">When</span> an endpoint <span class="delete">accepts multiple QUIC versions,</span> it <span class="delete">can potentially</span></td><td> </td><td class="rblock">   <span class="insert">Once the handshake completes, if</span> an endpoint <span class="insert">is unable to buffer all</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   interpret transport parameters as they are defined by any of</span> the <span class="delete">QUIC</span></td><td> </td><td class="rblock"><span class="insert">   data in a CRYPTO frame,</span> it <span class="insert">MAY discard that CRYPTO frame and all</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   versions</span> it <span class="delete">supports.  The version field in</span> the <span class="delete">QUIC</span> packet <span class="delete">header is</span></td><td> </td><td class="rblock"><span class="insert">   CRYPTO frames received in</span> the <span class="insert">future, or</span> it <span class="insert">MAY close the connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   authenticated using transport parameters.  The position</span> and the</td><td> </td><td class="rblock"><span class="insert">   with a CRYPTO_BUFFER_EXCEEDED error code.  Packets containing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">format of the version fields in</span> transport <span class="delete">parameters MUST either be</span></td><td> </td><td class="rblock"><span class="insert">   discarded CRYPTO frames MUST be acknowledged because</span> the packet <span class="insert">has</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   identical across different QUIC versions, or be unambiguously</span></td><td> </td><td class="rblock"><span class="insert">   been received</span> and <span class="insert">processed by</span> the transport <span class="insert">even though the CRYPTO</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   different to ensure no confusion about their interpretation.  One way</span></td><td> </td><td class="rblock"><span class="insert">   frame was discarded.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that a new format could be introduced is to define a TLS extension</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   with a different codepoint.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">8.  Address Validation</td><td> </td><td class="right">8.  Address Validation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0197"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Address validation <span class="delete">is used by QUIC to avoid being</span> used for a traffic</td><td> </td><td class="rblock">   Address validation <span class="insert">ensures that an endpoint cannot be</span> used for a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   amplification attack.  In such an attack, a packet is sent to a</td><td> </td><td class="rblock">   traffic amplification attack.  In such an attack, a packet is sent to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   server with spoofed source address information that identifies a</td><td> </td><td class="rblock">   a server with spoofed source address information that identifies a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   victim.  If a server generates more or larger packets in response to</td><td> </td><td class="right">   victim.  If a server generates more or larger packets in response to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that packet, the attacker can use the server to send more data toward</td><td> </td><td class="right">   that packet, the attacker can use the server to send more data toward</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the victim than it would be able to send on its own.</td><td> </td><td class="right">   the victim than it would be able to send on its own.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The primary defense against amplification attack is verifying that an</td><td> </td><td class="right">   The primary defense against amplification attack is verifying that an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint is able to receive packets at the transport address that it</td><td> </td><td class="right">   endpoint is able to receive packets at the transport address that it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   claims.  Address validation is performed both during connection</td><td> </td><td class="right">   claims.  Address validation is performed both during connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   establishment (see Section 8.1) and during connection migration (see</td><td> </td><td class="right">   establishment (see Section 8.1) and during connection migration (see</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Section 8.2).</td><td> </td><td class="right">   Section 8.2).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-9" class="change"><td></td><th><small>skipping to change at</small><a href="#part-9"><em> page 38, line 17<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-9"><em> page 47, line 23<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   Connection establishment implicitly provides address validation for</td><td> </td><td class="right">   Connection establishment implicitly provides address validation for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   both endpoints.  In particular, receipt of a packet protected with</td><td> </td><td class="right">   both endpoints.  In particular, receipt of a packet protected with</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Handshake keys confirms that the client received the Initial packet</td><td> </td><td class="right">   Handshake keys confirms that the client received the Initial packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   from the server.  Once the server has successfully processed a</td><td> </td><td class="right">   from the server.  Once the server has successfully processed a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Handshake packet from the client, it can consider the client address</td><td> </td><td class="right">   Handshake packet from the client, it can consider the client address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to have been validated.</td><td> </td><td class="right">   to have been validated.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Prior to validating the client address, servers MUST NOT send more</td><td> </td><td class="right">   Prior to validating the client address, servers MUST NOT send more</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   than three times as many bytes as the number of bytes they have</td><td> </td><td class="right">   than three times as many bytes as the number of bytes they have</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   received.  This limits the magnitude of any amplification attack that</td><td> </td><td class="right">   received.  This limits the magnitude of any amplification attack that</td><td class="lineno"></td></tr>
      <tr id="diff0198"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   can be mounted using spoofed source addresses.  <span class="delete">In determining this</span></td><td> </td><td class="rblock">   can be mounted using spoofed source addresses.  <span class="insert">For the purposes of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   limit,</span> servers <span class="delete">only</span> count <span class="delete">the size</span> of successfully processed <span class="delete">packets.</span></td><td> </td><td class="rblock"><span class="insert">   avoiding amplification prior to address validation,</span> servers <span class="insert">MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   count <span class="insert">all</span> of <span class="insert">the payload bytes received in datagrams that are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   uniquely attributed to a single connection.  This includes datagrams</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that contain packets that are</span> successfully processed <span class="insert">and datagrams</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that contain packets that are all discarded.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0199"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Clients MUST <span class="delete">pad</span> UDP datagrams <span class="delete">that contain only</span> Initial packets <span class="delete">to</span></td><td> </td><td class="rblock">   Clients MUST <span class="insert">ensure that</span> UDP datagrams <span class="insert">containing</span> Initial packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   at least 1200 <span class="delete">bytes.  Once a</span> client <span class="delete">has received an acknowledgment</span></td><td> </td><td class="rblock">   <span class="insert">have UDP payloads of</span> at least 1200 <span class="insert">bytes, adding padding to packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   for a Handshake packet it MAY send smaller datagrams.  Sending</span> padded</td><td> </td><td class="rblock"><span class="insert">   in the datagram as necessary.  A</span> client <span class="insert">that sends</span> padded datagrams</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   datagrams <span class="delete">ensures that</span> the server <span class="delete">is not overly constrained by the</span></td><td> </td><td class="rblock">   <span class="insert">allows</span> the server <span class="insert">to send more data prior to completing address</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   amplification restriction.</span></td><td> </td><td class="rblock"><span class="insert">   validation.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0200"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Packet loss, in particular loss</span> of <span class="delete">a</span> Handshake packet from the</td><td> </td><td class="rblock">   <span class="insert">Loss</span> of <span class="insert">an Initial or</span> Handshake packet from the <span class="insert">server</span> can cause a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">server,</span> can cause a <span class="delete">situation in which</span> the <span class="delete">server cannot</span> send when</td><td> </td><td class="rblock">   <span class="insert">deadlock if</span> the <span class="insert">client does not</span> send <span class="insert">additional Initial or Handshake</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the client has <span class="delete">no</span> data to send <span class="delete">and</span> the <span class="delete">anti-amplification limit is</span></td><td> </td><td class="rblock"><span class="insert">   packets.  A deadlock could occur</span> when the <span class="insert">server reaches its anti-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   reached.  In order</span> to <span class="delete">avoid</span> this <span class="delete">causing a handshake</span> deadlock,</td><td> </td><td class="rblock"><span class="insert">   amplification limit and the</span> client has <span class="insert">received acknowledgements for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   clients <span class="delete">SHOULD</span> send a packet <span class="delete">upon</span> a <span class="delete">handshake timeout, as described</span></td><td> </td><td class="rblock"><span class="insert">   all the</span> data <span class="insert">it has sent.  In this case, when the client has no</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   in [QUIC-RECOVERY].  If</span> the client <span class="delete">has no data to retransmit and does</span></td><td> </td><td class="rblock"><span class="insert">   reason</span> to send <span class="insert">additional packets,</span> the <span class="insert">server will be unable</span> to <span class="insert">send</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   not have Handshake keys, it SHOULD</span> send an Initial packet in a UDP</td><td> </td><td class="rblock"><span class="insert">   more data because it has not validated the client's address.  To</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   datagram <span class="delete">of</span> at least 1200 <span class="delete">bytes.  If the client has</span> Handshake keys,</td><td> </td><td class="rblock"><span class="insert">   prevent</span> this deadlock, clients <span class="insert">MUST</span> send a packet <span class="insert">on</span> a <span class="insert">probe timeout</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">it SHOULD</span> send a Handshake packet.</td><td> </td><td class="rblock"><span class="insert">   (PTO, see Section 6.2 of [QUIC-RECOVERY]).  Specifically,</span> the client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">MUST</span> send an Initial packet in a UDP datagram <span class="insert">that contains</span> at least</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   1200 <span class="insert">bytes if it does not have</span> Handshake keys, <span class="insert">and otherwise</span> send a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Handshake packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server might wish to validate the client address before starting</td><td> </td><td class="right">   A server might wish to validate the client address before starting</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the cryptographic handshake.  QUIC uses a token in the Initial packet</td><td> </td><td class="right">   the cryptographic handshake.  QUIC uses a token in the Initial packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to provide address validation prior to completing the handshake.</td><td> </td><td class="right">   to provide address validation prior to completing the handshake.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This token is delivered to the client during connection establishment</td><td> </td><td class="right">   This token is delivered to the client during connection establishment</td><td class="lineno"></td></tr>
      <tr id="diff0201"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   with a Retry packet (see Section <span class="delete">8.1.1)</span> or in a previous connection</td><td> </td><td class="rblock">   with a Retry packet (see Section <span class="insert">8.1.2)</span> or in a previous connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   using the NEW_TOKEN frame (see Section <span class="delete">8.1.2).</span></td><td> </td><td class="rblock">   using the NEW_TOKEN frame (see Section <span class="insert">8.1.3).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   In addition to sending limits imposed prior to address validation,</td><td> </td><td class="right">   In addition to sending limits imposed prior to address validation,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   servers are also constrained in what they can send by the limits set</td><td> </td><td class="right">   servers are also constrained in what they can send by the limits set</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   by the congestion controller.  Clients are only constrained by the</td><td> </td><td class="right">   by the congestion controller.  Clients are only constrained by the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   congestion controller.</td><td> </td><td class="right">   congestion controller.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0202"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">8.1.1.  Address Validation using Retry Packets</td><td> </td><td class="rblock">8.1.1.  <span class="insert">Token Construction</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A token sent in a NEW_TOKEN frames or a Retry packet MUST be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   constructed in a way that allows the server to identify how it was</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provided to a client.  These tokens are carried in the same field,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   but require different handling from servers.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">8.1.2.</span>  Address Validation using Retry Packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Upon receiving the client's Initial packet, the server can request</td><td> </td><td class="right">   Upon receiving the client's Initial packet, the server can request</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   address validation by sending a Retry packet (Section 17.2.5)</td><td> </td><td class="right">   address validation by sending a Retry packet (Section 17.2.5)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   containing a token.  This token MUST be repeated by the client in all</td><td> </td><td class="right">   containing a token.  This token MUST be repeated by the client in all</td><td class="lineno"></td></tr>
      <tr id="diff0203"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Initial packets it sends after it receives the Retry packet.  In</td><td> </td><td class="rblock">   Initial packets it sends <span class="insert">for that connection</span> after it receives the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   response to processing an Initial containing a token, a server can</td><td> </td><td class="rblock">   Retry packet.  In response to processing an Initial containing a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   either abort the connection or permit it to proceed.</td><td> </td><td class="rblock">   token, a server can either abort the connection or permit it to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   proceed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   As long as it is not possible for an attacker to generate a valid</td><td> </td><td class="right">   As long as it is not possible for an attacker to generate a valid</td><td class="lineno"></td></tr>
      <tr id="diff0204"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   token for its own address (see Section 8.1.<span class="delete">3</span>) and the client is able</td><td> </td><td class="rblock">   token for its own address (see Section 8.1.<span class="insert">4</span>) and the client is able</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to return that token, it proves to the server that it received the</td><td> </td><td class="right">   to return that token, it proves to the server that it received the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   token.</td><td> </td><td class="right">   token.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server can also use a Retry packet to defer the state and</td><td> </td><td class="right">   A server can also use a Retry packet to defer the state and</td><td class="lineno"></td></tr>
      <tr id="diff0205"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   processing costs of connection establishment.  <span class="delete">By giving</span> the <span class="delete">client</span> a</td><td> </td><td class="rblock">   processing costs of connection establishment.  <span class="insert">Requiring</span> the <span class="insert">server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   different connection <span class="delete">ID</span> to <span class="delete">use,</span> a server can <span class="delete">cause the connection to</span></td><td> </td><td class="rblock"><span class="insert">   to provide</span> a different connection <span class="insert">ID, along with the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   be <span class="delete">routed</span> to a server <span class="delete">instance with more resources available for new</span></td><td> </td><td class="rblock"><span class="insert">   original_destination_connection_id transport parameter defined in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   connections.</span></td><td> </td><td class="rblock"><span class="insert">   Section 18.2, forces the server</span> to <span class="insert">demonstrate that it, or an entity</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   it cooperates with, received the original Initial packet from the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client.  Providing a different connection ID also grants</span> a server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">some control over how subsequent packets are routed.  This</span> can be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">used to direct connections</span> to a <span class="insert">different</span> server <span class="insert">instance.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0206"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A flow showing the use of a Retry packet is shown in Figure <span class="delete">6.</span></td><td> </td><td class="rblock">   <span class="insert">If a server receives a client Initial that can be unprotected but</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   contains an invalid Retry token, it knows the client will not accept</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   another Retry token.  The server can discard such a packet and allow</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the client to time out to detect handshake failure, but that could</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   impose a significant latency penalty on the client.  Instead, the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server SHOULD immediately close (Section 10.3) the connection with an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   INVALID_TOKEN error.  Note that a server has not established any</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   state for the connection at this point and so does not enter the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   closing period.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   A flow showing the use of a Retry packet is shown in Figure <span class="insert">8.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Client                                                  Server</td><td> </td><td class="right">   Client                                                  Server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial[0]: CRYPTO[CH] -&gt;</td><td> </td><td class="right">   Initial[0]: CRYPTO[CH] -&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                   &lt;- Retry+Token</td><td> </td><td class="right">                                                   &lt;- Retry+Token</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0207"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Initial+Token[<span class="delete">0</span>]: CRYPTO[CH] -&gt;</td><td> </td><td class="rblock">   Initial+Token[<span class="insert">1</span>]: CRYPTO[CH] -&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0208"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                    Initial[0]: CRYPTO[SH] ACK[<span class="delete">0</span>]</td><td> </td><td class="rblock">                                    Initial[0]: CRYPTO[SH] ACK[<span class="insert">1</span>]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                          Handshake[0]: CRYPTO[EE, CERT, CV, FIN]</td><td> </td><td class="right">                          Handshake[0]: CRYPTO[EE, CERT, CV, FIN]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                    &lt;- 1-RTT[0]: STREAM[1, "..."]</td><td> </td><td class="right">                                    &lt;- 1-RTT[0]: STREAM[1, "..."]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0209"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                  <span class="delete">Figure 6</span>: Example Handshake with Retry</td><td> </td><td class="rblock">                  <span class="insert"> Figure 8</span>: Example Handshake with Retry</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0210"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">8.1.<span class="delete">2</span>.  Address Validation for Future Connections</td><td> </td><td class="rblock">8.1.<span class="insert">3</span>.  Address Validation for Future Connections</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server MAY provide clients with an address validation token during</td><td> </td><td class="right">   A server MAY provide clients with an address validation token during</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   one connection that can be used on a subsequent connection.  Address</td><td> </td><td class="right">   one connection that can be used on a subsequent connection.  Address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   validation is especially important with 0-RTT because a server</td><td> </td><td class="right">   validation is especially important with 0-RTT because a server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   potentially sends a significant amount of data to a client in</td><td> </td><td class="right">   potentially sends a significant amount of data to a client in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   response to 0-RTT data.</td><td> </td><td class="right">   response to 0-RTT data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The server uses the NEW_TOKEN frame Section 19.7 to provide the</td><td> </td><td class="right">   The server uses the NEW_TOKEN frame Section 19.7 to provide the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   client with an address validation token that can be used to validate</td><td> </td><td class="right">   client with an address validation token that can be used to validate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   future connections.  The client includes this token in Initial</td><td> </td><td class="right">   future connections.  The client includes this token in Initial</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets to provide address validation in a future connection.  The</td><td> </td><td class="right">   packets to provide address validation in a future connection.  The</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   client MUST include the token in all Initial packets it sends, unless</td><td> </td><td class="right">   client MUST include the token in all Initial packets it sends, unless</td><td class="lineno"></td></tr>
      <tr id="diff0211"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a Retry replaces the token with a newer <span class="delete">token.</span>  The client MUST NOT</td><td> </td><td class="rblock">   a Retry replaces the token with a newer <span class="insert">one.</span>  The client MUST NOT use</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   use the token provided in a Retry for future connections.  Servers</td><td> </td><td class="rblock">   the token provided in a Retry for future connections.  Servers MAY</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   MAY discard any Initial packet that does not carry the expected</td><td> </td><td class="rblock">   discard any Initial packet that does not carry the expected token.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   token.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0212"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Unlike the token that is created for a Retry packet, <span class="delete">there</span> might be</td><td> </td><td class="rblock">   Unlike the token that is created for a Retry packet, <span class="insert">which is used</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   some time <span class="delete">between when the token is created and when the token is</span></td><td> </td><td class="rblock"><span class="insert">   immediately, the token sent in the NEW_TOKEN frame</span> might be <span class="insert">used</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   subsequently used.</span>  Thus, a token SHOULD <span class="delete">include</span> an expiration <span class="delete">time.</span></td><td> </td><td class="rblock"><span class="insert">   after</span> some <span class="insert">period of</span> time <span class="insert">has passed.</span>  Thus, a token SHOULD <span class="insert">have</span> an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   The server MAY include</span> either an explicit expiration time or an</td><td> </td><td class="rblock">   expiration <span class="insert">time, which could be</span> either an explicit expiration time or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   issued timestamp <span class="delete">and</span> dynamically calculate the expiration time.  It</td><td> </td><td class="rblock">   an issued timestamp <span class="insert">that can be used to</span> dynamically calculate the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   is <span class="delete">also</span> unlikely that the client port number is the same on two</td><td> </td><td class="rblock">   expiration time.  <span class="insert">A server can store the expiration time or include</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   it in an encrypted form in the token.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A token issued with NEW_TOKEN MUST NOT include information that would</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   allow values to be linked by an observer to the connection on which</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   it was issued, unless the values are encrypted.  For example, it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   cannot include the previous connection ID or addressing information.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A server MUST ensure that every NEW_TOKEN frame it sends is unique</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   across all clients, with the exception of those sent to repair losses</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of previously sent NEW_TOKEN frames.  Information that allows the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server to distinguish between tokens from Retry and NEW_TOKEN MAY be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   accessible to entities other than the server.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   It is unlikely that the client port number is the same on two</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   different connections; validating the port is therefore unlikely to</td><td> </td><td class="right">   different connections; validating the port is therefore unlikely to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   be successful.</td><td> </td><td class="right">   be successful.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0213"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A token <span class="delete">SHOULD be constructed to be easily distinguishable from</span></td><td> </td><td class="rblock">   A token received in a NEW_TOKEN frame <span class="insert">is applicable</span> to <span class="insert">any server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   tokens that are sent in Retry packets as they are carried in the same</span></td><td> </td><td class="rblock"><span class="insert">   that the connection is considered authoritative for (e.g., server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   field.</span></td><td> </td><td class="rblock"><span class="insert">   names included in the certificate).  When connecting</span> to <span class="insert">a server for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">   which</span> the <span class="insert">client retains an applicable and unused token,</span> it <span class="insert">SHOULD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   If the client has a token</span> received in a NEW_TOKEN frame <span class="delete">on a previous</span></td><td> </td><td class="rblock">   include that <span class="insert">token</span> in the Token field of its Initial packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   connection</span> to <span class="delete">what it believes</span> to <span class="delete">be</span> the <span class="delete">same server,</span> it <span class="delete">can</span> include</td><td> </td><td class="rblock">   <span class="insert">Including a token might allow the server to validate the client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that <span class="delete">value</span> in the Token field of its Initial packet.</td><td> </td><td class="rblock"><span class="insert">   address without an additional round trip.  A client MUST NOT include</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   a token that is not applicable to the server that it is connecting</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to, unless the client has the knowledge that the server that issued</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the token and the server the client is connecting to are jointly</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   managing the tokens.  A client MAY use a token from any previous</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection to that server.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A token allows a server to correlate activity between the connection</td><td> </td><td class="right">   A token allows a server to correlate activity between the connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   where the token was issued and any connection where it is used.</td><td> </td><td class="right">   where the token was issued and any connection where it is used.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Clients that want to break continuity of identity with a server MAY</td><td> </td><td class="right">   Clients that want to break continuity of identity with a server MAY</td><td class="lineno"></td></tr>
      <tr id="diff0214"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   discard tokens provided using the NEW_TOKEN frame.  <span class="delete">A</span> token obtained</td><td> </td><td class="rblock">   discard tokens provided using the NEW_TOKEN frame.  <span class="insert">In comparison, a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   in a Retry packet MUST be used immediately during the connection</td><td> </td><td class="rblock">   token obtained in a Retry packet MUST be used immediately during the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   attempt and cannot be used in subsequent connection attempts.</td><td> </td><td class="rblock">   connection attempt and cannot be used in subsequent connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   attempts.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0215"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A client SHOULD NOT reuse a token <span class="delete">in</span> different <span class="delete">connections.</span>  Reusing</td><td> </td><td class="rblock">   A client SHOULD NOT reuse a <span class="insert">NEW_TOKEN</span> token <span class="insert">for</span> different <span class="insert">connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a token allows connections to be linked by entities on the network</td><td> </td><td class="rblock"><span class="insert">   attempts.</span>  Reusing a token allows connections to be linked by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">path (see</span> Section <span class="delete">9.5).  A client MUST NOT reuse</span> a token <span class="delete">if it</span></td><td> </td><td class="rblock">   entities on the network <span class="insert">path; see</span> Section <span class="insert">9.5.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   believes that its point of network attachment has changed since the</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   token was last used; that is, if there is a change</span> in <span class="delete">its local IP</span></td><td> </td><td class="rblock"><span class="insert">   Clients might receive multiple tokens on</span> a <span class="insert">single connection.  Aside</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   address or <span class="delete">network interface.  A client needs</span> to <span class="delete">start</span> the <span class="delete">connection</span></td><td> </td><td class="rblock"><span class="insert">   from preventing linkability, any</span> token <span class="insert">can be used</span> in <span class="insert">any connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   process over if it migrates prior</span> to <span class="delete">completing</span> the <span class="delete">handshake.</span></td><td> </td><td class="rblock"><span class="insert">   attempt.  Servers can send additional tokens to either enable</span> address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">validation for multiple connection attempts</span> or to <span class="insert">replace older</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   tokens that might become invalid.  For a client, this ambiguity means</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that sending</span> the <span class="insert">most recent unused token is most likely to be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   effective.  Though saving and using older tokens has no negative</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   consequences, clients can regard older tokens as being less likely be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   useful</span> to the <span class="insert">server for address validation.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   When a server receives an Initial packet with an address validation</td><td> </td><td class="right">   When a server receives an Initial packet with an address validation</td><td class="lineno"></td></tr>
      <tr id="diff0216"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   token, it <span class="delete">SHOULD attempt to validate it</span>, unless it has already</td><td> </td><td class="rblock">   token, it <span class="insert">MUST attempt to validate the token</span>, unless it has already</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   completed address validation.  If the token is invalid then the</td><td> </td><td class="right">   completed address validation.  If the token is invalid then the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   server SHOULD proceed as if the client did not have a validated</td><td> </td><td class="right">   server SHOULD proceed as if the client did not have a validated</td><td class="lineno"></td></tr>
      <tr id="diff0217"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   address, including potentially sending a Retry.  If the validation</td><td> </td><td class="rblock">   address, including potentially sending a Retry.  <span class="insert">A server SHOULD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   succeeds, the server SHOULD then allow the handshake to proceed.</td><td> </td><td class="rblock"><span class="insert">   encode tokens provided with NEW_TOKEN frames and Retry packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   differently, and validate the latter more strictly.</span>  If the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   validation succeeds, the server SHOULD then allow the handshake to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   proceed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Note:  The rationale for treating the client as unvalidated rather</td><td> </td><td class="right">   Note:  The rationale for treating the client as unvalidated rather</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      than discarding the packet is that the client might have received</td><td> </td><td class="right">      than discarding the packet is that the client might have received</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the token in a previous connection using the NEW_TOKEN frame, and</td><td> </td><td class="right">      the token in a previous connection using the NEW_TOKEN frame, and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      if the server has lost state, it might be unable to validate the</td><td> </td><td class="right">      if the server has lost state, it might be unable to validate the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      token at all, leading to connection failure if the packet is</td><td> </td><td class="right">      token at all, leading to connection failure if the packet is</td><td class="lineno"></td></tr>
      <tr id="diff0218"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      discarded.  <span class="delete">A server MAY encode tokens provided with NEW_TOKEN</span></td><td> </td><td class="rblock">      discarded.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      frames and Retry packets differently, and validate the latter more</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      strictly.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   In a stateless design, a server can use encrypted and authenticated</td><td> </td><td class="right">   In a stateless design, a server can use encrypted and authenticated</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   tokens to pass information to clients that the server can later</td><td> </td><td class="right">   tokens to pass information to clients that the server can later</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   recover and use to validate a client address.  Tokens are not</td><td> </td><td class="right">   recover and use to validate a client address.  Tokens are not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   integrated into the cryptographic handshake and so they are not</td><td> </td><td class="right">   integrated into the cryptographic handshake and so they are not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authenticated.  For instance, a client might be able to reuse a</td><td> </td><td class="right">   authenticated.  For instance, a client might be able to reuse a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   token.  To avoid attacks that exploit this property, a server can</td><td> </td><td class="right">   token.  To avoid attacks that exploit this property, a server can</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   limit its use of tokens to only the information needed to validate</td><td> </td><td class="right">   limit its use of tokens to only the information needed to validate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   client addresses.</td><td> </td><td class="right">   client addresses.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0219"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Clients MAY use tokens obtained on one connection for any connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attempt using the same version.  When selecting a token to use,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   clients do not need to consider other properties of the connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that is being attempted, including the choice of possible application</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   protocols, session tickets, or other connection properties.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Attackers could replay tokens to use servers as amplifiers in DDoS</td><td> </td><td class="right">   Attackers could replay tokens to use servers as amplifiers in DDoS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   attacks.  To protect against such attacks, servers SHOULD ensure that</td><td> </td><td class="right">   attacks.  To protect against such attacks, servers SHOULD ensure that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   tokens sent in Retry packets are only accepted for a short time.</td><td> </td><td class="right">   tokens sent in Retry packets are only accepted for a short time.</td><td class="lineno"></td></tr>
      <tr id="diff0220"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Tokens that are provided in NEW_TOKEN frames <span class="delete">(see Section</span> 19.7) need</td><td> </td><td class="rblock">   Tokens that are provided in NEW_TOKEN frames <span class="insert">(Section</span> 19.7) need to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to be valid for longer, but SHOULD NOT be accepted multiple times in</td><td> </td><td class="rblock">   be valid for longer, but SHOULD NOT be accepted multiple times in a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a short period.  Servers are encouraged to allow tokens to be used</td><td> </td><td class="rblock">   short period.  Servers are encouraged to allow tokens to be used only</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   only once, if possible.</td><td> </td><td class="rblock">   once, if possible.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0221"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">8.1.<span class="delete">3</span>.  Address Validation Token Integrity</td><td> </td><td class="rblock">8.1.<span class="insert">4</span>.  Address Validation Token Integrity</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An address validation token MUST be difficult to guess.  Including a</td><td> </td><td class="right">   An address validation token MUST be difficult to guess.  Including a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   large enough random value in the token would be sufficient, but this</td><td> </td><td class="right">   large enough random value in the token would be sufficient, but this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   depends on the server remembering the value it sends to clients.</td><td> </td><td class="right">   depends on the server remembering the value it sends to clients.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A token-based scheme allows the server to offload any state</td><td> </td><td class="right">   A token-based scheme allows the server to offload any state</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   associated with validation to the client.  For this design to work,</td><td> </td><td class="right">   associated with validation to the client.  For this design to work,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the token MUST be covered by integrity protection against</td><td> </td><td class="right">   the token MUST be covered by integrity protection against</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   modification or falsification by clients.  Without integrity</td><td> </td><td class="right">   modification or falsification by clients.  Without integrity</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protection, malicious clients could generate or guess values for</td><td> </td><td class="right">   protection, malicious clients could generate or guess values for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   tokens that would be accepted by the server.  Only the server</td><td> </td><td class="right">   tokens that would be accepted by the server.  Only the server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   requires access to the integrity protection key for tokens.</td><td> </td><td class="right">   requires access to the integrity protection key for tokens.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   There is no need for a single well-defined format for the token</td><td> </td><td class="right">   There is no need for a single well-defined format for the token</td><td class="lineno"></td></tr>
      <tr id="diff0222"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   because the server that generates the token also consumes it.  <span class="delete">A</span></td><td> </td><td class="rblock">   because the server that generates the token also consumes it.  <span class="insert">Tokens</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   token could</span> include information <span class="delete">about</span> the <span class="delete">claimed client</span> address <span class="delete">(IP</span></td><td> </td><td class="rblock"><span class="insert">   sent in Retry packets SHOULD</span> include information <span class="insert">that allows</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   and port), a timestamp,</span> and <span class="delete">any other supplementary</span> information the</td><td> </td><td class="rblock">   <span class="insert">server to verify that the source IP</span> address and <span class="insert">port in client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   server <span class="delete">will need</span> to <span class="delete">validate</span> the token in the <span class="delete">future.</span></td><td> </td><td class="rblock"><span class="insert">   packets remain constant.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Tokens sent in NEW_TOKEN frames MUST include</span> information <span class="insert">that allows</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   the server to <span class="insert">verify that the client IP address has not changed from</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   when</span> the token <span class="insert">was issued.  Servers can use tokens from NEW_TOKEN</span> in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">deciding not to send a Retry packet, even if the client address has</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   changed.  If</span> the <span class="insert">client IP address has changed, the server MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   adhere to the anti-amplification limits found in Section 8.1.  Note</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that in the presence of NAT, this requirement might be insufficient</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to protect other hosts that share the NAT from amplification attack.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Servers MUST ensure that replay of tokens is prevented or limited.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   For instance, servers might limit the time over which a token is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   accepted.  Tokens provided in NEW_TOKEN frames might need to allow</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   longer validity periods.  Tokens MAY include additional information</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   about clients to further narrow applicability or reuse.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">8.2.  Path Validation</td><td> </td><td class="right">8.2.  Path Validation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Path validation is used during connection migration (see Section 9</td><td> </td><td class="right">   Path validation is used during connection migration (see Section 9</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and Section 9.6) by the migrating endpoint to verify reachability of</td><td> </td><td class="right">   and Section 9.6) by the migrating endpoint to verify reachability of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a peer from a new local address.  In path validation, endpoints test</td><td> </td><td class="right">   a peer from a new local address.  In path validation, endpoints test</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   reachability between a specific local address and a specific peer</td><td> </td><td class="right">   reachability between a specific local address and a specific peer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   address, where an address is the two-tuple of IP address and port.</td><td> </td><td class="right">   address, where an address is the two-tuple of IP address and port.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Path validation tests that packets (PATH_CHALLENGE) can be both sent</td><td> </td><td class="right">   Path validation tests that packets (PATH_CHALLENGE) can be both sent</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-10" class="change"><td></td><th><small>skipping to change at</small><a href="#part-10"><em> page 42, line 37<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-10"><em> page 53, line 30<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint can send NEW_CONNECTION_ID and PATH_CHALLENGE frames in the</td><td> </td><td class="right">   endpoint can send NEW_CONNECTION_ID and PATH_CHALLENGE frames in the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   same packet.  This ensures that an unused connection ID will be</td><td> </td><td class="right">   same packet.  This ensures that an unused connection ID will be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   available to the peer when sending a response.</td><td> </td><td class="right">   available to the peer when sending a response.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">8.3.  Initiating Path Validation</td><td> </td><td class="right">8.3.  Initiating Path Validation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   To initiate path validation, an endpoint sends a PATH_CHALLENGE frame</td><td> </td><td class="right">   To initiate path validation, an endpoint sends a PATH_CHALLENGE frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   containing a random payload on the path to be validated.</td><td> </td><td class="right">   containing a random payload on the path to be validated.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MAY send multiple PATH_CHALLENGE frames to guard against</td><td> </td><td class="right">   An endpoint MAY send multiple PATH_CHALLENGE frames to guard against</td><td class="lineno"></td></tr>
      <tr id="diff0223"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet loss.  An endpoint SHOULD NOT send a PATH_CHALLENGE more</td><td> </td><td class="rblock">   packet loss.  <span class="insert">However, an endpoint SHOULD NOT send multiple</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   frequently than it would an Initial packet, ensuring that connection</td><td> </td><td class="rblock"><span class="insert">   PATH_CHALLENGE frames in a single packet.</span>  An endpoint SHOULD NOT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   migration is no more load on a new path than establishing a new</td><td> </td><td class="rblock">   send a PATH_CHALLENGE more frequently than it would an Initial</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection.</td><td> </td><td class="rblock">   packet, ensuring that connection migration is no more load on a new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   path than establishing a new connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The endpoint MUST use unpredictable data in every PATH_CHALLENGE</td><td> </td><td class="right">   The endpoint MUST use unpredictable data in every PATH_CHALLENGE</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame so that it can associate the peer's response with the</td><td> </td><td class="right">   frame so that it can associate the peer's response with the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   corresponding PATH_CHALLENGE.</td><td> </td><td class="right">   corresponding PATH_CHALLENGE.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">8.4.  Path Validation Responses</td><td> </td><td class="right">8.4.  Path Validation Responses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   On receiving a PATH_CHALLENGE frame, an endpoint MUST respond</td><td> </td><td class="right">   On receiving a PATH_CHALLENGE frame, an endpoint MUST respond</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   immediately by echoing the data contained in the PATH_CHALLENGE frame</td><td> </td><td class="right">   immediately by echoing the data contained in the PATH_CHALLENGE frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   in a PATH_RESPONSE frame.</td><td> </td><td class="right">   in a PATH_RESPONSE frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0224"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">To ensure that packets can be both sent to and received from the</span></td><td> </td><td class="rblock">   <span class="insert">An endpoint</span> MUST <span class="insert">NOT send more than one PATH_RESPONSE frame in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   peer, the PATH_RESPONSE</span> MUST <span class="delete">be sent on the same path as the</span></td><td> </td><td class="rblock"><span class="insert">   response to one</span> PATH_CHALLENGE <span class="insert">frame; see Section 13.3.  The peer is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   triggering PATH_CHALLENGE.  That is, from the same local address on</span></td><td> </td><td class="rblock"><span class="insert">   expected</span> to <span class="insert">send more</span> PATH_CHALLENGE <span class="insert">frames as necessary to evoke</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   which the</span> PATH_CHALLENGE <span class="delete">was received,</span> to <span class="delete">the same remote address</span></td><td> </td><td class="rblock"><span class="insert">   additional PATH_RESPONSE frames.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   from which the</span> PATH_CHALLENGE <span class="delete">was received.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">8.5.  Successful Path Validation</td><td> </td><td class="right">8.5.  Successful Path Validation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A new address is considered valid when a PATH_RESPONSE frame is</td><td> </td><td class="right">   A new address is considered valid when a PATH_RESPONSE frame is</td><td class="lineno"></td></tr>
      <tr id="diff0225"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   received that <span class="delete">meets the following criteria:</span></td><td> </td><td class="rblock">   received that contains the data that was sent in a previous</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock">   PATH_CHALLENGE.  Receipt of an acknowledgment for a packet containing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  It</span> contains the data that was sent in a previous PATH_CHALLENGE.</td><td> </td><td class="rblock">   a PATH_CHALLENGE frame is not adequate validation, since the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      Receipt of an acknowledgment for a packet containing a</td><td> </td><td class="rblock">   acknowledgment can be spoofed by a malicious peer.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      PATH_CHALLENGE frame is not adequate validation, since the</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      acknowledgment can be spoofed by a malicious peer.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  It was sent from the same remote address to which the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      corresponding PATH_CHALLENGE was sent.  If a PATH_RESPONSE frame</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      is received from a different remote address than the one to which</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      the PATH_CHALLENGE was sent, path validation is considered to have</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      failed, even if the data matches that sent in the PATH_CHALLENGE.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  It was received on the same local address from which the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      corresponding PATH_CHALLENGE was sent.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Note that receipt on a different local address does not result in</td><td> </td><td class="right">   Note that receipt on a different local address does not result in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   path validation failure, as it might be a result of a forwarded</td><td> </td><td class="right">   path validation failure, as it might be a result of a forwarded</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet (see Section 9.3.3) or misrouting.  It is possible that a</td><td> </td><td class="right">   packet (see Section 9.3.3) or misrouting.  It is possible that a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   valid PATH_RESPONSE might be received in the future.</td><td> </td><td class="right">   valid PATH_RESPONSE might be received in the future.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">8.6.  Failed Path Validation</td><td> </td><td class="right">8.6.  Failed Path Validation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Path validation only fails when the endpoint attempting to validate</td><td> </td><td class="right">   Path validation only fails when the endpoint attempting to validate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the path abandons its attempt to validate the path.</td><td> </td><td class="right">   the path abandons its attempt to validate the path.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-11" class="change"><td></td><th><small>skipping to change at</small><a href="#part-11"><em> page 44, line 19<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-11"><em> page 54, line 50<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   a new path to become available or close the connection.</td><td> </td><td class="right">   a new path to become available or close the connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A path validation might be abandoned for other reasons besides</td><td> </td><td class="right">   A path validation might be abandoned for other reasons besides</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   failure.  Primarily, this happens if a connection migration to a new</td><td> </td><td class="right">   failure.  Primarily, this happens if a connection migration to a new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   path is initiated while a path validation on the old path is in</td><td> </td><td class="right">   path is initiated while a path validation on the old path is in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   progress.</td><td> </td><td class="right">   progress.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">9.  Connection Migration</td><td> </td><td class="right">9.  Connection Migration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The use of a connection ID allows connections to survive changes to</td><td> </td><td class="right">   The use of a connection ID allows connections to survive changes to</td><td class="lineno"></td></tr>
      <tr id="diff0226"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   endpoint addresses <span class="delete">(that is, IP</span> address <span class="delete">and/or</span> port), such as those</td><td> </td><td class="rblock">   endpoint addresses <span class="insert">(IP</span> address <span class="insert">and</span> port), such as those caused by an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   caused by an endpoint migrating to a new network.  This section</td><td> </td><td class="rblock">   endpoint migrating to a new network.  This section describes the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   describes the process by which an endpoint migrates to a new address.</td><td> </td><td class="rblock">   process by which an endpoint migrates to a new address.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0227"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">An endpoint MUST NOT initiate connection migration before the</span></td><td> </td><td class="rblock">   The design of QUIC relies on endpoints retaining a stable address for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   handshake is finished and the endpoint has 1-RTT keys.</span>  The design of</td><td> </td><td class="rblock">   the duration of the handshake.  <span class="insert">An endpoint MUST NOT initiate</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   QUIC relies on endpoints retaining a stable address for the duration</td><td> </td><td class="rblock"><span class="insert">   connection migration before the handshake is confirmed, as defined in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   of the handshake.</td><td> </td><td class="rblock"><span class="insert">   section 4.1.2 of [QUIC-TLS].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0228"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">An</span> endpoint also MUST NOT <span class="delete">initiate connection migration if</span> the <span class="delete">peer</span></td><td> </td><td class="rblock">   <span class="insert">If the peer sent the disable_active_migration transport parameter, an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   sent</span> the <span class="delete">"disable_migration" transport parameter</span> during the</td><td> </td><td class="rblock">   endpoint also MUST NOT <span class="insert">send packets (including probing packets; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   handshake.  An endpoint <span class="delete">which</span> has sent this transport parameter, but</td><td> </td><td class="rblock"><span class="insert">   Section 9.1) from a different local address to</span> the <span class="insert">address</span> the <span class="insert">peer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   detects that a peer has nonetheless migrated to a different <span class="delete">network</span></td><td> </td><td class="rblock"><span class="insert">   used</span> during the handshake.  An endpoint <span class="insert">that</span> has sent this transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   MAY treat this as</span> a connection <span class="delete">error of type INVALID_MIGRATION.</span></td><td> </td><td class="rblock">   parameter, but detects that a peer has nonetheless migrated to a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   different <span class="insert">remote address MUST either drop the incoming packets on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that path without generating</span> a <span class="insert">stateless reset or proceed with path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   validation and allow the peer to migrate.  Generating a stateless</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   reset or closing the</span> connection <span class="insert">would allow third parties in the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   network to cause connections to close by spoofing or otherwise</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   manipulating observed traffic.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0229"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Not all changes of peer address are <span class="delete">intentional</span> migrations.  The peer</td><td> </td><td class="rblock">   Not all changes of peer address are <span class="insert">intentional, or active,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   could experience NAT rebinding: a change of address due to a</td><td> </td><td class="rblock">   migrations.  The peer could experience NAT rebinding: a change of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   middlebox, usually a NAT, allocating a new outgoing port or even a</td><td> </td><td class="rblock">   address due to a middlebox, usually a NAT, allocating a new outgoing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   new outgoing IP address for a flow.  <span class="delete">NAT rebinding is not connection</span></td><td> </td><td class="rblock">   port or even a new outgoing IP address for a flow.  <span class="insert">An</span> endpoint <span class="insert">MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   migration as defined in this section, though an</span> endpoint <span class="delete">SHOULD</span></td><td> </td><td class="rblock">   perform path validation (Section 8.2) if it detects <span class="insert">any</span> change <span class="insert">to a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   perform path validation (Section 8.2) if it detects <span class="delete">a</span> change <span class="delete">in the</span></td><td> </td><td class="rblock"><span class="insert">   peer's address, unless it has previously validated that address.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   IP address</span> of <span class="delete">its peer.</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   When an endpoint has no validated path on which to send packets, it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   MAY discard connection state.  An endpoint capable</span> of <span class="insert">connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   migration MAY wait for a new path to become available before</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   discarding connection state.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document limits migration of connections to new client</td><td> </td><td class="right">   This document limits migration of connections to new client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   addresses, except as described in Section 9.6.  Clients are</td><td> </td><td class="right">   addresses, except as described in Section 9.6.  Clients are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   responsible for initiating all migrations.  Servers do not send non-</td><td> </td><td class="right">   responsible for initiating all migrations.  Servers do not send non-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   probing packets (see Section 9.1) toward a client address until they</td><td> </td><td class="right">   probing packets (see Section 9.1) toward a client address until they</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   see a non-probing packet from that address.  If a client receives</td><td> </td><td class="right">   see a non-probing packet from that address.  If a client receives</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets from an unknown server address, the client MUST discard these</td><td> </td><td class="right">   packets from an unknown server address, the client MUST discard these</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets.</td><td> </td><td class="right">   packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">9.1.  Probing a New Path</td><td> </td><td class="right">9.1.  Probing a New Path</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MAY probe for peer reachability from a new local address</td><td> </td><td class="right">   An endpoint MAY probe for peer reachability from a new local address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   using path validation Section 8.2 prior to migrating the connection</td><td> </td><td class="right">   using path validation Section 8.2 prior to migrating the connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to the new local address.  Failure of path validation simply means</td><td> </td><td class="right">   to the new local address.  Failure of path validation simply means</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that the new path is not usable for this connection.  Failure to</td><td> </td><td class="right">   that the new path is not usable for this connection.  Failure to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   validate a path does not cause the connection to end unless there are</td><td> </td><td class="right">   validate a path does not cause the connection to end unless there are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   no valid alternative paths available.</td><td> </td><td class="right">   no valid alternative paths available.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint uses a new connection ID for probes sent from a new local</td><td> </td><td class="right">   An endpoint uses a new connection ID for probes sent from a new local</td><td class="lineno"></td></tr>
      <tr id="diff0230"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   address<span class="delete">,</span> see Section 9.5 for further discussion.  An endpoint that</td><td> </td><td class="rblock">   address<span class="insert">;</span> see Section 9.5 for further discussion.  An endpoint that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   uses a new local address needs to ensure that at least one new</td><td> </td><td class="right">   uses a new local address needs to ensure that at least one new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection ID is available at the peer.  That can be achieved by</td><td> </td><td class="right">   connection ID is available at the peer.  That can be achieved by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   including a NEW_CONNECTION_ID frame in the probe.</td><td> </td><td class="right">   including a NEW_CONNECTION_ID frame in the probe.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Receiving a PATH_CHALLENGE frame from a peer indicates that the peer</td><td> </td><td class="right">   Receiving a PATH_CHALLENGE frame from a peer indicates that the peer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   is probing for reachability on a path.  An endpoint sends a</td><td> </td><td class="right">   is probing for reachability on a path.  An endpoint sends a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   PATH_RESPONSE in response as per Section 8.2.</td><td> </td><td class="right">   PATH_RESPONSE in response as per Section 8.2.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   PATH_CHALLENGE, PATH_RESPONSE, NEW_CONNECTION_ID, and PADDING frames</td><td> </td><td class="right">   PATH_CHALLENGE, PATH_RESPONSE, NEW_CONNECTION_ID, and PADDING frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are "probing frames", and all other frames are "non-probing frames".</td><td> </td><td class="right">   are "probing frames", and all other frames are "non-probing frames".</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-12" class="change"><td></td><th><small>skipping to change at</small><a href="#part-12"><em> page 45, line 45<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-12"><em> page 56, line 36<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   establishment.  Therefore, a migrating endpoint can send to its peer</td><td> </td><td class="right">   establishment.  Therefore, a migrating endpoint can send to its peer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   knowing that the peer is willing to receive at the peer's current</td><td> </td><td class="right">   knowing that the peer is willing to receive at the peer's current</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   address.  Thus an endpoint can migrate to a new local address without</td><td> </td><td class="right">   address.  Thus an endpoint can migrate to a new local address without</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   first validating the peer's address.</td><td> </td><td class="right">   first validating the peer's address.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   When migrating, the new path might not support the endpoint's current</td><td> </td><td class="right">   When migrating, the new path might not support the endpoint's current</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sending rate.  Therefore, the endpoint resets its congestion</td><td> </td><td class="right">   sending rate.  Therefore, the endpoint resets its congestion</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   controller, as described in Section 9.4.</td><td> </td><td class="right">   controller, as described in Section 9.4.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The new path might not have the same ECN capability.  Therefore, the</td><td> </td><td class="right">   The new path might not have the same ECN capability.  Therefore, the</td><td class="lineno"></td></tr>
      <tr id="diff0231"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   endpoint verifies ECN capability as described in Section 13.<span class="delete">3</span>.</td><td> </td><td class="rblock">   endpoint verifies ECN capability as described in Section 13.<span class="insert">4</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Receiving acknowledgments for data sent on the new path serves as</td><td> </td><td class="right">   Receiving acknowledgments for data sent on the new path serves as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   proof of the peer's reachability from the new address.  Note that</td><td> </td><td class="right">   proof of the peer's reachability from the new address.  Note that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   since acknowledgments may be received on any path, return</td><td> </td><td class="right">   since acknowledgments may be received on any path, return</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   reachability on the new path is not established.  To establish return</td><td> </td><td class="right">   reachability on the new path is not established.  To establish return</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   reachability on the new path, an endpoint MAY concurrently initiate</td><td> </td><td class="right">   reachability on the new path, an endpoint MAY concurrently initiate</td><td class="lineno"></td></tr>
      <tr id="diff0232"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   path validation Section 8.2 on the new <span class="delete">path.</span></td><td> </td><td class="rblock">   path validation Section 8.2 on the new <span class="insert">path or it MAY choose to wait</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   for the peer to send the next non-probing frame to its new address.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">9.3.  Responding to Connection Migration</td><td> </td><td class="right">9.3.  Responding to Connection Migration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Receiving a packet from a new peer address containing a non-probing</td><td> </td><td class="right">   Receiving a packet from a new peer address containing a non-probing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame indicates that the peer has migrated to that address.</td><td> </td><td class="right">   frame indicates that the peer has migrated to that address.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   In response to such a packet, an endpoint MUST start sending</td><td> </td><td class="right">   In response to such a packet, an endpoint MUST start sending</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   subsequent packets to the new peer address and MUST initiate path</td><td> </td><td class="right">   subsequent packets to the new peer address and MUST initiate path</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   validation (Section 8.2) to verify the peer's ownership of the</td><td> </td><td class="right">   validation (Section 8.2) to verify the peer's ownership of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   unvalidated address.</td><td> </td><td class="right">   unvalidated address.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MAY send data to an unvalidated peer address, but it MUST</td><td> </td><td class="right">   An endpoint MAY send data to an unvalidated peer address, but it MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protect against potential attacks as described in Section 9.3.1 and</td><td> </td><td class="right">   protect against potential attacks as described in Section 9.3.1 and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Section 9.3.2.  An endpoint MAY skip validation of a peer address if</td><td> </td><td class="right">   Section 9.3.2.  An endpoint MAY skip validation of a peer address if</td><td class="lineno"></td></tr>
      <tr id="diff0233"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that address has been seen recently.</td><td> </td><td class="rblock">   that address has been seen recently.  <span class="insert">In particular, if an endpoint</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   returns to a previously-validated path after detecting some form of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   spurious migration, skipping address validation and restoring loss</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   detection and congestion state can reduce the performance impact of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the attack.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint only changes the address that it sends packets to in</td><td> </td><td class="right">   An endpoint only changes the address that it sends packets to in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   response to the highest-numbered non-probing packet.  This ensures</td><td> </td><td class="right">   response to the highest-numbered non-probing packet.  This ensures</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that an endpoint does not send packets to an old peer address in the</td><td> </td><td class="right">   that an endpoint does not send packets to an old peer address in the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   case that it receives reordered packets.</td><td> </td><td class="right">   case that it receives reordered packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   After changing the address to which it sends non-probing packets, an</td><td> </td><td class="right">   After changing the address to which it sends non-probing packets, an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint could abandon any path validation for other addresses.</td><td> </td><td class="right">   endpoint could abandon any path validation for other addresses.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Receiving a packet from a new peer address might be the result of a</td><td> </td><td class="right">   Receiving a packet from a new peer address might be the result of a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-13" class="change"><td></td><th><small>skipping to change at</small><a href="#part-13"><em> page 46, line 52<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-13"><em> page 57, line 51<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   As described in Section 9.3, an endpoint is required to validate a</td><td> </td><td class="right">   As described in Section 9.3, an endpoint is required to validate a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   peer's new address to confirm the peer's possession of the new</td><td> </td><td class="right">   peer's new address to confirm the peer's possession of the new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   address.  Until a peer's address is deemed valid, an endpoint MUST</td><td> </td><td class="right">   address.  Until a peer's address is deemed valid, an endpoint MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   limit the rate at which it sends data to this address.  The endpoint</td><td> </td><td class="right">   limit the rate at which it sends data to this address.  The endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MUST NOT send more than a minimum congestion window's worth of data</td><td> </td><td class="right">   MUST NOT send more than a minimum congestion window's worth of data</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   per estimated round-trip time (kMinimumWindow, as defined in</td><td> </td><td class="right">   per estimated round-trip time (kMinimumWindow, as defined in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [QUIC-RECOVERY]).  In the absence of this limit, an endpoint risks</td><td> </td><td class="right">   [QUIC-RECOVERY]).  In the absence of this limit, an endpoint risks</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   being used for a denial of service attack against an unsuspecting</td><td> </td><td class="right">   being used for a denial of service attack against an unsuspecting</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   victim.  Note that since the endpoint will not have any round-trip</td><td> </td><td class="right">   victim.  Note that since the endpoint will not have any round-trip</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   time measurements to this address, the estimate SHOULD be the default</td><td> </td><td class="right">   time measurements to this address, the estimate SHOULD be the default</td><td class="lineno"></td></tr>
      <tr id="diff0234"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   initial value<span class="delete"> (see [QUIC-RECOVERY])</span>.</td><td> </td><td class="rblock">   initial value<span class="insert">; see [QUIC-RECOVERY]</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If an endpoint skips validation of a peer address as described in</td><td> </td><td class="right">   If an endpoint skips validation of a peer address as described in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Section 9.3, it does not need to limit its sending rate.</td><td> </td><td class="right">   Section 9.3, it does not need to limit its sending rate.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">9.3.2.  On-Path Address Spoofing</td><td> </td><td class="right">9.3.2.  On-Path Address Spoofing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An on-path attacker could cause a spurious connection migration by</td><td> </td><td class="right">   An on-path attacker could cause a spurious connection migration by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   copying and forwarding a packet with a spoofed address such that it</td><td> </td><td class="right">   copying and forwarding a packet with a spoofed address such that it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   arrives before the original packet.  The packet with the spoofed</td><td> </td><td class="right">   arrives before the original packet.  The packet with the spoofed</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   address will be seen to come from a migrating connection, and the</td><td> </td><td class="right">   address will be seen to come from a migrating connection, and the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-14" class="change"><td></td><th><small>skipping to change at</small><a href="#part-14"><em> page 48, line 40<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-14"><em> page 59, line 40<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint could also use heuristics to improve detection of this</td><td> </td><td class="right">   An endpoint could also use heuristics to improve detection of this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   style of attack.  For instance, NAT rebinding is improbable if</td><td> </td><td class="right">   style of attack.  For instance, NAT rebinding is improbable if</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets were recently received on the old path, similarly rebinding</td><td> </td><td class="right">   packets were recently received on the old path, similarly rebinding</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   is rare on IPv6 paths.  Endpoints can also look for duplicated</td><td> </td><td class="right">   is rare on IPv6 paths.  Endpoints can also look for duplicated</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets.  Conversely, a change in connection ID is more likely to</td><td> </td><td class="right">   packets.  Conversely, a change in connection ID is more likely to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   indicate an intentional migration rather than an attack.</td><td> </td><td class="right">   indicate an intentional migration rather than an attack.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">9.4.  Loss Detection and Congestion Control</td><td> </td><td class="right">9.4.  Loss Detection and Congestion Control</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The capacity available on the new path might not be the same as the</td><td> </td><td class="right">   The capacity available on the new path might not be the same as the</td><td class="lineno"></td></tr>
      <tr id="diff0235"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   old path.  Packets sent on the old path <span class="delete">SHOULD</span> NOT contribute to</td><td> </td><td class="rblock">   old path.  Packets sent on the old path <span class="insert">MUST</span> NOT contribute to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   congestion control or RTT estimation for the new path.</td><td> </td><td class="right">   congestion control or RTT estimation for the new path.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0236"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   On confirming a peer's ownership of its new address, an endpoint</td><td> </td><td class="rblock">   On confirming a peer's ownership of its new address, an endpoint <span class="insert">MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">SHOULD</span> immediately reset the congestion controller and round-trip</td><td> </td><td class="rblock">   immediately reset the congestion controller and round-trip time</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   time estimator for the new <span class="delete">path.</span></td><td> </td><td class="rblock">   estimator for the new path <span class="insert">to initial values (see Sections A.3 and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">   B.3 in [QUIC-RECOVERY])</span> unless it <span class="insert">has knowledge</span> that <span class="insert">a</span> previous send</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   An endpoint MUST NOT return to the send rate used for the previous</span></td><td> </td><td class="rblock">   rate <span class="insert">or round-trip time estimate</span> is valid for the new path.  For</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   path unless it <span class="delete">is reasonably sure</span> that <span class="delete">the</span> previous send rate is</td><td> </td><td class="rblock">   instance, <span class="insert">an endpoint might infer that</span> a change in <span class="insert">only</span> the client's</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   valid for the new path.  For instance, a change in the client's port</td><td> </td><td class="rblock">   port number is indicative of a <span class="insert">NAT rebinding, meaning that</span> the new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   number is <span class="delete">likely</span> indicative of a <span class="delete">rebinding in a middlebox and not a</span></td><td> </td><td class="rblock">   path is <span class="insert">likely to have similar bandwidth and round-trip time.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   complete change in path.  This determination likely depends on</span></td><td> </td><td class="rblock"><span class="insert">   However,</span> this <span class="insert">determination will be imperfect.  If the determination</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   heuristics, which could be imperfect; if</span> the new path <span class="delete">capacity</span> is</td><td> </td><td class="rblock"><span class="insert">   is incorrect,</span> the congestion controller and <span class="insert">the RTT estimator are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">significantly reduced, ultimately</span> this <span class="delete">relies on</span> the congestion</td><td> </td><td class="rblock"><span class="insert">   expected to adapt to the new path.  Generally, implementations are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   controller <span class="delete">responding to congestion signals</span> and <span class="delete">reducing send rates</span></td><td> </td><td class="rblock"><span class="insert">   advised to be cautious when using previous values on a new path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   appropriately.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   There may be apparent reordering at the receiver when an endpoint</td><td> </td><td class="right">   There may be apparent reordering at the receiver when an endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sends data and probes from/to multiple addresses during the migration</td><td> </td><td class="right">   sends data and probes from/to multiple addresses during the migration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   period, since the two resulting paths may have different round-trip</td><td> </td><td class="right">   period, since the two resulting paths may have different round-trip</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   times.  A receiver of packets on multiple paths will still send ACK</td><td> </td><td class="right">   times.  A receiver of packets on multiple paths will still send ACK</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frames covering all received packets.</td><td> </td><td class="right">   frames covering all received packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   While multiple paths might be used during connection migration, a</td><td> </td><td class="right">   While multiple paths might be used during connection migration, a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   single congestion control context and a single loss recovery context</td><td> </td><td class="right">   single congestion control context and a single loss recovery context</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (as described in [QUIC-RECOVERY]) may be adequate.  For instance, an</td><td> </td><td class="right">   (as described in [QUIC-RECOVERY]) may be adequate.  For instance, an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint might delay switching to a new congestion control context</td><td> </td><td class="right">   endpoint might delay switching to a new congestion control context</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   until it is confirmed that an old path is no longer needed (such as</td><td> </td><td class="right">   until it is confirmed that an old path is no longer needed (such as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the case in Section 9.3.3).</td><td> </td><td class="right">   the case in Section 9.3.3).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A sender can make exceptions for probe packets so that their loss</td><td> </td><td class="right">   A sender can make exceptions for probe packets so that their loss</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   detection is independent and does not unduly cause the congestion</td><td> </td><td class="right">   detection is independent and does not unduly cause the congestion</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   controller to reduce its sending rate.  An endpoint might set a</td><td> </td><td class="right">   controller to reduce its sending rate.  An endpoint might set a</td><td class="lineno"></td></tr>
      <tr id="diff0237"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   separate timer when a PATH_CHALLENGE is sent, which is cancelled <span class="delete">when</span></td><td> </td><td class="rblock">   separate timer when a PATH_CHALLENGE is sent, which is cancelled <span class="insert">if</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the corresponding PATH_RESPONSE is received.  If the timer fires</td><td> </td><td class="right">   the corresponding PATH_RESPONSE is received.  If the timer fires</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   before the PATH_RESPONSE is received, the endpoint might send a new</td><td> </td><td class="right">   before the PATH_RESPONSE is received, the endpoint might send a new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   PATH_CHALLENGE, and restart the timer for a longer period of time.</td><td> </td><td class="right">   PATH_CHALLENGE, and restart the timer for a longer period of time.</td><td class="lineno"></td></tr>
      <tr id="diff0238"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">This timer SHOULD be set as described in Section 6.2.1 of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [QUIC-RECOVERY] and MUST NOT be more aggressive.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">9.5.  Privacy Implications of Connection Migration</td><td> </td><td class="right">9.5.  Privacy Implications of Connection Migration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Using a stable connection ID on multiple network paths allows a</td><td> </td><td class="right">   Using a stable connection ID on multiple network paths allows a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   passive observer to correlate activity between those paths.  An</td><td> </td><td class="right">   passive observer to correlate activity between those paths.  An</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint that moves between networks might not wish to have their</td><td> </td><td class="right">   endpoint that moves between networks might not wish to have their</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   activity correlated by any entity other than their peer, so different</td><td> </td><td class="right">   activity correlated by any entity other than their peer, so different</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection IDs are used when sending from different local addresses,</td><td> </td><td class="right">   connection IDs are used when sending from different local addresses,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   as discussed in Section 5.1.  For this to be effective endpoints need</td><td> </td><td class="right">   as discussed in Section 5.1.  For this to be effective endpoints need</td><td class="lineno"></td></tr>
      <tr id="diff0239"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to ensure that connection<span class="delete">s</span> IDs they provide cannot be linked by any</td><td> </td><td class="rblock">   to ensure that connection IDs they provide cannot be linked by any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   other entity.</td><td> </td><td class="right">   other entity.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0240"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">This eliminates</span> the <span class="delete">use of the connection</span> ID <span class="delete">for linking activity</span></td><td> </td><td class="rblock">   <span class="insert">At any time, endpoints MAY change</span> the <span class="insert">Destination Connection</span> ID <span class="insert">they</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   from the same connection on different networks.  Header protection</span></td><td> </td><td class="rblock"><span class="insert">   send</span> to <span class="insert">a value that has</span> not <span class="insert">been</span> used <span class="insert">on another path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   ensures that packet numbers cannot be used</span> to <span class="delete">correlate activity.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   This does</span> not <span class="delete">prevent other properties of packets, such as timing and</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   size, from being</span> used <span class="delete">to correlate activity.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0241"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Clients MAY move</span> to a new connection ID <span class="delete">at any time based on</span></td><td> </td><td class="rblock">   <span class="insert">An endpoint MUST NOT reuse a connection ID when sending from more</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   implementation-specific concerns.</span>  For example, after a period of</td><td> </td><td class="rblock"><span class="insert">   than one local address, for example when initiating connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   network <span class="delete">inactivity</span> NAT rebinding might <span class="delete">occur</span> when the client <span class="delete">begins</span></td><td> </td><td class="rblock"><span class="insert">   migration as described in Section 9.2 or when probing a new network</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   sending data again.</span></td><td> </td><td class="rblock"><span class="insert">   path as described in Section 9.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Similarly, an endpoint MUST NOT reuse a connection ID when sending to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   more than one destination address.  Due</span> to <span class="insert">network changes outside</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the control of its peer, an endpoint might receive packets from</span> a new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">source address with the same destination connection ID, in which case</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   it MAY continue to use the current connection ID with the new remote</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   address while still sending from the same local address.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   These requirements regarding</span> connection ID <span class="insert">reuse apply only to the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   sending of packets, as unintentional changes in path without a change</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in connection ID are possible.</span>  For example, after a period of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   network <span class="insert">inactivity,</span> NAT rebinding might <span class="insert">cause packets to be sent on a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   new path</span> when the client <span class="insert">resumes sending.  An endpoint responds to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   such an event as described in Section 9.3.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Using different connection IDs for packets sent in both directions on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   each new network path eliminates the use of the connection ID for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   linking packets from the same connection across different network</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   paths.  Header protection ensures that packet numbers cannot be used</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to correlate activity.  This does not prevent other properties of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets, such as timing and size, from being used to correlate</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   activity.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint SHOULD NOT initiate migration with a peer that has</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   requested a zero-length connection ID, because traffic over the new</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   path might be trivially linkable to traffic over the old one.  If the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server is able to route packets with a zero-length connection ID to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the right connection, it means that the server is using other</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   information to demultiplex packets.  For example, a server might</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provide a unique address to every client, for instance using HTTP</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   alternative services [ALTSVC].  Information that might allow correct</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   routing of packets across multiple network paths will also allow</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   activity on those paths to be linked by entities other than the peer.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A client might wish to reduce linkability by employing a new</td><td> </td><td class="right">   A client might wish to reduce linkability by employing a new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection ID and source UDP port when sending traffic after a period</td><td> </td><td class="right">   connection ID and source UDP port when sending traffic after a period</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   of inactivity.  Changing the UDP port from which it sends packets at</td><td> </td><td class="right">   of inactivity.  Changing the UDP port from which it sends packets at</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the same time might cause the packet to appear as a connection</td><td> </td><td class="right">   the same time might cause the packet to appear as a connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   migration.  This ensures that the mechanisms that support migration</td><td> </td><td class="right">   migration.  This ensures that the mechanisms that support migration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are exercised even for clients that don't experience NAT rebindings</td><td> </td><td class="right">   are exercised even for clients that don't experience NAT rebindings</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   or genuine migrations.  Changing port number can cause a peer to</td><td> </td><td class="right">   or genuine migrations.  Changing port number can cause a peer to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   reset its congestion state (see Section 9.4), so the port SHOULD only</td><td> </td><td class="right">   reset its congestion state (see Section 9.4), so the port SHOULD only</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   be changed infrequently.</td><td> </td><td class="right">   be changed infrequently.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0242"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Endpoints</span> that <span class="delete">use</span> connection IDs <span class="delete">with length greater than zero could</span></td><td> </td><td class="rblock">   <span class="insert">An endpoint</span> that <span class="insert">exhausts available</span> connection IDs <span class="insert">cannot probe new</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   have their activity correlated if their peers keep using the same</span></td><td> </td><td class="rblock"><span class="insert">   paths or initiate migration, nor can it respond</span> to <span class="insert">probes or attempts</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   destination connection ID after migration.  Endpoints that receive</span></td><td> </td><td class="rblock"><span class="insert">   by its peer</span> to <span class="insert">migrate.  To</span> ensure that <span class="insert">migration is possible and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packets with a previously unused Destination Connection ID SHOULD</span></td><td> </td><td class="rblock">   packets sent on different paths cannot be <span class="insert">correlated,</span> endpoints</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   change</span> to <span class="delete">sending packets with a connection ID that has not been used</span></td><td> </td><td class="rblock">   SHOULD provide new connection IDs before <span class="insert">peers migrate; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   on any other network path.  The goal here is</span> to ensure that packets</td><td> </td><td class="rblock"><span class="insert">   Section 5.1.1.</span>  If <span class="insert">a peer might have exhausted available</span> connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   sent on different paths cannot be <span class="delete">correlated.  To fulfill this</span></td><td> </td><td class="rblock">   <span class="insert">IDs, a migrating endpoint could include</span> a <span class="insert">NEW_CONNECTION_ID frame</span> in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   privacy requirement,</span> endpoints <span class="delete">that initiate migration and use</span></td><td> </td><td class="rblock">   <span class="insert">all packets sent on a new network path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   connection IDs with length greater than zero</span> SHOULD provide <span class="delete">their</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   peers with</span> new connection IDs before <span class="delete">migration.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Caution:</span>  If <span class="delete">both endpoints change</span> connection <span class="delete">ID in response to</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      seeing</span> a <span class="delete">change</span> in <span class="delete">connection ID from their peer, then this can</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      trigger an infinite sequence of changes.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">9.6.  Server's Preferred Address</td><td> </td><td class="right">9.6.  Server's Preferred Address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC allows servers to accept connections on one IP address and</td><td> </td><td class="right">   QUIC allows servers to accept connections on one IP address and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   attempt to transfer these connections to a more preferred address</td><td> </td><td class="right">   attempt to transfer these connections to a more preferred address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   shortly after the handshake.  This is particularly useful when</td><td> </td><td class="right">   shortly after the handshake.  This is particularly useful when</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   clients initially connect to an address shared by multiple servers</td><td> </td><td class="right">   clients initially connect to an address shared by multiple servers</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   but would prefer to use a unicast address to ensure connection</td><td> </td><td class="right">   but would prefer to use a unicast address to ensure connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stability.  This section describes the protocol for migrating a</td><td> </td><td class="right">   stability.  This section describes the protocol for migrating a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection to a preferred server address.</td><td> </td><td class="right">   connection to a preferred server address.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Migrating a connection to a new server address mid-connection is left</td><td> </td><td class="right">   Migrating a connection to a new server address mid-connection is left</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   for future work.  If a client receives packets from a new server</td><td> </td><td class="right">   for future work.  If a client receives packets from a new server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   address not indicated by the preferred_address transport parameter,</td><td> </td><td class="right">   address not indicated by the preferred_address transport parameter,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the client SHOULD discard these packets.</td><td> </td><td class="right">   the client SHOULD discard these packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0243"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">9.6.1.  Communicating <span class="delete">A</span> Preferred Address</td><td> </td><td class="rblock">9.6.1.  Communicating <span class="insert">a</span> Preferred Address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server conveys a preferred address by including the</td><td> </td><td class="right">   A server conveys a preferred address by including the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   preferred_address transport parameter in the TLS handshake.</td><td> </td><td class="right">   preferred_address transport parameter in the TLS handshake.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Servers MAY communicate a preferred address of each address family</td><td> </td><td class="right">   Servers MAY communicate a preferred address of each address family</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (IPv4 and IPv6) to allow clients to pick the one most suited to their</td><td> </td><td class="right">   (IPv4 and IPv6) to allow clients to pick the one most suited to their</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   network attachment.</td><td> </td><td class="right">   network attachment.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0244"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Once the handshake is <span class="delete">finish</span>ed, the client SHOULD select one of the</td><td> </td><td class="rblock">   Once the handshake is <span class="insert">confirm</span>ed, the client SHOULD select one of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   two server's preferred addresses and initiate path validation (see</td><td> </td><td class="right">   two server's preferred addresses and initiate path validation (see</td><td class="lineno"></td></tr>
      <tr id="diff0245"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section 8.2) of that address using <span class="delete">the</span> connection <span class="delete">ID provided in</span> the</td><td> </td><td class="rblock">   Section 8.2) of that address using <span class="insert">any previously unused active</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   preferred_address transport <span class="delete">parameter.</span></td><td> </td><td class="rblock">   connection <span class="insert">ID, taken from either</span> the preferred_address transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">parameter or a NEW_CONNECTION_ID frame.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If path validation succeeds, the client SHOULD immediately begin</td><td> </td><td class="right">   If path validation succeeds, the client SHOULD immediately begin</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sending all future packets to the new server address using the new</td><td> </td><td class="right">   sending all future packets to the new server address using the new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection ID and discontinue use of the old server address.  If path</td><td> </td><td class="right">   connection ID and discontinue use of the old server address.  If path</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   validation fails, the client MUST continue sending all future packets</td><td> </td><td class="right">   validation fails, the client MUST continue sending all future packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to the server's original IP address.</td><td> </td><td class="right">   to the server's original IP address.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">9.6.2.  Responding to Connection Migration</td><td> </td><td class="right">9.6.2.  Responding to Connection Migration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server might receive a packet addressed to its preferred IP address</td><td> </td><td class="right">   A server might receive a packet addressed to its preferred IP address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-15" class="change"><td></td><th><small>skipping to change at</small><a href="#part-15"><em> page 51, line 37<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-15"><em> page 63, line 32<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   preferred address.  This helps to guard against spurious migration</td><td> </td><td class="right">   preferred address.  This helps to guard against spurious migration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   initiated by an attacker.</td><td> </td><td class="right">   initiated by an attacker.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Once the server has completed its path validation and has received a</td><td> </td><td class="right">   Once the server has completed its path validation and has received a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   non-probing packet with a new largest packet number on its preferred</td><td> </td><td class="right">   non-probing packet with a new largest packet number on its preferred</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   address, the server begins sending non-probing packets to the client</td><td> </td><td class="right">   address, the server begins sending non-probing packets to the client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   exclusively from its preferred IP address.  It SHOULD drop packets</td><td> </td><td class="right">   exclusively from its preferred IP address.  It SHOULD drop packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   for this connection received on the old IP address, but MAY continue</td><td> </td><td class="right">   for this connection received on the old IP address, but MAY continue</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to process delayed packets.</td><td> </td><td class="right">   to process delayed packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0246"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">The addresses that a server provides in the preferred_address</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transport parameter are only valid for the connection in which they</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   are provided.  A client MUST NOT use these for other connections,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   including connections that are resumed from the current connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">9.6.3.  Interaction of Client Migration and Preferred Address</td><td> </td><td class="right">9.6.3.  Interaction of Client Migration and Preferred Address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A client might need to perform a connection migration before it has</td><td> </td><td class="right">   A client might need to perform a connection migration before it has</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   migrated to the server's preferred address.  In this case, the client</td><td> </td><td class="right">   migrated to the server's preferred address.  In this case, the client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   SHOULD perform path validation to both the original and preferred</td><td> </td><td class="right">   SHOULD perform path validation to both the original and preferred</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   server address from the client's new address concurrently.</td><td> </td><td class="right">   server address from the client's new address concurrently.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If path validation of the server's preferred address succeeds, the</td><td> </td><td class="right">   If path validation of the server's preferred address succeeds, the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   client MUST abandon validation of the original address and migrate to</td><td> </td><td class="right">   client MUST abandon validation of the original address and migrate to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   using the server's preferred address.  If path validation of the</td><td> </td><td class="right">   using the server's preferred address.  If path validation of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-16" class="change"><td></td><th><small>skipping to change at</small><a href="#part-16"><em> page 52, line 17<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-16"><em> page 64, line 20<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   server's preferred address.</td><td> </td><td class="right">   server's preferred address.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Servers SHOULD initiate path validation to the client's new address</td><td> </td><td class="right">   Servers SHOULD initiate path validation to the client's new address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   upon receiving a probe packet from a different address.  Servers MUST</td><td> </td><td class="right">   upon receiving a probe packet from a different address.  Servers MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   NOT send more than a minimum congestion window's worth of non-probing</td><td> </td><td class="right">   NOT send more than a minimum congestion window's worth of non-probing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets to the new address before path validation is complete.</td><td> </td><td class="right">   packets to the new address before path validation is complete.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A client that migrates to a new address SHOULD use a preferred</td><td> </td><td class="right">   A client that migrates to a new address SHOULD use a preferred</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   address from the same address family for the server.</td><td> </td><td class="right">   address from the same address family for the server.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0247"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">The connection ID provided in the preferred_address transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   parameter is not specific to the addresses that are provided.  This</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection ID is provided to ensure that the client has a connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ID available for migration, but the client MAY use this connection ID</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   on any path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">9.7.  Use of IPv6 Flow-Label and Migration</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Endpoints that send data using IPv6 SHOULD apply an IPv6 flow label</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in compliance with [RFC6437], unless the local API does not allow</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   setting IPv6 flow labels.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The IPv6 flow label SHOULD be a pseudo-random function of the source</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   and destination addresses, source and destination UDP ports, and the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   destination CID.  The flow label generation MUST be designed to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   minimize the chances of linkability with a previously used flow</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   label, as this would enable correlating activity on multiple paths;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   see Section 9.5.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A possible implementation is to compute the flow label as a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   cryptographic hash function of the source and destination addresses,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   source and destination UDP ports, destination CID, and a local</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   secret.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">10.  Connection Termination</td><td> </td><td class="right">10.  Connection Termination</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0248"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Connections should remain open until they become idle for a pre-</span></td><td> </td><td class="rblock">   <span class="insert">An established</span> QUIC <span class="insert">connection</span> can be terminated in one of three</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   negotiated period of time.  A</span> QUIC <span class="delete">connection, once established,</span> can</td><td> </td><td class="rblock">   ways:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   be terminated in one of three ways:</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0249"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  idle timeout (Section 10.2)</td><td> </td><td class="rblock">   <span class="insert">*</span>  idle timeout (Section 10.2)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0250"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  immediate close (Section 10.3)</td><td> </td><td class="rblock">   <span class="insert">*</span>  immediate close (Section 10.3)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">*  stateless reset (Section 10.4)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0251"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  stateless reset (Section 10.4)</span></td><td> </td><td class="rblock">   <span class="insert">An endpoint MAY discard connection state if it does not have a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   validated path on which it can send packets; see Section 8.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">10.1.  Closing and Draining Connection States</td><td> </td><td class="right">10.1.  Closing and Draining Connection States</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The closing and draining connection states exist to ensure that</td><td> </td><td class="right">   The closing and draining connection states exist to ensure that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connections close cleanly and that delayed or reordered packets are</td><td> </td><td class="right">   connections close cleanly and that delayed or reordered packets are</td><td class="lineno"></td></tr>
      <tr id="diff0252"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   properly discarded.  These states SHOULD persist for three times the</td><td> </td><td class="rblock">   properly discarded.  These states SHOULD persist for <span class="insert">at least</span> three</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   current Probe Timeout (PTO) interval as defined in [QUIC-RECOVERY].</td><td> </td><td class="rblock">   times the current Probe Timeout (PTO) interval as defined in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   [QUIC-RECOVERY].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint enters a closing period after initiating an immediate</td><td> </td><td class="right">   An endpoint enters a closing period after initiating an immediate</td><td class="lineno"></td></tr>
      <tr id="diff0253"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">close (Section 10.3).</span>  While closing, an endpoint MUST NOT send</td><td> </td><td class="rblock">   <span class="insert">close; Section 10.3.</span>  While closing, an endpoint MUST NOT send</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets unless they contain a CONNECTION_CLOSE <span class="delete">frame (see</span></td><td> </td><td class="rblock">   packets unless they contain a CONNECTION_CLOSE <span class="insert">frame; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section 10.3 for <span class="delete">details).</span>  An endpoint retains only enough</td><td> </td><td class="rblock">   Section 10.3 for <span class="insert">details.</span>  An endpoint retains only enough</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   information to generate a packet containing a CONNECTION_CLOSE frame</td><td> </td><td class="right">   information to generate a packet containing a CONNECTION_CLOSE frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and to identify packets as belonging to the connection.  The</td><td> </td><td class="right">   and to identify packets as belonging to the connection.  The</td><td class="lineno"></td></tr>
      <tr id="diff0254"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection ID and QUIC version <span class="delete">is</span> sufficient information to identify</td><td> </td><td class="rblock">   <span class="insert">endpoint's selected</span> connection ID and <span class="insert">the</span> QUIC version <span class="insert">are</span> sufficient</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets for a closing connection; an endpoint can discard all other</td><td> </td><td class="rblock">   information to identify packets for a closing connection; an endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection state.  An endpoint MAY retain packet protection keys for</td><td> </td><td class="rblock">   can discard all other connection state.  An endpoint MAY retain</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   incoming packets to allow it to read and process a CONNECTION_CLOSE</td><td> </td><td class="rblock">   packet protection keys for incoming packets to allow it to read and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   frame.</td><td> </td><td class="rblock">   process a CONNECTION_CLOSE frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The draining state is entered once an endpoint receives a signal that</td><td> </td><td class="right">   The draining state is entered once an endpoint receives a signal that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   its peer is closing or draining.  While otherwise identical to the</td><td> </td><td class="right">   its peer is closing or draining.  While otherwise identical to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   closing state, an endpoint in the draining state MUST NOT send any</td><td> </td><td class="right">   closing state, an endpoint in the draining state MUST NOT send any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets.  Retaining packet protection keys is unnecessary once a</td><td> </td><td class="right">   packets.  Retaining packet protection keys is unnecessary once a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection is in the draining state.</td><td> </td><td class="right">   connection is in the draining state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MAY transition from the closing period to the draining</td><td> </td><td class="right">   An endpoint MAY transition from the closing period to the draining</td><td class="lineno"></td></tr>
      <tr id="diff0255"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   period if it <span class="delete">can confirm</span> that <span class="delete">its</span> peer is also closing or draining.</td><td> </td><td class="rblock">   period if it <span class="insert">receives a CONNECTION_CLOSE frame or stateless reset,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Receiving a CONNECTION_CLOSE frame is sufficient confirmation, as is</span></td><td> </td><td class="rblock"><span class="insert">   both of which indicate</span> that <span class="insert">the</span> peer is also closing or draining.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   receiving a stateless reset.</span>  The draining period SHOULD end when the</td><td> </td><td class="rblock">   The draining period SHOULD end when the closing period would have</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   closing period would have ended.  In other words, the endpoint can</td><td> </td><td class="rblock">   ended.  In other words, the endpoint can use the same end time, but</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   use the same end time, but cease retransmission of the closing</td><td> </td><td class="rblock">   cease retransmission of the closing packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Disposing of connection state prior to the end of the closing or</td><td> </td><td class="right">   Disposing of connection state prior to the end of the closing or</td><td class="lineno"></td></tr>
      <tr id="diff0256"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   draining period could cause delayed or reordered packets to <span class="delete">be</span></td><td> </td><td class="rblock">   draining period could cause delayed or reordered packets to <span class="insert">generate</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   handled poorly.</span>  Endpoints that have some alternative means to ensure</td><td> </td><td class="rblock"><span class="insert">   an unnecessary stateless reset.</span>  Endpoints that have some alternative</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that late-arriving packets on the connection do not <span class="delete">create QUIC</span></td><td> </td><td class="rblock">   means to ensure that late-arriving packets on the connection do not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   state,</span> such as those that are able to close the UDP socket, MAY use</td><td> </td><td class="rblock">   <span class="insert">induce a response,</span> such as those that are able to close the UDP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   an abbreviated draining period which can allow for faster resource</td><td> </td><td class="rblock">   socket, MAY use an abbreviated draining period which can allow for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   recovery.  Servers that retain an open socket for accepting new</td><td> </td><td class="rblock">   faster resource recovery.  Servers that retain an open socket for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connections SHOULD NOT exit the closing or draining period early.</td><td> </td><td class="rblock">   accepting new connections SHOULD NOT exit the closing or draining</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   period early.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Once the closing or draining period has ended, an endpoint SHOULD</td><td> </td><td class="right">   Once the closing or draining period has ended, an endpoint SHOULD</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   discard all connection state.  This results in new packets on the</td><td> </td><td class="right">   discard all connection state.  This results in new packets on the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection being handled generically.  For instance, an endpoint MAY</td><td> </td><td class="right">   connection being handled generically.  For instance, an endpoint MAY</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   send a stateless reset in response to any further incoming packets.</td><td> </td><td class="right">   send a stateless reset in response to any further incoming packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The draining and closing periods do not apply when a stateless reset</td><td> </td><td class="right">   The draining and closing periods do not apply when a stateless reset</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 10.4) is sent.</td><td> </td><td class="right">   (Section 10.4) is sent.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint is not expected to handle key updates when it is closing</td><td> </td><td class="right">   An endpoint is not expected to handle key updates when it is closing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   or draining.  A key update might prevent the endpoint from moving</td><td> </td><td class="right">   or draining.  A key update might prevent the endpoint from moving</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   from the closing state to draining, but it otherwise has no impact.</td><td> </td><td class="right">   from the closing state to draining, but it otherwise has no impact.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   While in the closing period, an endpoint could receive packets from a</td><td> </td><td class="right">   While in the closing period, an endpoint could receive packets from a</td><td class="lineno"></td></tr>
      <tr id="diff0257"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   new source address, indicating a <span class="delete">client</span> connection <span class="delete">migration</span></td><td> </td><td class="rblock">   new source address, indicating a connection <span class="insert">migration; Section 9.</span>  An</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   (Section 9).</span>  An endpoint in the closing state MUST strictly limit</td><td> </td><td class="rblock">   endpoint in the closing state MUST strictly limit the number of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the number of packets it sends to this new address until the address</td><td> </td><td class="rblock">   packets it sends to this new address until the address is <span class="insert">validated;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   is <span class="delete">validated (see</span> Section <span class="delete">8.2).</span>  A server in the closing state MAY</td><td> </td><td class="rblock"><span class="insert">   see</span> Section <span class="insert">8.2.</span>  A server in the closing state MAY instead choose to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   instead choose to discard packets received from a new source address.</td><td> </td><td class="rblock">   discard packets received from a new source address.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">10.2.  Idle Timeout</td><td> </td><td class="right">10.2.  Idle Timeout</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0258"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   If <span class="delete">the idle timeout is enabled,</span> a connection <span class="delete">that</span> remains idle for</td><td> </td><td class="rblock">   If a <span class="insert">max_idle_timeout is specified by either peer in its transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   longer than the <span class="delete">advertised idle timeout (see Section 18.1) is closed.</span></td><td> </td><td class="rblock"><span class="insert">   parameters (Section 18.2), the</span> connection <span class="insert">is silently closed and its</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   A connection enters the draining state when</span> the <span class="delete">idle timeout expires.</span></td><td> </td><td class="rblock"><span class="insert">   state is discarded when it</span> remains idle for longer than the <span class="insert">minimum</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of both peers max_idle_timeout values and three times</span> the <span class="insert">current</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Probe Timeout (PTO).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0259"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Each endpoint advertises <span class="delete">its own idle timeout to its peer.  An</span></td><td> </td><td class="rblock">   Each endpoint advertises a <span class="insert">max_idle_timeout,</span> but <span class="insert">the effective value</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   enpdpoint restarts any timer it maintains when a packet from its peer</span></td><td> </td><td class="rblock"><span class="insert">   at an endpoint is computed as the minimum of the two advertised</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   is received and processed successfully.  The timer is also restarted</span></td><td> </td><td class="rblock"><span class="insert">   values.  By announcing</span> a <span class="insert">max_idle_timeout, an endpoint commits to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   when sending</span> a <span class="delete">packet containing frames other than ACK or PADDING (an</span></td><td> </td><td class="rblock">   initiating <span class="insert">an immediate close (Section 10.3) if it abandons the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   ACK-eliciting packet, see [QUIC-RECOVERY]),</span> but <span class="delete">only if no other ACK-</span></td><td> </td><td class="rblock"><span class="insert">   connection prior to the effective value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   eliciting packets have been sent since last receiving</span> a <span class="delete">packet.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Restarting when sending packets ensures that connections do not</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   prematurely time out when</span> initiating <span class="delete">new activity.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0260"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The value for an idle timeout can be asymmetric.  The value</span></td><td> </td><td class="rblock">   <span class="insert">An</span> endpoint <span class="insert">restarts its idle timer when a packet from its peer</span> is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   advertised by an</span> endpoint is <span class="delete">only used to determine whether the</span></td><td> </td><td class="rblock">   <span class="insert">received and processed successfully.  An endpoint also restarts its</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   connection is live at</span> that <span class="delete">endpoint.</span>  An endpoint that sends packets</td><td> </td><td class="rblock"><span class="insert">   idle timer when sending an ack-eliciting packet if no other ack-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">near the end of</span> the <span class="delete">idle</span> timeout <span class="delete">period of a peer</span> risks having <span class="delete">those</span></td><td> </td><td class="rblock"><span class="insert">   eliciting packets have been sent since last receiving and processing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packets</span> discarded <span class="delete">if its peer enters</span> the draining state before <span class="delete">the</span></td><td> </td><td class="rblock"><span class="insert">   a packet.  Restarting this timer when sending a packet ensures</span> that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets arrive.  <span class="delete">If</span> a peer could <span class="delete">timeout</span> within <span class="delete">an Probe Timeout</span></td><td> </td><td class="rblock">   <span class="insert">connections are not closed after new activity is initiated.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   (PTO,</span> see Section <span class="delete">6.2.2</span> of <span class="delete">[QUIC-RECOVERY]),</span> it is <span class="delete">advisable</span> to <span class="delete">test</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   for <span class="delete">liveness before</span> sending <span class="delete">any data</span> that <span class="delete">cannot be retried safely.</span></td><td> </td><td class="rblock"><span class="insert">10.2.1.  Liveness Testing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   An endpoint that sends packets <span class="insert">close to</span> the <span class="insert">effective</span> timeout risks</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   having <span class="insert">them be</span> discarded <span class="insert">at</span> the <span class="insert">peer, since the peer might enter its</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   draining state before <span class="insert">these</span> packets arrive.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">An endpoint can send</span> a <span class="insert">PING or another ack-eliciting frame to test</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the connection for liveness if the</span> peer could <span class="insert">time out soon, such as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   within <span class="insert">a PTO;</span> see Section <span class="insert">6.2</span> of <span class="insert">[QUIC-RECOVERY].  This is especially</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   useful if any available application data cannot be safely retried.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Note that the application determines what data is safe to retry.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">10.2.2.  Deferring Idle Timeout</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint might need to send ack-eliciting packets to avoid an idle</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   timeout if</span> it is <span class="insert">expecting response data, but does not have or is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   unable</span> to <span class="insert">send application data.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An implementation of QUIC might provide applications with an option</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to defer an idle timeout.  This facility could be used when the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   application wishes to avoid losing state that has been associated</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   with an open connection, but does not expect to exchange application</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   data</span> for <span class="insert">some time.  With this option, an endpoint could send a PING</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frame periodically to defer an idle timeout; see Section 19.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Application protocols that use QUIC SHOULD provide guidance on when</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   deferring an idle timeout is appropriate.  Unnecessary</span> sending <span class="insert">of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   PING frames could have a detrimental effect on performance.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A connection will time out if no packets are sent or received for a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   period longer than the time negotiated using the max_idle_timeout</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transport parameter; see Section 10.  However, state in middleboxes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   might time out earlier than that.  Though REQ-5 in [RFC4787]</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   recommends a 2 minute timeout interval, experience shows</span> that <span class="insert">sending</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets every 15 to 30 seconds is necessary to prevent the majority</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of middleboxes from losing state for UDP flows.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">10.3.  Immediate Close</td><td> </td><td class="right">10.3.  Immediate Close</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint sends a CONNECTION_CLOSE frame (Section 19.19) to</td><td> </td><td class="right">   An endpoint sends a CONNECTION_CLOSE frame (Section 19.19) to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   terminate the connection immediately.  A CONNECTION_CLOSE frame</td><td> </td><td class="right">   terminate the connection immediately.  A CONNECTION_CLOSE frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   causes all streams to immediately become closed; open streams can be</td><td> </td><td class="right">   causes all streams to immediately become closed; open streams can be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   assumed to be implicitly reset.</td><td> </td><td class="right">   assumed to be implicitly reset.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0261"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   After sending a CONNECTION_CLOSE frame, <span class="delete">endpoints</span> immediately <span class="delete">enter</span></td><td> </td><td class="rblock">   After sending a CONNECTION_CLOSE frame, <span class="insert">an endpoint</span> immediately</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the closing state.  During the closing period, an endpoint that sends</td><td> </td><td class="rblock">   <span class="insert">enters</span> the closing state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a CONNECTION_CLOSE frame SHOULD respond to any packet that <span class="delete">it</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   receives</span> with another packet containing a CONNECTION_CLOSE frame.  <span class="delete">To</span></td><td> </td><td class="rblock">   During the closing period, an endpoint that sends a CONNECTION_CLOSE</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   minimize the state that</span> an endpoint <span class="delete">maintains for a closing</span></td><td> </td><td class="rblock">   frame SHOULD respond to any <span class="insert">incoming</span> packet that <span class="insert">can be decrypted</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   connection, endpoints MAY send the exact same packet.  However,</span></td><td> </td><td class="rblock">   with another packet containing a CONNECTION_CLOSE frame.  <span class="insert">Such</span> an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   endpoints</span> SHOULD limit the number of packets <span class="delete">they generate</span> containing</td><td> </td><td class="rblock">   endpoint SHOULD limit the number of packets <span class="insert">it generates</span> containing a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a CONNECTION_CLOSE frame.  For instance, an endpoint could</td><td> </td><td class="rblock">   CONNECTION_CLOSE frame.  For instance, an endpoint could <span class="insert">wait for a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   progressively <span class="delete">increase the</span> number of packets that it <span class="delete">receives before</span></td><td> </td><td class="rblock">   progressively <span class="insert">increasing</span> number of <span class="insert">received</span> packets <span class="insert">or amount of time</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   sending additional</span> packets <span class="delete">or increase</span> the <span class="delete">time between packets.</span></td><td> </td><td class="rblock"><span class="insert">   before responding to a received packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint is allowed to drop the packet protection keys when</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   entering the closing period (Section 10.1) and send a packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   containing a CONNECTION_CLOSE in response to any UDP datagram</span> that <span class="insert">is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   received.  However, an endpoint without the packet protection keys</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   cannot identify and discard invalid packets.  To avoid creating an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   unwitting amplification attack, such endpoints MUST reduce the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frequency with which</span> it <span class="insert">sends</span> packets <span class="insert">containing a CONNECTION_CLOSE</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frame.  To minimize</span> the <span class="insert">state that an endpoint maintains for a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   closing connection, endpoints MAY send the exact same packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Note:  Allowing retransmission of a closing packet contradicts other</td><td> </td><td class="right">   Note:  Allowing retransmission of a closing packet contradicts other</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      advice in this document that recommends the creation of new packet</td><td> </td><td class="right">      advice in this document that recommends the creation of new packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      numbers for every packet.  Sending new packet numbers is primarily</td><td> </td><td class="right">      numbers for every packet.  Sending new packet numbers is primarily</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of advantage to loss recovery and congestion control, which are</td><td> </td><td class="right">      of advantage to loss recovery and congestion control, which are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      not expected to be relevant for a closed connection.</td><td> </td><td class="right">      not expected to be relevant for a closed connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Retransmitting the final packet requires less state.</td><td> </td><td class="right">      Retransmitting the final packet requires less state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   New packets from unverified addresses could be used to create an</td><td> </td><td class="right">   New packets from unverified addresses could be used to create an</td><td class="lineno"></td></tr>
      <tr id="diff0262"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   amplification attack<span class="delete"> (see Section 8)</span>.  To avoid this, endpoints MUST</td><td> </td><td class="rblock">   amplification attack<span class="insert">; see Section 8</span>.  To avoid this, endpoints MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   either limit transmission of CONNECTION_CLOSE frames to validated</td><td> </td><td class="right">   either limit transmission of CONNECTION_CLOSE frames to validated</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   addresses or drop packets without response if the response would be</td><td> </td><td class="right">   addresses or drop packets without response if the response would be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   more than three times larger than the received packet.</td><td> </td><td class="right">   more than three times larger than the received packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   After receiving a CONNECTION_CLOSE frame, endpoints enter the</td><td> </td><td class="right">   After receiving a CONNECTION_CLOSE frame, endpoints enter the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   draining state.  An endpoint that receives a CONNECTION_CLOSE frame</td><td> </td><td class="right">   draining state.  An endpoint that receives a CONNECTION_CLOSE frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MAY send a single packet containing a CONNECTION_CLOSE frame before</td><td> </td><td class="right">   MAY send a single packet containing a CONNECTION_CLOSE frame before</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   entering the draining state, using a CONNECTION_CLOSE frame and a</td><td> </td><td class="right">   entering the draining state, using a CONNECTION_CLOSE frame and a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   NO_ERROR code if appropriate.  An endpoint MUST NOT send further</td><td> </td><td class="right">   NO_ERROR code if appropriate.  An endpoint MUST NOT send further</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets, which could result in a constant exchange of</td><td> </td><td class="right">   packets, which could result in a constant exchange of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   CONNECTION_CLOSE frames until the closing period on either peer</td><td> </td><td class="right">   CONNECTION_CLOSE frames until the closing period on either peer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ended.</td><td> </td><td class="right">   ended.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An immediate close can be used after an application protocol has</td><td> </td><td class="right">   An immediate close can be used after an application protocol has</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   arranged to close a connection.  This might be after the application</td><td> </td><td class="right">   arranged to close a connection.  This might be after the application</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protocols negotiates a graceful shutdown.  The application protocol</td><td> </td><td class="right">   protocols negotiates a graceful shutdown.  The application protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   exchanges whatever messages that are needed to cause both endpoints</td><td> </td><td class="right">   exchanges whatever messages that are needed to cause both endpoints</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to agree to close the connection, after which the application</td><td> </td><td class="right">   to agree to close the connection, after which the application</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   requests that the connection be closed.  The application protocol can</td><td> </td><td class="right">   requests that the connection be closed.  The application protocol can</td><td class="lineno"></td></tr>
      <tr id="diff0263"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   use <span class="delete">an</span> CONNECTION_CLOSE frame with an appropriate error code to</td><td> </td><td class="rblock">   use <span class="insert">a</span> CONNECTION_CLOSE frame with an appropriate error code to signal</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   signal closure.</td><td> </td><td class="rblock">   closure.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0264"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If</span> the <span class="delete">connection has been successfully established, endpoints</span> MUST</td><td> </td><td class="rblock"><span class="insert">10.3.1.  Immediate Close During</span> the <span class="insert">Handshake</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   send any CONNECTION_CLOSE frames in a 1-RTT packet.  <span class="delete">Prior</span> to</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">connection establishment a peer might</span> not <span class="delete">have 1-RTT keys,</span> so</td><td> </td><td class="rblock"><span class="insert">   When sending CONNECTION_CLOSE, the goal is to ensure that the peer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">endpoints SHOULD send</span> CONNECTION_CLOSE <span class="delete">frames</span> in a <span class="delete">Handshake packet.</span></td><td> </td><td class="rblock"><span class="insert">   will process the frame.  Generally, this means sending the frame in a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   If</span> the <span class="delete">endpoint does not have</span> Handshake <span class="delete">keys, or</span> it is <span class="delete">not certain</span></td><td> </td><td class="rblock"><span class="insert">   packet with the highest level of packet protection to avoid the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that the <span class="delete">peer</span> has Handshake <span class="delete">keys,</span> it <span class="delete">MAY</span> send CONNECTION_CLOSE <span class="delete">frames</span></td><td> </td><td class="rblock"><span class="insert">   packet being discarded.  After the handshake is confirmed (see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   in an Initial packet.  <span class="delete">If</span> multiple <span class="delete">packets are sent, they</span> can be</td><td> </td><td class="rblock"><span class="insert">   Section 4.1.2 of [QUIC-TLS]), an endpoint</span> MUST send any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   coalesced <span class="delete">(see</span> Section <span class="delete">12.2)</span> to <span class="delete">facilitate retransmission.</span></td><td> </td><td class="rblock">   CONNECTION_CLOSE frames in a 1-RTT packet.  <span class="insert">However, prior</span> to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">confirming the handshake, it is possible that more advanced packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   protection keys are</span> not <span class="insert">available to the peer,</span> so <span class="insert">another</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   CONNECTION_CLOSE <span class="insert">frame MAY be sent</span> in a <span class="insert">packet that uses a lower</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet protection level.  More specifically:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  A client will always know whether</span> the <span class="insert">server has</span> Handshake <span class="insert">keys</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (see Section 17.2.2.1), but</span> it is <span class="insert">possible</span> that <span class="insert">a server does not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      know whether</span> the <span class="insert">client</span> has Handshake <span class="insert">keys.  Under these</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      circumstances, a server SHOULD send a CONNECTION_CLOSE frame in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      both Handshake and Initial packets to ensure that at least one of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      them is processable by the client.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  A client that sends CONNECTION_CLOSE in a 0-RTT packet cannot be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      assured of the server has accepted 0-RTT and so sending a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      CONNECTION_CLOSE frame in an Initial packet makes</span> it <span class="insert">more likely</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      that the server can receive the close signal, even if the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      application error code might not be received.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Prior to confirming the handshake, a peer might be unable to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      process 1-RTT packets, so an endpoint SHOULD send CONNECTION_CLOSE</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      in both Handshake and 1-RTT packets.  A server SHOULD also</span> send</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      CONNECTION_CLOSE in an Initial packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Sending a CONNECTION_CLOSE of type 0x1d in an Initial or Handshake</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet could expose application state or be used to alter application</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   state.  A CONNECTION_CLOSE of type 0x1d MUST be replaced by a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   CONNECTION_CLOSE of type 0x1c when sending the frame in Initial or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Handshake packets.  Otherwise, information about the application</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   state might be revealed.  Endpoints MUST clear the value of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Reason Phrase field and SHOULD use the APPLICATION_ERROR code when</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   converting to a CONNECTION_CLOSE of type 0x1c.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   CONNECTION_CLOSE frames sent in</span> multiple <span class="insert">packet types</span> can be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   coalesced <span class="insert">into a single UDP datagram; see</span> Section <span class="insert">12.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint might send a CONNECTION_CLOSE frame in an Initial packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   or in response to unauthenticated information received in Initial or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Handshake packets.  Such an immediate close might expose legitimate</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connections</span> to <span class="insert">a denial of service.  QUIC does not include defensive</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   measures for on-path attacks during the handshake; see Section 21.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   However, at the cost of reducing feedback about errors for legitimate</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   peers, some forms of denial of service can be made more difficult for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   an attacker if endpoints discard illegal packets rather than</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   terminating a connection with CONNECTION_CLOSE.  For this reason,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   endpoints MAY discard packets rather than immediately close if errors</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   are detected in packets that lack authentication.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint that has not established state, such as a server that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   detects an error in an Initial packet, does not enter the closing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   state.  An endpoint that has no state for the connection does not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   enter a closing or draining period on sending a CONNECTION_CLOSE</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frame.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">10.4.  Stateless Reset</td><td> </td><td class="right">10.4.  Stateless Reset</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A stateless reset is provided as an option of last resort for an</td><td> </td><td class="right">   A stateless reset is provided as an option of last resort for an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint that does not have access to the state of a connection.  A</td><td> </td><td class="right">   endpoint that does not have access to the state of a connection.  A</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   crash or outage might result in peers continuing to send data to an</td><td> </td><td class="right">   crash or outage might result in peers continuing to send data to an</td><td class="lineno"></td></tr>
      <tr id="diff0265"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   endpoint that is unable to properly continue the connection.  A</td><td> </td><td class="rblock">   endpoint that is unable to properly continue the connection.  <span class="insert">An</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   stateless reset is not appropriate for signaling error conditions.</td><td> </td><td class="rblock"><span class="insert">   endpoint MAY send a stateless reset in response to receiving a packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that it cannot associate with an active connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   A stateless reset is not appropriate for signaling error conditions.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint that wishes to communicate a fatal connection error MUST</td><td> </td><td class="right">   An endpoint that wishes to communicate a fatal connection error MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   use a CONNECTION_CLOSE frame if it has sufficient state to do so.</td><td> </td><td class="right">   use a CONNECTION_CLOSE frame if it has sufficient state to do so.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   To support this process, a token is sent by endpoints.  The token is</td><td> </td><td class="right">   To support this process, a token is sent by endpoints.  The token is</td><td class="lineno"></td></tr>
      <tr id="diff0266"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   carried in the NEW_CONNECTION_ID <span class="delete">frame sent by either peer, and</span></td><td> </td><td class="rblock">   carried in the <span class="insert">Stateless Reset Token field of a</span> NEW_CONNECTION_ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   servers</span> can specify <span class="delete">the</span> stateless_reset_token transport parameter</td><td> </td><td class="rblock">   <span class="insert">frame.  Servers</span> can <span class="insert">also</span> specify <span class="insert">a</span> stateless_reset_token transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   during the handshake <span class="delete">(clients</span> cannot because their transport</td><td> </td><td class="rblock">   parameter during the handshake <span class="insert">that applies to the connection ID that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   parameters don't have confidentiality <span class="delete">protection).  This value is</span></td><td> </td><td class="rblock"><span class="insert">   it selected during the handshake; clients</span> cannot <span class="insert">use this transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   protected by encryption, so only client and server know <span class="delete">this</span> value.</td><td> </td><td class="rblock"><span class="insert">   parameter</span> because their transport parameters don't have</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Tokens are invalidated when their associated connection ID is retired</td><td> </td><td class="rblock">   confidentiality <span class="insert">protection.  These tokens are</span> protected by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   via a RETIRE_CONNECTION_ID frame (Section 19.16).</td><td> </td><td class="rblock">   encryption, so only client and server know <span class="insert">their</span> value.  Tokens are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   invalidated when their associated connection ID is retired via a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   RETIRE_CONNECTION_ID frame (Section 19.16).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint that receives packets that it cannot process sends a</td><td> </td><td class="right">   An endpoint that receives packets that it cannot process sends a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet in the following layout:</td><td> </td><td class="right">   packet in the following layout:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0267"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">Stateless Reset {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Fixed Bits (2) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Unpredictable Bits <span class="insert">(38..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |0|1|</span>               Unpredictable Bits <span class="delete">(182..)                ...</span></td><td> </td><td class="rblock">     Stateless Reset Token <span class="insert">(128),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +                                                               +</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +</span>                   Stateless Reset Token <span class="delete">(128)                 +</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +                                                               +</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0268"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                     <span class="delete">Figure 7</span>: Stateless Reset Packet</td><td> </td><td class="rblock">                     <span class="insert"> Figure 9</span>: Stateless Reset Packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This design ensures that a stateless reset packet is - to the extent</td><td> </td><td class="right">   This design ensures that a stateless reset packet is - to the extent</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   possible - indistinguishable from a regular packet with a short</td><td> </td><td class="right">   possible - indistinguishable from a regular packet with a short</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   header.</td><td> </td><td class="right">   header.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A stateless reset uses an entire UDP datagram, starting with the</td><td> </td><td class="right">   A stateless reset uses an entire UDP datagram, starting with the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   first two bits of the packet header.  The remainder of the first byte</td><td> </td><td class="right">   first two bits of the packet header.  The remainder of the first byte</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and an arbitrary number of bytes following it that are set to</td><td> </td><td class="right">   and an arbitrary number of bytes following it that are set to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   unpredictable values.  The last 16 bytes of the datagram contain a</td><td> </td><td class="right">   unpredictable values.  The last 16 bytes of the datagram contain a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stateless Reset Token.</td><td> </td><td class="right">   Stateless Reset Token.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0269"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A</span> stateless reset will be <span class="delete">interpreted by a recipient as</span> a packet with</td><td> </td><td class="rblock">   <span class="insert">To entities other than its intended recipient, a</span> stateless reset will</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a short header.  For the <span class="delete">packet</span> to appear as <span class="delete">valid,</span> the <span class="delete">Random</span> Bits</td><td> </td><td class="rblock">   <span class="insert">appear to</span> be a packet with a short header.  For the <span class="insert">stateless reset</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   field needs to include at least <span class="delete">182</span> bits of data (or <span class="delete">23</span> bytes, less</td><td> </td><td class="rblock">   to appear as <span class="insert">a valid QUIC packet,</span> the <span class="insert">Unpredictable</span> Bits field needs</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the two fixed bits).  <span class="delete">This is intended to allow for a Destination</span></td><td> </td><td class="rblock">   to include at least <span class="insert">38</span> bits of data (or <span class="insert">5</span> bytes, less the two fixed</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Connection ID of the maximum length permitted, with a minimal packet</span></td><td> </td><td class="rblock">   bits).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   number, and payload.  The Stateless Reset Token corresponds to the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   minimum expansion of the packet protection AEAD.  More unpredictable</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   bytes might be necessary if the endpoint could have negotiated a</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet protection scheme with a larger minimum AEAD expansion.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0270"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   An endpoint SHOULD NOT send a stateless reset that is <span class="delete">significantly</span></td><td> </td><td class="rblock">   <span class="insert">A minimum size of 21 bytes does not guarantee that a stateless reset</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   larger than the packet it <span class="delete">receives.</span>  Endpoints MUST discard packets</td><td> </td><td class="rblock"><span class="insert">   is difficult to distinguish from other packets if the recipient</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that are too small to be valid QUIC packets.  With the set of AEAD</td><td> </td><td class="rblock"><span class="insert">   requires the use of a connection ID.  To prevent a resulting</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   functions defined in [QUIC-TLS], packets that are smaller than 21</td><td> </td><td class="rblock"><span class="insert">   stateless reset from being trivially distinguishable from a valid</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   bytes are never valid.</td><td> </td><td class="rblock"><span class="insert">   packet, all packets sent by an endpoint SHOULD be padded to at least</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   22 bytes longer than the minimum connection ID that the endpoint</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   might use.</span>  An endpoint <span class="insert">that sends a stateless reset in response to a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet that is 43 bytes or less in length</span> SHOULD <span class="insert">send a stateless</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   reset that is one byte shorter than the packet it responds to.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   These values assume that the Stateless Reset Token is the same length</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   as the minimum expansion of the packet protection AEAD.  Additional</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   unpredictable bytes are necessary if the endpoint could have</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   negotiated a packet protection scheme with a larger minimum</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   expansion.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint MUST</span> NOT send a stateless reset that is <span class="insert">three times or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   more</span> larger than the packet it <span class="insert">receives to avoid being used for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   amplification.  Section 10.4.3 describes additional limits on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   stateless reset size.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Endpoints MUST discard packets that are too small to be valid QUIC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   packets.  With the set of AEAD functions defined in [QUIC-TLS],</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   packets that are smaller than 21 bytes are never valid.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Endpoints MUST send stateless reset packets formatted as a packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   with a short header.  However, endpoints MUST treat any packet ending</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in a valid stateless reset token as a stateless reset, as other QUIC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   versions might allow the use of a long header.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MAY send a stateless reset in response to a packet with a</td><td> </td><td class="right">   An endpoint MAY send a stateless reset in response to a packet with a</td><td class="lineno"></td></tr>
      <tr id="diff0271"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   long header.  <span class="delete">This would</span> not <span class="delete">be</span> effective <span class="delete">if</span> the stateless reset</td><td> </td><td class="rblock">   long header.  <span class="insert">Sending a stateless reset is</span> not effective <span class="insert">prior to</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   token <span class="delete">was not yet</span> available to a peer.  In this QUIC version, packets</td><td> </td><td class="rblock">   stateless reset token <span class="insert">being</span> available to a peer.  In this QUIC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   with a long header are only used during connection establishment.</td><td> </td><td class="rblock">   version, packets with a long header are only used during connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Because the stateless reset token is not available until connection</td><td> </td><td class="rblock">   establishment.  Because the stateless reset token is not available</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   establishment is complete or near completion, ignoring an unknown</td><td> </td><td class="rblock">   until connection establishment is complete or near completion,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet with a long header might be <span class="delete">more effective.</span></td><td> </td><td class="rblock">   ignoring an unknown packet with a long header might be <span class="insert">as effective</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   as sending a stateless reset.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint cannot determine the Source Connection ID from a packet</td><td> </td><td class="right">   An endpoint cannot determine the Source Connection ID from a packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   with a short header, therefore it cannot set the Destination</td><td> </td><td class="right">   with a short header, therefore it cannot set the Destination</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Connection ID in the stateless reset packet.  The Destination</td><td> </td><td class="right">   Connection ID in the stateless reset packet.  The Destination</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Connection ID will therefore differ from the value used in previous</td><td> </td><td class="right">   Connection ID will therefore differ from the value used in previous</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets.  A random Destination Connection ID makes the connection ID</td><td> </td><td class="right">   packets.  A random Destination Connection ID makes the connection ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   appear to be the result of moving to a new connection ID that was</td><td> </td><td class="right">   appear to be the result of moving to a new connection ID that was</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provided using a NEW_CONNECTION_ID frame (Section 19.15).</td><td> </td><td class="right">   provided using a NEW_CONNECTION_ID frame (Section 19.15).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Using a randomized connection ID results in two problems:</td><td> </td><td class="right">   Using a randomized connection ID results in two problems:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0272"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The packet might not reach the peer.  If the Destination</td><td> </td><td class="rblock">   <span class="insert">*</span>  The packet might not reach the peer.  If the Destination</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Connection ID is critical for routing toward the peer, then this</td><td> </td><td class="right">      Connection ID is critical for routing toward the peer, then this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      packet could be incorrectly routed.  This might also trigger</td><td> </td><td class="right">      packet could be incorrectly routed.  This might also trigger</td><td class="lineno"></td></tr>
      <tr id="diff0273"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      another Stateless Reset in response<span class="delete">,</span> see Section 10.4.3.  A</td><td> </td><td class="rblock">      another Stateless Reset in response<span class="insert">;</span> see Section 10.4.3.  A</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Stateless Reset that is not correctly routed is an ineffective</td><td> </td><td class="right">      Stateless Reset that is not correctly routed is an ineffective</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      error detection and recovery mechanism.  In this case, endpoints</td><td> </td><td class="right">      error detection and recovery mechanism.  In this case, endpoints</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      will need to rely on other methods - such as timers - to detect</td><td> </td><td class="right">      will need to rely on other methods - such as timers - to detect</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      that the connection has failed.</td><td> </td><td class="right">      that the connection has failed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0274"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The randomly generated connection ID can be used by entities other</td><td> </td><td class="rblock">   <span class="insert">*</span>  The randomly generated connection ID can be used by entities other</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      than the peer to identify this as a potential stateless reset.  An</td><td> </td><td class="right">      than the peer to identify this as a potential stateless reset.  An</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      endpoint that occasionally uses different connection IDs might</td><td> </td><td class="right">      endpoint that occasionally uses different connection IDs might</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      introduce some uncertainty about this.</td><td> </td><td class="right">      introduce some uncertainty about this.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0275"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Finally, the last 16 bytes of the packet are set to the value of the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Stateless Reset Token.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This stateless reset design is specific to QUIC version 1.  An</td><td> </td><td class="right">   This stateless reset design is specific to QUIC version 1.  An</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint that supports multiple versions of QUIC needs to generate a</td><td> </td><td class="right">   endpoint that supports multiple versions of QUIC needs to generate a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stateless reset that will be accepted by peers that support any</td><td> </td><td class="right">   stateless reset that will be accepted by peers that support any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   version that the endpoint might support (or might have supported</td><td> </td><td class="right">   version that the endpoint might support (or might have supported</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   prior to losing state).  Designers of new versions of QUIC need to be</td><td> </td><td class="right">   prior to losing state).  Designers of new versions of QUIC need to be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   aware of this and either reuse this design, or use a portion of the</td><td> </td><td class="right">   aware of this and either reuse this design, or use a portion of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet other than the last 16 bytes for carrying data.</td><td> </td><td class="right">   packet other than the last 16 bytes for carrying data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">10.4.1.  Detecting a Stateless Reset</td><td> </td><td class="right">10.4.1.  Detecting a Stateless Reset</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0276"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   An endpoint detects a potential stateless reset <span class="delete">when</span> a <span class="delete">incoming</span></td><td> </td><td class="rblock">   An endpoint detects a potential stateless reset <span class="insert">using the trailing 16</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet</span> with a <span class="delete">short header</span> either cannot be associated with a</td><td> </td><td class="rblock"><span class="insert">   bytes of the UDP datagram.  An endpoint remembers all Stateless Reset</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection, cannot be <span class="delete">decrypted,</span> or <span class="delete">is marked as</span> a <span class="delete">duplicate packet.</span></td><td> </td><td class="rblock"><span class="insert">   Tokens associated with the connection IDs and remote addresses for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   The endpoint then compares</span> the <span class="delete">last 16 bytes</span> of the <span class="delete">packet with</span> the</td><td> </td><td class="rblock"><span class="insert">   datagrams it has recently sent.  This includes Stateless Reset Tokens</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Stateless Reset <span class="delete">Token provided by its peer, either in</span> a</td><td> </td><td class="rblock"><span class="insert">   from NEW_CONNECTION_ID frames and the server's transport parameters</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">NEW_CONNECTION_ID frame</span> or the <span class="delete">server's transport parameters.</span>  If</td><td> </td><td class="rblock"><span class="insert">   but excludes Stateless Reset Tokens associated with connection IDs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">these values</span> are <span class="delete">identical,</span> the endpoint MUST enter the draining</td><td> </td><td class="rblock"><span class="insert">   that are either unused or retired.  The endpoint identifies</span> a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   period and not send any further packets on this connection.  <span class="delete">If the</span></td><td> </td><td class="rblock">   <span class="insert">received datagram as a stateless reset by comparing the last 16 bytes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   comparison fails, the packet can be discarded.</span></td><td> </td><td class="rblock"><span class="insert">   of the datagram with all Stateless Reset Tokens associated</span> with <span class="insert">the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   remote address on which the datagram was received.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This comparison can be performed for every inbound datagram.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Endpoints MAY skip this check if any packet from</span> a <span class="insert">datagram is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   successfully processed.  However, the comparison MUST be performed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   when the first packet in an incoming datagram</span> either cannot be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   associated with a connection, <span class="insert">or</span> cannot be <span class="insert">decrypted.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint MUST NOT check for any Stateless Reset Tokens associated</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   with connection IDs it has not used</span> or <span class="insert">for connection IDs that have</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   been retired.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   When comparing</span> a <span class="insert">datagram to Stateless Reset Token values, endpoints</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   MUST perform</span> the <span class="insert">comparison without leaking information about the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   value</span> of the <span class="insert">token.  For example, performing this comparison in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   constant time protects</span> the <span class="insert">value of individual</span> Stateless Reset <span class="insert">Tokens</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   from information leakage through timing side channels.  Another</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   approach would be to store and compare the transformed values of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Stateless Reset Tokens instead of the raw token values, where the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transformation is defined as</span> a <span class="insert">cryptographically-secure pseudo-random</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   function using a secret key (e.g., block cipher, HMAC [RFC2104]).  An</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   endpoint is not expected to protect information about whether a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet was successfully decrypted,</span> or the <span class="insert">number of valid Stateless</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Reset Tokens.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   If <span class="insert">the last 16 bytes of the datagram</span> are <span class="insert">identical in value to a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Stateless Reset Token,</span> the endpoint MUST enter the draining period</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   and not send any further packets on this connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">10.4.2.  Calculating a Stateless Reset Token</td><td> </td><td class="right">10.4.2.  Calculating a Stateless Reset Token</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The stateless reset token MUST be difficult to guess.  In order to</td><td> </td><td class="right">   The stateless reset token MUST be difficult to guess.  In order to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   create a Stateless Reset Token, an endpoint could randomly generate</td><td> </td><td class="right">   create a Stateless Reset Token, an endpoint could randomly generate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC4086] a secret for every connection that it creates.  However,</td><td> </td><td class="right">   [RFC4086] a secret for every connection that it creates.  However,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   this presents a coordination problem when there are multiple</td><td> </td><td class="right">   this presents a coordination problem when there are multiple</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   instances in a cluster or a storage problem for an endpoint that</td><td> </td><td class="right">   instances in a cluster or a storage problem for an endpoint that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   might lose state.  Stateless reset specifically exists to handle the</td><td> </td><td class="right">   might lose state.  Stateless reset specifically exists to handle the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   case where state is lost, so this approach is suboptimal.</td><td> </td><td class="right">   case where state is lost, so this approach is suboptimal.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-17" class="change"><td></td><th><small>skipping to change at</small><a href="#part-17"><em> page 58, line 42<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-17"><em> page 74, line 40<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets so that the endpoint can use the connection ID from a packet</td><td> </td><td class="right">   packets so that the endpoint can use the connection ID from a packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to reset the connection.  An endpoint that uses this design MUST</td><td> </td><td class="right">   to reset the connection.  An endpoint that uses this design MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   either use the same connection ID length for all connections or</td><td> </td><td class="right">   either use the same connection ID length for all connections or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   encode the length of the connection ID such that it can be recovered</td><td> </td><td class="right">   encode the length of the connection ID such that it can be recovered</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   without state.  In addition, it cannot provide a zero-length</td><td> </td><td class="right">   without state.  In addition, it cannot provide a zero-length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection ID.</td><td> </td><td class="right">   connection ID.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Revealing the Stateless Reset Token allows any entity to terminate</td><td> </td><td class="right">   Revealing the Stateless Reset Token allows any entity to terminate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the connection, so a value can only be used once.  This method for</td><td> </td><td class="right">   the connection, so a value can only be used once.  This method for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   choosing the Stateless Reset Token means that the combination of</td><td> </td><td class="right">   choosing the Stateless Reset Token means that the combination of</td><td class="lineno"></td></tr>
      <tr id="diff0277"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection ID and static key <span class="delete">cannot occur</span> for another connection.  A</td><td> </td><td class="rblock">   connection ID and static key <span class="insert">MUST NOT be used</span> for another connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   denial of service attack is possible if the same connection ID is</td><td> </td><td class="rblock">   A denial of service attack is possible if the same connection ID is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   used by instances that share a static key, or if an attacker can</td><td> </td><td class="right">   used by instances that share a static key, or if an attacker can</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   cause a packet to be routed to an instance that has no state but the</td><td> </td><td class="right">   cause a packet to be routed to an instance that has no state but the</td><td class="lineno"></td></tr>
      <tr id="diff0278"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   same static <span class="delete">key (see</span> Section <span class="delete">21.8).</span>  A connection ID from a</td><td> </td><td class="rblock">   same static <span class="insert">key; see</span> Section <span class="insert">21.9.</span>  A connection ID from a connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection that is reset by revealing the Stateless Reset Token</td><td> </td><td class="rblock">   that is reset by revealing the Stateless Reset Token <span class="insert">MUST NOT</span> be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">cannot</span> be reused for new connections at nodes that share a static</td><td> </td><td class="rblock">   reused for new connections at nodes that share a static key.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   key.</td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">The same Stateless Reset Token MUST NOT be used for multiple</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection IDs.  Endpoints are not required to compare new values</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   against all previous values, but a duplicate value MAY be treated as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   a connection error of type PROTOCOL_VIOLATION.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Note that Stateless Reset packets do not have any cryptographic</td><td> </td><td class="right">   Note that Stateless Reset packets do not have any cryptographic</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protection.</td><td> </td><td class="right">   protection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">10.4.3.  Looping</td><td> </td><td class="right">10.4.3.  Looping</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The design of a Stateless Reset is such that without knowing the</td><td> </td><td class="right">   The design of a Stateless Reset is such that without knowing the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stateless reset token it is indistinguishable from a valid packet.</td><td> </td><td class="right">   stateless reset token it is indistinguishable from a valid packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   For instance, if a server sends a Stateless Reset to another server</td><td> </td><td class="right">   For instance, if a server sends a Stateless Reset to another server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   it might receive another Stateless Reset in response, which could</td><td> </td><td class="right">   it might receive another Stateless Reset in response, which could</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-18" class="change"><td></td><th><small>skipping to change at</small><a href="#part-18"><em> page 59, line 28<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-18"><em> page 75, line 28<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   sufficient to prevent looping.  In the event of a loop, this results</td><td> </td><td class="right">   sufficient to prevent looping.  In the event of a loop, this results</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   in packets eventually being too small to trigger a response.</td><td> </td><td class="right">   in packets eventually being too small to trigger a response.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint can remember the number of Stateless Reset packets that</td><td> </td><td class="right">   An endpoint can remember the number of Stateless Reset packets that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   it has sent and stop generating new Stateless Reset packets once a</td><td> </td><td class="right">   it has sent and stop generating new Stateless Reset packets once a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   limit is reached.  Using separate limits for different remote</td><td> </td><td class="right">   limit is reached.  Using separate limits for different remote</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   addresses will ensure that Stateless Reset packets can be used to</td><td> </td><td class="right">   addresses will ensure that Stateless Reset packets can be used to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   close connections when other peers or connections have exhausted</td><td> </td><td class="right">   close connections when other peers or connections have exhausted</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   limits.</td><td> </td><td class="right">   limits.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0279"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Reducing the size of a Stateless Reset below <span class="delete">the recommended minimum</span></td><td> </td><td class="rblock">   Reducing the size of a Stateless Reset below <span class="insert">41</span> bytes <span class="insert">means</span> that the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   size of 39</span> bytes <span class="delete">could mean</span> that the packet could reveal to an</td><td> </td><td class="rblock">   packet could reveal to an observer that it is a Stateless <span class="insert">Reset,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   observer that it is a Stateless <span class="delete">Reset.</span>  Conversely, refusing to send</td><td> </td><td class="rblock"><span class="insert">   depending upon the length of the peer's connection IDs.</span>  Conversely,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a Stateless Reset in response to a small packet might result in</td><td> </td><td class="rblock">   refusing to send a Stateless Reset in response to a small packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Stateless Reset not being useful in detecting cases of broken</td><td> </td><td class="rblock">   might result in Stateless Reset not being useful in detecting cases</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connections where only very small packets are sent; such failures</td><td> </td><td class="rblock">   of broken connections where only very small packets are sent; such</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   might only be detected by other means, such as timers.</td><td> </td><td class="rblock">   failures might only be detected by other means, such as timers.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">An endpoint can increase the odds that a packet will trigger a</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Stateless Reset if it cannot be processed by padding it to at least</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   40 bytes.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">11.  Error Handling</td><td> </td><td class="right">11.  Error Handling</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint that detects an error SHOULD signal the existence of that</td><td> </td><td class="right">   An endpoint that detects an error SHOULD signal the existence of that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   error to its peer.  Both transport-level and application-level errors</td><td> </td><td class="right">   error to its peer.  Both transport-level and application-level errors</td><td class="lineno"></td></tr>
      <tr id="diff0280"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   can affect an entire <span class="delete">connection (see</span> Section <span class="delete">11.1), while only</span></td><td> </td><td class="rblock">   can affect an entire <span class="insert">connection; see</span> Section <span class="insert">11.1.  Only application-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   application-level</span> errors can be isolated to a single <span class="delete">stream (see</span></td><td> </td><td class="rblock"><span class="insert">   level</span> errors can be isolated to a single <span class="insert">stream; see</span> Section <span class="insert">11.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">11.2).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The most appropriate error code (Section 20) SHOULD be included in</td><td> </td><td class="right">   The most appropriate error code (Section 20) SHOULD be included in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the frame that signals the error.  Where this specification</td><td> </td><td class="right">   the frame that signals the error.  Where this specification</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   identifies error conditions, it also identifies the error code that</td><td> </td><td class="right">   identifies error conditions, it also identifies the error code that</td><td class="lineno"></td></tr>
      <tr id="diff0281"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   is <span class="delete">used.</span></td><td> </td><td class="rblock">   is <span class="insert">used; though these are worded as requirements, different</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   implementation strategies might lead to different errors being</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   reported.  In particular, an endpoint MAY use any applicable error</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   code when it detects an error condition; a generic error code (such</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   as PROTOCOL_VIOLATION or INTERNAL_ERROR) can always be used in place</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of specific error codes.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A stateless reset (Section 10.4) is not suitable for any error that</td><td> </td><td class="right">   A stateless reset (Section 10.4) is not suitable for any error that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   can be signaled with a CONNECTION_CLOSE or RESET_STREAM frame.  A</td><td> </td><td class="right">   can be signaled with a CONNECTION_CLOSE or RESET_STREAM frame.  A</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stateless reset MUST NOT be used by an endpoint that has the state</td><td> </td><td class="right">   stateless reset MUST NOT be used by an endpoint that has the state</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   necessary to send a frame on the connection.</td><td> </td><td class="right">   necessary to send a frame on the connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">11.1.  Connection Errors</td><td> </td><td class="right">11.1.  Connection Errors</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Errors that result in the connection being unusable, such as an</td><td> </td><td class="right">   Errors that result in the connection being unusable, such as an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   obvious violation of protocol semantics or corruption of state that</td><td> </td><td class="right">   obvious violation of protocol semantics or corruption of state that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   affects an entire connection, MUST be signaled using a</td><td> </td><td class="right">   affects an entire connection, MUST be signaled using a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   CONNECTION_CLOSE frame (Section 19.19).  An endpoint MAY close the</td><td> </td><td class="right">   CONNECTION_CLOSE frame (Section 19.19).  An endpoint MAY close the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection in this manner even if the error only affects a single</td><td> </td><td class="right">   connection in this manner even if the error only affects a single</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream.</td><td> </td><td class="right">   stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Application protocols can signal application-specific protocol errors</td><td> </td><td class="right">   Application protocols can signal application-specific protocol errors</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   using the application-specific variant of the CONNECTION_CLOSE frame.</td><td> </td><td class="right">   using the application-specific variant of the CONNECTION_CLOSE frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Errors that are specific to the transport, including all those</td><td> </td><td class="right">   Errors that are specific to the transport, including all those</td><td class="lineno"></td></tr>
      <tr id="diff0282"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   described in this document, are carried the QUIC-specific variant of</td><td> </td><td class="rblock">   described in this document, are carried <span class="insert">in</span> the QUIC-specific variant</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the CONNECTION_CLOSE frame.</td><td> </td><td class="rblock">   of the CONNECTION_CLOSE frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A CONNECTION_CLOSE frame could be sent in a packet that is lost.  An</td><td> </td><td class="right">   A CONNECTION_CLOSE frame could be sent in a packet that is lost.  An</td><td class="lineno"></td></tr>
      <tr id="diff0283"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   endpoint SHOULD be prepared to retransmit a packet containing</td><td> </td><td class="rblock">   endpoint SHOULD be prepared to retransmit a packet containing a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">containing</span> a CONNECTION_CLOSE frame if it receives more packets on a</td><td> </td><td class="rblock">   CONNECTION_CLOSE frame if it receives more packets on a terminated</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   terminated connection.  Limiting the number of retransmissions and</td><td> </td><td class="rblock">   connection.  Limiting the number of retransmissions and the time over</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the time over which this final packet is sent limits the effort</td><td> </td><td class="rblock">   which this final packet is sent limits the effort expended on</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   expended on terminated connections.</td><td> </td><td class="rblock">   terminated connections.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint that chooses not to retransmit packets containing a</td><td> </td><td class="right">   An endpoint that chooses not to retransmit packets containing a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   CONNECTION_CLOSE frame risks a peer missing the first such packet.</td><td> </td><td class="right">   CONNECTION_CLOSE frame risks a peer missing the first such packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The only mechanism available to an endpoint that continues to receive</td><td> </td><td class="right">   The only mechanism available to an endpoint that continues to receive</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   data for a terminated connection is to use the stateless reset</td><td> </td><td class="right">   data for a terminated connection is to use the stateless reset</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   process (Section 10.4).</td><td> </td><td class="right">   process (Section 10.4).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0284"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">An endpoint that receives an invalid CONNECTION_CLOSE frame MUST NOT</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   signal the existence of the error to its peer.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">11.2.  Stream Errors</td><td> </td><td class="right">11.2.  Stream Errors</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If an application-level error affects a single stream, but otherwise</td><td> </td><td class="right">   If an application-level error affects a single stream, but otherwise</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   leaves the connection in a recoverable state, the endpoint can send a</td><td> </td><td class="right">   leaves the connection in a recoverable state, the endpoint can send a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   RESET_STREAM frame (Section 19.4) with an appropriate error code to</td><td> </td><td class="right">   RESET_STREAM frame (Section 19.4) with an appropriate error code to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   terminate just the affected stream.</td><td> </td><td class="right">   terminate just the affected stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0285"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   RESET_STREAM MUST be instigated by the protocol <span class="delete">using QUIC, either</span></td><td> </td><td class="rblock">   <span class="insert">Resetting a stream without the involvement of the application</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   directly or through the receipt</span> of <span class="delete">a STOP_SENDING frame from a peer.</span></td><td> </td><td class="rblock"><span class="insert">   protocol could cause the application protocol to enter an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   RESET_STREAM carries an</span> application error <span class="delete">code.  Resetting</span> a stream</td><td> </td><td class="rblock"><span class="insert">   unrecoverable state.</span>  RESET_STREAM MUST <span class="insert">only</span> be instigated by the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">without knowledge</span> of the application protocol <span class="delete">could cause</span> the</td><td> </td><td class="rblock">   <span class="insert">application</span> protocol <span class="insert">that uses QUIC.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">protocol to enter</span> an <span class="delete">unrecoverable state.</span>  Application protocols</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">might require certain</span> streams <span class="delete">to be reliably delivered in order to</span></td><td> </td><td class="rblock"><span class="insert">   The semantics</span> of <span class="insert">the</span> application error <span class="insert">code carried in RESET_STREAM</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   guarantee consistent state between endpoints.</span></td><td> </td><td class="rblock"><span class="insert">   are defined by the application protocol.  Only the application</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   protocol is able to cause</span> a stream <span class="insert">to be terminated.  A local</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   instance</span> of the application protocol <span class="insert">uses a direct API call and a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   remote instance uses</span> the <span class="insert">STOP_SENDING frame, which triggers</span> an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">automatic RESET_STREAM.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Application protocols <span class="insert">SHOULD define rules for handling</span> streams <span class="insert">that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   are prematurely cancelled by either endpoint.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">12.  Packets and Frames</td><td> </td><td class="right">12.  Packets and Frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC endpoints communicate by exchanging packets.  Packets have</td><td> </td><td class="right">   QUIC endpoints communicate by exchanging packets.  Packets have</td><td class="lineno"></td></tr>
      <tr id="diff0286"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   confidentiality and integrity <span class="delete">protection (see</span> Section <span class="delete">12.1) and</span> are</td><td> </td><td class="rblock">   confidentiality and integrity <span class="insert">protection; see</span> Section <span class="insert">12.1.  Packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   carried in UDP <span class="delete">datagrams (see</span> Section <span class="delete">12.2).</span></td><td> </td><td class="rblock">   are carried in UDP <span class="insert">datagrams; see</span> Section <span class="insert">12.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0287"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This version of QUIC uses the long packet header <span class="delete">(see Section 17.2)</span></td><td> </td><td class="rblock">   This version of QUIC uses the long packet header during connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   during connection <span class="delete">establishment.</span>  Packets with the long header are</td><td> </td><td class="rblock">   <span class="insert">establishment; see Section 17.2.</span>  Packets with the long header are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial (Section 17.2.2), 0-RTT (Section 17.2.3), Handshake</td><td> </td><td class="right">   Initial (Section 17.2.2), 0-RTT (Section 17.2.3), Handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 17.2.4), and Retry (Section 17.2.5).  Version negotiation</td><td> </td><td class="right">   (Section 17.2.4), and Retry (Section 17.2.5).  Version negotiation</td><td class="lineno"></td></tr>
      <tr id="diff0288"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   uses a version-independent packet with a long <span class="delete">header (see</span></td><td> </td><td class="rblock">   uses a version-independent packet with a long <span class="insert">header; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">17.2.1).</span></td><td> </td><td class="rblock">   Section <span class="insert">17.2.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0289"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Packets with the short header <span class="delete">(Section 17.3)</span> are designed for minimal</td><td> </td><td class="rblock">   Packets with the short header are designed for minimal overhead and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   overhead and are used after a connection is established and 1-RTT</td><td> </td><td class="rblock">   are used after a connection is established and 1-RTT keys are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   keys are <span class="delete">available.</span></td><td> </td><td class="rblock">   <span class="insert">available; see Section 17.3.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">12.1.  Protected Packets</td><td> </td><td class="right">12.1.  Protected Packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0290"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   All QUIC packets except Version Negotiation <span class="delete">and Retry</span> packets use</td><td> </td><td class="rblock">   All QUIC packets except Version Negotiation packets use authenticated</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   authenticated encryption with additional data (AEAD) [RFC5116] to</td><td> </td><td class="rblock">   encryption with additional data (AEAD) [RFC5116] to provide</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   provide confidentiality and integrity protection.  Details of packet</td><td> </td><td class="rblock">   confidentiality and <span class="insert">integrity protection.  Retry packets use AEAD to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   protection are found in [QUIC-TLS]; this section includes an overview</td><td> </td><td class="rblock"><span class="insert">   provide</span> integrity protection.  Details of packet protection are found</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   of the process.</td><td> </td><td class="rblock">   in [QUIC-TLS]; this section includes an overview of the process.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial packets are protected using keys that are statically derived.</td><td> </td><td class="right">   Initial packets are protected using keys that are statically derived.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This packet protection is not effective confidentiality protection.</td><td> </td><td class="right">   This packet protection is not effective confidentiality protection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial protection only exists to ensure that the sender of the</td><td> </td><td class="right">   Initial protection only exists to ensure that the sender of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet is on the network path.  Any entity that receives the Initial</td><td> </td><td class="right">   packet is on the network path.  Any entity that receives the Initial</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet from a client can recover the keys necessary to remove packet</td><td> </td><td class="right">   packet from a client can recover the keys necessary to remove packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protection or to generate packets that will be successfully</td><td> </td><td class="right">   protection or to generate packets that will be successfully</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authenticated.</td><td> </td><td class="right">   authenticated.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   All other packets are protected with keys derived from the</td><td> </td><td class="right">   All other packets are protected with keys derived from the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   cryptographic handshake.  The type of the packet from the long header</td><td> </td><td class="right">   cryptographic handshake.  The type of the packet from the long header</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   or key phase from the short header are used to identify which</td><td> </td><td class="right">   or key phase from the short header are used to identify which</td><td class="lineno"></td></tr>
      <tr id="diff0291"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   encryption <span class="delete">level - and therefore the</span> keys <span class="delete">- that</span> are used.  Packets</td><td> </td><td class="rblock">   encryption keys are used.  Packets protected with 0-RTT and 1-RTT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   protected with 0-RTT and 1-RTT keys are expected to have</td><td> </td><td class="rblock">   keys are expected to have confidentiality and data origin</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   confidentiality and data origin authentication; the cryptographic</td><td> </td><td class="rblock">   authentication; the cryptographic handshake ensures that only the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   handshake ensures that only the communicating endpoints receive the</td><td> </td><td class="rblock">   communicating endpoints receive the corresponding keys.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   corresponding keys.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The packet number field contains a packet number, which has</td><td> </td><td class="right">   The packet number field contains a packet number, which has</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   additional confidentiality protection that is applied after packet</td><td> </td><td class="right">   additional confidentiality protection that is applied after packet</td><td class="lineno"></td></tr>
      <tr id="diff0292"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   protection is applied<span class="delete"> (see [QUIC-TLS] for details)</span>.  The underlying</td><td> </td><td class="rblock">   protection is applied<span class="insert">; see [QUIC-TLS] for details</span>.  The underlying</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet number increases with each packet sent in a given packet</td><td> </td><td class="right">   packet number increases with each packet sent in a given packet</td><td class="lineno"></td></tr>
      <tr id="diff0293"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   number space<span class="delete">,</span> see Section 12.3 for details.</td><td> </td><td class="rblock">   number space<span class="insert">;</span> see Section 12.3 for details.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">12.2.  Coalescing Packets</td><td> </td><td class="right">12.2.  Coalescing Packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial (Section 17.2.2), 0-RTT (Section 17.2.3), and Handshake</td><td> </td><td class="right">   Initial (Section 17.2.2), 0-RTT (Section 17.2.3), and Handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 17.2.4) packets contain a Length field, which determines the</td><td> </td><td class="right">   (Section 17.2.4) packets contain a Length field, which determines the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   end of the packet.  The length includes both the Packet Number and</td><td> </td><td class="right">   end of the packet.  The length includes both the Packet Number and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Payload fields, both of which are confidentiality protected and</td><td> </td><td class="right">   Payload fields, both of which are confidentiality protected and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   initially of unknown length.  The length of the Payload field is</td><td> </td><td class="right">   initially of unknown length.  The length of the Payload field is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   learned once header protection is removed.</td><td> </td><td class="right">   learned once header protection is removed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Using the Length field, a sender can coalesce multiple QUIC packets</td><td> </td><td class="right">   Using the Length field, a sender can coalesce multiple QUIC packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   into one UDP datagram.  This can reduce the number of UDP datagrams</td><td> </td><td class="right">   into one UDP datagram.  This can reduce the number of UDP datagrams</td><td class="lineno"></td></tr>
      <tr id="diff0294"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   needed to complete the cryptographic handshake and <span class="delete">starting</span> sending</td><td> </td><td class="rblock">   needed to complete the cryptographic handshake and <span class="insert">start</span> sending</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   data.  Receivers MUST be able to process coalesced packets.</td><td> </td><td class="rblock">   data.  <span class="insert">This can also be used to construct PMTU probes; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 14.4.1.</span>  Receivers MUST be able to process coalesced packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Coalescing packets in order of increasing encryption levels (Initial,</td><td> </td><td class="right">   Coalescing packets in order of increasing encryption levels (Initial,</td><td class="lineno"></td></tr>
      <tr id="diff0295"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   0-RTT, Handshake, <span class="delete">1-RTT)</span> makes it more likely the receiver will be</td><td> </td><td class="rblock">   0-RTT, Handshake, <span class="insert">1-RTT; see Section 4.1.4 of [QUIC-TLS])</span> makes it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   able to process all the packets in a single pass.  A packet with a</td><td> </td><td class="rblock">   more likely the receiver will be able to process all the packets in a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   short header does not include a length, so it can only be the last</td><td> </td><td class="rblock">   single pass.  A packet with a short header does not include a length,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet included in a UDP datagram.</td><td> </td><td class="rblock">   so it can only be the last packet included in a UDP datagram.  <span class="insert">An</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   endpoint SHOULD NOT coalesce multiple packets at the same encryption</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   level.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Senders MUST NOT coalesce QUIC packets for different connections into</td><td> </td><td class="right">   Senders MUST NOT coalesce QUIC packets for different connections into</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a single UDP datagram.  Receivers SHOULD ignore any subsequent</td><td> </td><td class="right">   a single UDP datagram.  Receivers SHOULD ignore any subsequent</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets with a different Destination Connection ID than the first</td><td> </td><td class="right">   packets with a different Destination Connection ID than the first</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet in the datagram.</td><td> </td><td class="right">   packet in the datagram.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Every QUIC packet that is coalesced into a single UDP datagram is</td><td> </td><td class="right">   Every QUIC packet that is coalesced into a single UDP datagram is</td><td class="lineno"></td></tr>
      <tr id="diff0296"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   separate and complete.  <span class="delete">Though the values of some fields in the</span></td><td> </td><td class="rblock">   separate and complete.  The receiver of coalesced QUIC packets MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet header might be redundant, no fields are omitted.</span>  The</td><td> </td><td class="rblock">   individually process each QUIC packet and separately acknowledge</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   receiver of coalesced QUIC packets MUST individually process each</td><td> </td><td class="rblock">   them, as if they were received as the payload of different UDP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   QUIC packet and separately acknowledge them, as if they were received</td><td> </td><td class="rblock">   datagrams.  For example, if decryption fails (because the keys are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   as the payload of different UDP datagrams.  For example, if</td><td> </td><td class="rblock">   not available or any other reason), the receiver MAY either discard</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   decryption fails (because the keys are not available or any other</td><td> </td><td class="rblock">   or buffer the packet for later processing and MUST attempt to process</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   reason), <span class="delete">the</span> the receiver MAY either discard or buffer the packet for</td><td> </td><td class="rblock">   the remaining packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   later processing and MUST attempt to process the remaining packets.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Retry packets (Section 17.2.5), Version Negotiation packets</td><td> </td><td class="right">   Retry packets (Section 17.2.5), Version Negotiation packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 17.2.1), and packets with a short header (Section 17.3) do</td><td> </td><td class="right">   (Section 17.2.1), and packets with a short header (Section 17.3) do</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   not contain a Length field and so cannot be followed by other packets</td><td> </td><td class="right">   not contain a Length field and so cannot be followed by other packets</td><td class="lineno"></td></tr>
      <tr id="diff0297"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   in the same UDP datagram.</td><td> </td><td class="rblock">   in the same UDP datagram.  <span class="insert">Note also that there is no situation where</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   a Retry or Version Negotiation packet is coalesced with another</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">12.3.  Packet Numbers</td><td> </td><td class="right">12.3.  Packet Numbers</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The packet number is an integer in the range 0 to 2^62-1.  This</td><td> </td><td class="right">   The packet number is an integer in the range 0 to 2^62-1.  This</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   number is used in determining the cryptographic nonce for packet</td><td> </td><td class="right">   number is used in determining the cryptographic nonce for packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protection.  Each endpoint maintains a separate packet number for</td><td> </td><td class="right">   protection.  Each endpoint maintains a separate packet number for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sending and receiving.</td><td> </td><td class="right">   sending and receiving.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packet numbers are limited to this range because they need to be</td><td> </td><td class="right">   Packet numbers are limited to this range because they need to be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   representable in whole in the Largest Acknowledged field of an ACK</td><td> </td><td class="right">   representable in whole in the Largest Acknowledged field of an ACK</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame (Section 19.3).  When present in a long or short header</td><td> </td><td class="right">   frame (Section 19.3).  When present in a long or short header</td><td class="lineno"></td></tr>
      <tr id="diff0298"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   however, packet numbers are reduced and encoded in 1 to 4 <span class="delete">bytes,</span> see</td><td> </td><td class="rblock">   however, packet numbers are reduced and encoded in 1 to 4 <span class="insert">bytes;</span> see</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">17.1).</span></td><td> </td><td class="rblock">   Section <span class="insert">17.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0299"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Version Negotiation (Section 17.2.1) and Retry <span class="delete">Section 17.2.5</span> packets</td><td> </td><td class="rblock">   Version Negotiation (Section 17.2.1) and Retry <span class="insert">(Section 17.2.5)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   do not include a packet number.</td><td> </td><td class="rblock">   packets do not include a packet number.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packet numbers are divided into 3 spaces in QUIC:</td><td> </td><td class="right">   Packet numbers are divided into 3 spaces in QUIC:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0300"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Initial space: All Initial packets Section 17.2.2</span> are in this</td><td> </td><td class="rblock">   <span class="insert">*  Initial space: All Initial packets (Section 17.2.2)</span> are in this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      space.</td><td> </td><td class="right">      space.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0301"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Handshake space: All Handshake packets <span class="delete">Section 17.2.4</span> are in this</td><td> </td><td class="rblock">   <span class="insert">*</span>  Handshake space: All Handshake packets <span class="insert">(Section 17.2.4)</span> are in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      space.</td><td> </td><td class="rblock">      this space.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0302"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Application data space: All 0-RTT and 1-RTT encrypted packets</td><td> </td><td class="rblock">   <span class="insert">*</span>  Application data space: All 0-RTT and 1-RTT encrypted packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">Section 12.1</span> are in this space.</td><td> </td><td class="rblock">      <span class="insert">(Section 12.1)</span> are in this space.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   As described in [QUIC-TLS], each packet type uses different</td><td> </td><td class="right">   As described in [QUIC-TLS], each packet type uses different</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protection keys.</td><td> </td><td class="right">   protection keys.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Conceptually, a packet number space is the context in which a packet</td><td> </td><td class="right">   Conceptually, a packet number space is the context in which a packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   can be processed and acknowledged.  Initial packets can only be sent</td><td> </td><td class="right">   can be processed and acknowledged.  Initial packets can only be sent</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   with Initial packet protection keys and acknowledged in packets which</td><td> </td><td class="right">   with Initial packet protection keys and acknowledged in packets which</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are also Initial packets.  Similarly, Handshake packets are sent at</td><td> </td><td class="right">   are also Initial packets.  Similarly, Handshake packets are sent at</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the Handshake encryption level and can only be acknowledged in</td><td> </td><td class="right">   the Handshake encryption level and can only be acknowledged in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Handshake packets.</td><td> </td><td class="right">   Handshake packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This enforces cryptographic separation between the data sent in the</td><td> </td><td class="right">   This enforces cryptographic separation between the data sent in the</td><td class="lineno"></td></tr>
      <tr id="diff0303"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   different packet <span class="delete">sequence</span> number spaces.  Packet numbers in each</td><td> </td><td class="rblock">   different packet number spaces.  Packet numbers in each space start</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   space start at packet number 0.  Subsequent packets sent in the same</td><td> </td><td class="rblock">   at packet number 0.  Subsequent packets sent in the same packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet number space MUST increase the packet number by at least one.</td><td> </td><td class="rblock">   number space MUST increase the packet number by at least one.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0-RTT and 1-RTT data exist in the same packet number space to make</td><td> </td><td class="right">   0-RTT and 1-RTT data exist in the same packet number space to make</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   loss recovery algorithms easier to implement between the two packet</td><td> </td><td class="right">   loss recovery algorithms easier to implement between the two packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   types.</td><td> </td><td class="right">   types.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A QUIC endpoint MUST NOT reuse a packet number within the same packet</td><td> </td><td class="right">   A QUIC endpoint MUST NOT reuse a packet number within the same packet</td><td class="lineno"></td></tr>
      <tr id="diff0304"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   number space in one <span class="delete">connection (that is, under the same cryptographic</span></td><td> </td><td class="rblock">   number space in one <span class="insert">connection.</span>  If the packet number for sending</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   keys).</span>  If the packet number for sending reaches 2^62 - 1, the sender</td><td> </td><td class="rblock">   reaches 2^62 - 1, the sender MUST close the connection without</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   MUST close the connection without sending a CONNECTION_CLOSE frame or</td><td> </td><td class="rblock">   sending a CONNECTION_CLOSE frame or any further packets; an endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   any further packets; an endpoint MAY send a Stateless Reset</td><td> </td><td class="rblock">   MAY send a Stateless Reset (Section 10.4) in response to further</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   (Section 10.4) in response to further packets that it receives.</td><td> </td><td class="rblock">   packets that it receives.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A receiver MUST discard a newly unprotected packet unless it is</td><td> </td><td class="right">   A receiver MUST discard a newly unprotected packet unless it is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   certain that it has not processed another packet with the same packet</td><td> </td><td class="right">   certain that it has not processed another packet with the same packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   number from the same packet number space.  Duplicate suppression MUST</td><td> </td><td class="right">   number from the same packet number space.  Duplicate suppression MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   happen after removing packet protection for the reasons described in</td><td> </td><td class="right">   happen after removing packet protection for the reasons described in</td><td class="lineno"></td></tr>
      <tr id="diff0305"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section 9.3 of [QUIC-TLS].  <span class="delete">An efficient algorithm</span> for <span class="delete">duplicate</span></td><td> </td><td class="rblock">   Section 9.3 of [QUIC-TLS].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   suppression</span> can be <span class="delete">found</span> in Section <span class="delete">3.4.3 of [RFC4303].</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Endpoints that track all individual packets</span> for <span class="insert">the purposes of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   detecting duplicates are at risk of accumulating excessive state.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The data required for detecting duplicates</span> can be <span class="insert">limited by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   maintaining a minimum packet number below which all packets are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   immediately dropped.  Any minimum needs to account for large</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   variations</span> in <span class="insert">round trip time, which includes the possibility that a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   peer might probe network paths with a much larger round trip times;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   see</span> Section <span class="insert">9.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packet number encoding at a sender and decoding at a receiver are</td><td> </td><td class="right">   Packet number encoding at a sender and decoding at a receiver are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   described in Section 17.1.</td><td> </td><td class="right">   described in Section 17.1.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">12.4.  Frames and Frame Types</td><td> </td><td class="right">12.4.  Frames and Frame Types</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The payload of QUIC packets, after removing packet protection,</td><td> </td><td class="right">   The payload of QUIC packets, after removing packet protection,</td><td class="lineno"></td></tr>
      <tr id="diff0306"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   co<span class="delete">mmonly consists of a sequence of frames, as shown in Figure 8</span>.</td><td> </td><td class="rblock">   co<span class="insert">nsists of a sequence of complete frames, as shown in Figure 10</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Version Negotiation, Stateless Reset, and Retry packets do not</td><td> </td><td class="right">   Version Negotiation, Stateless Reset, and Retry packets do not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   contain frames.</td><td> </td><td class="right">   contain frames.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0307"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">Packet Payload {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock">     Frame <span class="insert">(..) ...,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                          Frame <span class="delete">1 (*)                        ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                          Frame 2 (*)                        ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                                  ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                          Frame N (*)                        ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0308"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                          Figure <span class="delete">8</span>: QUIC Payload</td><td> </td><td class="rblock">                          Figure <span class="insert">10</span>: QUIC Payload</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0309"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">QUIC payloads</span> MUST contain at least one frame, and MAY contain</td><td> </td><td class="rblock">   <span class="insert">The payload of a packet that contains frames</span> MUST contain at least</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   multiple frames and multiple frame types.</td><td> </td><td class="rblock">   one frame, and MAY contain multiple frames and multiple frame types.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Frames always fit within a single QUIC packet and cannot span</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   multiple packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0310"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Frames MUST fit within a single QUIC packet and MUST NOT span a QUIC</span></td><td> </td><td class="rblock">   Each frame begins with a Frame Type, indicating its type, followed by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet boundary.</span>  Each frame begins with a Frame Type, indicating its</td><td> </td><td class="rblock">   additional type-dependent fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   type, followed by additional type-dependent fields:</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0311"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock">     Frame Type <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Type-Dependent Fields <span class="insert">(..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                       Frame Type <span class="delete">(i)                        ...</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                   Type-Dependent Fields <span class="delete">(*)                 ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0312"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                      Figure <span class="delete">9</span>: Generic Frame Layout</td><td> </td><td class="rblock">                      Figure <span class="insert">11</span>: Generic Frame Layout</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The frame types defined in this specification are listed in Table 3.</td><td> </td><td class="right">   The frame types defined in this specification are listed in Table 3.</td><td class="lineno"></td></tr>
      <tr id="diff0313"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The Frame Type in <span class="delete">STREAM</span> frames is used to carry other frame-specific</td><td> </td><td class="rblock">   The Frame Type in <span class="insert">ACK, STREAM, MAX_STREAMS, STREAMS_BLOCKED, and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   flags.  For all other frames, the Frame Type field simply identifies</td><td> </td><td class="rblock"><span class="insert">   CONNECTION_CLOSE</span> frames is used to carry other frame-specific flags.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the frame.  These frames are explained in more detail in Section 19.</td><td> </td><td class="rblock">   For all other frames, the Frame Type field simply identifies the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   frame.  These frames are explained in more detail in Section 19.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0314"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          <span class="delete">+-------------+----------------------+---------------+</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | Type Value  | Frame Type Name      | Definition    |</td><td> </td><td class="rblock">     | Type Value  | Frame Type Name      | Definition    | <span class="insert">Packets |</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          <span class="delete">+-------------+----------------------+---------------+</span></td><td> </td><td class="rblock"><span class="insert">     +=============+======================+===============+=========+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x00        | PADDING              | Section 19.1  |</td><td> </td><td class="rblock">     | 0x00        | PADDING              | Section 19.1  | <span class="insert">IH01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x01        | PING                 | Section 19.2  |</td><td> </td><td class="rblock">     | 0x01        | PING                 | Section 19.2  | <span class="insert">IH01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x02 - 0x03 | ACK                  | Section 19.3  |</td><td> </td><td class="rblock">     | 0x02 - 0x03 | ACK                  | Section 19.3  | <span class="insert">IH_1</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x04        | RESET_STREAM         | Section 19.4  |</td><td> </td><td class="rblock">     | 0x04        | RESET_STREAM         | Section 19.4  | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x05        | STOP_SENDING         | Section 19.5  |</td><td> </td><td class="rblock">     | 0x05        | STOP_SENDING         | Section 19.5  | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x06        | CRYPTO               | Section 19.6  |</td><td> </td><td class="rblock">     | 0x06        | CRYPTO               | Section 19.6  | <span class="insert">IH_1</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x07        | NEW_TOKEN            | Section 19.7  |</td><td> </td><td class="rblock">     | 0x07        | NEW_TOKEN            | Section 19.7  | <span class="insert">___1</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x08 - 0x0f | STREAM               | Section 19.8  |</td><td> </td><td class="rblock">     | 0x08 - 0x0f | STREAM               | Section 19.8  | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x10        | MAX_DATA             | Section 19.9  |</td><td> </td><td class="rblock">     | 0x10        | MAX_DATA             | Section 19.9  | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x11        | MAX_STREAM_DATA      | Section 19.10 |</td><td> </td><td class="rblock">     | 0x11        | MAX_STREAM_DATA      | Section 19.10 | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x12 - 0x13 | MAX_STREAMS          | Section 19.11 |</td><td> </td><td class="rblock">     | 0x12 - 0x13 | MAX_STREAMS          | Section 19.11 | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x14        | DATA_BLOCKED         | Section 19.12 |</td><td> </td><td class="rblock">     | 0x14        | DATA_BLOCKED         | Section 19.12 | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x15        | STREAM_DATA_BLOCKED  | Section 19.13 |</td><td> </td><td class="rblock">     | 0x15        | STREAM_DATA_BLOCKED  | Section 19.13 | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x16 - 0x17 | STREAMS_BLOCKED      | Section 19.14 |</td><td> </td><td class="rblock">     | 0x16 - 0x17 | STREAMS_BLOCKED      | Section 19.14 | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x18        | NEW_CONNECTION_ID    | Section 19.15 |</td><td> </td><td class="rblock">     | 0x18        | NEW_CONNECTION_ID    | Section 19.15 | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x19        | RETIRE_CONNECTION_ID | Section 19.16 |</td><td> </td><td class="rblock">     | 0x19        | RETIRE_CONNECTION_ID | Section 19.16 | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x1a        | PATH_CHALLENGE       | Section 19.17 |</td><td> </td><td class="rblock">     | 0x1a        | PATH_CHALLENGE       | Section 19.17 | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x1b        | PATH_RESPONSE        | Section 19.18 |</td><td> </td><td class="rblock">     | 0x1b        | PATH_RESPONSE        | Section 19.18 | <span class="insert">__01</span>    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          |             <span class="delete">|                      |               |</span></td><td> </td><td class="rblock">     <span class="insert">+-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          | 0x1c - 0x1d | CONNECTION_CLOSE     | Section 19.19 |</td><td> </td><td class="rblock">     | 0x1c - 0x1d | CONNECTION_CLOSE     | Section 19.19 | <span class="insert">ih01    |</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          <span class="delete">+-------------+----------------------+---------------+</span></td><td> </td><td class="rblock"><span class="insert">     +-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     | 0x1e        | HANDSHAKE_DONE       | Section 19.20 | ___1    |</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     +-------------+----------------------+---------------+---------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                           Table 3: Frame Types</td><td> </td><td class="right">                           Table 3: Frame Types</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0315"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">The "Packets" column in Table 3 does not form part of the IANA</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   registry; see Section 22.3.  This column lists the types of packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that each frame type could appear in, indicated by the following</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   characters:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   I:  Initial (Section 17.2.2)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   H:  Handshake (Section 17.2.4)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   0:  0-RTT (Section 17.2.3)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1:  1-RTT (Section 17.3)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ih:  A CONNECTION_CLOSE frame of type 0x1d cannot appear in Initial</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      or Handshake packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 4 of [QUIC-TLS] provides more detail about these</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   restrictions.  Note that all frames can appear in 1-RTT packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint MUST treat the receipt of a frame of unknown type as a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection error of type FRAME_ENCODING_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   All QUIC frames are idempotent in this version of QUIC.  That is, a</td><td> </td><td class="right">   All QUIC frames are idempotent in this version of QUIC.  That is, a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   valid frame does not cause undesirable side effects or errors when</td><td> </td><td class="right">   valid frame does not cause undesirable side effects or errors when</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   received more than once.</td><td> </td><td class="right">   received more than once.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The Frame Type field uses a variable length integer encoding (see</td><td> </td><td class="right">   The Frame Type field uses a variable length integer encoding (see</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Section 16) with one exception.  To ensure simple and efficient</td><td> </td><td class="right">   Section 16) with one exception.  To ensure simple and efficient</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   implementations of frame parsing, a frame type MUST use the shortest</td><td> </td><td class="right">   implementations of frame parsing, a frame type MUST use the shortest</td><td class="lineno"></td></tr>
      <tr id="diff0316"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   possible encoding.  <span class="delete">Though a two-, four- or eight-byte encoding of</span></td><td> </td><td class="rblock">   possible encoding.  <span class="insert">For</span> frame types defined in this <span class="insert">document, this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the</span> frame types defined in this <span class="delete">document</span> is <span class="delete">possible, the Frame Type</span></td><td> </td><td class="rblock"><span class="insert">   means a single-byte encoding, even though it</span> is <span class="insert">possible to encode</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   field for</span> these <span class="delete">frames is encoded on</span> a <span class="delete">single byte.</span>  For instance,</td><td> </td><td class="rblock">   these <span class="insert">values as</span> a <span class="insert">two-, four- or eight-byte variable length integer.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   though 0x4001 is a legitimate two-byte encoding for a variable-length</td><td> </td><td class="rblock">   For instance, though 0x4001 is a legitimate two-byte encoding for a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   integer with a value of 1, PING frames are always encoded as a single</td><td> </td><td class="rblock">   variable-length integer with a value of 1, PING frames are always</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   byte with the value 0x01.  An endpoint MAY treat the receipt of a</td><td> </td><td class="rblock">   encoded as a single byte with the value 0x01.  <span class="insert">This rule applies to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   frame type that uses a longer encoding than necessary as a connection</td><td> </td><td class="rblock"><span class="insert">   all current and future QUIC frame types.</span>  An endpoint MAY treat the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   error of type PROTOCOL_VIOLATION.</td><td> </td><td class="rblock">   receipt of a frame type that uses a longer encoding than necessary as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   a connection error of type PROTOCOL_VIOLATION.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">13.  Packetization and Reliability</td><td> </td><td class="right">13.  Packetization and Reliability</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0317"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A sender bundles one or more frames in a QUIC <span class="delete">packet (see</span></td><td> </td><td class="rblock">   A sender bundles one or more frames in a QUIC <span class="insert">packet; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">12.4).</span></td><td> </td><td class="rblock">   Section <span class="insert">12.4.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A sender can minimize per-packet bandwidth and computational costs by</td><td> </td><td class="right">   A sender can minimize per-packet bandwidth and computational costs by</td><td class="lineno"></td></tr>
      <tr id="diff0318"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">bundling</span> as many frames as possible <span class="delete">within a</span> QUIC packet.  A sender</td><td> </td><td class="rblock">   <span class="insert">including</span> as many frames as possible <span class="insert">in each</span> QUIC packet.  A sender</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   MAY wait for a short period of time to <span class="delete">bundle</span> multiple frames before</td><td> </td><td class="rblock">   MAY wait for a short period of time to <span class="insert">collect</span> multiple frames before</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sending a packet that is not maximally packed, to avoid sending out</td><td> </td><td class="right">   sending a packet that is not maximally packed, to avoid sending out</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   large numbers of small packets.  An implementation MAY use knowledge</td><td> </td><td class="right">   large numbers of small packets.  An implementation MAY use knowledge</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   about application sending behavior or heuristics to determine whether</td><td> </td><td class="right">   about application sending behavior or heuristics to determine whether</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and for how long to wait.  This waiting period is an implementation</td><td> </td><td class="right">   and for how long to wait.  This waiting period is an implementation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   decision, and an implementation should be careful to delay</td><td> </td><td class="right">   decision, and an implementation should be careful to delay</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   conservatively, since any delay is likely to increase application-</td><td> </td><td class="right">   conservatively, since any delay is likely to increase application-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   visible latency.</td><td> </td><td class="right">   visible latency.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stream multiplexing is achieved by interleaving STREAM frames from</td><td> </td><td class="right">   Stream multiplexing is achieved by interleaving STREAM frames from</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   multiple streams into one or more QUIC packets.  A single QUIC packet</td><td> </td><td class="right">   multiple streams into one or more QUIC packets.  A single QUIC packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   can include multiple STREAM frames from one or more streams.</td><td> </td><td class="right">   can include multiple STREAM frames from one or more streams.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   One of the benefits of QUIC is avoidance of head-of-line blocking</td><td> </td><td class="right">   One of the benefits of QUIC is avoidance of head-of-line blocking</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   across multiple streams.  When a packet loss occurs, only streams</td><td> </td><td class="right">   across multiple streams.  When a packet loss occurs, only streams</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   with data in that packet are blocked waiting for a retransmission to</td><td> </td><td class="right">   with data in that packet are blocked waiting for a retransmission to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   be received, while other streams can continue making progress.  Note</td><td> </td><td class="right">   be received, while other streams can continue making progress.  Note</td><td class="lineno"></td></tr>
      <tr id="diff0319"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that when data from multiple streams is <span class="delete">bundled into</span> a single QUIC</td><td> </td><td class="rblock">   that when data from multiple streams is <span class="insert">included in</span> a single QUIC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet, loss of that packet blocks all those streams from making</td><td> </td><td class="right">   packet, loss of that packet blocks all those streams from making</td><td class="lineno"></td></tr>
      <tr id="diff0320"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   progress.  Implementations are advised to <span class="delete">bundl</span>e as few streams as</td><td> </td><td class="rblock">   progress.  Implementations are advised to <span class="insert">includ</span>e as few streams as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   necessary in outgoing packets without losing transmission efficiency</td><td> </td><td class="right">   necessary in outgoing packets without losing transmission efficiency</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to underfilled packets.</td><td> </td><td class="right">   to underfilled packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0321"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">13.1.  Packet Processing<span class="delete"> and Acknowledgment</span></td><td> </td><td class="rblock">13.1.  Packet Processing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A packet MUST NOT be acknowledged until packet protection has been</td><td> </td><td class="right">   A packet MUST NOT be acknowledged until packet protection has been</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   successfully removed and all frames contained in the packet have been</td><td> </td><td class="right">   successfully removed and all frames contained in the packet have been</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   processed.  For STREAM frames, this means the data has been enqueued</td><td> </td><td class="right">   processed.  For STREAM frames, this means the data has been enqueued</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   in preparation to be received by the application protocol, but it</td><td> </td><td class="right">   in preparation to be received by the application protocol, but it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   does not require that data is delivered and consumed.</td><td> </td><td class="right">   does not require that data is delivered and consumed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Once the packet has been fully processed, a receiver acknowledges</td><td> </td><td class="right">   Once the packet has been fully processed, a receiver acknowledges</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   receipt by sending one or more ACK frames containing the packet</td><td> </td><td class="right">   receipt by sending one or more ACK frames containing the packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   number of the received packet.</td><td> </td><td class="right">   number of the received packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0322"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">13.1.1.  Sending ACK Frames</span></td><td> </td><td class="rblock">   <span class="insert">An endpoint SHOULD treat receipt of an acknowledgment for a packet it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   did not send as a connection error of type PROTOCOL_VIOLATION, if it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   is able to detect the condition.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0323"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">An endpoint MUST NOT send more than one packet containing only an ACK</span></td><td> </td><td class="rblock"><span class="insert">13.2.  Generating Acknowledgements</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   frame per received packet that contains frames other than ACK and</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   PADDING frames.  An endpoint MUST NOT send a packet containing only</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   an ACK frame in response to a packet containing only ACK or PADDING</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   frames, even if there are packet gaps which precede the received</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet.  This prevents an indefinite feedback loop of ACKs.  The</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   endpoint MUST however acknowledge packets containing only ACK or</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   PADDING frames when sending ACK frames in response to other packets.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0324"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Packets containing PADDING frames are considered to be in flight for</span></td><td> </td><td class="rblock">   <span class="insert">Endpoints acknowledge all packets they receive and process.  However,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   congestion control purposes [QUIC-RECOVERY].  Sending</span> only <span class="delete">PADDING</span></td><td> </td><td class="rblock">   only <span class="insert">ack-eliciting packets</span> cause <span class="insert">an ACK frame</span> to <span class="insert">be sent within</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   frames might</span> cause <span class="delete">the sender</span> to <span class="delete">become limited by the congestion</span></td><td> </td><td class="rblock">   <span class="insert">maximum ack delay.  Packets</span> that are <span class="insert">not ack-eliciting are only</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   controller (as described in [QUIC-RECOVERY]) with no acknowledgments</span></td><td> </td><td class="rblock"><span class="insert">   acknowledged when an ACK frame is</span> sent <span class="insert">for other reasons.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   forthcoming from</span> the <span class="delete">receiver.  Therefore, a sender SHOULD ensure</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that <span class="delete">other frames</span> are sent <span class="delete">in addition to PADDING frames to elicit</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   acknowledgments from the receiver.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0325"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The receiver's delayed acknowledgment timer</span> SHOULD <span class="delete">NOT exceed the</span></td><td> </td><td class="rblock">   <span class="insert">When sending a packet for any reason, an endpoint</span> SHOULD <span class="insert">attempt to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   current RTT estimate or the value it indicates in the "max_ack_delay"</span></td><td> </td><td class="rblock"><span class="insert">   bundle</span> an <span class="insert">ACK frame if one has not been</span> sent <span class="insert">recently.  Doing so</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   transport parameter.  This ensures</span> an <span class="delete">acknowledgment is</span> sent at <span class="delete">least</span></td><td> </td><td class="rblock"><span class="insert">   helps with timely loss detection</span> at the <span class="insert">peer.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   once per RTT when packets needing acknowledgement are received.  The</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   sender can use</span> the <span class="delete">receiver's "max_ack_delay" value in determining</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   timeouts for timer-based retransmission.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0326"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Strategies</span> and <span class="delete">implications of the frequency of generating</span></td><td> </td><td class="rblock">   <span class="insert">In general, frequent feedback from a receiver improves loss</span> and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   acknowledgments are discussed</span> in <span class="delete">more detail in [QUIC-RECOVERY].</span></td><td> </td><td class="rblock">   <span class="insert">congestion response, but this has to be balanced against excessive</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   load generated by a receiver that sends an ACK frame</span> in <span class="insert">response to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   every ack-eliciting packet.  The guidance offered below seeks to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   strike this balance.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0327"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">To limit</span> ACK <span class="delete">Ranges (see Section 19.3.1) to those that have not yet</span></td><td> </td><td class="rblock"><span class="insert">13.2.1.  Sending</span> ACK <span class="insert">Frames</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   been received by the sender, the receiver SHOULD track which ACK</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   frames have been acknowledged by its peer.  The receiver SHOULD</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   exclude already acknowledged packets from future ACK frames whenever</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   these packets would unnecessarily contribute to the ACK frame size.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0328"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Because ACK frames are not sent in response</span> to <span class="delete">ACK-only</span> packets, a</td><td> </td><td class="rblock">   <span class="insert">Every packet SHOULD be acknowledged at least once, and ack-eliciting</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">receiver that</span> is <span class="delete">only sending ACK frames will only receive</span></td><td> </td><td class="rblock"><span class="insert">   packets MUST be acknowledged at least once within the maximum ack</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   acknowledgements for its packets if the</span> sender <span class="delete">includes them</span> in</td><td> </td><td class="rblock"><span class="insert">   delay.  An endpoint communicates its maximum delay using the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">packets with non-ACK frames.  A sender SHOULD bundle ACK frames with</span></td><td> </td><td class="rblock"><span class="insert">   max_ack_delay transport parameter; see Section 18.2.  max_ack_delay</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   other frames when possible.</span></td><td> </td><td class="rblock"><span class="insert">   declares an explicit contract: an endpoint promises</span> to <span class="insert">never</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   intentionally delay acknowledgments of an ack-eliciting packet by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   more than the indicated value.  If it does, any excess accrues to the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   RTT estimate and could result in spurious or delayed retransmissions</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   from the peer.  For Initial and Handshake</span> packets, a <span class="insert">max_ack_delay of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   0</span> is <span class="insert">used.  The</span> sender <span class="insert">uses the receiver's max_ack_delay value</span> in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">determining timeouts for timer-based retransmission, as detailed in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 6.2 of [QUIC-RECOVERY].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0329"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">To limit receiver state or the size of ACK frames, a receiver MAY</span></td><td> </td><td class="rblock">   <span class="insert">Since</span> packets <span class="insert">containing only ACK frames</span> are <span class="insert">not congestion</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   limit the number of ACK Ranges it sends.  A receiver can do this even</span></td><td> </td><td class="rblock"><span class="insert">   controlled, an endpoint MUST NOT send more than one such packet</span> in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   without receiving acknowledgment of its ACK frames, with the</span></td><td> </td><td class="rblock">   <span class="insert">response</span> to <span class="insert">receiving an ack-eliciting packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   knowledge this could cause the sender to unnecessarily retransmit</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   some data.  Standard QUIC [QUIC-RECOVERY] algorithms declare packets</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   lost after sufficiently newer</span> packets are <span class="delete">acknowledged.  Therefore,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the receiver SHOULD repeatedly acknowledge newly received packets</span> in</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">preference</span> to <span class="delete">packets received in the past.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0330"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   An endpoint <span class="delete">SHOULD treat receipt of an acknowledgment for</span> a packet <span class="delete">it</span></td><td> </td><td class="rblock">   An endpoint <span class="insert">MUST NOT send</span> a <span class="insert">non-ack-eliciting</span> packet <span class="insert">in response to</span> a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   did not send as</span> a <span class="delete">connection error of type PROTOCOL_VIOLATION,</span> if <span class="delete">it</span></td><td> </td><td class="rblock">   <span class="insert">non-ack-eliciting packet, even</span> if <span class="insert">there are packet gaps which precede</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   is able to detect</span> the <span class="delete">condition.</span></td><td> </td><td class="rblock"><span class="insert">   the received packet.  This avoids an infinite feedback loop of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledgements, which could prevent</span> the <span class="insert">connection from ever</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   becoming idle.  Non-ack-eliciting packets are eventually acknowledged</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   when the endpoint sends an ACK frame in response to other events.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0331"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">13.1.2.</span>  ACK Frames and Packet Protection</td><td> </td><td class="rblock">   <span class="insert">In order to assist loss detection at the sender, an endpoint SHOULD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   send an ACK frame immediately on receiving an ack-eliciting packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that is out of order.  The endpoint SHOULD NOT continue sending ACK</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frames immediately unless more ack-eliciting packets are received out</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of order.  If every subsequent ack-eliciting packet arrives out of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   order, then an ACK frame SHOULD be sent immediately for every</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   received ack-eliciting packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Similarly, packets marked with the ECN Congestion Experienced (CE)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   codepoint in the IP header SHOULD be acknowledged immediately, to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   reduce the peer's response time to congestion events.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The algorithms in [QUIC-RECOVERY] are expected to be resilient to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   receivers that do not follow guidance offered above.  However, an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   implementer should only deviate from these requirements after careful</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   consideration of the performance implications of doing so.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint that is only sending ACK frames will not receive</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledgments from its peer unless those acknowledgements are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   included in packets with ack-eliciting frames.  An endpoint SHOULD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   bundle ACK frames with other frames when there are new ack-eliciting</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets to acknowledge.  When only non-ack-eliciting packets need to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   be acknowledged, an endpoint MAY wait until an ack-eliciting packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   has been received to bundle an ACK frame with outgoing frames.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">13.2.2.  Acknowledgement Frequency</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A receiver determines how frequently to send acknowledgements in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   response to ack-eliciting packets.  This determination involves a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   tradeoff.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Endpoints rely on timely acknowledgment to detect loss; see Section 6</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of [QUIC-RECOVERY].  Window-based congestion controllers, such as the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   one in Section 7 of [QUIC-RECOVERY], rely on acknowledgments to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   manage their congestion window.  In both cases, delaying</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledgments can adversely affect performance.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   On the other hand, reducing the frequency of packets that carry only</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledgements reduces packet transmission and processing cost at</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   both endpoints.  It can also improve connection throughput on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   severely asymmetric links; see Section 3 of [RFC3449].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A receiver SHOULD send an ACK frame after receiving at least two ack-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   eliciting packets.  This recommendation is general in nature and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   consistent with recommendations for TCP endpoint behavior [RFC5681].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Knowledge of network conditions, knowledge of the peer's congestion</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   controller, or further research and experimentation might suggest</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   alternative acknowledgment strategies with better performance</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   characteristics.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A receiver MAY process multiple available packets before determining</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   whether to send an ACK frame in response.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">13.2.3.  Managing ACK Ranges</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   When an ACK frame is sent, one or more ranges of acknowledged packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   are included.  Including older packets reduces the chance of spurious</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   retransmits caused by losing previously sent ACK frames, at the cost</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of larger ACK frames.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ACK frames SHOULD always acknowledge the most recently received</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets, and the more out-of-order the packets are, the more</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   important it is to send an updated ACK frame quickly, to prevent the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   peer from declaring a packet as lost and spuriously retransmitting</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the frames it contains.  An ACK frame is expected to fit within a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   single QUIC packet.  If it does not, then older ranges (those with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the smallest packet numbers) are omitted.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 13.2.4 and Section 13.2.5 describe an exemplary approach for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   determining what packets to acknowledge in each ACK frame.  Though</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the goal of these algorithms is to generate an acknowledgment for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   every packet that is processed, it is still possible for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledgments to be lost.  A sender cannot expect to receive an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledgment for every packet that the receiver processes.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">13.2.4.  Receiver Tracking of ACK Frames</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   When a packet containing an ACK frame is sent, the largest</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledged in that frame may be saved.  When a packet containing an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ACK frame is acknowledged, the receiver can stop acknowledging</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets less than or equal to the largest acknowledged in the sent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ACK frame.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In cases without ACK frame loss, this algorithm allows for a minimum</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of 1 RTT of reordering.  In cases with ACK frame loss and reordering,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   this approach does not guarantee that every acknowledgement is seen</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   by the sender before it is no longer included in the ACK frame.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Packets could be received out of order and all subsequent ACK frames</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   containing them could be lost.  In this case, the loss recovery</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   algorithm could cause spurious retransmits, but the sender will</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   continue making forward progress.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">13.2.5.  Limiting ACK Ranges</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A receiver limits the number of ACK Ranges (Section 19.3.1) it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   remembers and sends in ACK frames, both to limit the size of ACK</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frames and to avoid resource exhaustion.  After receiving</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledgments for an ACK frame, the receiver SHOULD stop tracking</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   those acknowledged ACK Ranges.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   It is possible that retaining many ACK Ranges could cause an ACK</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frame to become too large.  A receiver can discard unacknowledged ACK</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Ranges to limit ACK frame size, at the cost of increased</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   retransmissions from the sender.  This is necessary if an ACK frame</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   would be too large to fit in a packet, however receivers MAY also</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   limit ACK frame size further to preserve space for other frames.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A receiver MUST retain an ACK Range unless it can ensure that it will</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   not subsequently accept packets with numbers in that range.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Maintaining a minimum packet number that increases as ranges are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   discarded is one way to achieve this with minimal state.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Receivers can discard all ACK Ranges, but they MUST retain the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   largest packet number that has been successfully processed as that is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   used to recover packet numbers from subsequent packets; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 17.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A receiver SHOULD include an ACK Range containing the largest</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   received packet number in every ACK frame.  The Largest Acknowledged</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   field is used in ECN validation at a sender and including a lower</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   value than what was included in a previous ACK frame could cause ECN</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to be unnecessarily disabled; see Section 13.4.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A receiver that sends only non-ack-eliciting packets, such as ACK</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frames, might not receive an acknowledgement for a long period of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   time.  This could cause the receiver to maintain state for a large</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   number of ACK frames for a long period of time, and ACK frames it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   sends could be unnecessarily large.  In such a case, a receiver could</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   bundle a PING or other small ack-eliciting frame occasionally, such</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   as once per round trip, to elicit an ACK from the peer.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A receiver MUST NOT bundle an ack-eliciting frame with all packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that would otherwise be non-ack-eliciting, to avoid an infinite</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   feedback loop of acknowledgements.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">13.2.6.  Measuring and Reporting Host Delay</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint measures the delays intentionally introduced between the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   time the packet with the largest packet number is received and the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   time an acknowledgment is sent.  The endpoint encodes this delay in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the Ack Delay field of an ACK frame; see Section 19.3.  This allows</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the receiver of the ACK to adjust for any intentional delays, which</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   is important for getting a better estimate of the path RTT when</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledgments are delayed.  A packet might be held in the OS kernel</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   or elsewhere on the host before being processed.  An endpoint MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   NOT include delays that it does not control when populating the Ack</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Delay field in an ACK frame.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">13.2.7.</span>  ACK Frames and Packet Protection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ACK frames MUST only be carried in a packet that has the same packet</td><td> </td><td class="right">   ACK frames MUST only be carried in a packet that has the same packet</td><td class="lineno"></td></tr>
      <tr id="diff0332"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   number space as the packet being ACKed<span class="delete"> (see Section 12.1)</span>.  For</td><td> </td><td class="rblock">   number space as the packet being ACKed<span class="insert">; see Section 12.1</span>.  For</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   instance, packets that are protected with 1-RTT keys MUST be</td><td> </td><td class="right">   instance, packets that are protected with 1-RTT keys MUST be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   acknowledged in packets that are also protected with 1-RTT keys.</td><td> </td><td class="right">   acknowledged in packets that are also protected with 1-RTT keys.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packets that a client sends with 0-RTT packet protection MUST be</td><td> </td><td class="right">   Packets that a client sends with 0-RTT packet protection MUST be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   acknowledged by the server in packets protected by 1-RTT keys.  This</td><td> </td><td class="right">   acknowledged by the server in packets protected by 1-RTT keys.  This</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   can mean that the client is unable to use these acknowledgments if</td><td> </td><td class="right">   can mean that the client is unable to use these acknowledgments if</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the server cryptographic handshake messages are delayed or lost.</td><td> </td><td class="right">   the server cryptographic handshake messages are delayed or lost.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Note that the same limitation applies to other data sent by the</td><td> </td><td class="right">   Note that the same limitation applies to other data sent by the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   server protected by the 1-RTT keys.</td><td> </td><td class="right">   server protected by the 1-RTT keys.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0333"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Endpoints SHOULD send acknowledgments for packets containing CRYPTO</span></td><td> </td><td class="rblock"><span class="insert">13.2.8.  PADDING Frames Consume Congestion Window</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   frames with a reduced delay; see Section 6.2.1 of [QUIC-RECOVERY].</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0334"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">13.2.</span>  Retransmission of Information</td><td> </td><td class="rblock">   <span class="insert">Packets containing PADDING frames are considered to be in flight for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   congestion control purposes [QUIC-RECOVERY].  Packets containing only</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   PADDING frames therefore consume congestion window but do not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   generate acknowledgments that will open the congestion window.  To</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   avoid a deadlock, a sender SHOULD ensure that other frames are sent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   periodically in addition to PADDING frames to elicit acknowledgments</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   from the receiver.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">13.3.</span>  Retransmission of Information</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC packets that are determined to be lost are not retransmitted</td><td> </td><td class="right">   QUIC packets that are determined to be lost are not retransmitted</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   whole.  The same applies to the frames that are contained within lost</td><td> </td><td class="right">   whole.  The same applies to the frames that are contained within lost</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets.  Instead, the information that might be carried in frames is</td><td> </td><td class="right">   packets.  Instead, the information that might be carried in frames is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sent again in new frames as needed.</td><td> </td><td class="right">   sent again in new frames as needed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   New frames and packets are used to carry information that is</td><td> </td><td class="right">   New frames and packets are used to carry information that is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   determined to have been lost.  In general, information is sent again</td><td> </td><td class="right">   determined to have been lost.  In general, information is sent again</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   when a packet containing that information is determined to be lost</td><td> </td><td class="right">   when a packet containing that information is determined to be lost</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and sending ceases when a packet containing that information is</td><td> </td><td class="right">   and sending ceases when a packet containing that information is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   acknowledged.</td><td> </td><td class="right">   acknowledged.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0335"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Data sent in CRYPTO frames is retransmitted according to the rules</td><td> </td><td class="rblock">   <span class="insert">*</span>  Data sent in CRYPTO frames is retransmitted according to the rules</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      in [QUIC-RECOVERY], until all data has been acknowledged.  Data in</td><td> </td><td class="right">      in [QUIC-RECOVERY], until all data has been acknowledged.  Data in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      CRYPTO frames for Initial and Handshake packets is discarded when</td><td> </td><td class="right">      CRYPTO frames for Initial and Handshake packets is discarded when</td><td class="lineno"></td></tr>
      <tr id="diff0336"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      keys for the corresponding <span class="delete">encryption level</span> are discarded.</td><td> </td><td class="rblock">      keys for the corresponding <span class="insert">packet number space</span> are discarded.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0337"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Application data sent in STREAM frames is retransmitted in new</td><td> </td><td class="rblock">   <span class="insert">*</span>  Application data sent in STREAM frames is retransmitted in new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      STREAM frames unless the endpoint has sent a RESET_STREAM for that</td><td> </td><td class="right">      STREAM frames unless the endpoint has sent a RESET_STREAM for that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      stream.  Once an endpoint sends a RESET_STREAM frame, no further</td><td> </td><td class="right">      stream.  Once an endpoint sends a RESET_STREAM frame, no further</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      STREAM frames are needed.</td><td> </td><td class="right">      STREAM frames are needed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0338"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  The</span> most recent set of <span class="delete">acknowledgments are sent in ACK frames.  An</span></td><td> </td><td class="rblock">   <span class="insert">*  ACK frames carry the</span> most recent set of <span class="insert">acknowledgements and the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      ACK frame SHOULD contain all unacknowledged acknowledgments,</span> as</td><td> </td><td class="rblock"><span class="insert">      Ack Delay from the largest acknowledged packet,</span> as described in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      described in Section <span class="delete">13.1.1.</span></td><td> </td><td class="rblock">      Section <span class="insert">13.2.1.  Delaying the transmission of packets containing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      ACK frames or sending old ACK frames can cause the peer to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      generate an inflated RTT sample or unnecessarily disable ECN.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0339"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Cancellation of stream transmission, as carried in a RESET_STREAM</td><td> </td><td class="rblock">   <span class="insert">*</span>  Cancellation of stream transmission, as carried in a RESET_STREAM</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      frame, is sent until acknowledged or until all stream data is</td><td> </td><td class="right">      frame, is sent until acknowledged or until all stream data is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      acknowledged by the peer (that is, either the "Reset Recvd" or</td><td> </td><td class="right">      acknowledged by the peer (that is, either the "Reset Recvd" or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      "Data Recvd" state is reached on the sending part of the stream).</td><td> </td><td class="right">      "Data Recvd" state is reached on the sending part of the stream).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      The content of a RESET_STREAM frame MUST NOT change when it is</td><td> </td><td class="right">      The content of a RESET_STREAM frame MUST NOT change when it is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      sent again.</td><td> </td><td class="right">      sent again.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0340"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Similarly, a request to cancel stream transmission, as encoded in</td><td> </td><td class="rblock">   <span class="insert">*</span>  Similarly, a request to cancel stream transmission, as encoded in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      a STOP_SENDING frame, is sent until the receiving part of the</td><td> </td><td class="right">      a STOP_SENDING frame, is sent until the receiving part of the</td><td class="lineno"></td></tr>
      <tr id="diff0341"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      stream enters either a "Data Recvd" or "Reset Recvd" state<span class="delete">,</span> see</td><td> </td><td class="rblock">      stream enters either a "Data Recvd" or "Reset Recvd" state<span class="insert">;</span> see</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Section 3.5.</td><td> </td><td class="right">      Section 3.5.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0342"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Connection close signals, including packets that contain</td><td> </td><td class="rblock">   <span class="insert">*</span>  Connection close signals, including packets that contain</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      CONNECTION_CLOSE frames, are not sent again when packet loss is</td><td> </td><td class="right">      CONNECTION_CLOSE frames, are not sent again when packet loss is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      detected, but as described in Section 10.</td><td> </td><td class="right">      detected, but as described in Section 10.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0343"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The current connection maximum data is sent in MAX_DATA frames.</td><td> </td><td class="rblock">   <span class="insert">*</span>  The current connection maximum data is sent in MAX_DATA frames.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      An updated value is sent in a MAX_DATA frame if the packet</td><td> </td><td class="right">      An updated value is sent in a MAX_DATA frame if the packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      containing the most recently sent MAX_DATA frame is declared lost,</td><td> </td><td class="right">      containing the most recently sent MAX_DATA frame is declared lost,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      or when the endpoint decides to update the limit.  Care is</td><td> </td><td class="right">      or when the endpoint decides to update the limit.  Care is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      necessary to avoid sending this frame too often as the limit can</td><td> </td><td class="right">      necessary to avoid sending this frame too often as the limit can</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      increase frequently and cause an unnecessarily large number of</td><td> </td><td class="right">      increase frequently and cause an unnecessarily large number of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      MAX_DATA frames to be sent.</td><td> </td><td class="right">      MAX_DATA frames to be sent.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0344"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The current maximum stream data offset is sent in MAX_STREAM_DATA</td><td> </td><td class="rblock">   <span class="insert">*</span>  The current maximum stream data offset is sent in MAX_STREAM_DATA</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      frames.  Like MAX_DATA, an updated value is sent when the packet</td><td> </td><td class="right">      frames.  Like MAX_DATA, an updated value is sent when the packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      containing the most recent MAX_STREAM_DATA frame for a stream is</td><td> </td><td class="right">      containing the most recent MAX_STREAM_DATA frame for a stream is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      lost or when the limit is updated, with care taken to prevent the</td><td> </td><td class="right">      lost or when the limit is updated, with care taken to prevent the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      frame from being sent too often.  An endpoint SHOULD stop sending</td><td> </td><td class="right">      frame from being sent too often.  An endpoint SHOULD stop sending</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      MAX_STREAM_DATA frames when the receiving part of the stream</td><td> </td><td class="right">      MAX_STREAM_DATA frames when the receiving part of the stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      enters a "Size Known" state.</td><td> </td><td class="right">      enters a "Size Known" state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0345"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The limit on streams of a given type is sent in MAX_STREAMS</td><td> </td><td class="rblock">   <span class="insert">*</span>  The limit on streams of a given type is sent in MAX_STREAMS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      frames.  Like MAX_DATA, an updated value is sent when a packet</td><td> </td><td class="right">      frames.  Like MAX_DATA, an updated value is sent when a packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      containing the most recent MAX_STREAMS for a stream type frame is</td><td> </td><td class="right">      containing the most recent MAX_STREAMS for a stream type frame is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      declared lost or when the limit is updated, with care taken to</td><td> </td><td class="right">      declared lost or when the limit is updated, with care taken to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      prevent the frame from being sent too often.</td><td> </td><td class="right">      prevent the frame from being sent too often.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0346"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Blocked signals are carried in DATA_BLOCKED, STREAM_DATA_BLOCKED,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Blocked signals are carried in DATA_BLOCKED, STREAM_DATA_BLOCKED,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      and STREAMS_BLOCKED frames.  DATA_BLOCKED frames have connection</td><td> </td><td class="right">      and STREAMS_BLOCKED frames.  DATA_BLOCKED frames have connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      scope, STREAM_DATA_BLOCKED frames have stream scope, and</td><td> </td><td class="right">      scope, STREAM_DATA_BLOCKED frames have stream scope, and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      STREAMS_BLOCKED frames are scoped to a specific stream type.  New</td><td> </td><td class="right">      STREAMS_BLOCKED frames are scoped to a specific stream type.  New</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      frames are sent if packets containing the most recent frame for a</td><td> </td><td class="right">      frames are sent if packets containing the most recent frame for a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      scope is lost, but only while the endpoint is blocked on the</td><td> </td><td class="right">      scope is lost, but only while the endpoint is blocked on the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      corresponding limit.  These frames always include the limit that</td><td> </td><td class="right">      corresponding limit.  These frames always include the limit that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      is causing blocking at the time that they are transmitted.</td><td> </td><td class="right">      is causing blocking at the time that they are transmitted.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0347"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  A liveness or path validation check using PATH_CHALLENGE frames is</td><td> </td><td class="rblock">   <span class="insert">*</span>  A liveness or path validation check using PATH_CHALLENGE frames is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      sent periodically until a matching PATH_RESPONSE frame is received</td><td> </td><td class="right">      sent periodically until a matching PATH_RESPONSE frame is received</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      or until there is no remaining need for liveness or path</td><td> </td><td class="right">      or until there is no remaining need for liveness or path</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      validation checking.  PATH_CHALLENGE frames include a different</td><td> </td><td class="right">      validation checking.  PATH_CHALLENGE frames include a different</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      payload each time they are sent.</td><td> </td><td class="right">      payload each time they are sent.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0348"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Responses to path validation using PATH_RESPONSE frames are sent</td><td> </td><td class="rblock">   <span class="insert">*</span>  Responses to path validation using PATH_RESPONSE frames are sent</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      just once.  <span class="delete">A new</span> PATH_CHALLENGE <span class="delete">frame will be sent if another</span></td><td> </td><td class="rblock">      just once.  <span class="insert">The peer is expected to send more</span> PATH_CHALLENGE</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      PATH_RESPONSE <span class="delete">frame is needed.</span></td><td> </td><td class="rblock">      <span class="insert">frames as necessary to evoke additional</span> PATH_RESPONSE <span class="insert">frames.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0349"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  New connection IDs are sent in NEW_CONNECTION_ID frames and</td><td> </td><td class="rblock">   <span class="insert">*</span>  New connection IDs are sent in NEW_CONNECTION_ID frames and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      retransmitted if the packet containing them is lost.</td><td> </td><td class="right">      retransmitted if the packet containing them is lost.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Retransmissions of this frame carry the same sequence number</td><td> </td><td class="right">      Retransmissions of this frame carry the same sequence number</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      value.  Likewise, retired connection IDs are sent in</td><td> </td><td class="right">      value.  Likewise, retired connection IDs are sent in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      RETIRE_CONNECTION_ID frames and retransmitted if the packet</td><td> </td><td class="right">      RETIRE_CONNECTION_ID frames and retransmitted if the packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      containing them is lost.</td><td> </td><td class="right">      containing them is lost.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0350"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  PING and PADDING frames contain no information, so lost PING or</td><td> </td><td class="rblock">   <span class="insert">*  NEW_TOKEN frames are retransmitted if the packet containing them</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      is lost.  No special support is made for detecting reordered and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      duplicated NEW_TOKEN frames other than a direct comparison of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      frame contents.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  PING and PADDING frames contain no information, so lost PING or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      PADDING frames do not require repair.</td><td> </td><td class="right">      PADDING frames do not require repair.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0351"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">*  The HANDSHAKE_DONE frame MUST be retransmitted until it is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      acknowledged.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Endpoints SHOULD prioritize retransmission of data over sending new</td><td> </td><td class="right">   Endpoints SHOULD prioritize retransmission of data over sending new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   data, unless priorities specified by the application indicate</td><td> </td><td class="right">   data, unless priorities specified by the application indicate</td><td class="lineno"></td></tr>
      <tr id="diff0352"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   otherwise<span class="delete"> (see Section 2.3)</span>.</td><td> </td><td class="rblock">   otherwise<span class="insert">; see Section 2.3</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Even though a sender is encouraged to assemble frames containing up-</td><td> </td><td class="right">   Even though a sender is encouraged to assemble frames containing up-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to-date information every time it sends a packet, it is not forbidden</td><td> </td><td class="right">   to-date information every time it sends a packet, it is not forbidden</td><td class="lineno"></td></tr>
      <tr id="diff0353"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to retransmit copies of frames from lost packets.  A receiver MUST</td><td> </td><td class="rblock">   to retransmit copies of frames from lost packets.  A <span class="insert">sender that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   accept packets containing an outdated frame, such as a MAX_DATA frame</td><td> </td><td class="rblock"><span class="insert">   retransmits copies of frames needs to handle decreases in available</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   carrying a smaller maximum data than one found in an older packet.</td><td> </td><td class="rblock"><span class="insert">   payload size due to change in packet number length, connection ID</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   length, and path MTU.  A</span> receiver MUST accept packets containing an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   outdated frame, such as a MAX_DATA frame carrying a smaller maximum</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   data than one found in an older packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Upon detecting losses, a sender MUST take appropriate congestion</td><td> </td><td class="right">   Upon detecting losses, a sender MUST take appropriate congestion</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   control action.  The details of loss detection and congestion control</td><td> </td><td class="right">   control action.  The details of loss detection and congestion control</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are described in [QUIC-RECOVERY].</td><td> </td><td class="right">   are described in [QUIC-RECOVERY].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0354"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">13.<span class="delete">3</span>.  Explicit Congestion Notification</td><td> </td><td class="rblock">13.<span class="insert">4</span>.  Explicit Congestion Notification</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC endpoints can use Explicit Congestion Notification (ECN)</td><td> </td><td class="right">   QUIC endpoints can use Explicit Congestion Notification (ECN)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC3168] to detect and respond to network congestion.  ECN allows a</td><td> </td><td class="right">   [RFC3168] to detect and respond to network congestion.  ECN allows a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   network node to indicate congestion in the network by setting a</td><td> </td><td class="right">   network node to indicate congestion in the network by setting a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   codepoint in the IP header of a packet instead of dropping it.</td><td> </td><td class="right">   codepoint in the IP header of a packet instead of dropping it.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Endpoints react to congestion by reducing their sending rate in</td><td> </td><td class="right">   Endpoints react to congestion by reducing their sending rate in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   response, as described in [QUIC-RECOVERY].</td><td> </td><td class="right">   response, as described in [QUIC-RECOVERY].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   To use ECN, QUIC endpoints first determine whether a path supports</td><td> </td><td class="right">   To use ECN, QUIC endpoints first determine whether a path supports</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ECN marking and the peer is able to access the ECN codepoint in the</td><td> </td><td class="right">   ECN marking and the peer is able to access the ECN codepoint in the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   IP header.  A network path does not support ECN if ECN marked packets</td><td> </td><td class="right">   IP header.  A network path does not support ECN if ECN marked packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   get dropped or ECN markings are rewritten on the path.  An endpoint</td><td> </td><td class="right">   get dropped or ECN markings are rewritten on the path.  An endpoint</td><td class="lineno"></td></tr>
      <tr id="diff0355"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">verifies</span> the path, both during connection establishment and when</td><td> </td><td class="rblock">   <span class="insert">validates the use of ECN on</span> the path, both during connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   migrating to a new path <span class="delete">(see Section</span> 9).</td><td> </td><td class="rblock">   establishment and when migrating to a new path <span class="insert">(Section</span> 9).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0356"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">13.<span class="delete">3</span>.1.  ECN Counts</td><td> </td><td class="rblock">13.<span class="insert">4</span>.1.  ECN Counts</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   On receiving a QUIC packet with an ECT or CE codepoint, an ECN-</td><td> </td><td class="right">   On receiving a QUIC packet with an ECT or CE codepoint, an ECN-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   enabled endpoint that can access the ECN codepoints from the</td><td> </td><td class="right">   enabled endpoint that can access the ECN codepoints from the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   enclosing IP packet increases the corresponding ECT(0), ECT(1), or CE</td><td> </td><td class="right">   enclosing IP packet increases the corresponding ECT(0), ECT(1), or CE</td><td class="lineno"></td></tr>
      <tr id="diff0357"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   count, and includes these counts in subsequent ACK <span class="delete">frames (see</span></td><td> </td><td class="rblock">   count, and includes these counts in subsequent ACK <span class="insert">frames; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">13.1</span> and Section <span class="delete">19.3).</span>  Note that this requires being able</td><td> </td><td class="rblock">   Section <span class="insert">13.2</span> and Section <span class="insert">19.3.</span>  Note that this requires being able to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to read the ECN codepoints from the enclosing IP packet, which is not</td><td> </td><td class="rblock">   read the ECN codepoints from the enclosing IP packet, which is not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   possible on all platforms.</td><td> </td><td class="right">   possible on all platforms.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0358"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A packet detected by a receiver as a duplicate does not affect the</td><td> </td><td class="rblock">   <span class="insert">An IP packet that results in no QUIC packets being processed does not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   receiver's local ECN codepoint counts; see <span class="delete">(Section 21.7)</span> for</td><td> </td><td class="rblock"><span class="insert">   increase ECN counts.</span>  A <span class="insert">QUIC</span> packet detected by a receiver as a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   relevant security concerns.</td><td> </td><td class="rblock">   duplicate does not affect the receiver's local ECN codepoint counts;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   see <span class="insert">Section 21.8</span> for relevant security concerns.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If an endpoint receives a QUIC packet without an ECT or CE codepoint</td><td> </td><td class="right">   If an endpoint receives a QUIC packet without an ECT or CE codepoint</td><td class="lineno"></td></tr>
      <tr id="diff0359"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   in the IP packet header, it responds per Section 13.<span class="delete">1</span> with an ACK</td><td> </td><td class="rblock">   in the IP packet header, it responds per Section 13.<span class="insert">2</span> with an ACK</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame without increasing any ECN counts.  If an endpoint does not</td><td> </td><td class="right">   frame without increasing any ECN counts.  If an endpoint does not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   implement ECN support or does not have access to received ECN</td><td> </td><td class="right">   implement ECN support or does not have access to received ECN</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   codepoints, it does not increase ECN counts.</td><td> </td><td class="right">   codepoints, it does not increase ECN counts.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Coalesced packets (see Section 12.2) mean that several packets can</td><td> </td><td class="right">   Coalesced packets (see Section 12.2) mean that several packets can</td><td class="lineno"></td></tr>
      <tr id="diff0360"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   share the same IP header.  The ECN count<span class="delete">er</span> for the ECN codepoint</td><td> </td><td class="rblock">   share the same IP header.  The ECN count<span class="insert">s</span> for the ECN codepoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   received in the associated IP header are incremented once for each</td><td> </td><td class="right">   received in the associated IP header are incremented once for each</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC packet, not per enclosing IP packet or UDP datagram.</td><td> </td><td class="right">   QUIC packet, not per enclosing IP packet or UDP datagram.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Each packet number space maintains separate acknowledgement state and</td><td> </td><td class="right">   Each packet number space maintains separate acknowledgement state and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   separate ECN counts.  For example, if one each of an Initial, 0-RTT,</td><td> </td><td class="right">   separate ECN counts.  For example, if one each of an Initial, 0-RTT,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Handshake, and 1-RTT QUIC packet are coalesced, the corresponding</td><td> </td><td class="right">   Handshake, and 1-RTT QUIC packet are coalesced, the corresponding</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   counts for the Initial and Handshake packet number space will be</td><td> </td><td class="right">   counts for the Initial and Handshake packet number space will be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   incremented by one and the counts for the 1-RTT packet number space</td><td> </td><td class="right">   incremented by one and the counts for the 1-RTT packet number space</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   will be increased by two.</td><td> </td><td class="right">   will be increased by two.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0361"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">13.<span class="delete">3.2.  ECN Verific</span>ation</td><td> </td><td class="rblock">13.<span class="insert">4.2.  ECN Valid</span>ation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0362"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Each endpoint independently verifies and enables use of ECN by</span></td><td> </td><td class="rblock">   <span class="insert">It is possible</span> for <span class="insert">faulty network devices</span> to <span class="insert">corrupt or erroneously</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   setting the IP header ECN codepoint to ECN Capable Transport (ECT)</span></td><td> </td><td class="rblock"><span class="insert">   drop</span> packets <span class="insert">with ECN markings.  To provide robust connectivity in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   for <span class="delete">the path from it</span> to <span class="delete">the other peer.  Even if not setting ECN</span></td><td> </td><td class="rblock">   the <span class="insert">presence of such devices, each</span> endpoint <span class="insert">independently validates</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   codepoints on</span> packets <span class="delete">it transmits,</span> the endpoint <span class="delete">SHOULD provide</span></td><td> </td><td class="rblock">   ECN <span class="insert">counts and disables ECN if errors are detected.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   feedback about</span> ECN <span class="delete">markings received (if accessible).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0363"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">To verify both that a</span> path <span class="delete">supports</span> ECN and <span class="delete">the peer can provide</span> ECN</td><td> </td><td class="rblock">   <span class="insert">Endpoints validate ECN for packets sent on each network</span> path</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">feedback, an endpoint sets the ECT(0) codepoint in the IP header of</span></td><td> </td><td class="rblock">   <span class="insert">independently.  An endpoint thus validates</span> ECN <span class="insert">on new connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   all outgoing packets [RFC8311].</span></td><td> </td><td class="rblock"><span class="insert">   establishment, when switching to a new server preferred address,</span> and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">on active connection migration to a new path.  Appendix B describes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   one possible algorithm for testing paths for</span> ECN <span class="insert">support.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0364"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If</span> an <span class="delete">ECT codepoint set in the IP header is</span> not <span class="delete">corrupted by a</span></td><td> </td><td class="rblock">   <span class="insert">Even if</span> an <span class="insert">endpoint does</span> not <span class="insert">use ECN markings on packets it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   network device, then a received packet contains either</span> the <span class="delete">codepoint</span></td><td> </td><td class="rblock"><span class="insert">   transmits,</span> the <span class="insert">endpoint MUST provide feedback about ECN markings</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   sent by</span> the peer <span class="delete">or</span> the <span class="delete">Congestion Experienced (CE) codepoint set by</span></td><td> </td><td class="rblock"><span class="insert">   received from</span> the peer <span class="insert">if they are accessible.  Failing to report ECN</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   a network device that is experiencing congestion.</span></td><td> </td><td class="rblock"><span class="insert">   counts will cause</span> the <span class="insert">peer to disable ECN marking.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0365"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If a QUIC packet sent with an ECT codepoint is newly acknowledged by</span></td><td> </td><td class="rblock"><span class="insert">13.4.2.1.  Sending</span> ECN <span class="insert">Markings</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the peer in an ACK frame without</span> ECN <span class="delete">feedback, the endpoint stops</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   setting ECT codepoints in subsequent IP packets, with the expectation</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that either the network path or the peer no longer supports ECN.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0366"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Network devices that corrupt or apply non-standard ECN markings might</span></td><td> </td><td class="rblock">   To <span class="insert">start ECN validation,</span> an endpoint <span class="insert">SHOULD do</span> the following <span class="insert">when</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   result in reduced throughput or other undesirable side-effects.</span>  To</td><td> </td><td class="rblock"><span class="insert">   sending packets on a new path</span> to <span class="insert">a peer:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">reduce this risk,</span> an endpoint <span class="delete">uses</span> the following <span class="delete">steps</span> to <span class="delete">verify the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   counts it receives in an ACK frame.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0367"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  The total increase</span> in <span class="delete">ECT(0), ECT(1), and CE counts MUST be no</span></td><td> </td><td class="rblock">   <span class="insert">*  Set the ECT(0) codepoint</span> in the <span class="insert">IP header</span> of <span class="insert">early outgoing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      smaller than</span> the <span class="delete">total number</span> of <span class="delete">QUIC</span> packets sent <span class="delete">with an ECT</span></td><td> </td><td class="rblock">      packets sent <span class="insert">on a new path</span> to <span class="insert">the peer [RFC8311].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      codepoint that are newly acknowledged in this ACK frame.  This</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      step detects any network remarking from ECT(0), ECT(1), or CE</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      codepoints</span> to <span class="delete">Not-ECT.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0368"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Any increase in either ECT(0) or ECT(1) counts, plus any increase</td><td> </td><td class="rblock">   <span class="insert">*  If all packets that were sent with the ECT(0) codepoint are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      eventually deemed lost [QUIC-RECOVERY], validation is deemed to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      have failed.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   To reduce the chances of misinterpreting congestive loss as packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   dropped by a faulty network element, an endpoint could set the ECT(0)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   codepoint for only the first ten outgoing packets on a path, or for a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   period of three RTTs, whichever occurs first.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Other methods of probing paths for ECN support are possible, as are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   different marking strategies.  Implementations MAY use other methods</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   defined in RFCs; see [RFC8311].  Implementations that use the ECT(1)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   codepoint need to perform ECN validation using ECT(1) counts.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">13.4.2.2.  Receiving ACK Frames</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint that sets ECT(0) or ECT(1) codepoints on packets it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transmits MUST use the following steps on receiving an ACK frame to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   validate ECN.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  If this ACK frame newly acknowledges a packet that the endpoint</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      sent with either ECT(0) or ECT(1) codepoints set, and if no ECN</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      feedback is present in the ACK frame, validation fails.  This step</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      protects against both a network element that zeroes out ECN bits</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      and a peer that is unable to access ECN markings, since the peer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      could respond without ECN feedback in these cases.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  For validation to succeed, the total increase in ECT(0), ECT(1),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      and CE counts MUST be no smaller than the total number of QUIC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      packets sent with an ECT codepoint that are newly acknowledged in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      this ACK frame.  This step detects any network remarking from</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      ECT(0), ECT(1), or CE codepoints to Not-ECT.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  Any increase in either ECT(0) or ECT(1) counts, plus any increase</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      in the CE count, MUST be no smaller than the number of packets</td><td> </td><td class="right">      in the CE count, MUST be no smaller than the number of packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      sent with the corresponding ECT codepoint that are newly</td><td> </td><td class="right">      sent with the corresponding ECT codepoint that are newly</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      acknowledged in this ACK frame.  This step detects any erroneous</td><td> </td><td class="right">      acknowledged in this ACK frame.  This step detects any erroneous</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      network remarking from ECT(0) to ECT(1) (or vice versa).</td><td> </td><td class="right">      network remarking from ECT(0) to ECT(1) (or vice versa).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0369"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Processing ECN counts out of order can result in validation failure.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint SHOULD NOT perform this validation if this ACK frame does</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   not advance the largest packet number acknowledged in this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint could miss acknowledgements for a packet when ACK frames</td><td> </td><td class="right">   An endpoint could miss acknowledgements for a packet when ACK frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are lost.  It is therefore possible for the total increase in ECT(0),</td><td> </td><td class="right">   are lost.  It is therefore possible for the total increase in ECT(0),</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ECT(1), and CE counts to be greater than the number of packets</td><td> </td><td class="right">   ECT(1), and CE counts to be greater than the number of packets</td><td class="lineno"></td></tr>
      <tr id="diff0370"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   acknowledged in an ACK frame.  When this happens, and if v<span class="delete">erific</span>ation</td><td> </td><td class="rblock">   acknowledged in an ACK frame.  When this happens, and if v<span class="insert">alid</span>ation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   succeeds, the local reference counts MUST be increased to match the</td><td> </td><td class="right">   succeeds, the local reference counts MUST be increased to match the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   counts in the ACK frame.</td><td> </td><td class="right">   counts in the ACK frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0371"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Processing counts out of order can result in verification failure.</span></td><td> </td><td class="rblock"><span class="insert">13.4.2.3.  Validation Outcomes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   An endpoint SHOULD NOT perform this verification if the ACK frame is</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   received in a packet with packet number lower than a previously</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   received ACK frame.  Verifying based on ACK frames that arrive out of</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   order can result in disabling ECN unnecessarily.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0372"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Upon successful verification, an</span> endpoint <span class="delete">continues to set ECT</span></td><td> </td><td class="rblock">   <span class="insert">If validation fails, then the</span> endpoint <span class="insert">stops sending ECN markings</span> in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   codepoints</span> in subsequent packets with the expectation that the path</td><td> </td><td class="rblock">   subsequent <span class="insert">IP</span> packets with the expectation that <span class="insert">either</span> the <span class="insert">network</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">is ECN-capable.</span></td><td> </td><td class="rblock">   path <span class="insert">or the peer does not support ECN.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0373"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If verification fails, then the</span> endpoint <span class="delete">ceases setting</span> ECT</td><td> </td><td class="rblock">   <span class="insert">Upon successful validation, an</span> endpoint <span class="insert">can continue to set</span> ECT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   codepoints in subsequent <span class="delete">IP</span> packets with the expectation that <span class="delete">either</span></td><td> </td><td class="rblock">   codepoints in subsequent packets with the expectation that the path</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the <span class="delete">network</span> path <span class="delete">or</span> the <span class="delete">peer does not support ECN.</span></td><td> </td><td class="rblock">   <span class="insert">is ECN-capable.  Network routing and path elements can change mid-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection however; an endpoint MUST disable ECN if validation fails</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   at any point in</span> the <span class="insert">connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0374"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If an endpoint sets ECT codepoints on outgoing IP packets and</span></td><td> </td><td class="rblock">   <span class="insert">Even</span> if <span class="insert">validation fails,</span> an endpoint MAY <span class="insert">revalidate</span> ECN <span class="insert">on</span> the <span class="insert">same</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   encounters a retransmission timeout due to the absence of</span></td><td> </td><td class="rblock"><span class="insert">   path at any later time</span> in the <span class="insert">connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   acknowledgments from the peer (see [QUIC-RECOVERY]), or</span> if an</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   endpoint <span class="delete">has reason to believe that an element on the network path</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   might be corrupting ECN codepoints, the endpoint</span> MAY <span class="delete">cease setting</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   ECT codepoints in subsequent packets.  Doing so allows the connection</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   to be resilient to network elements that corrupt</span> ECN <span class="delete">codepoints in</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the <span class="delete">IP header or drop packets with ECT or CE codepoints</span> in the <span class="delete">IP</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   header.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">14.  Packet Size</td><td> </td><td class="right">14.  Packet Size</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The QUIC packet size includes the QUIC header and protected payload,</td><td> </td><td class="right">   The QUIC packet size includes the QUIC header and protected payload,</td><td class="lineno"></td></tr>
      <tr id="diff0375"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   but not the UDP or IP header.</td><td> </td><td class="rblock">   but not the UDP or IP header<span class="insert">s</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0376"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Clients MUST ensure they send the first Initial packet in</span> a <span class="delete">single</span> IP</td><td> </td><td class="rblock">   <span class="insert">QUIC depends upon</span> a <span class="insert">minimum</span> IP packet <span class="insert">size of at least 1280 bytes.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">packet.  Similarly, the first Initial packet sent after receiving a</span></td><td> </td><td class="rblock"><span class="insert">   This is the IPv6 minimum size [RFC8200] and is also supported by most</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Retry</span> packet <span class="delete">MUST be sent</span> in a <span class="delete">single IP packet.</span></td><td> </td><td class="rblock"><span class="insert">   modern IPv4 networks.  Assuming the minimum IP header size, this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   results</span> in a <span class="insert">QUIC maximum packet size of 1232 bytes for IPv6 and 1252</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   bytes for IPv4.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0377"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">payload of a UDP datagram carrying the first Initial packet MUST</span></td><td> </td><td class="rblock">   The <span class="insert">QUIC maximum</span> packet <span class="insert">size is</span> the <span class="insert">largest</span> size <span class="insert">of QUIC packet</span> that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   be expanded to at least 1200 bytes, by adding PADDING frames to the</span></td><td> </td><td class="rblock">   <span class="insert">can be sent across a</span> network path <span class="insert">using</span> a <span class="insert">single packet.  Any maximum</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Initial</span> packet <span class="delete">and/or by combining</span> the <span class="delete">Initial packet with a 0-RTT</span></td><td> </td><td class="rblock"><span class="insert">   packet size larger than 1200 bytes can be discovered using Path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packet (see Section 12.2).  Sending a UDP datagram of this</span> size</td><td> </td><td class="rblock">   Maximum Transmission Unit <span class="insert">Discovery (PMTUD; see Section 14.2.1) or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">ensures</span> that <span class="delete">the</span> network path <span class="delete">supports</span> a <span class="delete">reasonable</span> Maximum</td><td> </td><td class="rblock"><span class="insert">   Datagram Packetization Layer PMTU Discovery (DPLPMTUD;</span> see</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Transmission Unit <span class="delete">(MTU), and helps reduce the amplitude of</span></td><td> </td><td class="rblock">   Section <span class="insert">14.3).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   amplification attacks caused by server responses toward an unverified</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   client address,</span> see Section <span class="delete">8.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0378"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The datagram containing</span> the <span class="delete">first Initial</span> packet <span class="delete">from a client MAY</span></td><td> </td><td class="rblock">   <span class="insert">Enforcement of</span> the <span class="insert">max_udp_payload_size transport parameter</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   exceed 1200 bytes if</span> the <span class="delete">client believes that the Path Maximum</span></td><td> </td><td class="rblock"><span class="insert">   (Section 18.2) might act as an additional limit on the maximum</span> packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Transmission Unit (PMTU) supports</span> the size <span class="delete">that it chooses.</span></td><td> </td><td class="rblock">   <span class="insert">size.  A sender can avoid exceeding this limit, once the value is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   known.  However, prior to learning</span> the <span class="insert">value of</span> the <span class="insert">transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   parameter, endpoints risk datagrams being lost if they send packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   larger than the smallest allowed maximum packet</span> size <span class="insert">of 1200 bytes.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0379"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A <span class="delete">server MAY send a CONNECTION_CLOSE frame with error code</span></td><td> </td><td class="rblock">   <span class="insert">UDP datagrams MUST NOT be fragmented at the IP layer.  In IPv4</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   PROTOCOL_VIOLATION in response</span> to the <span class="delete">first</span> Initial packet <span class="delete">it</span></td><td> </td><td class="rblock"><span class="insert">   [IPv4], the DF bit MUST be set to prevent fragmentation on the path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   receives</span> from a client if the UDP datagram is <span class="delete">smaller</span> than 1200</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   bytes.  <span class="delete">It MUST NOT send any other</span> frame <span class="delete">type in response, or</span></td><td> </td><td class="rblock"><span class="insert">14.1.  Initial Packet Size</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   otherwise behave as if any part</span> of <span class="delete">the offending packet was processed</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   as valid.</span></td><td> </td><td class="rblock">   A <span class="insert">client MUST expand the payload of all UDP datagrams carrying</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Initial packets to at least the smallest allowed maximum packet size</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (1200 bytes) by adding PADDING frames</span> to the Initial packet <span class="insert">or by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   coalescing the Initial packet; see Section 12.2.  Sending a UDP</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   datagram of this size ensures that the network path</span> from <span class="insert">the client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to the server supports</span> a <span class="insert">reasonable Path Maximum Transmission Unit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (PMTU).  This also helps reduce the amplitude of amplification</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attacks caused by server responses toward an unverified</span> client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">address; see Section 8.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Datagrams containing Initial packets MAY exceed 1200 bytes</span> if the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">client believes that the network path and peer both support the size</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that it chooses.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A server MUST discard an Initial packet that is carried in a</span> UDP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   datagram <span class="insert">with a payload that</span> is <span class="insert">less</span> than <span class="insert">the smallest allowed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   maximum packet size of</span> 1200 bytes.  <span class="insert">A server MAY also immediately</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   close the connection by sending a CONNECTION_CLOSE</span> frame <span class="insert">with an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   error code</span> of <span class="insert">PROTOCOL_VIOLATION; see Section 10.3.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The server MUST also limit the number of bytes it sends before</td><td> </td><td class="right">   The server MUST also limit the number of bytes it sends before</td><td class="lineno"></td></tr>
      <tr id="diff0380"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   validating the address of the client<span class="delete">,</span> see Section 8.</td><td> </td><td class="rblock">   validating the address of the client<span class="insert">;</span> see Section 8.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0381"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">14.<span class="delete">1</span>.  Path Maximum Transmission Unit (PMTU)</td><td> </td><td class="rblock">14.<span class="insert">2</span>.  Path Maximum Transmission Unit (PMTU)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0382"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">PMTU</span> is the maximum size of the entire IP packet including the IP</td><td> </td><td class="rblock">   The <span class="insert">Path Maximum Transmission Unit (PMTU)</span> is the maximum size of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   header, UDP header, and UDP payload.  The UDP payload includes the</td><td> </td><td class="rblock">   entire IP packet including the IP header, UDP header, and UDP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   QUIC packet header, protected payload, and any authentication fields.</td><td> </td><td class="rblock">   payload.  The UDP payload includes the QUIC packet header, protected</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The PMTU can depend <span class="delete">upon the current</span> path <span class="delete">characteristics.</span></td><td> </td><td class="rblock">   payload, and any authentication fields.  The PMTU can depend <span class="insert">on</span> path</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Therefore, the current</span> largest UDP payload an <span class="delete">implementation will</span></td><td> </td><td class="rblock">   <span class="insert">characteristics, and can therefore change over time.  The</span> largest UDP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   send</span> is referred to as the <span class="delete">QUIC</span> maximum packet size.</td><td> </td><td class="rblock">   payload an <span class="insert">endpoint sends at any given time</span> is referred to as the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">endpoint's</span> maximum packet size.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0383"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">QUIC depends on a PMTU of at least 1280 bytes.  This is the IPv6</span></td><td> </td><td class="rblock">   <span class="insert">An endpoint</span> SHOULD <span class="insert">use DPLPMTUD (Section 14.3) or PMTUD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   minimum size [RFC8200] and is also supported by most modern IPv4</span></td><td> </td><td class="rblock"><span class="insert">   (Section 14.2.1)</span> to <span class="insert">determine whether</span> the <span class="insert">path to a destination will</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   networks.  All QUIC packets (except for PMTU probe packets)</span> SHOULD <span class="delete">be</span></td><td> </td><td class="rblock"><span class="insert">   support a desired</span> maximum packet size <span class="insert">without fragmentation.  In</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   sized</span> to <span class="delete">fit within</span> the maximum packet size <span class="delete">to avoid</span> the packet <span class="delete">being</span></td><td> </td><td class="rblock">   <span class="insert">absence of these mechanisms, QUIC endpoints SHOULD NOT send IP</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   fragmented or dropped [RFC8085].</span></td><td> </td><td class="rblock"><span class="insert">   packets larger than the smallest allowed maximum</span> packet <span class="insert">size.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0384"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">An endpoint SHOULD use Datagram Packetization Layer PMTU Discovery</span></td><td> </td><td class="rblock">   <span class="insert">Both DPLPMTUD and PMTUD send IP packets that are larger than</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   ([DPLPMTUD]) or implement Path MTU Discovery (PMTUD) [RFC1191]</span></td><td> </td><td class="rblock">   <span class="insert">current maximum packet size.  We refer</span> to <span class="insert">these as PMTU probes.  All</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC8201] to determine whether</span> the <span class="delete">path</span> to a <span class="delete">destination will support</span></td><td> </td><td class="rblock"><span class="insert">   QUIC packets that are not sent in</span> a <span class="insert">PMTU probe SHOULD be sized to fit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   a desired message</span> size <span class="delete">without fragmentation.</span></td><td> </td><td class="rblock"><span class="insert">   within the maximum packet</span> size <span class="insert">to avoid the packet being fragmented</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   or dropped [RFC8085].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0385"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">In</span> the <span class="delete">absence</span> of <span class="delete">these mechanisms, QUIC endpoints SHOULD NOT send</span> IP</td><td> </td><td class="rblock">   <span class="insert">If a QUIC endpoint determines that</span> the <span class="insert">PMTU between any pair</span> of <span class="insert">local</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">packets larger than 1280 bytes.  Assuming</span> the <span class="delete">minimum IP header size,</span></td><td> </td><td class="rblock"><span class="insert">   and remote</span> IP <span class="insert">addresses has fallen below</span> the <span class="insert">smallest allowed</span> maximum</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   this results in a QUIC</span> maximum packet size of <span class="delete">1232 bytes for IPv6 and</span></td><td> </td><td class="rblock">   packet size of <span class="insert">1200 bytes, it MUST immediately cease sending</span> QUIC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   1252 bytes for IPv4.  A</span> QUIC <span class="delete">implementation MAY be more conservative</span></td><td> </td><td class="rblock">   <span class="insert">packets, except</span> for <span class="insert">those in PMTU probes</span> or <span class="insert">those containing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   in computing the QUIC maximum packet size to allow</span> for <span class="delete">unknown tunnel</span></td><td> </td><td class="rblock"><span class="insert">   CONNECTION_CLOSE frames, on the affected path.  An endpoint MAY</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   overheads</span> or <span class="delete">IP header options/extensions.</span></td><td> </td><td class="rblock"><span class="insert">   terminate the connection if an alternative path cannot be found.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Each pair of local and remote addresses could have a different PMTU.</td><td> </td><td class="right">   Each pair of local and remote addresses could have a different PMTU.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC implementations that implement any kind of PMTU discovery</td><td> </td><td class="right">   QUIC implementations that implement any kind of PMTU discovery</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   therefore SHOULD maintain a maximum packet size for each combination</td><td> </td><td class="right">   therefore SHOULD maintain a maximum packet size for each combination</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   of local and remote IP addresses.</td><td> </td><td class="right">   of local and remote IP addresses.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0386"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If a</span> QUIC <span class="delete">endpoint determines that the PMTU between any pair of local</span></td><td> </td><td class="rblock">   <span class="insert">A</span> QUIC <span class="insert">implementation MAY be more conservative in computing</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   and remote IP addresses has fallen below the size needed to support</span></td><td> </td><td class="rblock">   maximum packet <span class="insert">size to allow</span> for <span class="insert">unknown tunnel overheads or IP</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the <span class="delete">smallest allowed</span> maximum packet <span class="delete">size, it MUST immediately cease</span></td><td> </td><td class="rblock"><span class="insert">   header options/extensions.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   sending QUIC packets, except</span> for <span class="delete">PMTU probe packets, on the affected</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   path.  An endpoint MAY terminate the connection if an alternative</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   path cannot be found.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0387"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">14.2.<span class="delete">  ICMP Packet Too Big Messages</span></td><td> </td><td class="rblock">14.2.<span class="insert">1.  Handling of ICMP Messages by PMTUD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0388"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">PMTU discovery [RFC1191] [RFC8201]</span> relies on reception of ICMP</td><td> </td><td class="rblock">   <span class="insert">Path Maximum Transmission Unit Discovery (PMTUD; [RFC1191],</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   messages (e.g., IPv6 Packet Too Big messages) that indicate when a</td><td> </td><td class="rblock"><span class="insert">   [RFC8201])</span> relies on reception of ICMP messages (e.g., IPv6 Packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet is dropped because it is larger than the local router MTU.</td><td> </td><td class="rblock">   Too Big messages) that indicate when a packet is dropped because it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   DPLPMTUD can also optionally use these messages.  This use of ICMP</td><td> </td><td class="rblock">   is larger than the local router MTU.  DPLPMTUD can also optionally</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   messages is potentially vulnerable to off-path attacks that</td><td> </td><td class="rblock">   use these messages.  This use of ICMP messages is potentially</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   successfully guess the addresses used on the path and reduce the PMTU</td><td> </td><td class="rblock">   vulnerable to off-path attacks that successfully guess the addresses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to a bandwidth-inefficient value.</td><td> </td><td class="rblock">   used on the path and reduce the PMTU to a bandwidth-inefficient</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   value.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MUST ignore an ICMP message that claims the PMTU has</td><td> </td><td class="right">   An endpoint MUST ignore an ICMP message that claims the PMTU has</td><td class="lineno"></td></tr>
      <tr id="diff0389"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   decreased below <span class="delete">1280 bytes</span>.</td><td> </td><td class="rblock">   decreased below <span class="insert">the minimum QUIC packet size</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The requirements for generating ICMP ([RFC1812], [RFC4443]) state</td><td> </td><td class="right">   The requirements for generating ICMP ([RFC1812], [RFC4443]) state</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that the quoted packet should contain as much of the original packet</td><td> </td><td class="right">   that the quoted packet should contain as much of the original packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   as possible without exceeding the minimum MTU for the IP version.</td><td> </td><td class="right">   as possible without exceeding the minimum MTU for the IP version.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The size of the quoted packet can actually be smaller, or the</td><td> </td><td class="right">   The size of the quoted packet can actually be smaller, or the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   information unintelligible, as described in Section 1.1 of</td><td> </td><td class="right">   information unintelligible, as described in Section 1.1 of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [DPLPMTUD].</td><td> </td><td class="right">   [DPLPMTUD].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0390"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   QUIC endpoints SHOULD validate ICMP messages to protect from off-path</td><td> </td><td class="rblock">   QUIC endpoints <span class="insert">using PMTUD</span> SHOULD validate ICMP messages to protect</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   injection as specified in [RFC8201] and Section 5.2 of [RFC8085].</td><td> </td><td class="rblock">   from off-path injection as specified in [RFC8201] and Section 5.2 of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This validation SHOULD use the quoted packet supplied in the payload</td><td> </td><td class="rblock">   [RFC8085].  This validation SHOULD use the quoted packet supplied in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   of an ICMP message to associate the message with a corresponding</td><td> </td><td class="rblock">   the payload of an ICMP message to associate the message with a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   transport connection <span class="delete">[DPLPMTUD].</span></td><td> </td><td class="rblock">   corresponding transport connection <span class="insert">(see Section 4.6.1 of [DPLPMTUD]).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ICMP message validation MUST include matching IP addresses and UDP</td><td> </td><td class="right">   ICMP message validation MUST include matching IP addresses and UDP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ports [RFC8085] and, when possible, connection IDs to an active QUIC</td><td> </td><td class="right">   ports [RFC8085] and, when possible, connection IDs to an active QUIC</td><td class="lineno"></td></tr>
      <tr id="diff0391"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   session.</td><td> </td><td class="rblock">   session.  <span class="insert">The endpoint SHOULD ignore all ICMP messages that fail</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   validation.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0392"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Further validation can also</span> be <span class="delete">provided:</span></td><td> </td><td class="rblock">   <span class="insert">An endpoint MUST NOT increase PMTU based on ICMP messages; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 3, clause 6 of [DPLPMTUD].  Any reduction in the QUIC maximum</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet size in response to ICMP messages MAY</span> be <span class="insert">provisional until</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   QUIC's loss detection algorithm determines that the quoted packet has</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   actually been lost.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0393"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  An IPv4 endpoint could set the Don't Fragment (DF) bit on a small</span></td><td> </td><td class="rblock"><span class="insert">14.3.  Datagram Packetization Layer PMTU Discovery</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      proportion of packets, so that most invalid ICMP messages arrive</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      when there are no DF packets outstanding, and can therefore be</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      identified as spurious.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0394"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  An endpoint could store additional information from the IP</span> or <span class="delete">UDP</span></td><td> </td><td class="rblock">   <span class="insert">Datagram Packetization Layer PMTU Discovery (DPLPMTUD; [DPLPMTUD])</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      headers to use</span> for <span class="delete">validation (for example,</span> the <span class="delete">IP ID or UDP</span></td><td> </td><td class="rblock"><span class="insert">   relies on tracking loss</span> or <span class="insert">acknowledgment of QUIC packets that are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      checksum).</span></td><td> </td><td class="rblock"><span class="insert">   carried in PMTU probes.  PMTU probes</span> for <span class="insert">DPLPMTUD that use</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">PADDING frame implement "Probing using padding data", as defined in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 4.1 of [DPLPMTUD].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0395"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The endpoint</span> SHOULD <span class="delete">ignore all ICMP messages that fail validation.</span></td><td> </td><td class="rblock">   <span class="insert">Endpoints</span> SHOULD <span class="insert">set the initial value of BASE_PMTU (see Section 5.1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of [DPLPMTUD]) to be consistent with the minimum QUIC packet size.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The MIN_PLPMTU is the same as the BASE_PMTU.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0396"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">An endpoint MUST NOT increase PMTU based on ICMP messages.  Any</span></td><td> </td><td class="rblock">   QUIC <span class="insert">endpoints implementing DPLPMTUD maintain a</span> maximum packet size</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   reduction in the</span> QUIC maximum packet size <span class="delete">MAY be provisional until</span></td><td> </td><td class="rblock">   <span class="insert">(DPLPMTUD MPS) for each combination of local and remote IP addresses.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   QUIC's loss detection algorithm determines that the quoted packet has</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   actually been lost.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0397"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">14.3.<span class="delete">  Datagram Packetization Layer PMTU Discover</span>y</td><td> </td><td class="rblock">14.3.<span class="insert">1.  DPLPMTUD and Initial Connectivit</span>y</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0398"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Section 6.4</span> of <span class="delete">[DPLPMTUD] provides considerations for implementing</span></td><td> </td><td class="rblock">   <span class="insert">From the perspective</span> of <span class="insert">DPLPMTUD, QUIC transport is an acknowledged</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Datagram Packetization Layer PMTUD (DPLPMTUD) with QUIC.</span></td><td> </td><td class="rblock"><span class="insert">   packetization layer (PL).  A sender can therefore enter the DPLPMTUD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   BASE state when the QUIC connection handshake has been completed.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0399"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">When implementing</span> the <span class="delete">algorithm in Section 5.3 of [DPLPMTUD], the</span></td><td> </td><td class="rblock"><span class="insert">14.3.2.  Validating</span> the QUIC <span class="insert">Path with DPLPMTUD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   initial value of BASE_PMTU SHOULD be consistent with the minimum</span> QUIC</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">packet size (1232 bytes for IPv6 and 1252 bytes for IPv4).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0400"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">PING and PADDING frames can be used to generate PMTU probe packets.</span></td><td> </td><td class="rblock">   <span class="insert">QUIC provides an acknowledged PL, therefore</span> a <span class="insert">sender does not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   These frames might not be retransmitted if</span> a <span class="delete">probe packet containing</span></td><td> </td><td class="rblock"><span class="insert">   implement the DPLPMTUD CONFIRMATION_TIMER while in</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   them is lost.  However, these frames do consume congestion window,</span></td><td> </td><td class="rblock">   <span class="insert">SEARCH_COMPLETE state; see Section 5.2</span> of <span class="insert">[DPLPMTUD].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   which could delay</span> the <span class="delete">transmission</span> of <span class="delete">subsequent application data.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0401"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A PING frame can be included in a PMTU probe to ensure that a valid</span></td><td> </td><td class="rblock"><span class="insert">14.3.3.  Handling of ICMP Messages by DPLPMTUD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   probe is acknowledged.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0402"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The considerations for processing ICMP messages in <span class="delete">the previous</span></td><td> </td><td class="rblock">   <span class="insert">An endpoint using DPLPMTUD requires the validation of any received</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   section</span> also apply if these messages are used by DPLPMTUD.</td><td> </td><td class="rblock"><span class="insert">   ICMP Packet Too Big (PTB) message before using the PTB information,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   as defined in Section 4.6 of [DPLPMTUD].  In addition to UDP port</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   validation, QUIC validates an ICMP message by using other PL</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   information (e.g., validation of connection IDs in the quoted packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of any received ICMP message).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   The considerations for processing ICMP messages <span class="insert">described</span> in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Section 14.2.1</span> also apply if these messages are used by DPLPMTUD.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">14.4.  Sending QUIC PMTU Probes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   PMTU probes are ack-eliciting packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Endpoints could limit the content of PMTU probes to PING and PADDING</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frames as packets that are larger than the current maximum packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   size are more likely to be dropped by the network.  Loss of a QUIC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet that is carried in a PMTU probe is therefore not a reliable</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   indication of congestion and SHOULD NOT trigger a congestion control</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   reaction; see Section 3, Bullet 7 of [DPLPMTUD].  However, PMTU</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   probes consume congestion window, which could delay subsequent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transmission by an application.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">14.4.1.  PMTU Probes Containing Source Connection ID</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Endpoints that rely on the destination connection ID for routing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   incoming QUIC packets are likely to require that the connection ID be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   included in PMTU probes to route any resulting ICMP messages</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (Section 14.2.1) back to the correct endpoint.  However, only long</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   header packets (Section 17.2) contain the Source Connection ID field,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   and long header packets are not decrypted or acknowledged by the peer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   once the handshake is complete.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   One way to construct a PMTU probe is to coalesce (see Section 12.2) a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet with a long header, such as a Handshake or 0-RTT packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (Section 17.2), with a short header packet in a single UDP datagram.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If the resulting PMTU probe reaches the endpoint, the packet with the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   long header will be ignored, but the short header packet will be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledged.  If the PMTU probe causes an ICMP message to be sent,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the first part of the probe will be quoted in that message.  If the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Source Connection ID field is within the quoted portion of the probe,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that could be used for routing or validation of the ICMP message.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Note:  The purpose of using a packet with a long header is only to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      ensure that the quoted packet contained in the ICMP message</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      contains a Source Connection ID field.  This packet does not need</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      to be a valid packet and it can be sent even if there is no</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      current use for packets of that type.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">15.  Versions</td><td> </td><td class="right">15.  Versions</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC versions are identified using a 32-bit unsigned number.</td><td> </td><td class="right">   QUIC versions are identified using a 32-bit unsigned number.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The version 0x00000000 is reserved to represent version negotiation.</td><td> </td><td class="right">   The version 0x00000000 is reserved to represent version negotiation.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This version of the specification is identified by the number</td><td> </td><td class="right">   This version of the specification is identified by the number</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0x00000001.</td><td> </td><td class="right">   0x00000001.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Other versions of QUIC might have different properties to this</td><td> </td><td class="right">   Other versions of QUIC might have different properties to this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-19" class="change"><td></td><th><small>skipping to change at</small><a href="#part-19"><em> page 76, line 50<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-19"><em> page 100, line 11<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Versions with the most significant 16 bits of the version number</td><td> </td><td class="right">   Versions with the most significant 16 bits of the version number</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   cleared are reserved for use in future IETF consensus documents.</td><td> </td><td class="right">   cleared are reserved for use in future IETF consensus documents.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Versions that follow the pattern 0x?a?a?a?a are reserved for use in</td><td> </td><td class="right">   Versions that follow the pattern 0x?a?a?a?a are reserved for use in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   forcing version negotiation to be exercised.  That is, any version</td><td> </td><td class="right">   forcing version negotiation to be exercised.  That is, any version</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   number where the low four bits of all bytes is 1010 (in binary).  A</td><td> </td><td class="right">   number where the low four bits of all bytes is 1010 (in binary).  A</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   client or server MAY advertise support for any of these reserved</td><td> </td><td class="right">   client or server MAY advertise support for any of these reserved</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   versions.</td><td> </td><td class="right">   versions.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0403"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Reserved version numbers will <span class="delete">probably</span> never represent a real</td><td> </td><td class="rblock">   Reserved version numbers will never represent a real protocol; a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   protocol; a client MAY use one of these version numbers with the</td><td> </td><td class="rblock">   client MAY use one of these version numbers with the expectation that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   expectation that the server will initiate version negotiation; a</td><td> </td><td class="rblock">   the server will initiate version negotiation; a server MAY advertise</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   server MAY advertise support for one of these versions and can expect</td><td> </td><td class="rblock">   support for one of these versions and can expect that clients ignore</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that clients ignore the value.</td><td> </td><td class="rblock">   the value.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [[RFC editor: please remove the remainder of this section before</td><td> </td><td class="right">   [[RFC editor: please remove the remainder of this section before</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   publication.]]</td><td> </td><td class="right">   publication.]]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The version number for the final version of this specification</td><td> </td><td class="right">   The version number for the final version of this specification</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (0x00000001), is reserved for the version of the protocol that is</td><td> </td><td class="right">   (0x00000001), is reserved for the version of the protocol that is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   published as an RFC.</td><td> </td><td class="right">   published as an RFC.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Version numbers used to identify IETF drafts are created by adding</td><td> </td><td class="right">   Version numbers used to identify IETF drafts are created by adding</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the draft number to 0xff000000.  For example, draft-ietf-quic-</td><td> </td><td class="right">   the draft number to 0xff000000.  For example, draft-ietf-quic-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   transport-13 would be identified as 0xff00000D.</td><td> </td><td class="right">   transport-13 would be identified as 0xff00000D.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Implementors are encouraged to register version numbers of QUIC that</td><td> </td><td class="right">   Implementors are encouraged to register version numbers of QUIC that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   they are using for private experimentation on the GitHub wiki at</td><td> </td><td class="right">   they are using for private experimentation on the GitHub wiki at</td><td class="lineno"></td></tr>
      <tr id="diff0404"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">&lt;https://github.com/quicwg/base-drafts/wiki/QUIC-Versions&gt;</span>.</td><td> </td><td class="rblock">   <span class="insert">https://github.com/quicwg/base-drafts/wiki/QUIC-Versions</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">16.  Variable-Length Integer Encoding</td><td> </td><td class="right">16.  Variable-Length Integer Encoding</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC packets and frames commonly use a variable-length encoding for</td><td> </td><td class="right">   QUIC packets and frames commonly use a variable-length encoding for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   non-negative integer values.  This encoding ensures that smaller</td><td> </td><td class="right">   non-negative integer values.  This encoding ensures that smaller</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   integer values need fewer bytes to encode.</td><td> </td><td class="right">   integer values need fewer bytes to encode.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The QUIC variable-length integer encoding reserves the two most</td><td> </td><td class="right">   The QUIC variable-length integer encoding reserves the two most</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   significant bits of the first byte to encode the base 2 logarithm of</td><td> </td><td class="right">   significant bits of the first byte to encode the base 2 logarithm of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the integer encoding length in bytes.  The integer value is encoded</td><td> </td><td class="right">   the integer encoding length in bytes.  The integer value is encoded</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   on the remaining bits, in network byte order.</td><td> </td><td class="right">   on the remaining bits, in network byte order.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This means that integers are encoded on 1, 2, 4, or 8 bytes and can</td><td> </td><td class="right">   This means that integers are encoded on 1, 2, 4, or 8 bytes and can</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   encode 6, 14, 30, or 62 bit values respectively.  Table 4 summarizes</td><td> </td><td class="right">   encode 6, 14, 30, or 62 bit values respectively.  Table 4 summarizes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the encoding properties.</td><td> </td><td class="right">   the encoding properties.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          +------+--------+-------------+-----------------------+</td><td> </td><td class="right">          +------+--------+-------------+-----------------------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | 2Bit | Length | Usable Bits | Range                 |</td><td> </td><td class="right">          | 2Bit | Length | Usable Bits | Range                 |</td><td class="lineno"></td></tr>
      <tr id="diff0405"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          +<span class="delete">------+--------+-------------+-----------------------</span>+</td><td> </td><td class="rblock">          +<span class="insert">======+========+=============+=======================</span>+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | 00   | 1      | 6           | 0-63                  |</td><td> </td><td class="right">          | 00   | 1      | 6           | 0-63                  |</td><td class="lineno"></td></tr>
      <tr id="diff0406"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          <span class="delete">|      |        |             |                       |</span></td><td> </td><td class="rblock">          <span class="insert">+------+--------+-------------+-----------------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | 01   | 2      | 14          | 0-16383               |</td><td> </td><td class="right">          | 01   | 2      | 14          | 0-16383               |</td><td class="lineno"></td></tr>
      <tr id="diff0407"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          <span class="delete">|      |        |             |                       |</span></td><td> </td><td class="rblock">          <span class="insert">+------+--------+-------------+-----------------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | 10   | 4      | 30          | 0-1073741823          |</td><td> </td><td class="right">          | 10   | 4      | 30          | 0-1073741823          |</td><td class="lineno"></td></tr>
      <tr id="diff0408"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          <span class="delete">|      |        |             |                       |</span></td><td> </td><td class="rblock">          <span class="insert">+------+--------+-------------+-----------------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          | 11   | 8      | 62          | 0-4611686018427387903 |</td><td> </td><td class="right">          | 11   | 8      | 62          | 0-4611686018427387903 |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          +------+--------+-------------+-----------------------+</td><td> </td><td class="right">          +------+--------+-------------+-----------------------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                   Table 4: Summary of Integer Encodings</td><td> </td><td class="right">                   Table 4: Summary of Integer Encodings</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   For example, the eight byte sequence c2 19 7c 5e ff 14 e8 8c (in</td><td> </td><td class="right">   For example, the eight byte sequence c2 19 7c 5e ff 14 e8 8c (in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   hexadecimal) decodes to the decimal value 151288809941952652; the</td><td> </td><td class="right">   hexadecimal) decodes to the decimal value 151288809941952652; the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   four byte sequence 9d 7f 3e 7d decodes to 494878333; the two byte</td><td> </td><td class="right">   four byte sequence 9d 7f 3e 7d decodes to 494878333; the two byte</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sequence 7b bd decodes to 15293; and the single byte 25 decodes to 37</td><td> </td><td class="right">   sequence 7b bd decodes to 15293; and the single byte 25 decodes to 37</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (as does the two byte sequence 40 25).</td><td> </td><td class="right">   (as does the two byte sequence 40 25).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0409"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Error codes (Section 20) and versions <span class="delete">Section 15</span> are described using</td><td> </td><td class="rblock">   Error codes (Section 20) and versions <span class="insert">(Section 15)</span> are described</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   integers, but do not use this encoding.</td><td> </td><td class="rblock">   using integers, but do not use this encoding.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">17.  Packet Formats</td><td> </td><td class="right">17.  Packet Formats</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   All numeric values are encoded in network byte order (that is, big-</td><td> </td><td class="right">   All numeric values are encoded in network byte order (that is, big-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endian) and all field sizes are in bits.  Hexadecimal notation is</td><td> </td><td class="right">   endian) and all field sizes are in bits.  Hexadecimal notation is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   used for describing the value of fields.</td><td> </td><td class="right">   used for describing the value of fields.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">17.1.  Packet Number Encoding and Decoding</td><td> </td><td class="right">17.1.  Packet Number Encoding and Decoding</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packet numbers are integers in the range 0 to 2^62-1 (Section 12.3).</td><td> </td><td class="right">   Packet numbers are integers in the range 0 to 2^62-1 (Section 12.3).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-20" class="change"><td></td><th><small>skipping to change at</small><a href="#part-20"><em> page 79, line 19<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-20"><em> page 103, line 4<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   Once header protection is removed, the packet number is decoded by</td><td> </td><td class="right">   Once header protection is removed, the packet number is decoded by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   finding the packet number value that is closest to the next expected</td><td> </td><td class="right">   finding the packet number value that is closest to the next expected</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet.  The next expected packet is the highest received packet</td><td> </td><td class="right">   packet.  The next expected packet is the highest received packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   number plus one.  For example, if the highest successfully</td><td> </td><td class="right">   number plus one.  For example, if the highest successfully</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authenticated packet had a packet number of 0xa82f30ea, then a packet</td><td> </td><td class="right">   authenticated packet had a packet number of 0xa82f30ea, then a packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   containing a 16-bit value of 0x9b32 will be decoded as 0xa82f9b32.</td><td> </td><td class="right">   containing a 16-bit value of 0x9b32 will be decoded as 0xa82f9b32.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Example pseudo-code for packet number decoding can be found in</td><td> </td><td class="right">   Example pseudo-code for packet number decoding can be found in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Appendix A.</td><td> </td><td class="right">   Appendix A.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">17.2.  Long Header Packets</td><td> </td><td class="right">17.2.  Long Header Packets</td><td class="lineno"></td></tr>
      <tr id="diff0410"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Long Header Packet {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Header Form (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Fixed Bit (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Long Packet Type (2),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Type-Specific Bits (4),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Version (32),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Destination Connection ID Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Destination Connection ID (0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Source Connection ID Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Source Connection ID (0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0411"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">                    Figure <span class="insert">12:</span> Long Header Packet Format</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |1|1|T T|X X X X|</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                         Version (32)                          |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |DCIL(4)|SCIL(4)|</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |               Destination Connection ID (0/32..144)         ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                 Source Connection ID (0/32..144)            ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                   Figure <span class="delete">10:</span> Long Header Packet Format</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Long headers are used for packets that are sent prior to the</td><td> </td><td class="right">   Long headers are used for packets that are sent prior to the</td><td class="lineno"></td></tr>
      <tr id="diff0412"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">completion of version negotiation and</span> establishment of 1-RTT keys.</td><td> </td><td class="rblock">   establishment of 1-RTT keys.  Once <span class="insert">1-RTT keys</span> are <span class="insert">available,</span> a sender</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Once <span class="delete">both conditions</span> are <span class="delete">met,</span> a sender switches to sending packets</td><td> </td><td class="rblock">   switches to sending packets using the short header (Section 17.3).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   using the short header (Section 17.3).  The long form allows for</td><td> </td><td class="rblock">   The long form allows for special packets - such as the Version</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   special packets - such as the Version Negotiation packet - to be</td><td> </td><td class="rblock">   Negotiation packet - to be represented in this uniform fixed-length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   represented in this uniform fixed-length packet format.  Packets that</td><td> </td><td class="rblock">   packet format.  Packets that use the long header contain the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   use the long header contain the following fields:</td><td> </td><td class="rblock">   following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Header Form:  The most significant bit (0x80) of byte 0 (the first</td><td> </td><td class="right">   Header Form:  The most significant bit (0x80) of byte 0 (the first</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      byte) is set to 1 for long headers.</td><td> </td><td class="right">      byte) is set to 1 for long headers.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Fixed Bit:  The next bit (0x40) of byte 0 is set to 1.  Packets</td><td> </td><td class="right">   Fixed Bit:  The next bit (0x40) of byte 0 is set to 1.  Packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      containing a zero value for this bit are not valid packets in this</td><td> </td><td class="right">      containing a zero value for this bit are not valid packets in this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      version and MUST be discarded.</td><td> </td><td class="right">      version and MUST be discarded.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0413"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Long Packet <span class="delete">Type (T):</span>  The next two bits (those with a mask of 0x30)</td><td> </td><td class="rblock">   Long Packet <span class="insert">Type:</span>  The next two bits (those with a mask of 0x30) of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      of byte 0 contain a packet type.  Packet types are listed in</td><td> </td><td class="rblock">      byte 0 contain a packet type.  Packet types are listed in Table 5.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      Table 5.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0414"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Type-Specific <span class="delete">Bits (X):</span>  The lower four bits (those with a mask of</td><td> </td><td class="rblock">   Type-Specific <span class="insert">Bits:</span>  The lower four bits (those with a mask of 0x0f)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      0x0f) of byte 0 are type-specific.</td><td> </td><td class="rblock">      of byte 0 are type-specific.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Version:  The QUIC Version is a 32-bit field that follows the first</td><td> </td><td class="right">   Version:  The QUIC Version is a 32-bit field that follows the first</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      byte.  This field indicates which version of QUIC is in use and</td><td> </td><td class="right">      byte.  This field indicates which version of QUIC is in use and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      determines how the rest of the protocol fields are interpreted.</td><td> </td><td class="right">      determines how the rest of the protocol fields are interpreted.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0415"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">DCIL and SCIL:</span>  The byte following the version contains the <span class="delete">lengths</span></td><td> </td><td class="rblock">   <span class="insert">Destination Connection ID Length:</span>  The byte following the version</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      of the <span class="delete">two connection ID fields that follow it.  These lengths are</span></td><td> </td><td class="rblock">      contains the <span class="insert">length in bytes</span> of the Destination Connection ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      encoded as two 4-bit unsigned integers.  The</span> Destination</td><td> </td><td class="rblock">      field that <span class="insert">follows it.  This length</span> is encoded <span class="insert">as</span> an <span class="insert">8-bit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      Connection ID <span class="delete">Length (DCIL) field occupies the 4 high bits of the</span></td><td> </td><td class="rblock"><span class="insert">      unsigned integer.  In QUIC version 1, this value MUST NOT exceed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      byte and the Source Connection ID Length (SCIL)</span> field <span class="delete">occupies the</span></td><td> </td><td class="rblock"><span class="insert">      20.  Endpoints that receive a version 1 long header</span> with <span class="insert">a</span> value</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      4 low bits of the byte.  An encoded length of 0 indicates</span> that <span class="delete">the</span></td><td> </td><td class="rblock">      <span class="insert">larger than 20 MUST drop the packet.  Servers SHOULD be able to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      connection ID</span> is <span class="delete">also 0 bytes in length.  Non-zero</span> encoded <span class="delete">lengths</span></td><td> </td><td class="rblock"><span class="insert">      read longer connection IDs from other QUIC versions in order to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      are increased by 3 to get the full length of the connection ID,</span></td><td> </td><td class="rblock"><span class="insert">      properly form</span> a <span class="insert">version negotiation packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      producing a length between 4 and 18 bytes inclusive.  For example,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      an <span class="delete">byte</span> with <span class="delete">the</span> value <span class="delete">0x50 describes an 8-byte Destination</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Connection ID and</span> a <span class="delete">zero-length Source Connection ID.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Destination Connection ID:  The Destination Connection ID field</td><td> </td><td class="right">   Destination Connection ID:  The Destination Connection ID field</td><td class="lineno"></td></tr>
      <tr id="diff0416"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      follows the <span class="delete">connection</span> ID <span class="delete">lengths</span> and is <span class="delete">either</span> 0 bytes in <span class="delete">length</span></td><td> </td><td class="rblock">      follows the <span class="insert">Destination Connection</span> ID <span class="insert">Length field</span> and is <span class="insert">between</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      or between 4 and 18 bytes.</span>  Section 7.2 describes the use of this</td><td> </td><td class="rblock">      0 <span class="insert">and 20</span> bytes in <span class="insert">length.</span>  Section 7.2 describes the use of this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      field in more detail.</td><td> </td><td class="right">      field in more detail.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0417"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Source Connection ID Length:  The byte following the Destination</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Connection ID contains the length in bytes of the Source</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Connection ID field that follows it.  This length is encoded as a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      8-bit unsigned integer.  In QUIC version 1, this value MUST NOT</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      exceed 20 bytes.  Endpoints that receive a version 1 long header</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      with a value larger than 20 MUST drop the packet.  Servers SHOULD</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      be able to read longer connection IDs from other QUIC versions in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      order to properly form a version negotiation packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Source Connection ID:  The Source Connection ID field follows the</td><td> </td><td class="right">   Source Connection ID:  The Source Connection ID field follows the</td><td class="lineno"></td></tr>
      <tr id="diff0418"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">Destination</span> Connection ID and is <span class="delete">either</span> 0 bytes in <span class="delete">length or</span></td><td> </td><td class="rblock">      <span class="insert">Source</span> Connection ID <span class="insert">Length field</span> and is <span class="insert">between</span> 0 <span class="insert">and 20</span> bytes in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      between 4 and 18 bytes.</span>  Section 7.2 describes the use of this</td><td> </td><td class="rblock">      <span class="insert">length.</span>  Section 7.2 describes the use of this field in more</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      field in more detail.</td><td> </td><td class="rblock">      detail.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   In this version of QUIC, the following packet types with the long</td><td> </td><td class="right">   In this version of QUIC, the following packet types with the long</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   header are defined:</td><td> </td><td class="right">   header are defined:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                   +------+-----------+----------------+</td><td> </td><td class="right">                   +------+-----------+----------------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                   | Type | Name      | Section        |</td><td> </td><td class="right">                   | Type | Name      | Section        |</td><td class="lineno"></td></tr>
      <tr id="diff0419"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                   +<span class="delete">------+-----------+----------------</span>+</td><td> </td><td class="rblock">                   +<span class="insert">======+===========+================</span>+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                   |  0x0 | Initial   | Section 17.2.2 |</td><td> </td><td class="right">                   |  0x0 | Initial   | Section 17.2.2 |</td><td class="lineno"></td></tr>
      <tr id="diff0420"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                   <span class="delete">|      |           |                |</span></td><td> </td><td class="rblock">                   <span class="insert">+------+-----------+----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                   |  0x1 | 0-RTT     | Section 17.2.3 |</td><td> </td><td class="right">                   |  0x1 | 0-RTT     | Section 17.2.3 |</td><td class="lineno"></td></tr>
      <tr id="diff0421"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                   <span class="delete">|      |           |                |</span></td><td> </td><td class="rblock">                   <span class="insert">+------+-----------+----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                   |  0x2 | Handshake | Section 17.2.4 |</td><td> </td><td class="right">                   |  0x2 | Handshake | Section 17.2.4 |</td><td class="lineno"></td></tr>
      <tr id="diff0422"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                   <span class="delete">|      |           |                |</span></td><td> </td><td class="rblock">                   <span class="insert">+------+-----------+----------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                   |  0x3 | Retry     | Section 17.2.5 |</td><td> </td><td class="right">                   |  0x3 | Retry     | Section 17.2.5 |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                   +------+-----------+----------------+</td><td> </td><td class="right">                   +------+-----------+----------------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                     Table 5: Long Header Packet Types</td><td> </td><td class="right">                     Table 5: Long Header Packet Types</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The header form bit, connection ID lengths byte, Destination and</td><td> </td><td class="right">   The header form bit, connection ID lengths byte, Destination and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Source Connection ID fields, and Version fields of a long header</td><td> </td><td class="right">   Source Connection ID fields, and Version fields of a long header</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet are version-independent.  The other fields in the first byte</td><td> </td><td class="right">   packet are version-independent.  The other fields in the first byte</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are version-specific.  See [QUIC-INVARIANTS] for details on how</td><td> </td><td class="right">   are version-specific.  See [QUIC-INVARIANTS] for details on how</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets from different versions of QUIC are interpreted.</td><td> </td><td class="right">   packets from different versions of QUIC are interpreted.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The interpretation of the fields and the payload are specific to a</td><td> </td><td class="right">   The interpretation of the fields and the payload are specific to a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   version and packet type.  While type-specific semantics for this</td><td> </td><td class="right">   version and packet type.  While type-specific semantics for this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   version are described in the following sections, several long-header</td><td> </td><td class="right">   version are described in the following sections, several long-header</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets in this version of QUIC contain these additional fields:</td><td> </td><td class="right">   packets in this version of QUIC contain these additional fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0423"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Reserved <span class="delete">Bits (R):</span>  Two bits (those with a mask of 0x0c) of byte 0</td><td> </td><td class="rblock">   Reserved <span class="insert">Bits:</span>  Two bits (those with a mask of 0x0c) of byte 0 are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      are reserved across multiple packet types.  These bits are</td><td> </td><td class="rblock">      reserved across multiple packet types.  These bits are protected</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      protected using header <span class="delete">protection (see</span> Section 5.4 of <span class="delete">[QUIC-TLS]).</span></td><td> </td><td class="rblock">      using header <span class="insert">protection; see</span> Section 5.4 of <span class="insert">[QUIC-TLS].</span>  The value</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      The value included prior to protection MUST be set to 0.  An</td><td> </td><td class="rblock">      included prior to protection MUST be set to 0.  An endpoint MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      endpoint MUST treat receipt of a packet that has a non-zero value</td><td> </td><td class="rblock">      treat receipt of a packet that has a non-zero value for these</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      for these <span class="delete">bits</span> after removing <span class="delete">protection</span> as a connection error of</td><td> </td><td class="rblock">      <span class="insert">bits,</span> after removing <span class="insert">both packet and header protection,</span> as a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      type PROTOCOL_VIOLATION.</td><td> </td><td class="rblock">      connection error of type PROTOCOL_VIOLATION.  <span class="insert">Discarding such a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      packet after only removing header protection can expose the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      endpoint to attacks; see Section 9.3 of [QUIC-TLS].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0424"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Packet Number <span class="delete">Length (P):</span>  In packet types which contain a Packet</td><td> </td><td class="rblock">   Packet Number <span class="insert">Length:</span>  In packet types which contain a Packet Number</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      Number field, the least significant two bits (those with a mask of</td><td> </td><td class="rblock">      field, the least significant two bits (those with a mask of 0x03)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      0x03) of byte 0 contain the length of the packet number, encoded</td><td> </td><td class="rblock">      of byte 0 contain the length of the packet number, encoded as an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      as an unsigned, two-bit integer that is one less than the length</td><td> </td><td class="rblock">      unsigned, two-bit integer that is one less than the length of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      of the packet number field in bytes.  That is, the length of the</td><td> </td><td class="rblock">      packet number field in bytes.  That is, the length of the packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      packet number field is the value of this field, plus one.  These</td><td> </td><td class="rblock">      number field is the value of this field, plus one.  These bits are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      bits are protected using header <span class="delete">protection (see</span> Section 5.4 of</td><td> </td><td class="rblock">      protected using header <span class="insert">protection; see</span> Section 5.4 of <span class="insert">[QUIC-TLS].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">[QUIC-TLS]).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Length:  The length of the remainder of the packet (that is, the</td><td> </td><td class="right">   Length:  The length of the remainder of the packet (that is, the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Packet Number and Payload fields) in bytes, encoded as a variable-</td><td> </td><td class="right">      Packet Number and Payload fields) in bytes, encoded as a variable-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      length integer (Section 16).</td><td> </td><td class="right">      length integer (Section 16).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packet Number:  The packet number field is 1 to 4 bytes long.  The</td><td> </td><td class="right">   Packet Number:  The packet number field is 1 to 4 bytes long.  The</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      packet number has confidentiality protection separate from packet</td><td> </td><td class="right">      packet number has confidentiality protection separate from packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      protection, as described in Section 5.4 of [QUIC-TLS].  The length</td><td> </td><td class="right">      protection, as described in Section 5.4 of [QUIC-TLS].  The length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of the packet number field is encoded in the Packet Number Length</td><td> </td><td class="right">      of the packet number field is encoded in the Packet Number Length</td><td class="lineno"></td></tr>
      <tr id="diff0425"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      bits of byte 0<span class="delete"> (see above)</span>.</td><td> </td><td class="rblock">      bits of byte 0<span class="insert">; see above</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">17.2.1.  Version Negotiation Packet</td><td> </td><td class="right">17.2.1.  Version Negotiation Packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A Version Negotiation packet is inherently not version-specific.</td><td> </td><td class="right">   A Version Negotiation packet is inherently not version-specific.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Upon receipt by a client, it will be identified as a Version</td><td> </td><td class="right">   Upon receipt by a client, it will be identified as a Version</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Negotiation packet based on the Version field having a value of 0.</td><td> </td><td class="right">   Negotiation packet based on the Version field having a value of 0.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The Version Negotiation packet is a response to a client packet that</td><td> </td><td class="right">   The Version Negotiation packet is a response to a client packet that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   contains a version that is not supported by the server, and is only</td><td> </td><td class="right">   contains a version that is not supported by the server, and is only</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sent by servers.</td><td> </td><td class="right">   sent by servers.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The layout of a Version Negotiation packet is:</td><td> </td><td class="right">   The layout of a Version Negotiation packet is:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0426"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">Version Negotiation Packet {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Header Form (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Unused <span class="insert">(7),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |1|</span>  Unused <span class="delete">(7) |</span></td><td> </td><td class="rblock">     Version (32) <span class="insert">= 0,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Destination Connection ID <span class="insert">Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                          Version (32)                         <span class="delete">|</span></td><td> </td><td class="rblock"><span class="insert">     Destination Connection ID (0..2040),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Source Connection ID <span class="insert">Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |DCIL(4)|SCIL(4)|</span></td><td> </td><td class="rblock"><span class="insert">     Source Connection ID (0..2040),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Supported Version (32) <span class="insert">...,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>               Destination Connection ID <span class="delete">(0/32..144)         ...</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                 Source Connection ID <span class="delete">(0/32..144)            ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                    Supported Version <span class="delete">1</span> (32)                 <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                   [Supported Version 2 (32)]                ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                                  ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                   [Supported Version N (32)]                ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0427"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                   Figure 1<span class="delete">1</span>: Version Negotiation Packet</td><td> </td><td class="rblock">                   Figure 1<span class="insert">3</span>: Version Negotiation Packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The value in the Unused field is selected randomly by the server.</td><td> </td><td class="right">   The value in the Unused field is selected randomly by the server.</td><td class="lineno"></td></tr>
      <tr id="diff0428"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Clients MUST ignore the value of this field.  Servers SHOULD set the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   most significant bit of this field (0x40) to 1 so that Version</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Negotiation packets appear to have the Fixed Bit field.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The Version field of a Version Negotiation packet MUST be set to</td><td> </td><td class="right">   The Version field of a Version Negotiation packet MUST be set to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0x00000000.</td><td> </td><td class="right">   0x00000000.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The server MUST include the value from the Source Connection ID field</td><td> </td><td class="right">   The server MUST include the value from the Source Connection ID field</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   of the packet it receives in the Destination Connection ID field.</td><td> </td><td class="right">   of the packet it receives in the Destination Connection ID field.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The value for Source Connection ID MUST be copied from the</td><td> </td><td class="right">   The value for Source Connection ID MUST be copied from the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Destination Connection ID of the received packet, which is initially</td><td> </td><td class="right">   Destination Connection ID of the received packet, which is initially</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   randomly selected by a client.  Echoing both connection IDs gives</td><td> </td><td class="right">   randomly selected by a client.  Echoing both connection IDs gives</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   clients some assurance that the server received the packet and that</td><td> </td><td class="right">   clients some assurance that the server received the packet and that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the Version Negotiation packet was not generated by an off-path</td><td> </td><td class="right">   the Version Negotiation packet was not generated by an off-path</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   attacker.</td><td> </td><td class="right">   attacker.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0429"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">As future versions of QUIC may support Connection IDs larger than the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   version 1 limit, Version Negotiation packets could carry Connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   IDs that are longer than 20 bytes.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The remainder of the Version Negotiation packet is a list of 32-bit</td><td> </td><td class="right">   The remainder of the Version Negotiation packet is a list of 32-bit</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   versions which the server supports.</td><td> </td><td class="right">   versions which the server supports.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A Version Negotiation packet cannot be explicitly acknowledged in an</td><td> </td><td class="right">   A Version Negotiation packet cannot be explicitly acknowledged in an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ACK frame by a client.  Receiving another Initial packet implicitly</td><td> </td><td class="right">   ACK frame by a client.  Receiving another Initial packet implicitly</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   acknowledges a Version Negotiation packet.</td><td> </td><td class="right">   acknowledges a Version Negotiation packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The Version Negotiation packet does not include the Packet Number and</td><td> </td><td class="right">   The Version Negotiation packet does not include the Packet Number and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Length fields present in other packets that use the long header form.</td><td> </td><td class="right">   Length fields present in other packets that use the long header form.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Consequently, a Version Negotiation packet consumes an entire UDP</td><td> </td><td class="right">   Consequently, a Version Negotiation packet consumes an entire UDP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-21" class="change"><td></td><th><small>skipping to change at</small><a href="#part-21"><em> page 84, line 5<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-21"><em> page 107, line 13<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   response to a single UDP datagram.</td><td> </td><td class="right">   response to a single UDP datagram.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   See Section 6 for a description of the version negotiation process.</td><td> </td><td class="right">   See Section 6 for a description of the version negotiation process.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">17.2.2.  Initial Packet</td><td> </td><td class="right">17.2.2.  Initial Packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An Initial packet uses long headers with a type value of 0x0.  It</td><td> </td><td class="right">   An Initial packet uses long headers with a type value of 0x0.  It</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   carries the first CRYPTO frames sent by the client and server to</td><td> </td><td class="right">   carries the first CRYPTO frames sent by the client and server to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   perform key exchange, and carries ACKs in either direction.</td><td> </td><td class="right">   perform key exchange, and carries ACKs in either direction.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0430"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">   <span class="insert">Initial Packet {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |1|1| 0 |R R|P P|</span></td><td> </td><td class="rblock"><span class="insert">     Header Form (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Fixed Bit (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                         Version <span class="delete">(32)                          |</span></td><td> </td><td class="rblock"><span class="insert">     Long Packet Type (2) = 0,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Reserved Bits (2),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |DCIL(4)|SCIL(4)|</span></td><td> </td><td class="rblock"><span class="insert">     Packet Number Length (2),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Version <span class="insert">(32),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>               Destination Connection ID <span class="delete">(0/32..144)         ...</span></td><td> </td><td class="rblock"><span class="insert">     Destination Connection ID Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Destination Connection ID <span class="insert">(0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                 Source Connection ID <span class="delete">(0/32..144)            ...</span></td><td> </td><td class="rblock">     Source Connection ID <span class="insert">Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Source Connection ID (0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                         Token Length <span class="delete">(i)                    ...</span></td><td> </td><td class="rblock">     Token Length <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Token <span class="insert">(..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                            Token <span class="delete">(*)                        ...</span></td><td> </td><td class="rblock">     Length <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Packet Number <span class="insert">(8..32),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                           Length <span class="delete">(i)                        ...</span></td><td> </td><td class="rblock"><span class="insert">     Packet</span> Payload <span class="insert">(..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                    Packet Number <span class="delete">(8/16/24/32)               ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                          Payload <span class="delete">(*)                        ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0431"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                         Figure 1<span class="delete">2</span>: Initial Packet</td><td> </td><td class="rblock">                         Figure 1<span class="insert">4</span>: Initial Packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The Initial packet contains a long header as well as the Length and</td><td> </td><td class="right">   The Initial packet contains a long header as well as the Length and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packet Number fields.  The first byte contains the Reserved and</td><td> </td><td class="right">   Packet Number fields.  The first byte contains the Reserved and</td><td class="lineno"></td></tr>
      <tr id="diff0432"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Packet Number Length bits.  Between the <span class="delete">SCID</span> and Length fields, there</td><td> </td><td class="rblock">   Packet Number Length bits.  Between the <span class="insert">Source Connection ID</span> and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   are two additional <span class="delete">field</span> specific to the Initial packet.</td><td> </td><td class="rblock">   Length fields, there are two additional <span class="insert">fields</span> specific to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Initial packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Token Length:  A variable-length integer specifying the length of the</td><td> </td><td class="right">   Token Length:  A variable-length integer specifying the length of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Token field, in bytes.  This value is zero if no token is present.</td><td> </td><td class="right">      Token field, in bytes.  This value is zero if no token is present.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Initial packets sent by the server MUST set the Token Length field</td><td> </td><td class="right">      Initial packets sent by the server MUST set the Token Length field</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      to zero; clients that receive an Initial packet with a non-zero</td><td> </td><td class="right">      to zero; clients that receive an Initial packet with a non-zero</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Token Length field MUST either discard the packet or generate a</td><td> </td><td class="right">      Token Length field MUST either discard the packet or generate a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      connection error of type PROTOCOL_VIOLATION.</td><td> </td><td class="right">      connection error of type PROTOCOL_VIOLATION.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Token:  The value of the token that was previously provided in a</td><td> </td><td class="right">   Token:  The value of the token that was previously provided in a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Retry packet or NEW_TOKEN frame.</td><td> </td><td class="right">      Retry packet or NEW_TOKEN frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0433"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Payload:  The payload of the packet.</td><td> </td><td class="rblock">   Pa<span class="insert">cket Pa</span>yload:  The payload of the packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   In order to prevent tampering by version-unaware middleboxes, Initial</td><td> </td><td class="right">   In order to prevent tampering by version-unaware middleboxes, Initial</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets are protected with connection- and version-specific keys</td><td> </td><td class="right">   packets are protected with connection- and version-specific keys</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Initial keys) as described in [QUIC-TLS].  This protection does not</td><td> </td><td class="right">   (Initial keys) as described in [QUIC-TLS].  This protection does not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provide confidentiality or integrity against on-path attackers, but</td><td> </td><td class="right">   provide confidentiality or integrity against on-path attackers, but</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provides some level of protection against off-path attackers.</td><td> </td><td class="right">   provides some level of protection against off-path attackers.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The client and server use the Initial packet type for any packet that</td><td> </td><td class="right">   The client and server use the Initial packet type for any packet that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   contains an initial cryptographic handshake message.  This includes</td><td> </td><td class="right">   contains an initial cryptographic handshake message.  This includes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   all cases where a new packet containing the initial cryptographic</td><td> </td><td class="right">   all cases where a new packet containing the initial cryptographic</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   message needs to be created, such as the packets sent after receiving</td><td> </td><td class="right">   message needs to be created, such as the packets sent after receiving</td><td class="lineno"></td></tr>
      <tr id="diff0434"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a <span class="delete">Version Negotiation (Section 17.2.1) or</span> Retry packet</td><td> </td><td class="rblock">   a Retry packet (Section 17.2.5).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   (Section 17.2.5).</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server sends its first Initial packet in response to a client</td><td> </td><td class="right">   A server sends its first Initial packet in response to a client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial.  A server may send multiple Initial packets.  The</td><td> </td><td class="right">   Initial.  A server may send multiple Initial packets.  The</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   cryptographic key exchange could require multiple round trips or</td><td> </td><td class="right">   cryptographic key exchange could require multiple round trips or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   retransmissions of this data.</td><td> </td><td class="right">   retransmissions of this data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The payload of an Initial packet includes a CRYPTO frame (or frames)</td><td> </td><td class="right">   The payload of an Initial packet includes a CRYPTO frame (or frames)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   containing a cryptographic handshake message, ACK frames, or both.</td><td> </td><td class="right">   containing a cryptographic handshake message, ACK frames, or both.</td><td class="lineno"></td></tr>
      <tr id="diff0435"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">PADDING</span> and CONNECTION_CLOSE frames are also permitted.  An endpoint</td><td> </td><td class="rblock">   <span class="insert">PING, PADDING,</span> and CONNECTION_CLOSE frames <span class="insert">of type 0x1c</span> are also</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that receives an Initial packet containing other frames can either</td><td> </td><td class="rblock">   permitted.  An endpoint that receives an Initial packet containing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   discard the packet as spurious or treat it as a connection error.</td><td> </td><td class="rblock">   other frames can either discard the packet as spurious or treat it as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   a connection error.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The first packet sent by a client always includes a CRYPTO frame that</td><td> </td><td class="right">   The first packet sent by a client always includes a CRYPTO frame that</td><td class="lineno"></td></tr>
      <tr id="diff0436"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   contains the <span class="delete">entirety</span> of the first cryptographic handshake message.</td><td> </td><td class="rblock">   contains the <span class="insert">start or all</span> of the first cryptographic handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">This packet, and the cryptographic handshake message, MUST fit in a</span></td><td> </td><td class="rblock">   message.  The first CRYPTO frame sent always begins at an offset of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   single UDP datagram (see Section 7).</span>  The first CRYPTO frame sent</td><td> </td><td class="rblock">   <span class="insert">0; see</span> Section <span class="insert">7.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   always begins at an offset of <span class="delete">0 (see</span> Section <span class="delete">7).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Note that if the server sends a HelloRetryRequest, the client will</td><td> </td><td class="right">   Note that if the server sends a HelloRetryRequest, the client will</td><td class="lineno"></td></tr>
      <tr id="diff0437"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   send <span class="delete">a second</span> Initial <span class="delete">packet.  This</span> Initial <span class="delete">packet</span> will continue the</td><td> </td><td class="rblock">   send <span class="insert">another series of</span> Initial <span class="insert">packets.  These</span> Initial <span class="insert">packets</span> will</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   cryptographic handshake and will contain <span class="delete">a</span> CRYPTO <span class="delete">frame with</span> an</td><td> </td><td class="rblock">   continue the cryptographic handshake and will contain CRYPTO <span class="insert">frames</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   offset matching the size of the CRYPTO <span class="delete">frame</span> sent in the first</td><td> </td><td class="rblock"><span class="insert">   starting at</span> an offset matching the size of the CRYPTO <span class="insert">frames</span> sent in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Initial <span class="delete">packet.  Cryptographic handshake messages subsequent to the</span></td><td> </td><td class="rblock">   the first <span class="insert">flight of</span> Initial <span class="insert">packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   first do not need to fit within a single UDP datagram.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">17.2.2.1.  Abandoning Initial Packets</td><td> </td><td class="right">17.2.2.1.  Abandoning Initial Packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A client stops both sending and processing Initial packets when it</td><td> </td><td class="right">   A client stops both sending and processing Initial packets when it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sends its first Handshake packet.  A server stops sending and</td><td> </td><td class="right">   sends its first Handshake packet.  A server stops sending and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   processing Initial packets when it receives its first Handshake</td><td> </td><td class="right">   processing Initial packets when it receives its first Handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet.  Though packets might still be in flight or awaiting</td><td> </td><td class="right">   packet.  Though packets might still be in flight or awaiting</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   acknowledgment, no further Initial packets need to be exchanged</td><td> </td><td class="right">   acknowledgment, no further Initial packets need to be exchanged</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   beyond this point.  Initial packet protection keys are discarded (see</td><td> </td><td class="right">   beyond this point.  Initial packet protection keys are discarded (see</td><td class="lineno"></td></tr>
      <tr id="diff0438"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">4.10</span> of [QUIC-TLS]) along with any loss recovery and</td><td> </td><td class="rblock">   Section <span class="insert">4.11.1</span> of [QUIC-TLS]) along with any loss recovery and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   congestion control <span class="delete">state (see Sections 5.3.1.2 and 6.9</span> of</td><td> </td><td class="rblock">   congestion control <span class="insert">state; see Section 6.4</span> of <span class="insert">[QUIC-RECOVERY].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">[QUIC-RECOVERY]).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Any data in CRYPTO frames is discarded - and no longer retransmitted</td><td> </td><td class="right">   Any data in CRYPTO frames is discarded - and no longer retransmitted</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   - when Initial keys are discarded.</td><td> </td><td class="right">   - when Initial keys are discarded.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">17.2.3.  0-RTT</td><td> </td><td class="right">17.2.3.  0-RTT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A 0-RTT packet uses long headers with a type value of 0x1, followed</td><td> </td><td class="right">   A 0-RTT packet uses long headers with a type value of 0x1, followed</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   by the Length and Packet Number fields.  The first byte contains the</td><td> </td><td class="right">   by the Length and Packet Number fields.  The first byte contains the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Reserved and Packet Number Length bits.  It is used to carry "early"</td><td> </td><td class="right">   Reserved and Packet Number Length bits.  It is used to carry "early"</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   data from the client to the server as part of the first flight, prior</td><td> </td><td class="right">   data from the client to the server as part of the first flight, prior</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to handshake completion.  As part of the TLS handshake, the server</td><td> </td><td class="right">   to handshake completion.  As part of the TLS handshake, the server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   can accept or reject this early data.</td><td> </td><td class="right">   can accept or reject this early data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   See Section 2.3 of [TLS13] for a discussion of 0-RTT data and its</td><td> </td><td class="right">   See Section 2.3 of [TLS13] for a discussion of 0-RTT data and its</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   limitations.</td><td> </td><td class="right">   limitations.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0439"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">   <span class="insert">0-RTT Packet {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |1|1| 1 |R R|P P|</span></td><td> </td><td class="rblock"><span class="insert">     Header Form (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Fixed Bit (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                         Version <span class="delete">(32)                          |</span></td><td> </td><td class="rblock"><span class="insert">     Long Packet Type (2) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Reserved Bits (2),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |DCIL(4)|SCIL(4)|</span></td><td> </td><td class="rblock"><span class="insert">     Packet Number Length (2),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Version <span class="insert">(32),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>               Destination Connection ID <span class="delete">(0/32..144)         ...</span></td><td> </td><td class="rblock"><span class="insert">     Destination Connection ID Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Destination Connection ID <span class="insert">(0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                 Source Connection ID <span class="delete">(0/32..144)            ...</span></td><td> </td><td class="rblock">     Source Connection ID Length <span class="insert">(8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Source Connection ID (0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                           Length <span class="delete">(i)                        ...</span></td><td> </td><td class="rblock"><span class="insert">     Length (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Packet Number <span class="insert">(8..32),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                    Packet Number <span class="delete">(8/16/24/32)               ...</span></td><td> </td><td class="rblock"><span class="insert">     Packet</span> Payload <span class="insert">(..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                          Payload <span class="delete">(*)                        ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0440"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                          <span class="delete">    </span> 0-RTT Packet</td><td> </td><td class="rblock">                          <span class="insert">Figure 15:</span> 0-RTT Packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packet numbers for 0-RTT protected packets use the same space as</td><td> </td><td class="right">   Packet numbers for 0-RTT protected packets use the same space as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   1-RTT protected packets.</td><td> </td><td class="right">   1-RTT protected packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0441"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   After a client receives a Retry <span class="delete">or Version Negotiation</span> packet, 0-RTT</td><td> </td><td class="rblock">   After a client receives a Retry packet, 0-RTT packets are likely to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets are likely to have been lost or discarded by the server.  A</td><td> </td><td class="rblock">   have been lost or discarded by the server.  A client <span class="insert">SHOULD</span> attempt</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   client <span class="delete">MAY</span> attempt to resend data in 0-RTT packets after it sends a</td><td> </td><td class="rblock">   to resend data in 0-RTT packets after it sends a new Initial packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   new Initial packet.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0442"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A client MUST NOT reset the packet number it uses for 0-RTT <span class="delete">packets.</span></td><td> </td><td class="rblock">   A client MUST NOT reset the packet number it uses for 0-RTT <span class="insert">packets,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   The</span> keys used to protect 0-RTT packets will not change as a result of</td><td> </td><td class="rblock"><span class="insert">   since the</span> keys used to protect 0-RTT packets will not change as a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   responding to a Retry <span class="delete">or Version Negotiation packet unless the client</span></td><td> </td><td class="rblock">   result of responding to a Retry <span class="insert">packet.</span>  Sending packets with the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   also regenerates the cryptographic handshake message.</span>  Sending</td><td> </td><td class="rblock">   same packet number in that case is likely to compromise the packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets with the same packet number in that case is likely to</td><td> </td><td class="rblock">   protection for all 0-RTT packets because the same key and nonce could</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   compromise the packet protection for all 0-RTT packets because the</td><td> </td><td class="rblock">   be used to protect different content.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   same key and nonce could be used to protect different content.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0443"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Receiving a Retry or Version Negotiation packet, especially a Retry</span></td><td> </td><td class="rblock">   A client only receives acknowledgments for its 0-RTT packets once the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that changes the connection ID used for subsequent packets, indicates</span></td><td> </td><td class="rblock">   handshake is complete.  Consequently, a server might expect 0-RTT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   a strong possibility that 0-RTT packets could be lost.</span>  A client only</td><td> </td><td class="rblock">   packets to start with a packet number of 0.  Therefore, in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   receives acknowledgments for its 0-RTT packets once the handshake is</td><td> </td><td class="rblock">   determining the length of the packet number encoding for 0-RTT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   complete.  Consequently, a server might expect 0-RTT packets to start</td><td> </td><td class="rblock">   packets, a client MUST assume that all packets up to the current</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   with a packet number of 0.  Therefore, in determining the length of</td><td> </td><td class="rblock">   packet number are in flight, starting from a packet number of 0.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the packet number encoding for 0-RTT packets, a client MUST assume</td><td> </td><td class="rblock">   Thus, 0-RTT packets could need to use a longer packet number</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that all packets up to the current packet number are in flight,</td><td> </td><td class="rblock">   encoding.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   starting from a packet number of 0.  Thus, 0-RTT packets could need</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to use a longer packet number encoding.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0444"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A client <span class="delete">SHOULD instead generate a fresh cryptographic handshake</span></td><td> </td><td class="rblock">   A client <span class="insert">MUST NOT send 0-RTT packets once it starts processing 1-RTT</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   message and start packet numbers</span> from <span class="delete">0.</span>  This <span class="delete">ensures</span> that <span class="delete">new</span> 0-RTT</td><td> </td><td class="rblock"><span class="insert">   packets</span> from <span class="insert">the server.</span>  This <span class="insert">means</span> that 0-RTT packets <span class="insert">cannot</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets <span class="delete">will not use the same keys, avoiding</span> any <span class="delete">risk of key and</span></td><td> </td><td class="rblock"><span class="insert">   contain</span> any <span class="insert">response to frames</span> from <span class="insert">1-RTT packets.  For instance, a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   nonce reuse; this also prevents 0-RTT packets from previous handshake</span></td><td> </td><td class="rblock"><span class="insert">   client cannot send an ACK frame in a 0-RTT packet, because that can</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   attempts</span> from <span class="delete">being accepted</span> as <span class="delete">part</span> of <span class="delete">the connection.</span></td><td> </td><td class="rblock"><span class="insert">   only acknowledge a 1-RTT packet.  An acknowledgment for a 1-RTT</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet MUST be carried in a 1-RTT packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A server SHOULD treat a violation of remembered limits</span> as <span class="insert">a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection error</span> of <span class="insert">an appropriate type (for instance, a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   FLOW_CONTROL_ERROR for exceeding stream data limits).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">17.2.4.  Handshake Packet</td><td> </td><td class="right">17.2.4.  Handshake Packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A Handshake packet uses long headers with a type value of 0x2,</td><td> </td><td class="right">   A Handshake packet uses long headers with a type value of 0x2,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   followed by the Length and Packet Number fields.  The first byte</td><td> </td><td class="right">   followed by the Length and Packet Number fields.  The first byte</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   contains the Reserved and Packet Number Length bits.  It is used to</td><td> </td><td class="right">   contains the Reserved and Packet Number Length bits.  It is used to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   carry acknowledgments and cryptographic handshake messages from the</td><td> </td><td class="right">   carry acknowledgments and cryptographic handshake messages from the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   server and client.</td><td> </td><td class="right">   server and client.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0445"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">   <span class="insert">Handshake Packet {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |1|1| 2 |R R|P P|</span></td><td> </td><td class="rblock"><span class="insert">     Header Form (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Fixed Bit (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                         Version <span class="delete">(32)                          |</span></td><td> </td><td class="rblock"><span class="insert">     Long Packet Type (2) = 2,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Reserved Bits (2),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |DCIL(4)|SCIL(4)|</span></td><td> </td><td class="rblock"><span class="insert">     Packet Number Length (2),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Version <span class="insert">(32),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>               Destination Connection ID <span class="delete">(0/32..144)         ...</span></td><td> </td><td class="rblock"><span class="insert">     Destination Connection ID Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Destination Connection ID <span class="insert">(0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                 Source Connection ID <span class="delete">(0/32..144)            ...</span></td><td> </td><td class="rblock">     Source Connection ID Length <span class="insert">(8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Source Connection ID (0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                           Length <span class="delete">(i)                        ...</span></td><td> </td><td class="rblock"><span class="insert">     Length (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Packet Number <span class="insert">(8..32),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                    Packet Number <span class="delete">(8/16/24/32)               ...</span></td><td> </td><td class="rblock"><span class="insert">     Packet</span> Payload <span class="insert">(..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                          Payload <span class="delete">(*)                        ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0446"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                   Figure 1<span class="delete">3</span>: Handshake Protected Packet</td><td> </td><td class="rblock">                   Figure 1<span class="insert">6</span>: Handshake Protected Packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Once a client has received a Handshake packet from a server, it uses</td><td> </td><td class="right">   Once a client has received a Handshake packet from a server, it uses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Handshake packets to send subsequent cryptographic handshake messages</td><td> </td><td class="right">   Handshake packets to send subsequent cryptographic handshake messages</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and acknowledgments to the server.</td><td> </td><td class="right">   and acknowledgments to the server.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The Destination Connection ID field in a Handshake packet contains a</td><td> </td><td class="right">   The Destination Connection ID field in a Handshake packet contains a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection ID that is chosen by the recipient of the packet; the</td><td> </td><td class="right">   connection ID that is chosen by the recipient of the packet; the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Source Connection ID includes the connection ID that the sender of</td><td> </td><td class="right">   Source Connection ID includes the connection ID that the sender of</td><td class="lineno"></td></tr>
      <tr id="diff0447"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the packet wishes to use<span class="delete"> (see Section 7.2)</span>.</td><td> </td><td class="rblock">   the packet wishes to use<span class="insert">; see Section 7.2</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Handshake packets are their own packet number space, and thus the</td><td> </td><td class="right">   Handshake packets are their own packet number space, and thus the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   first Handshake packet sent by a server contains a packet number of</td><td> </td><td class="right">   first Handshake packet sent by a server contains a packet number of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0.</td><td> </td><td class="right">   0.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The payload of this packet contains CRYPTO frames and could contain</td><td> </td><td class="right">   The payload of this packet contains CRYPTO frames and could contain</td><td class="lineno"></td></tr>
      <tr id="diff0448"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   PADDING, or ACK frames.  Handshake packets MAY contain</td><td> </td><td class="rblock">   <span class="insert">PING,</span> PADDING, or ACK frames.  Handshake packets MAY contain</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   CONNECTION_CLOSE <span class="delete">frames.</span>  Endpoints MUST treat receipt of Handshake</td><td> </td><td class="rblock">   CONNECTION_CLOSE <span class="insert">frames of type 0x1c.</span>  Endpoints MUST treat receipt</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets with other frames as a connection error.</td><td> </td><td class="rblock">   of Handshake packets with other frames as a connection error.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0449"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Like Initial packets (see Section 17.2.2.1), data in CRYPTO frames <span class="delete">at</span></td><td> </td><td class="rblock">   Like Initial packets (see Section 17.2.2.1), data in CRYPTO frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the</span> Handshake <span class="delete">encryption level</span> is discarded - and no longer</td><td> </td><td class="rblock">   <span class="insert">for</span> Handshake <span class="insert">packets</span> is discarded - and no longer retransmitted -</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   retransmitted - when Handshake protection keys are discarded.</td><td> </td><td class="rblock">   when Handshake protection keys are discarded.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">17.2.5.  Retry Packet</td><td> </td><td class="right">17.2.5.  Retry Packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A Retry packet uses a long packet header with a type value of 0x3.</td><td> </td><td class="right">   A Retry packet uses a long packet header with a type value of 0x3.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   It carries an address validation token created by the server.  It is</td><td> </td><td class="right">   It carries an address validation token created by the server.  It is</td><td class="lineno"></td></tr>
      <tr id="diff0450"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   used by a server that wishes to perform a <span class="delete">stateless retry (see</span></td><td> </td><td class="rblock">   used by a server that wishes to perform a <span class="insert">retry; see</span> Section <span class="insert">8.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">8.1).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0                   1                   2                   3</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |1|1| 3 | ODCIL |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                         Version (32)                          |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |DCIL(4)|SCIL(4)|</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |               Destination Connection ID (0/32..144)         ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                 Source Connection ID (0/32..144)            ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |          Original Destination Connection ID (0/32..144)     ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                        Retry Token (*)                      ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                          Figure 14: Retry Packet</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0451"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A</span> Retry <span class="delete">packet (shown in Figure 14) does not contain any protected</span></td><td> </td><td class="rblock">   Retry <span class="insert">Packet {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   fields.  In addition to the long header, it contains these additional</span></td><td> </td><td class="rblock"><span class="insert">     Header Form (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   fields:</span></td><td> </td><td class="rblock"><span class="insert">     Fixed Bit (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Long Packet Type (2) = 3,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Unused (4),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Version (32),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Destination Connection ID Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Destination Connection ID (0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Source Connection ID Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Source Connection ID (0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Retry Token (..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Retry Integrity Tag (128),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0452"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">ODCIL:  The four least-significant bits of the first byte of a</span> Retry</td><td> </td><td class="rblock">                          <span class="insert">Figure 17:</span> Retry <span class="insert">Packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">packet are not protected as they are for other packets with the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      long header, because Retry packets don't contain a protected</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      payload.  These bits instead encode the length of the Original</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Destination Connection ID field.  The length uses the same</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      encoding as the DCIL and SCIL fields.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0453"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Original Destination Connection ID:  The Original Destination</span></td><td> </td><td class="rblock">   <span class="insert">A</span> Retry <span class="insert">packet (shown</span> in <span class="insert">Figure 17) does not contain any protected</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Connection ID contains the value of the Destination Connection ID</span></td><td> </td><td class="rblock"><span class="insert">   fields.</span>  The <span class="insert">value in the Unused</span> field is <span class="insert">selected randomly by the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      from the Initial packet that this</span> Retry <span class="delete">is</span> in <span class="delete">response to.</span>  The</td><td> </td><td class="rblock"><span class="insert">   server.  In addition to the fields from the long header, it contains</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">length of this</span> field is <span class="delete">given in ODCIL.</span></td><td> </td><td class="rblock"><span class="insert">   these additional fields:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Retry Token:  An opaque token that the server can use to validate the</td><td> </td><td class="right">   Retry Token:  An opaque token that the server can use to validate the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      client's address.</td><td> </td><td class="right">      client's address.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0454"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Retry Integrity Tag:  See the Retry Packet Integrity section of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      [QUIC-TLS].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">17.2.5.1.  Sending a Retry Packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The server populates the Destination Connection ID with the</td><td> </td><td class="right">   The server populates the Destination Connection ID with the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection ID that the client included in the Source Connection ID of</td><td> </td><td class="right">   connection ID that the client included in the Source Connection ID of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the Initial packet.</td><td> </td><td class="right">   the Initial packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The server includes a connection ID of its choice in the Source</td><td> </td><td class="right">   The server includes a connection ID of its choice in the Source</td><td class="lineno"></td></tr>
      <tr id="diff0455"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Connection ID field.  This value MUST <span class="delete">not</span> be equal to the Destination</td><td> </td><td class="rblock">   Connection ID field.  This value MUST <span class="insert">NOT</span> be equal to the Destination</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Connection ID field of the packet sent by the client.  The client</td><td> </td><td class="rblock">   Connection ID field of the packet sent by the client.  <span class="insert">A client MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   MUST use <span class="delete">this connection</span> ID in the Destination Connection ID of</td><td> </td><td class="rblock"><span class="insert">   discard a Retry packet that contains a Source Connection ID field</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   subsequent packets that it sends.</td><td> </td><td class="rblock"><span class="insert">   that is identical to the Destination Connection ID field of its</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Initial packet.</span>  The client MUST use <span class="insert">the value from the Source</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Connection</span> ID <span class="insert">field of the Retry packet</span> in the Destination Connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   ID <span class="insert">field</span> of subsequent packets that it sends.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server MAY send Retry packets in response to Initial and 0-RTT</td><td> </td><td class="right">   A server MAY send Retry packets in response to Initial and 0-RTT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets.  A server can either discard or buffer 0-RTT packets that it</td><td> </td><td class="right">   packets.  A server can either discard or buffer 0-RTT packets that it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   receives.  A server can send multiple Retry packets as it receives</td><td> </td><td class="right">   receives.  A server can send multiple Retry packets as it receives</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial or 0-RTT packets.  A server MUST NOT send more than one Retry</td><td> </td><td class="right">   Initial or 0-RTT packets.  A server MUST NOT send more than one Retry</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet in response to a single UDP datagram.</td><td> </td><td class="right">   packet in response to a single UDP datagram.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0456"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">17.2.5.2.  Handling a Retry Packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A client MUST accept and process at most one Retry packet for each</td><td> </td><td class="right">   A client MUST accept and process at most one Retry packet for each</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection attempt.  After the client has received and processed an</td><td> </td><td class="right">   connection attempt.  After the client has received and processed an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial or Retry packet from the server, it MUST discard any</td><td> </td><td class="right">   Initial or Retry packet from the server, it MUST discard any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   subsequent Retry packets that it receives.</td><td> </td><td class="right">   subsequent Retry packets that it receives.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0457"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Clients MUST discard Retry packets that <span class="delete">contain an Original</span></td><td> </td><td class="rblock">   Clients MUST discard Retry packets that <span class="insert">have a Retry Integrity Tag</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Destination Connection ID field</span> that <span class="delete">does not match</span> the <span class="delete">Destination</span></td><td> </td><td class="rblock">   that <span class="insert">cannot be validated, see</span> the <span class="insert">Retry Packet Integrity section of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Connection ID from its Initial packet.</span>  This <span class="delete">prevents</span> an off-path</td><td> </td><td class="rblock"><span class="insert">   [QUIC-TLS].</span>  This <span class="insert">diminishes</span> an off-path <span class="insert">attacker's ability to inject</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">attacker from injecting</span> a Retry <span class="delete">packet.</span></td><td> </td><td class="rblock"><span class="insert">   a Retry packet and protects against accidental corruption of Retry</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets.  A client MUST discard a Retry packet with</span> a <span class="insert">zero-length</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Retry <span class="insert">Token field.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The client responds to a Retry packet with an Initial packet that</td><td> </td><td class="right">   The client responds to a Retry packet with an Initial packet that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   includes the provided Retry Token to continue connection</td><td> </td><td class="right">   includes the provided Retry Token to continue connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   establishment.</td><td> </td><td class="right">   establishment.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A client sets the Destination Connection ID field of this Initial</td><td> </td><td class="right">   A client sets the Destination Connection ID field of this Initial</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet to the value from the Source Connection ID in the Retry</td><td> </td><td class="right">   packet to the value from the Source Connection ID in the Retry</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet.  Changing Destination Connection ID also results in a change</td><td> </td><td class="right">   packet.  Changing Destination Connection ID also results in a change</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to the keys used to protect the Initial packet.  It also sets the</td><td> </td><td class="right">   to the keys used to protect the Initial packet.  It also sets the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Token field to the token provided in the Retry.  The client MUST NOT</td><td> </td><td class="right">   Token field to the token provided in the Retry.  The client MUST NOT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   change the Source Connection ID because the server could include the</td><td> </td><td class="right">   change the Source Connection ID because the server could include the</td><td class="lineno"></td></tr>
      <tr id="diff0458"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection ID as part of its token validation <span class="delete">logic (see</span></td><td> </td><td class="rblock">   connection ID as part of its token validation <span class="insert">logic; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">8.1.2).</span></td><td> </td><td class="rblock">   Section <span class="insert">8.1.4.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A Retry packet does not include a packet number and cannot be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   explicitly acknowledged by a client.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">17.2.5.3.  Continuing a Handshake After Retry</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The next Initial packet from the client uses the connection ID and</td><td> </td><td class="right">   The next Initial packet from the client uses the connection ID and</td><td class="lineno"></td></tr>
      <tr id="diff0459"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   token values from the Retry packet<span class="delete"> (see Section 7.2)</span>.  Aside from</td><td> </td><td class="rblock">   token values from the Retry packet<span class="insert">; see Section 7.2</span>.  Aside from</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   this, the Initial packet sent by the client is subject to the same</td><td> </td><td class="right">   this, the Initial packet sent by the client is subject to the same</td><td class="lineno"></td></tr>
      <tr id="diff0460"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   restrictions as the first Initial packet.  A client <span class="delete">can either reuse</span></td><td> </td><td class="rblock">   restrictions as the first Initial packet.  A client <span class="insert">MUST use</span> the <span class="insert">same</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the cryptographic handshake message <span class="delete">or construct</span> a <span class="delete">new one at its</span></td><td> </td><td class="rblock">   cryptographic handshake message <span class="insert">it includes in this packet.  A server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   discretion.</span></td><td> </td><td class="rblock"><span class="insert">   MAY treat a packet that contains</span> a <span class="insert">different cryptographic handshake</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   message as a connection error or discard it.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A client MAY attempt 0-RTT after receiving a Retry packet by sending</td><td> </td><td class="right">   A client MAY attempt 0-RTT after receiving a Retry packet by sending</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0-RTT packets to the connection ID provided by the server.  A client</td><td> </td><td class="right">   0-RTT packets to the connection ID provided by the server.  A client</td><td class="lineno"></td></tr>
      <tr id="diff0461"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">that sends additional 0-RTT packets without constructing a new</span></td><td> </td><td class="rblock">   <span class="insert">MUST NOT change the</span> cryptographic handshake message <span class="insert">it sends in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   cryptographic handshake message MUST NOT reset the packet number <span class="delete">to 0</span></td><td> </td><td class="rblock"><span class="insert">   response to receiving a Retry.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   after a Retry <span class="delete">packet, see</span> Section <span class="delete">17.2.3.</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A client</span> MUST NOT reset the packet number <span class="insert">for any packet number space</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   after <span class="insert">processing</span> a Retry <span class="insert">packet;</span> Section <span class="insert">17.2.3 contains more</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   information on this.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server acknowledges the use of a Retry packet for a connection</td><td> </td><td class="right">   A server acknowledges the use of a Retry packet for a connection</td><td class="lineno"></td></tr>
      <tr id="diff0462"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   using the <span class="delete">original_connection_id</span> transport <span class="delete">parameter (see</span></td><td> </td><td class="rblock">   using the <span class="insert">retry_source_connection_id</span> transport <span class="insert">parameter; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">18.1).</span>  If the server sends a Retry packet, it <span class="delete">MUST include</span></td><td> </td><td class="rblock">   Section <span class="insert">18.2.</span>  If the server sends a Retry packet, it <span class="insert">also</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the value of the <span class="delete">Original Destination</span> Connection ID field <span class="delete">of</span> the</td><td> </td><td class="rblock"><span class="insert">   subsequently includes</span> the value of the <span class="insert">Source</span> Connection ID field</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Retry packet <span class="delete">(that is, the Destination Connection ID field from the</span></td><td> </td><td class="rblock">   <span class="insert">from</span> the Retry packet in <span class="insert">its retry_source_connection_id</span> transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   client's first Initial packet)</span> in <span class="delete">the</span> transport parameter.</td><td> </td><td class="rblock">   parameter.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If the client received and processed a Retry packet, it MUST validate</td><td> </td><td class="right">   If the client received and processed a Retry packet, it MUST validate</td><td class="lineno"></td></tr>
      <tr id="diff0463"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that the <span class="delete">original_connection_id</span> transport parameter is present and</td><td> </td><td class="rblock">   that the <span class="insert">retry_source_connection_id</span> transport parameter is present</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   correct; otherwise, it MUST validate that the transport parameter is</td><td> </td><td class="rblock">   and correct; otherwise, it MUST validate that the transport parameter</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   absent.  A client MUST treat a failed validation as a connection</td><td> </td><td class="rblock">   is absent.  A client MUST treat a failed validation as a connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   error of type <span class="delete">TRANSPORT_PARAMETER_ERROR.</span></td><td> </td><td class="rblock">   error of type <span class="insert">PROTOCOL_VIOLATION.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   A Retry packet does not include a packet number and cannot be</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   explicitly acknowledged by a client.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">17.3.  Short Header Packets</td><td> </td><td class="right">17.3.  Short Header Packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This version of QUIC defines a single packet type which uses the</td><td> </td><td class="right">   This version of QUIC defines a single packet type which uses the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   short packet header.</td><td> </td><td class="right">   short packet header.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0464"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">Short Header Packet {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Header Form (1) = 0,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Fixed Bit (1) = 1,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |0|1|S|R|R|K|P P|</span></td><td> </td><td class="rblock"><span class="insert">     Spin Bit (1),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Reserved Bits (2),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                Destination Connection ID <span class="delete">(0..144)           ...</span></td><td> </td><td class="rblock"><span class="insert">     Key Phase (1),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Packet Number Length (2),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                     Packet Number <span class="delete">(8/16/24/32)              ...</span></td><td> </td><td class="rblock">     Destination Connection ID <span class="insert">(0..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Packet Number <span class="insert">(8..32),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                     Protected</span> Payload <span class="delete">(*)                   ...</span></td><td> </td><td class="rblock"><span class="insert">     Packet</span> Payload <span class="insert">(..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0465"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                   Figure 1<span class="delete">5</span>: Short Header Packet Format</td><td> </td><td class="rblock">                   Figure 1<span class="insert">8</span>: Short Header Packet Format</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The short header can be used after the version and 1-RTT keys are</td><td> </td><td class="right">   The short header can be used after the version and 1-RTT keys are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   negotiated.  Packets that use the short header contain the following</td><td> </td><td class="right">   negotiated.  Packets that use the short header contain the following</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   fields:</td><td> </td><td class="right">   fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Header Form:  The most significant bit (0x80) of byte 0 is set to 0</td><td> </td><td class="right">   Header Form:  The most significant bit (0x80) of byte 0 is set to 0</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      for the short header.</td><td> </td><td class="right">      for the short header.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Fixed Bit:  The next bit (0x40) of byte 0 is set to 1.  Packets</td><td> </td><td class="right">   Fixed Bit:  The next bit (0x40) of byte 0 is set to 1.  Packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      containing a zero value for this bit are not valid packets in this</td><td> </td><td class="right">      containing a zero value for this bit are not valid packets in this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      version and MUST be discarded.</td><td> </td><td class="right">      version and MUST be discarded.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0466"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Spin <span class="delete">Bit (S):</span>  The <span class="delete">sixth</span> bit (0x20) of byte 0 is the <span class="delete">Latency Spin</span></td><td> </td><td class="rblock">   Spin <span class="insert">Bit:</span>  The <span class="insert">third most significant</span> bit (0x20) of byte 0 is the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Bit,</span> set as described in <span class="delete">[SPIN].</span></td><td> </td><td class="rblock">      <span class="insert">latency spin bit,</span> set as described in <span class="insert">Section 17.3.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0467"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Reserved <span class="delete">Bits (R):</span>  The next two bits (those with a mask of 0x18) of</td><td> </td><td class="rblock">   Reserved <span class="insert">Bits:</span>  The next two bits (those with a mask of 0x18) of byte</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      byte 0 are reserved.  These bits are protected using header</td><td> </td><td class="rblock">      0 are reserved.  These bits are protected using header <span class="insert">protection;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">protection (see</span> Section 5.4 of <span class="delete">[QUIC-TLS]).</span>  The value included</td><td> </td><td class="rblock"><span class="insert">      see</span> Section 5.4 of <span class="insert">[QUIC-TLS].</span>  The value included prior to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      prior to protection MUST be set to 0.  An endpoint MUST treat</td><td> </td><td class="rblock">      protection MUST be set to 0.  An endpoint MUST treat receipt of a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      receipt of a packet that has a non-zero value for these <span class="delete">bits</span> after</td><td> </td><td class="rblock">      packet that has a non-zero value for these <span class="insert">bits,</span> after removing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      removing <span class="delete">protection</span> as a connection error of type</td><td> </td><td class="rblock">      <span class="insert">both packet and header protection,</span> as a connection error of type</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      PROTOCOL_VIOLATION.</td><td> </td><td class="rblock">      PROTOCOL_VIOLATION.  <span class="insert">Discarding such a packet after only removing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      header protection can expose the endpoint to attacks; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Section 9.3 of [QUIC-TLS].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0468"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Key <span class="delete">Phase (K):</span>  The next bit (0x04) of byte 0 indicates the key</td><td> </td><td class="rblock">   Key <span class="insert">Phase:</span>  The next bit (0x04) of byte 0 indicates the key phase,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      phase, which allows a recipient of a packet to identify the packet</td><td> </td><td class="rblock">      which allows a recipient of a packet to identify the packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      protection keys that are used to protect the packet.  See</td><td> </td><td class="right">      protection keys that are used to protect the packet.  See</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      [QUIC-TLS] for details.  This bit is protected using header</td><td> </td><td class="right">      [QUIC-TLS] for details.  This bit is protected using header</td><td class="lineno"></td></tr>
      <tr id="diff0469"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      protection<span class="delete"> (see Section 5.4 of [QUIC-TLS])</span>.</td><td> </td><td class="rblock">      protection<span class="insert">; see Section 5.4 of [QUIC-TLS]</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0470"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Packet Number <span class="delete">Length (P):</span>  The least significant two bits (those with</td><td> </td><td class="rblock">   Packet Number <span class="insert">Length:</span>  The least significant two bits (those with a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      a mask of 0x03) of byte 0 contain the length of the packet number,</td><td> </td><td class="rblock">      mask of 0x03) of byte 0 contain the length of the packet number,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      encoded as an unsigned, two-bit integer that is one less than the</td><td> </td><td class="right">      encoded as an unsigned, two-bit integer that is one less than the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      length of the packet number field in bytes.  That is, the length</td><td> </td><td class="right">      length of the packet number field in bytes.  That is, the length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of the packet number field is the value of this field, plus one.</td><td> </td><td class="right">      of the packet number field is the value of this field, plus one.</td><td class="lineno"></td></tr>
      <tr id="diff0471"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock">      These bits are protected using header <span class="insert">protection; see</span> Section 5.4</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      These bits are protected using header <span class="delete">protection (see</span> Section 5.4</td><td> </td><td class="rblock">      of <span class="insert">[QUIC-TLS].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      of <span class="delete">[QUIC-TLS]).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Destination Connection ID:  The Destination Connection ID is a</td><td> </td><td class="right">   Destination Connection ID:  The Destination Connection ID is a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      connection ID that is chosen by the intended recipient of the</td><td> </td><td class="right">      connection ID that is chosen by the intended recipient of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      packet.  See Section 5.1 for more details.</td><td> </td><td class="right">      packet.  See Section 5.1 for more details.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Packet Number:  The packet number field is 1 to 4 bytes long.  The</td><td> </td><td class="right">   Packet Number:  The packet number field is 1 to 4 bytes long.  The</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      packet number has confidentiality protection separate from packet</td><td> </td><td class="right">      packet number has confidentiality protection separate from packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      protection, as described in Section 5.4 of [QUIC-TLS].  The length</td><td> </td><td class="right">      protection, as described in Section 5.4 of [QUIC-TLS].  The length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of the packet number field is encoded in Packet Number Length</td><td> </td><td class="right">      of the packet number field is encoded in Packet Number Length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      field.  See Section 17.1 for details.</td><td> </td><td class="right">      field.  See Section 17.1 for details.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0472"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Protected</span> Payload:  Packets with a short header always include a</td><td> </td><td class="rblock">   <span class="insert">Packet</span> Payload:  Packets with a short header always include a 1-RTT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      1-RTT protected payload.</td><td> </td><td class="rblock">      protected payload.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The header form bit and the connection ID field of a short header</td><td> </td><td class="right">   The header form bit and the connection ID field of a short header</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet are version-independent.  The remaining fields are specific to</td><td> </td><td class="right">   packet are version-independent.  The remaining fields are specific to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the selected QUIC version.  See [QUIC-INVARIANTS] for details on how</td><td> </td><td class="right">   the selected QUIC version.  See [QUIC-INVARIANTS] for details on how</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets from different versions of QUIC are interpreted.</td><td> </td><td class="right">   packets from different versions of QUIC are interpreted.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0473"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">1<span class="delete">8.  Transport Parameter Encoding</span></td><td> </td><td class="rblock">1<span class="insert">7.3.1.  Latency Spin Bit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0474"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">format of</span> the <span class="delete">transport parameters</span> is the <span class="delete">TransportParameters</span></td><td> </td><td class="rblock">   The <span class="insert">latency spin bit enables passive latency monitoring from</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   struct from Figure 16.  This</span> is <span class="delete">described using</span> the <span class="delete">presentation</span></td><td> </td><td class="rblock"><span class="insert">   observation points on the network path throughout</span> the <span class="insert">duration of a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   language from Section 3</span> of <span class="delete">[TLS13].</span></td><td> </td><td class="rblock"><span class="insert">   connection.  The spin bit</span> is <span class="insert">only present in</span> the <span class="insert">short packet header,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   since it</span> is <span class="insert">possible to measure</span> the <span class="insert">initial RTT</span> of <span class="insert">a connection by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   observing the handshake.  Therefore, the spin bit is available after</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   version negotiation and connection establishment are completed.  On-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   path measurement and use of the latency spin bit is further discussed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in [QUIC-MANAGEABILITY].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0475"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">uint32 QuicVersion;</span></td><td> </td><td class="rblock">   <span class="insert">The spin bit is an OPTIONAL feature of QUIC.  A QUIC stack that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   chooses to support the spin bit MUST implement it as specified in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   this section.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0476"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">enum {</span></td><td> </td><td class="rblock">   <span class="insert">Each endpoint unilaterally decides if the spin bit is enabled or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         original_connection_id(0),</span></td><td> </td><td class="rblock"><span class="insert">   disabled for a connection.  Implementations MUST allow administrators</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         idle_timeout(1),</span></td><td> </td><td class="rblock"><span class="insert">   of clients and servers to disable the spin bit either globally or on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         stateless_reset_token(2),</span></td><td> </td><td class="rblock"><span class="insert">   a per-connection basis.  Even when the spin bit is not disabled by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         max_packet_size(3),</span></td><td> </td><td class="rblock"><span class="insert">   the administrator, endpoints MUST disable their use of the spin bit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         initial_max_data(4),</span></td><td> </td><td class="rblock"><span class="insert">   for a random selection of at least one in every 16 network paths, or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         initial_max_stream_data_bidi_local(5),</span></td><td> </td><td class="rblock"><span class="insert">   for one in every 16 connection IDs.  As each endpoint disables the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         initial_max_stream_data_bidi_remote(6),</span></td><td> </td><td class="rblock"><span class="insert">   spin bit independently, this ensures that the spin bit signal is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         initial_max_stream_data_uni(7),</span></td><td> </td><td class="rblock"><span class="insert">   disabled on approximately one in eight network paths.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         initial_max_streams_bidi(8),</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         initial_max_streams_uni(9),</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         ack_delay_exponent(10),</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         max_ack_delay(11),</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         disable_migration(12),</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         preferred_address(13),</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         (65535)</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      } TransportParameterId;</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0477"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">struct {</span></td><td> </td><td class="rblock">   <span class="insert">When the spin bit is disabled, endpoints MAY set the spin bit to any</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         TransportParameterId parameter;</span></td><td> </td><td class="rblock"><span class="insert">   value, and MUST ignore any incoming value.  It is RECOMMENDED that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         opaque value&lt;0..2^16-1&gt;;</span></td><td> </td><td class="rblock"><span class="insert">   endpoints set the spin bit to a random value either chosen</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      } TransportParameter;</span></td><td> </td><td class="rblock"><span class="insert">   independently for each packet or chosen independently for each</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection ID.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0478"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">struct {</span></td><td> </td><td class="rblock">   <span class="insert">If the spin bit is enabled for the connection, the endpoint maintains</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         select (Handshake.msg_type) {</span></td><td> </td><td class="rblock"><span class="insert">   a spin value and sets the spin bit in the short header to the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">            case client_hello:</span></td><td> </td><td class="rblock"><span class="insert">   currently stored value when a packet with a short header is sent out.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">               QuicVersion initial_version;</span></td><td> </td><td class="rblock"><span class="insert">   The spin value is initialized to 0 in the endpoint at connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   start.  Each endpoint also remembers the highest packet number seen</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   from its peer on the connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0479"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">            <span class="delete">case encrypted_extensions:</span></td><td> </td><td class="rblock">   <span class="insert">When a server receives a short header packet that increments the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">               QuicVersion negotiated_version;</span></td><td> </td><td class="rblock"><span class="insert">   highest packet number seen by the server from the client, it sets the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">               QuicVersion supported_versions&lt;4..2^8-4&gt;;</span></td><td> </td><td class="rblock"><span class="insert">   spin value to be equal to the spin bit in the received packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         };</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">         TransportParameter parameters&lt;0..2^16-1&gt;;</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      } TransportParameters;</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0480"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">               <span class="delete">Figure 16: Definition</span> of <span class="delete">TransportParameters</span></td><td> </td><td class="rblock">   <span class="insert">When a client receives a short header packet that increments the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   highest packet number seen by the client from the server, it sets the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   spin value to the inverse</span> of <span class="insert">the spin bit in the received packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0481"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">"extension_data"</span> field of the quic_transport_parameters extension</td><td> </td><td class="rblock">   <span class="insert">An endpoint resets its spin value to zero when sending the first</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   defined in [QUIC-TLS] contains <span class="delete">a TransportParameters value.  TLS</span></td><td> </td><td class="rblock"><span class="insert">   packet of a given connection with a new connection ID.  This reduces</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   encoding rules are therefore used to describe</span> the <span class="delete">encoding of</span></td><td> </td><td class="rblock"><span class="insert">   the risk that transient spin bit state can be used to link flows</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   transport parameters.</td><td> </td><td class="rblock"><span class="insert">   across connection migration or ID change.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   With this mechanism, the server reflects the spin value received,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   while the client 'spins' it after one RTT.  On-path observers can</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   measure the time between two spin bit toggle events to estimate the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   end-to-end RTT of a connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">18.  Transport Parameter Encoding</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   The <span class="insert">extension_data</span> field of the quic_transport_parameters extension</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   defined in [QUIC-TLS] contains the <span class="insert">QUIC</span> transport parameters.  <span class="insert">They</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   are encoded as a sequence of transport parameters, as shown in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Figure 19:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Transport Parameters {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Transport Parameter (..) ...,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                Figure 19: Sequence of Transport Parameters</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Each transport parameter is encoded as an (identifier, length, value)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   tuple, as shown in Figure 20:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Transport Parameter {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Transport Parameter ID (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Transport Parameter Length (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Transport Parameter Value (..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                  Figure 20: Transport Parameter Encoding</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The Transport Parameter Length field contains the length of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Transport Parameter Value field.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC encodes transport parameters into a sequence of bytes, which are</td><td> </td><td class="right">   QUIC encodes transport parameters into a sequence of bytes, which are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   then included in the cryptographic handshake.</td><td> </td><td class="right">   then included in the cryptographic handshake.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0482"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">18.1.  Transport Parameter Definitions</td><td> </td><td class="rblock">18.1.  <span class="insert">Reserved Transport Parameters</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Transport parameters with an identifier of the form "31 * N + 27" for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   integer values of N are reserved to exercise the requirement that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   unknown transport parameters be ignored.  These transport parameters</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   have no semantics, and may carry arbitrary values.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">18.2.</span>  Transport Parameter Definitions</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This section details the transport parameters defined in this</td><td> </td><td class="right">   This section details the transport parameters defined in this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   document.</td><td> </td><td class="right">   document.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Many transport parameters listed here have integer values.  Those</td><td> </td><td class="right">   Many transport parameters listed here have integer values.  Those</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   transport parameters that are identified as integers use a variable-</td><td> </td><td class="right">   transport parameters that are identified as integers use a variable-</td><td class="lineno"></td></tr>
      <tr id="diff0483"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   length integer <span class="delete">encoding (see</span> Section <span class="delete">16) and</span> have a default value of</td><td> </td><td class="rblock">   length integer <span class="insert">encoding; see</span> Section <span class="insert">16.  Transport parameters</span> have a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   0 if the transport parameter is <span class="delete">absent,</span> unless otherwise stated.</td><td> </td><td class="rblock">   default value of 0 if the transport parameter is <span class="insert">absent</span> unless</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   otherwise stated.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The following transport parameters are defined:</td><td> </td><td class="right">   The following transport parameters are defined:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0484"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">original_connection_id (0x0000):</span>  The value of the Destination</td><td> </td><td class="rblock">   <span class="insert">original_destination_connection_id (0x00):</span>  The value of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      Connection ID field from the first Initial packet sent by the</td><td> </td><td class="rblock">      Destination Connection ID field from the first Initial packet sent</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">client.</span>  This transport parameter is only sent by a server.  <span class="delete">A</span></td><td> </td><td class="rblock">      by the <span class="insert">client; see Section 7.3.</span>  This transport parameter is only</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      server MUST include the original_connection_id transport parameter</span></td><td> </td><td class="rblock">      sent by a server.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      if it sent a Retry packet.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0485"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">idle_timeout (0x0001):</span>  The idle timeout is a value in <span class="delete">seconds</span> that</td><td> </td><td class="rblock">   <span class="insert">max_idle_timeout (0x01):</span>  The <span class="insert">max</span> idle timeout is a value in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      is encoded as an <span class="delete">integer,</span> see (Section 10.2).  <span class="delete">If</span> this parameter</td><td> </td><td class="rblock">      <span class="insert">milliseconds</span> that is encoded as an <span class="insert">integer;</span> see (Section 10.2).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">is absent</span> or <span class="delete">zero then the idle timeout is disabled.</span></td><td> </td><td class="rblock">      <span class="insert">Idle timeout is disabled when both endpoints omit</span> this <span class="insert">transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      parameter or <span class="insert">specify a value of 0.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0486"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   stateless_reset_token <span class="delete">(0x0002):</span>  A stateless reset token is used in</td><td> </td><td class="rblock">   stateless_reset_token <span class="insert">(0x02):</span>  A stateless reset token is used in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      verifying a stateless <span class="delete">reset,</span> see Section 10.4.  This parameter is</td><td> </td><td class="rblock">      verifying a stateless <span class="insert">reset;</span> see Section 10.4.  This parameter is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      a sequence of 16 bytes.  This transport parameter <span class="delete">is only</span> sent by</td><td> </td><td class="rblock">      a sequence of 16 bytes.  This transport parameter <span class="insert">MUST NOT be sent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      a server.</td><td> </td><td class="rblock"><span class="insert">      by a client, but MAY be</span> sent by a server.  <span class="insert">A server that does not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      send this transport parameter cannot use stateless reset</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (Section 10.4) for the connection ID negotiated during the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      handshake.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0487"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">max_packet_size (0x0003):</span>  The maximum <span class="delete">packet</span> size parameter is an</td><td> </td><td class="rblock">   <span class="insert">max_udp_payload_size (0x03):</span>  The maximum <span class="insert">UDP payload</span> size parameter</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      integer value that limits the size of <span class="delete">packets</span> that the endpoint is</td><td> </td><td class="rblock">      is an integer value that limits the size of <span class="insert">UDP payloads</span> that the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      willing to receive.  <span class="delete">This indicates that</span> packets larger than this</td><td> </td><td class="rblock">      endpoint is willing to receive.  <span class="insert">UDP</span> packets <span class="insert">with payloads</span> larger</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      limit <span class="delete">will be dropped.  The default for this parameter is the</span></td><td> </td><td class="rblock">      than this limit are <span class="insert">not likely</span> to <span class="insert">be processed by the receiver.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      maximum permitted UDP payload of 65527.  Values below 1200</span> are</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">invalid.  This limit only applies</span> to <span class="delete">protected packets</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      (Section 12.1).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0488"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   initial_max_data <span class="delete">(0x0004):</span>  The initial maximum data parameter is an</td><td> </td><td class="rblock">      <span class="insert">The default for this parameter is the maximum permitted UDP</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      payload of 65527.  Values below 1200 are invalid.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      This limit does act as an additional constraint on datagram size</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      in the same way as the path MTU, but it is a property of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      endpoint and not the path; see Section 14.  It is expected that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      this is the space an endpoint dedicates to holding incoming</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   initial_max_data <span class="insert">(0x04):</span>  The initial maximum data parameter is an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      integer value that contains the initial value for the maximum</td><td> </td><td class="right">      integer value that contains the initial value for the maximum</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      amount of data that can be sent on the connection.  This is</td><td> </td><td class="right">      amount of data that can be sent on the connection.  This is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      equivalent to sending a MAX_DATA (Section 19.9) for the connection</td><td> </td><td class="right">      equivalent to sending a MAX_DATA (Section 19.9) for the connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      immediately after completing the handshake.</td><td> </td><td class="right">      immediately after completing the handshake.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0489"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   initial_max_stream_data_bidi_local (0x0<span class="delete">00</span>5):  This parameter is an</td><td> </td><td class="rblock">   initial_max_stream_data_bidi_local (0x05):  This parameter is an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      integer value specifying the initial flow control limit for</td><td> </td><td class="right">      integer value specifying the initial flow control limit for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      locally-initiated bidirectional streams.  This limit applies to</td><td> </td><td class="right">      locally-initiated bidirectional streams.  This limit applies to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      newly created bidirectional streams opened by the endpoint that</td><td> </td><td class="right">      newly created bidirectional streams opened by the endpoint that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      sends the transport parameter.  In client transport parameters,</td><td> </td><td class="right">      sends the transport parameter.  In client transport parameters,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      this applies to streams with an identifier with the least</td><td> </td><td class="right">      this applies to streams with an identifier with the least</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      significant two bits set to 0x0; in server transport parameters,</td><td> </td><td class="right">      significant two bits set to 0x0; in server transport parameters,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      this applies to streams with the least significant two bits set to</td><td> </td><td class="right">      this applies to streams with the least significant two bits set to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      0x1.</td><td> </td><td class="right">      0x1.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0490"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   initial_max_stream_data_bidi_remote (0x0<span class="delete">00</span>6):  This parameter is an</td><td> </td><td class="rblock">   initial_max_stream_data_bidi_remote (0x06):  This parameter is an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      integer value specifying the initial flow control limit for peer-</td><td> </td><td class="right">      integer value specifying the initial flow control limit for peer-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      initiated bidirectional streams.  This limit applies to newly</td><td> </td><td class="right">      initiated bidirectional streams.  This limit applies to newly</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      created bidirectional streams opened by the endpoint that receives</td><td> </td><td class="right">      created bidirectional streams opened by the endpoint that receives</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the transport parameter.  In client transport parameters, this</td><td> </td><td class="right">      the transport parameter.  In client transport parameters, this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      applies to streams with an identifier with the least significant</td><td> </td><td class="right">      applies to streams with an identifier with the least significant</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      two bits set to 0x1; in server transport parameters, this applies</td><td> </td><td class="right">      two bits set to 0x1; in server transport parameters, this applies</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      to streams with the least significant two bits set to 0x0.</td><td> </td><td class="right">      to streams with the least significant two bits set to 0x0.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0491"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   initial_max_stream_data_uni (0x0<span class="delete">00</span>7):  This parameter is an integer</td><td> </td><td class="rblock">   initial_max_stream_data_uni (0x07):  This parameter is an integer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      value specifying the initial flow control limit for unidirectional</td><td> </td><td class="right">      value specifying the initial flow control limit for unidirectional</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      streams.  This limit applies to newly created unidirectional</td><td> </td><td class="right">      streams.  This limit applies to newly created unidirectional</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      streams opened by the endpoint that receives the transport</td><td> </td><td class="right">      streams opened by the endpoint that receives the transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      parameter.  In client transport parameters, this applies to</td><td> </td><td class="right">      parameter.  In client transport parameters, this applies to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      streams with an identifier with the least significant two bits set</td><td> </td><td class="right">      streams with an identifier with the least significant two bits set</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      to 0x3; in server transport parameters, this applies to streams</td><td> </td><td class="right">      to 0x3; in server transport parameters, this applies to streams</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      with the least significant two bits set to 0x2.</td><td> </td><td class="right">      with the least significant two bits set to 0x2.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0492"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   initial_max_streams_bidi (0x0<span class="delete">00</span>8):  The initial maximum bidirectional</td><td> </td><td class="rblock">   initial_max_streams_bidi (0x08):  The initial maximum bidirectional</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      streams parameter is an integer value that contains the initial</td><td> </td><td class="right">      streams parameter is an integer value that contains the initial</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      maximum number of bidirectional streams the peer may initiate.  If</td><td> </td><td class="right">      maximum number of bidirectional streams the peer may initiate.  If</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      this parameter is absent or zero, the peer cannot open</td><td> </td><td class="right">      this parameter is absent or zero, the peer cannot open</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      bidirectional streams until a MAX_STREAMS frame is sent.  Setting</td><td> </td><td class="right">      bidirectional streams until a MAX_STREAMS frame is sent.  Setting</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      this parameter is equivalent to sending a MAX_STREAMS</td><td> </td><td class="right">      this parameter is equivalent to sending a MAX_STREAMS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (Section 19.11) of the corresponding type with the same value.</td><td> </td><td class="right">      (Section 19.11) of the corresponding type with the same value.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0493"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   initial_max_streams_uni (0x0<span class="delete">00</span>9):  The initial maximum unidirectional</td><td> </td><td class="rblock">   initial_max_streams_uni (0x09):  The initial maximum unidirectional</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      streams parameter is an integer value that contains the initial</td><td> </td><td class="right">      streams parameter is an integer value that contains the initial</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      maximum number of unidirectional streams the peer may initiate.</td><td> </td><td class="right">      maximum number of unidirectional streams the peer may initiate.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      If this parameter is absent or zero, the peer cannot open</td><td> </td><td class="right">      If this parameter is absent or zero, the peer cannot open</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      unidirectional streams until a MAX_STREAMS frame is sent.  Setting</td><td> </td><td class="right">      unidirectional streams until a MAX_STREAMS frame is sent.  Setting</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      this parameter is equivalent to sending a MAX_STREAMS</td><td> </td><td class="right">      this parameter is equivalent to sending a MAX_STREAMS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (Section 19.11) of the corresponding type with the same value.</td><td> </td><td class="right">      (Section 19.11) of the corresponding type with the same value.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0494"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   ack_delay_exponent (0x0<span class="delete">00</span>a):  The ACK delay exponent is an integer</td><td> </td><td class="rblock">   ack_delay_exponent (0x0a):  The ACK delay exponent is an integer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      value indicating an exponent used to decode the ACK Delay field in</td><td> </td><td class="right">      value indicating an exponent used to decode the ACK Delay field in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the ACK frame (Section 19.3).  If this value is absent, a default</td><td> </td><td class="right">      the ACK frame (Section 19.3).  If this value is absent, a default</td><td class="lineno"></td></tr>
      <tr id="diff0495"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      value of 3 is assumed (indicating a multiplier of 8).  <span class="delete">The default</span></td><td> </td><td class="rblock">      value of 3 is assumed (indicating a multiplier of 8).  Values</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      value is also used for ACK frames that are sent in Initial and</span></td><td> </td><td class="rblock">      above 20 are invalid.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Handshake packets.</span>  Values above 20 are invalid.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0496"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   max_ack_delay (0x0<span class="delete">00</span>b):  The maximum ACK delay is an integer value</td><td> </td><td class="rblock">   max_ack_delay (0x0b):  The maximum ACK delay is an integer value</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      indicating the maximum amount of time in milliseconds by which the</td><td> </td><td class="right">      indicating the maximum amount of time in milliseconds by which the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      endpoint will delay sending acknowledgments.  This value SHOULD</td><td> </td><td class="right">      endpoint will delay sending acknowledgments.  This value SHOULD</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      include the receiver's expected delays in alarms firing.  For</td><td> </td><td class="right">      include the receiver's expected delays in alarms firing.  For</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      example, if a receiver sets a timer for 5ms and alarms commonly</td><td> </td><td class="right">      example, if a receiver sets a timer for 5ms and alarms commonly</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      fire up to 1ms late, then it should send a max_ack_delay of 6ms.</td><td> </td><td class="right">      fire up to 1ms late, then it should send a max_ack_delay of 6ms.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      If this value is absent, a default of 25 milliseconds is assumed.</td><td> </td><td class="right">      If this value is absent, a default of 25 milliseconds is assumed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Values of 2^14 or greater are invalid.</td><td> </td><td class="right">      Values of 2^14 or greater are invalid.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0497"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">disable_migration (0x000c):</span>  The disable migration transport</td><td> </td><td class="rblock">   <span class="insert">disable_active_migration (0x0c):</span>  The disable <span class="insert">active</span> migration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      parameter is included if the endpoint does not support connection</td><td> </td><td class="rblock">      transport parameter is included if the endpoint does not support</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      migration (Section <span class="delete">9).  Peers of an endpoint that</span> sets this</td><td> </td><td class="rblock">      <span class="insert">active</span> connection migration (Section <span class="insert">9) on the address being used</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      transport <span class="delete">parameter</span> MUST NOT <span class="delete">send any packets, including probing</span></td><td> </td><td class="rblock"><span class="insert">      during the handshake.  When a peer</span> sets this transport <span class="insert">parameter,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      packets (Section 9.1), from</span> a local address <span class="delete">other than</span> that used</td><td> </td><td class="rblock"><span class="insert">      an endpoint</span> MUST NOT <span class="insert">use</span> a <span class="insert">new</span> local address <span class="insert">when sending to the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">to perform</span> the handshake.  This parameter is a zero-length value.</td><td> </td><td class="rblock"><span class="insert">      address</span> that <span class="insert">the peer</span> used <span class="insert">during</span> the handshake.  <span class="insert">This transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      parameter does not prohibit connection migration after a client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      has acted on a preferred_address transport parameter.</span>  This</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      parameter is a zero-length value.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0498"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   preferred_address <span class="delete">(0x000d):</span>  The server's preferred address is used</td><td> </td><td class="rblock">   preferred_address <span class="insert">(0x0d):</span>  The server's preferred address is used to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      to effect a change in server address at the end of the handshake,</td><td> </td><td class="rblock">      effect a change in server address at the end of the handshake, as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      as described in Section 9.6.  The format of this transport</td><td> </td><td class="rblock">      described in Section 9.6.  The format of this transport parameter</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      parameter is <span class="delete">the PreferredAddress struct</span> shown in Figure <span class="delete">17.</span>  This</td><td> </td><td class="rblock">      is shown in Figure <span class="insert">21.</span>  This transport parameter is only sent by a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      transport parameter is only sent by a server.  Servers MAY choose</td><td> </td><td class="rblock">      server.  Servers MAY choose to only send a preferred address of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      to only send a preferred address of one address family by sending</td><td> </td><td class="rblock">      one address family by sending an all-zero address and port</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      an all-zero address and port (0.0.0.0:0 or ::.0) for the other</td><td> </td><td class="rblock">      (0.0.0.0:0 or ::.0) for the other family.  <span class="insert">IP addresses are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      family.</td><td> </td><td class="rblock"><span class="insert">      encoded in network byte order.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0499"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">struct {</span></td><td> </td><td class="rblock">      <span class="insert">The Connection ID field and the Stateless Reset Token field</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">        opaque ipv4Address[4];</span></td><td> </td><td class="rblock"><span class="insert">      contain an alternative connection ID that has a sequence number of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">        uint16 ipv4Port;</span></td><td> </td><td class="rblock"><span class="insert">      1; see Section 5.1.1.  Having these values bundled with the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">        opaque ipv6Address[16];</span></td><td> </td><td class="rblock"><span class="insert">      preferred address ensures that there will be at least one unused</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">        uint16 ipv6Port;</span></td><td> </td><td class="rblock"><span class="insert">      active connection ID when the client initiates migration to the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">        opaque connectionId&lt;0..18&gt;;</span></td><td> </td><td class="rblock"><span class="insert">      preferred address.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">        opaque statelessResetToken[16];</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      } PreferredAddress;</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0500"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                    Figure <span class="delete">17:</span> Preferred Address format</td><td> </td><td class="rblock">      <span class="insert">The Connection ID and Stateless Reset Token fields of a preferred</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      address are identical in syntax and semantics to the corresponding</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      fields of a NEW_CONNECTION_ID frame (Section 19.15).  A server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      that chooses a zero-length connection ID MUST NOT provide a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      preferred address.  Similarly, a server MUST NOT include a zero-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      length connection ID in this transport parameter.  A client MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      treat violation of these requirements as a connection error of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      type TRANSPORT_PARAMETER_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Preferred Address {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     IPv4 Address (32),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     IPv4 Port (16),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     IPv6 Address (128),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     IPv6 Port (16),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     CID Length (8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Connection ID (..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Stateless Reset Token (128),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                    Figure <span class="insert">21:</span> Preferred Address format</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">active_connection_id_limit (0x0e):  The active connection ID limit is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      an integer value specifying the maximum number of connection IDs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      from the peer that an endpoint is willing to store.  This value</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      includes the connection ID received during the handshake, that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      received in the preferred_address transport parameter, and those</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      received in NEW_CONNECTION_ID frames.  The value of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      active_connection_id_limit parameter MUST be at least 2.  An</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      endpoint that receives a value less than 2 MUST close the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      connection with an error of type TRANSPORT_PARAMETER_ERROR.  If</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      this transport parameter is absent, a default of 2 is assumed.  If</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      an endpoint issues a zero-length connection ID, it will never send</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      a NEW_CONNECTION_ID frame and therefore ignores the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      active_connection_id_limit value received from its peer.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   initial_source_connection_id (0x0f):  The value that the endpoint</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      included in the Source Connection ID field of the first Initial</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      packet it sends for the connection; see Section 7.3.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   retry_source_connection_id (0x10):  The value that the server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      included in the Source Connection ID field of a Retry packet; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Section 7.3.  This transport parameter is only sent by a server.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If present, transport parameters that set initial flow control limits</td><td> </td><td class="right">   If present, transport parameters that set initial flow control limits</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (initial_max_stream_data_bidi_local,</td><td> </td><td class="right">   (initial_max_stream_data_bidi_local,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   initial_max_stream_data_bidi_remote, and initial_max_stream_data_uni)</td><td> </td><td class="right">   initial_max_stream_data_bidi_remote, and initial_max_stream_data_uni)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are equivalent to sending a MAX_STREAM_DATA frame (Section 19.10) on</td><td> </td><td class="right">   are equivalent to sending a MAX_STREAM_DATA frame (Section 19.10) on</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   every stream of the corresponding type immediately after opening.  If</td><td> </td><td class="right">   every stream of the corresponding type immediately after opening.  If</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the transport parameter is absent, streams of that type start with a</td><td> </td><td class="right">   the transport parameter is absent, streams of that type start with a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   flow control limit of 0.</td><td> </td><td class="right">   flow control limit of 0.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0501"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A client MUST NOT include <span class="delete">an original connection ID, a stateless</span></td><td> </td><td class="rblock">   A client MUST NOT include <span class="insert">any server-only transport parameter:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   reset token,</span> or <span class="delete">a preferred address.</span>  A server MUST treat receipt of</td><td> </td><td class="rblock"><span class="insert">   original_destination_connection_id, preferred_address,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   any of these transport parameters as a connection error of type</td><td> </td><td class="rblock"><span class="insert">   retry_source_connection_id,</span> or <span class="insert">stateless_reset_token.</span>  A server MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   TRANSPORT_PARAMETER_ERROR.</td><td> </td><td class="rblock">   treat receipt of any of these transport parameters as a connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   error of type TRANSPORT_PARAMETER_ERROR.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.  Frame Types and Formats</td><td> </td><td class="right">19.  Frame Types and Formats</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   As described in Section 12.4, packets contain one or more frames.</td><td> </td><td class="right">   As described in Section 12.4, packets contain one or more frames.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This section describes the format and semantics of the core QUIC</td><td> </td><td class="right">   This section describes the format and semantics of the core QUIC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame types.</td><td> </td><td class="right">   frame types.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.1.  PADDING Frame</td><td> </td><td class="right">19.1.  PADDING Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The PADDING frame (type=0x00) has no semantic value.  PADDING frames</td><td> </td><td class="right">   The PADDING frame (type=0x00) has no semantic value.  PADDING frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   can be used to increase the size of a packet.  Padding can be used to</td><td> </td><td class="right">   can be used to increase the size of a packet.  Padding can be used to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   increase an initial client packet to the minimum required size, or to</td><td> </td><td class="right">   increase an initial client packet to the minimum required size, or to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provide protection against traffic analysis for protected packets.</td><td> </td><td class="right">   provide protection against traffic analysis for protected packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0502"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A</span> PADDING frame has no content.  That is, a PADDING frame consists of</td><td> </td><td class="rblock">   <span class="insert">As shown in Figure 22, a</span> PADDING frame has no content.  That is, a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the single byte that identifies the frame as a PADDING frame.</td><td> </td><td class="rblock">   PADDING frame consists of the single byte that identifies the frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   as a PADDING frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">PADDING Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x00,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                      Figure 22: PADDING Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.2.  PING Frame</td><td> </td><td class="right">19.2.  PING Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Endpoints can use PING frames (type=0x01) to verify that their peers</td><td> </td><td class="right">   Endpoints can use PING frames (type=0x01) to verify that their peers</td><td class="lineno"></td></tr>
      <tr id="diff0503"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   are still alive or to check reachability to the peer.  <span class="delete">The</span> PING frame</td><td> </td><td class="rblock">   are still alive or to check reachability to the peer.  <span class="insert">As shown in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   contains no <span class="delete">additional fields.</span></td><td> </td><td class="rblock"><span class="insert">   Figure 23 a</span> PING frame contains no <span class="insert">content.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   PING Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x01,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        Figure 23: PING Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The receiver of a PING frame simply needs to acknowledge the packet</td><td> </td><td class="right">   The receiver of a PING frame simply needs to acknowledge the packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   containing this frame.</td><td> </td><td class="right">   containing this frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The PING frame can be used to keep a connection alive when an</td><td> </td><td class="right">   The PING frame can be used to keep a connection alive when an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   application or application protocol wishes to prevent the connection</td><td> </td><td class="right">   application or application protocol wishes to prevent the connection</td><td class="lineno"></td></tr>
      <tr id="diff0504"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   from timing <span class="delete">out.  An application protocol SHOULD provide guidance</span></td><td> </td><td class="rblock">   from timing <span class="insert">out; see</span> Section <span class="insert">10.2.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   about the conditions under which generating a PING is recommended.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   This guidance SHOULD indicate whether it is the client or the server</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that is expected to send the PING.  Having both endpoints send PING</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   frames without coordination can produce an excessive number of</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   packets and poor performance.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   A connection will time out if no packets are sent or received for a</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   period longer than the time specified in the idle_timeout transport</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   parameter (see</span> Section <span class="delete">10).  However, state in middleboxes might time</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   out earlier than that.  Though REQ-5 in [RFC4787] recommends a 2</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   minute timeout interval, experience shows that sending packets every</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   15 to 30 seconds is necessary to prevent the majority of middleboxes</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   from losing state for UDP flows.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.3.  ACK Frames</td><td> </td><td class="right">19.3.  ACK Frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Receivers send ACK frames (types 0x02 and 0x03) to inform senders of</td><td> </td><td class="right">   Receivers send ACK frames (types 0x02 and 0x03) to inform senders of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets they have received and processed.  The ACK frame contains one</td><td> </td><td class="right">   packets they have received and processed.  The ACK frame contains one</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   or more ACK Ranges.  ACK Ranges identify acknowledged packets.  If</td><td> </td><td class="right">   or more ACK Ranges.  ACK Ranges identify acknowledged packets.  If</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the frame type is 0x03, ACK frames also contain the sum of QUIC</td><td> </td><td class="right">   the frame type is 0x03, ACK frames also contain the sum of QUIC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets with associated ECN marks received on the connection up until</td><td> </td><td class="right">   packets with associated ECN marks received on the connection up until</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   this point.  QUIC implementations MUST properly handle both types</td><td> </td><td class="right">   this point.  QUIC implementations MUST properly handle both types</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and, if they have enabled ECN for packets they send, they SHOULD use</td><td> </td><td class="right">   and, if they have enabled ECN for packets they send, they SHOULD use</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the information in the ECN section to manage their congestion state.</td><td> </td><td class="right">   the information in the ECN section to manage their congestion state.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC acknowledgements are irrevocable.  Once acknowledged, a packet</td><td> </td><td class="right">   QUIC acknowledgements are irrevocable.  Once acknowledged, a packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   remains acknowledged, even if it does not appear in a future ACK</td><td> </td><td class="right">   remains acknowledged, even if it does not appear in a future ACK</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame.  This is unlike TCP SACKs ([RFC2018]).</td><td> </td><td class="right">   frame.  This is unlike TCP SACKs ([RFC2018]).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0505"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">It is expected that a sender will reuse</span> the same packet number <span class="delete">across</span></td><td> </td><td class="rblock">   <span class="insert">Packets from different packet number spaces can be identified using</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   different</span> packet number <span class="delete">spaces.</span>  ACK <span class="delete">frames</span> only acknowledge <span class="delete">the</span></td><td> </td><td class="rblock">   the same <span class="insert">numeric value.  An acknowledgment for a packet needs to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packet numbers <span class="delete">that were transmitted by the sender</span> in the same <span class="delete">packet</span></td><td> </td><td class="rblock"><span class="insert">   indicate both a</span> packet number <span class="insert">and a</span> packet number <span class="insert">space.  This is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   number</span> space <span class="delete">of</span> the packet <span class="delete">that</span> the ACK <span class="delete">was received in.</span></td><td> </td><td class="rblock"><span class="insert">   accomplished by having each</span> ACK <span class="insert">frame</span> only acknowledge packet numbers</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   in the same space <span class="insert">as</span> the packet <span class="insert">in which</span> the ACK <span class="insert">frame is contained.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Version Negotiation and Retry packets cannot be acknowledged because</td><td> </td><td class="right">   Version Negotiation and Retry packets cannot be acknowledged because</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   they do not contain a packet number.  Rather than relying on ACK</td><td> </td><td class="right">   they do not contain a packet number.  Rather than relying on ACK</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frames, these packets are implicitly acknowledged by the next Initial</td><td> </td><td class="right">   frames, these packets are implicitly acknowledged by the next Initial</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet sent by the client.</td><td> </td><td class="right">   packet sent by the client.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0506"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   An ACK frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   An ACK frame is <span class="insert">shown in Figure 24.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0507"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">ACK Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x02..0x03,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Largest Acknowledged <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                     Largest Acknowledged <span class="delete">(i)                ...</span></td><td> </td><td class="rblock">     ACK Delay <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     ACK Range Count <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                          ACK Delay <span class="delete">(i)                      ...</span></td><td> </td><td class="rblock">     First ACK Range <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     ACK <span class="insert">Range (..) ...,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                       ACK Range Count <span class="delete">(i)                   ...</span></td><td> </td><td class="rblock">     [ECN <span class="insert">Counts (..)],</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                       First ACK Range <span class="delete">(i)                   ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                          ACK <span class="delete">Ranges (*)                     ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                          [ECN <span class="delete">Counts]                       ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0508"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                        Figure <span class="delete">18</span>: ACK Frame Format</td><td> </td><td class="rblock">                        Figure <span class="insert">24</span>: ACK Frame Format</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ACK frames contain the following fields:</td><td> </td><td class="right">   ACK frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Largest Acknowledged:  A variable-length integer representing the</td><td> </td><td class="right">   Largest Acknowledged:  A variable-length integer representing the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      largest packet number the peer is acknowledging; this is usually</td><td> </td><td class="right">      largest packet number the peer is acknowledging; this is usually</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the largest packet number that the peer has received prior to</td><td> </td><td class="right">      the largest packet number that the peer has received prior to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      generating the ACK frame.  Unlike the packet number in the QUIC</td><td> </td><td class="right">      generating the ACK frame.  Unlike the packet number in the QUIC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      long or short header, the value in an ACK frame is not truncated.</td><td> </td><td class="right">      long or short header, the value in an ACK frame is not truncated.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0509"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   ACK Delay:  A variable-length integer <span class="delete">including</span> the time in</td><td> </td><td class="rblock">   ACK Delay:  A variable-length integer <span class="insert">representing</span> the time <span class="insert">delta</span> in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      microseconds <span class="delete">that</span> the largest acknowledged packet, as indicated in</td><td> </td><td class="rblock">      microseconds <span class="insert">between when this ACK was sent and when</span> the largest</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      the Largest Acknowledged field, was received by this <span class="delete">peer to when</span></td><td> </td><td class="rblock">      acknowledged packet, as indicated in the Largest Acknowledged</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      this ACK was sent.</span>  The value of the ACK Delay field is scaled by</td><td> </td><td class="rblock">      field, was received by this <span class="insert">peer.</span>  The value of the ACK Delay</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      multiplying the encoded value by 2 to the power of the value of</td><td> </td><td class="rblock">      field is scaled by multiplying the encoded value by 2 to the power</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      the <span class="delete">"ack_delay_exponent"</span> transport parameter set by the sender of</td><td> </td><td class="rblock">      of the value of the <span class="insert">ack_delay_exponent</span> transport parameter set by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      the ACK <span class="delete">frame.  The "ack_delay_exponent" defaults to 3, or a</span></td><td> </td><td class="rblock">      the sender of the ACK <span class="insert">frame; see</span> Section <span class="insert">18.2.</span>  Scaling in this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      multiplier of 8 (see</span> Section <span class="delete">18.1).</span>  Scaling in this fashion</td><td> </td><td class="rblock">      fashion allows for a larger range of values with a shorter</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      allows for a larger range of values with a shorter encoding at the</td><td> </td><td class="rblock">      encoding at the cost of lower resolution.  <span class="insert">Because the receiver</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      cost of lower resolution.</td><td> </td><td class="rblock"><span class="insert">      doesn't use the ACK Delay for Initial and Handshake packets, a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      sender SHOULD send a value of 0.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ACK Range Count:  A variable-length integer specifying the number of</td><td> </td><td class="right">   ACK Range Count:  A variable-length integer specifying the number of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Gap and ACK Range fields in the frame.</td><td> </td><td class="right">      Gap and ACK Range fields in the frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   First ACK Range:  A variable-length integer indicating the number of</td><td> </td><td class="right">   First ACK Range:  A variable-length integer indicating the number of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      contiguous packets preceding the Largest Acknowledged that are</td><td> </td><td class="right">      contiguous packets preceding the Largest Acknowledged that are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      being acknowledged.  The First ACK Range is encoded as an ACK</td><td> </td><td class="right">      being acknowledged.  The First ACK Range is encoded as an ACK</td><td class="lineno"></td></tr>
      <tr id="diff0510"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      Range<span class="delete"> (see Section 19.3.1)</span> starting from the Largest Acknowledged.</td><td> </td><td class="rblock">      Range<span class="insert">; see Section 19.3.1</span> starting from the Largest Acknowledged.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      That is, the smallest packet acknowledged in the range is</td><td> </td><td class="right">      That is, the smallest packet acknowledged in the range is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      determined by subtracting the First ACK Range value from the</td><td> </td><td class="right">      determined by subtracting the First ACK Range value from the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Largest Acknowledged.</td><td> </td><td class="right">      Largest Acknowledged.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ACK Ranges:  Contains additional ranges of packets which are</td><td> </td><td class="right">   ACK Ranges:  Contains additional ranges of packets which are</td><td class="lineno"></td></tr>
      <tr id="diff0511"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      alternately not acknowledged (Gap) and acknowledged (ACK Range)<span class="delete">,</span></td><td> </td><td class="rblock">      alternately not acknowledged (Gap) and acknowledged (ACK Range)<span class="insert">;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      see Section 19.3.1.</td><td> </td><td class="right">      see Section 19.3.1.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0512"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   ECN Counts:  The three ECN Counts<span class="delete">,</span> see Section 19.3.2.</td><td> </td><td class="rblock">   ECN Counts:  The three ECN Counts<span class="insert">;</span> see Section 19.3.2.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.3.1.  ACK Ranges</td><td> </td><td class="right">19.3.1.  ACK Ranges</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0513"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The</span> ACK <span class="delete">Ranges field</span> consists of alternating Gap and ACK Range values</td><td> </td><td class="rblock">   <span class="insert">Each</span> ACK <span class="insert">Range</span> consists of alternating Gap and ACK Range values in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   in descending packet number order.  The number of Gap and ACK Range</td><td> </td><td class="rblock">   descending packet number order.  <span class="insert">ACK Ranges can be repeated.</span>  The</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   values is determined by the ACK Range Count field; one of each value</td><td> </td><td class="rblock">   number of Gap and ACK Range values is determined by the ACK Range</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   is present for each value in the ACK Range Count field.</td><td> </td><td class="rblock">   Count field; one of each value is present for each value in the ACK</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Range Count field.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0514"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   ACK Ranges are structured as <span class="delete">follows:</span></td><td> </td><td class="rblock">   ACK Ranges are structured as <span class="insert">shown in Figure 25.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0515"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">ACK</span> Range <span class="insert">{</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Gap (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     ACK</span> Range <span class="insert">Length (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                           [Gap (i)]                        ...</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                          [ACK</span> Range <span class="delete">(i)]                    ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                           [Gap (i)]                        ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                          [ACK</span> Range <span class="delete">(i)]                    ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                                  ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                           [Gap (i)]                        ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                          [ACK Range (i)]                    ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0516"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                           Figure <span class="delete">19</span>: ACK Ranges</td><td> </td><td class="rblock">                           Figure <span class="insert">25</span>: ACK Ranges</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0517"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The fields that form <span class="delete">the ACK Ranges</span> are:</td><td> </td><td class="rblock">   The fields that form <span class="insert">each ACK Range</span> are:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0518"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Gap (repeated):</span>  A variable-length integer indicating the number of</td><td> </td><td class="rblock">   <span class="insert">Gap:</span>  A variable-length integer indicating the number of contiguous</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      contiguous unacknowledged packets preceding the packet number one</td><td> </td><td class="rblock">      unacknowledged packets preceding the packet number one lower than</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      lower than the smallest in the preceding ACK Range.</td><td> </td><td class="rblock">      the smallest in the preceding ACK Range.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0519"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   ACK Range <span class="delete">(repeated):</span>  A variable-length integer indicating the</td><td> </td><td class="rblock">   ACK Range <span class="insert">Length:</span>  A variable-length integer indicating the number of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      number of contiguous acknowledged packets preceding the largest</td><td> </td><td class="rblock">      contiguous acknowledged packets preceding the largest packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      packet number, as determined by the preceding Gap.</td><td> </td><td class="rblock">      number, as determined by the preceding Gap.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Gap and ACK Range value use a relative integer encoding for</td><td> </td><td class="right">   Gap and ACK Range value use a relative integer encoding for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   efficiency.  Though each encoded value is positive, the values are</td><td> </td><td class="right">   efficiency.  Though each encoded value is positive, the values are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   subtracted, so that each ACK Range describes progressively lower-</td><td> </td><td class="right">   subtracted, so that each ACK Range describes progressively lower-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   numbered packets.</td><td> </td><td class="right">   numbered packets.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Each ACK Range acknowledges a contiguous range of packets by</td><td> </td><td class="right">   Each ACK Range acknowledges a contiguous range of packets by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   indicating the number of acknowledged packets that precede the</td><td> </td><td class="right">   indicating the number of acknowledged packets that precede the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   largest packet number in that range.  A value of zero indicates that</td><td> </td><td class="right">   largest packet number in that range.  A value of zero indicates that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   only the largest packet number is acknowledged.  Larger ACK Range</td><td> </td><td class="right">   only the largest packet number is acknowledged.  Larger ACK Range</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-22" class="change"><td></td><th><small>skipping to change at</small><a href="#part-22"><em> page 101, line 18<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-22"><em> page 125, line 32<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   Each Gap indicates a range of packets that are not being</td><td> </td><td class="right">   Each Gap indicates a range of packets that are not being</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   acknowledged.  The number of packets in the gap is one higher than</td><td> </td><td class="right">   acknowledged.  The number of packets in the gap is one higher than</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the encoded value of the Gap field.</td><td> </td><td class="right">   the encoded value of the Gap field.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The value of the Gap field establishes the largest packet number</td><td> </td><td class="right">   The value of the Gap field establishes the largest packet number</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   value for the subsequent ACK Range using the following formula:</td><td> </td><td class="right">   value for the subsequent ACK Range using the following formula:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      largest = previous_smallest - gap - 2</td><td> </td><td class="right">      largest = previous_smallest - gap - 2</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If any computed packet number is negative, an endpoint MUST generate</td><td> </td><td class="right">   If any computed packet number is negative, an endpoint MUST generate</td><td class="lineno"></td></tr>
      <tr id="diff0520"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a connection error of type <span class="delete">FRAME_ENCODING_ERROR indicating an error</span></td><td> </td><td class="rblock">   a connection error of type <span class="insert">FRAME_ENCODING_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   in an ACK frame.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.3.2.  ECN Counts</td><td> </td><td class="right">19.3.2.  ECN Counts</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The ACK frame uses the least significant bit (that is, type 0x03) to</td><td> </td><td class="right">   The ACK frame uses the least significant bit (that is, type 0x03) to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   indicate ECN feedback and report receipt of QUIC packets with</td><td> </td><td class="right">   indicate ECN feedback and report receipt of QUIC packets with</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   associated ECN codepoints of ECT(0), ECT(1), or CE in the packet's IP</td><td> </td><td class="right">   associated ECN codepoints of ECT(0), ECT(1), or CE in the packet's IP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   header.  ECN Counts are only present when the ACK frame type is 0x03.</td><td> </td><td class="right">   header.  ECN Counts are only present when the ACK frame type is 0x03.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ECN Counts are only parsed when the ACK frame type is 0x03.  There</td><td> </td><td class="right">   ECN Counts are only parsed when the ACK frame type is 0x03.  There</td><td class="lineno"></td></tr>
      <tr id="diff0521"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   are 3 ECN counts, as <span class="delete">follows:</span></td><td> </td><td class="rblock">   are 3 ECN counts, as <span class="insert">shown in Figure 26.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0522"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">ECN Counts {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     ECT0</span> Count <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     ECT1</span> Count <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                        ECT(0)</span> Count <span class="delete">(i)                     ...</span></td><td> </td><td class="rblock">     ECN-CE Count <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                        ECT(1)</span> Count <span class="delete">(i)                     ...</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">                        Figure 26: ECN Count Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                        ECN-CE Count <span class="delete">(i)                     ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The three ECN Counts are:</td><td> </td><td class="right">   The three ECN Counts are:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0523"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">ECT(0)</span> Count:  A variable-length integer representing the total</td><td> </td><td class="rblock">   <span class="insert">ECT0</span> Count:  A variable-length integer representing the total number</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      number packets received with the ECT(0) <span class="delete">codepoint.</span></td><td> </td><td class="rblock">      <span class="insert">of</span> packets received with the ECT(0) <span class="insert">codepoint in the packet number</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      space of the ACK frame.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0524"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">ECT(1)</span> Count:  A variable-length integer representing the total</td><td> </td><td class="rblock">   <span class="insert">ECT1</span> Count:  A variable-length integer representing the total number</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      number packets received with the ECT(1) <span class="delete">codepoint.</span></td><td> </td><td class="rblock">      <span class="insert">of</span> packets received with the ECT(1) <span class="insert">codepoint in the packet number</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      space of the ACK frame.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0525"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   CE Count:  A variable-length integer representing the total number</td><td> </td><td class="rblock">   CE Count:  A variable-length integer representing the total number <span class="insert">of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      packets received with the CE <span class="delete">codepoint.</span></td><td> </td><td class="rblock">      packets received with the CE <span class="insert">codepoint in the packet number space</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      of the ACK frame.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ECN counts are maintained separately for each packet number space.</td><td> </td><td class="right">   ECN counts are maintained separately for each packet number space.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.4.  RESET_STREAM Frame</td><td> </td><td class="right">19.4.  RESET_STREAM Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint uses a RESET_STREAM frame (type=0x04) to abruptly</td><td> </td><td class="right">   An endpoint uses a RESET_STREAM frame (type=0x04) to abruptly</td><td class="lineno"></td></tr>
      <tr id="diff0526"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   terminate a stream.</td><td> </td><td class="rblock">   terminate <span class="insert">the sending part of </span>a stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   After sending a RESET_STREAM, an endpoint ceases transmission and</td><td> </td><td class="right">   After sending a RESET_STREAM, an endpoint ceases transmission and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   retransmission of STREAM frames on the identified stream.  A receiver</td><td> </td><td class="right">   retransmission of STREAM frames on the identified stream.  A receiver</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   of RESET_STREAM can discard any data that it already received on that</td><td> </td><td class="right">   of RESET_STREAM can discard any data that it already received on that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream.</td><td> </td><td class="right">   stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint that receives a RESET_STREAM frame for a send-only stream</td><td> </td><td class="right">   An endpoint that receives a RESET_STREAM frame for a send-only stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MUST terminate the connection with error STREAM_STATE_ERROR.</td><td> </td><td class="right">   MUST terminate the connection with error STREAM_STATE_ERROR.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0527"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The RESET_STREAM frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The RESET_STREAM frame is <span class="insert">shown in Figure 27.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0528"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">RESET_STREAM Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x04,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Stream ID <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                        Stream ID <span class="delete">(i)                        ...</span></td><td> </td><td class="rblock">     Application <span class="insert">Protocol</span> Error Code <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Final Size <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>  Application Error Code <span class="delete">(16)  |</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                        Final Size <span class="delete">(i)                       ...</span></td><td> </td><td class="rblock"><span class="insert">                    Figure 27: RESET_STREAM Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   RESET_STREAM frames contain the following fields:</td><td> </td><td class="right">   RESET_STREAM frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stream ID:  A variable-length integer encoding of the Stream ID of</td><td> </td><td class="right">   Stream ID:  A variable-length integer encoding of the Stream ID of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the stream being terminated.</td><td> </td><td class="right">      the stream being terminated.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0529"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Application Protocol Error Code:  A <span class="delete">16-bit</span> application protocol error</td><td> </td><td class="rblock">   Application Protocol Error Code:  A <span class="insert">variable-length integer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      code (see Section 20.1) which indicates why the stream is being</td><td> </td><td class="rblock"><span class="insert">      containing the</span> application protocol error code (see Section 20.1)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      closed.</td><td> </td><td class="rblock">      which indicates why the stream is being closed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Final Size:  A variable-length integer indicating the final size of</td><td> </td><td class="right">   Final Size:  A variable-length integer indicating the final size of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the stream by the RESET_STREAM sender, in unit of bytes.</td><td> </td><td class="right">      the stream by the RESET_STREAM sender, in unit of bytes.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.5.  STOP_SENDING Frame</td><td> </td><td class="right">19.5.  STOP_SENDING Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint uses a STOP_SENDING frame (type=0x05) to communicate that</td><td> </td><td class="right">   An endpoint uses a STOP_SENDING frame (type=0x05) to communicate that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   incoming data is being discarded on receipt at application request.</td><td> </td><td class="right">   incoming data is being discarded on receipt at application request.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STOP_SENDING requests that a peer cease transmission on a stream.</td><td> </td><td class="right">   STOP_SENDING requests that a peer cease transmission on a stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A STOP_SENDING frame can be sent for streams in the Recv or Size</td><td> </td><td class="right">   A STOP_SENDING frame can be sent for streams in the Recv or Size</td><td class="lineno"></td></tr>
      <tr id="diff0530"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Known states<span class="delete"> (see Section 3.1)</span>.  Receiving a STOP_SENDING frame for a</td><td> </td><td class="rblock">   Known states<span class="insert">; see Section 3.1</span>.  Receiving a STOP_SENDING frame for a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   locally-initiated stream that has not yet been created MUST be</td><td> </td><td class="right">   locally-initiated stream that has not yet been created MUST be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   treated as a connection error of type STREAM_STATE_ERROR.  An</td><td> </td><td class="right">   treated as a connection error of type STREAM_STATE_ERROR.  An</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint that receives a STOP_SENDING frame for a receive-only stream</td><td> </td><td class="right">   endpoint that receives a STOP_SENDING frame for a receive-only stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MUST terminate the connection with error STREAM_STATE_ERROR.</td><td> </td><td class="right">   MUST terminate the connection with error STREAM_STATE_ERROR.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0531"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The STOP_SENDING frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The STOP_SENDING frame is <span class="insert">shown in Figure 28.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0532"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">STOP_SENDING Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x05,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Stream ID <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                        Stream ID <span class="delete">(i)                        ...</span></td><td> </td><td class="rblock">     Application <span class="insert">Protocol</span> Error Code <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>  Application Error Code <span class="delete">(16)  |</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">                    Figure 28: STOP_SENDING Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STOP_SENDING frames contain the following fields:</td><td> </td><td class="right">   STOP_SENDING frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stream ID:  A variable-length integer carrying the Stream ID of the</td><td> </td><td class="right">   Stream ID:  A variable-length integer carrying the Stream ID of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      stream being ignored.</td><td> </td><td class="right">      stream being ignored.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0533"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Application Error Code:  A <span class="delete">16-bit,</span> application-specified reason the</td><td> </td><td class="rblock">   Application <span class="insert">Protocol</span> Error Code:  A <span class="insert">variable-length integer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      sender is ignoring the <span class="delete">stream (see</span> Section <span class="delete">20.1).</span></td><td> </td><td class="rblock"><span class="insert">      containing the</span> application-specified reason the sender is ignoring</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      the <span class="insert">stream; see</span> Section <span class="insert">20.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.6.  CRYPTO Frame</td><td> </td><td class="right">19.6.  CRYPTO Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The CRYPTO frame (type=0x06) is used to transmit cryptographic</td><td> </td><td class="right">   The CRYPTO frame (type=0x06) is used to transmit cryptographic</td><td class="lineno"></td></tr>
      <tr id="diff0534"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   handshake messages.  It can be sent in all packet <span class="delete">types.</span>  The CRYPTO</td><td> </td><td class="rblock">   handshake messages.  It can be sent in all packet <span class="insert">types except 0-RTT.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   frame offers the cryptographic protocol an in-order stream of bytes.</td><td> </td><td class="rblock">   The CRYPTO frame offers the cryptographic protocol an in-order stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   CRYPTO frames are functionally identical to STREAM frames, except</td><td> </td><td class="rblock">   of bytes.  CRYPTO frames are functionally identical to STREAM frames,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that they do not bear a stream identifier; they are not flow</td><td> </td><td class="rblock">   except that they do not bear a stream identifier; they are not flow</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   controlled; and they do not carry markers for optional offset,</td><td> </td><td class="right">   controlled; and they do not carry markers for optional offset,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   optional length, and the end of the stream.</td><td> </td><td class="right">   optional length, and the end of the stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0535"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The CRYPTO frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The CRYPTO frame is <span class="insert">shown in Figure 29.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0536"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">CRYPTO Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type</span> (i) <span class="insert">= 0x06,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Offset (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                          Offset</span> (i)                         <span class="delete">...</span></td><td> </td><td class="rblock">     Length <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Crypto Data <span class="insert">(..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                          Length <span class="delete">(i)                         ...</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                        Crypto Data <span class="delete">(*)                      ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0537"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                      <span class="delete">Figure 20</span>: CRYPTO Frame Format</td><td> </td><td class="rblock">                      <span class="insert"> Figure 29</span>: CRYPTO Frame Format</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   CRYPTO frames contain the following fields:</td><td> </td><td class="right">   CRYPTO frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Offset:  A variable-length integer specifying the byte offset in the</td><td> </td><td class="right">   Offset:  A variable-length integer specifying the byte offset in the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      stream for the data in this CRYPTO frame.</td><td> </td><td class="right">      stream for the data in this CRYPTO frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Length:  A variable-length integer specifying the length of the</td><td> </td><td class="right">   Length:  A variable-length integer specifying the length of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Crypto Data field in this CRYPTO frame.</td><td> </td><td class="right">      Crypto Data field in this CRYPTO frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Crypto Data:  The cryptographic message data.</td><td> </td><td class="right">   Crypto Data:  The cryptographic message data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   There is a separate flow of cryptographic handshake data in each</td><td> </td><td class="right">   There is a separate flow of cryptographic handshake data in each</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   encryption level, each of which starts at an offset of 0.  This</td><td> </td><td class="right">   encryption level, each of which starts at an offset of 0.  This</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   implies that each encryption level is treated as a separate CRYPTO</td><td> </td><td class="right">   implies that each encryption level is treated as a separate CRYPTO</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream of data.</td><td> </td><td class="right">   stream of data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0538"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">The largest offset delivered on a stream - the sum of the offset and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   data length - cannot exceed 2^62-1.  Receipt of a frame that exceeds</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   this limit MUST be treated as a connection error of type</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   FRAME_ENCODING_ERROR or CRYPTO_BUFFER_EXCEEDED.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Unlike STREAM frames, which include a Stream ID indicating to which</td><td> </td><td class="right">   Unlike STREAM frames, which include a Stream ID indicating to which</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream the data belongs, the CRYPTO frame carries data for a single</td><td> </td><td class="right">   stream the data belongs, the CRYPTO frame carries data for a single</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream per encryption level.  The stream does not have an explicit</td><td> </td><td class="right">   stream per encryption level.  The stream does not have an explicit</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   end, so CRYPTO frames do not have a FIN bit.</td><td> </td><td class="right">   end, so CRYPTO frames do not have a FIN bit.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.7.  NEW_TOKEN Frame</td><td> </td><td class="right">19.7.  NEW_TOKEN Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A server sends a NEW_TOKEN frame (type=0x07) to provide the client</td><td> </td><td class="right">   A server sends a NEW_TOKEN frame (type=0x07) to provide the client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   with a token to send in the header of an Initial packet for a future</td><td> </td><td class="right">   with a token to send in the header of an Initial packet for a future</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection.</td><td> </td><td class="right">   connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0539"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The NEW_TOKEN frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The NEW_TOKEN frame is <span class="insert">shown in Figure 30.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0540"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">NEW_TOKEN Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x07,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Token Length <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                     Token Length <span class="delete">(i)  ...</span></td><td> </td><td class="rblock">     Token <span class="insert">(..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                            Token <span class="delete">(*)                        ...</span></td><td> </td><td class="rblock"><span class="insert">                     Figure 30: NEW_TOKEN Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   NEW_TOKEN frames contain the following fields:</td><td> </td><td class="right">   NEW_TOKEN frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Token Length:  A variable-length integer specifying the length of the</td><td> </td><td class="right">   Token Length:  A variable-length integer specifying the length of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      token in bytes.</td><td> </td><td class="right">      token in bytes.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Token:  An opaque blob that the client may use with a future Initial</td><td> </td><td class="right">   Token:  An opaque blob that the client may use with a future Initial</td><td class="lineno"></td></tr>
      <tr id="diff0541"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      packet.</td><td> </td><td class="rblock">      packet.  <span class="insert">The token MUST NOT be empty.  An endpoint MUST treat</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      receipt of a NEW_TOKEN frame with an empty Token field as a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      connection error of type FRAME_ENCODING_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint might receive multiple NEW_TOKEN frames that contain the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   same token value if packets containing the frame are incorrectly</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   determined to be lost.  Endpoints are responsible for discarding</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   duplicate values, which might be used to link connection attempts;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   see Section 8.1.3.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Clients MUST NOT send NEW_TOKEN frames.  Servers MUST treat receipt</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of a NEW_TOKEN frame as a connection error of type</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   PROTOCOL_VIOLATION.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.8.  STREAM Frames</td><td> </td><td class="right">19.8.  STREAM Frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STREAM frames implicitly create a stream and carry stream data.  The</td><td> </td><td class="right">   STREAM frames implicitly create a stream and carry stream data.  The</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STREAM frame takes the form 0b00001XXX (or the set of values from</td><td> </td><td class="right">   STREAM frame takes the form 0b00001XXX (or the set of values from</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0x08 to 0x0f).  The value of the three low-order bits of the frame</td><td> </td><td class="right">   0x08 to 0x0f).  The value of the three low-order bits of the frame</td><td class="lineno"></td></tr>
      <tr id="diff0542"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   type determine the fields that are present in the frame.</td><td> </td><td class="rblock">   type determine<span class="insert">s</span> the fields that are present in the frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0543"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The OFF bit (0x04) in the frame type is set to indicate that there</td><td> </td><td class="rblock">   <span class="insert">*</span>  The OFF bit (0x04) in the frame type is set to indicate that there</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      is an Offset field present.  When set to 1, the Offset field is</td><td> </td><td class="right">      is an Offset field present.  When set to 1, the Offset field is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      present.  When set to 0, the Offset field is absent and the Stream</td><td> </td><td class="right">      present.  When set to 0, the Offset field is absent and the Stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Data starts at an offset of 0 (that is, the frame contains the</td><td> </td><td class="right">      Data starts at an offset of 0 (that is, the frame contains the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      first bytes of the stream, or the end of a stream that includes no</td><td> </td><td class="right">      first bytes of the stream, or the end of a stream that includes no</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      data).</td><td> </td><td class="right">      data).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0544"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The LEN bit (0x02) in the frame type is set to indicate that there</td><td> </td><td class="rblock">   <span class="insert">*</span>  The LEN bit (0x02) in the frame type is set to indicate that there</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      is a Length field present.  If this bit is set to 0, the Length</td><td> </td><td class="right">      is a Length field present.  If this bit is set to 0, the Length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      field is absent and the Stream Data field extends to the end of</td><td> </td><td class="right">      field is absent and the Stream Data field extends to the end of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the packet.  If this bit is set to 1, the Length field is present.</td><td> </td><td class="right">      the packet.  If this bit is set to 1, the Length field is present.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0545"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The FIN bit (0x01) of the frame type is set only on frames that</td><td> </td><td class="rblock">   <span class="insert">*</span>  The FIN bit (0x01) of the frame type is set only on frames that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      contain the final size of the stream.  Setting this bit indicates</td><td> </td><td class="right">      contain the final size of the stream.  Setting this bit indicates</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      that the frame marks the end of the stream.</td><td> </td><td class="right">      that the frame marks the end of the stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0546"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   An endpoint <span class="delete">that</span> receives a STREAM frame for a <span class="delete">send-only</span> stream <span class="delete">MUST</span></td><td> </td><td class="rblock">   An endpoint <span class="insert">MUST terminate the connection with error</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   terminate the connection with error STREAM_STATE_ERROR.</span></td><td> </td><td class="rblock"><span class="insert">   STREAM_STATE_ERROR if it</span> receives a STREAM frame for a <span class="insert">locally-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   initiated</span> stream <span class="insert">that has not yet been created, or for a send-only</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   stream.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0547"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The STREAM frames are <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The STREAM frames are <span class="insert">shown in Figure 31.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0548"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">STREAM Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x08..0x0f,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Stream ID <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                         Stream ID <span class="delete">(i)                       ...</span></td><td> </td><td class="rblock">     [Offset <span class="insert">(i)],</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     [Length <span class="insert">(i)],</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                         [Offset <span class="delete">(i)]                        ...</span></td><td> </td><td class="rblock">     Stream Data <span class="insert">(..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                         [Length <span class="delete">(i)]                        ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                        Stream Data <span class="delete">(*)                      ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0549"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                      <span class="delete">Figure 2</span>1: STREAM Frame Format</td><td> </td><td class="rblock">                      <span class="insert"> Figure 3</span>1: STREAM Frame Format</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STREAM frames contain the following fields:</td><td> </td><td class="right">   STREAM frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stream ID:  A variable-length integer indicating the stream ID of the</td><td> </td><td class="right">   Stream ID:  A variable-length integer indicating the stream ID of the</td><td class="lineno"></td></tr>
      <tr id="diff0550"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      stream<span class="delete"> (see Section 2.1)</span>.</td><td> </td><td class="rblock">      stream<span class="insert">; see Section 2.1</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Offset:  A variable-length integer specifying the byte offset in the</td><td> </td><td class="right">   Offset:  A variable-length integer specifying the byte offset in the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      stream for the data in this STREAM frame.  This field is present</td><td> </td><td class="right">      stream for the data in this STREAM frame.  This field is present</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      when the OFF bit is set to 1.  When the Offset field is absent,</td><td> </td><td class="right">      when the OFF bit is set to 1.  When the Offset field is absent,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the offset is 0.</td><td> </td><td class="right">      the offset is 0.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Length:  A variable-length integer specifying the length of the</td><td> </td><td class="right">   Length:  A variable-length integer specifying the length of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Stream Data field in this STREAM frame.  This field is present</td><td> </td><td class="right">      Stream Data field in this STREAM frame.  This field is present</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      when the LEN bit is set to 1.  When the LEN bit is set to 0, the</td><td> </td><td class="right">      when the LEN bit is set to 1.  When the LEN bit is set to 0, the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Stream Data field consumes all the remaining bytes in the packet.</td><td> </td><td class="right">      Stream Data field consumes all the remaining bytes in the packet.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stream Data:  The bytes from the designated stream to be delivered.</td><td> </td><td class="right">   Stream Data:  The bytes from the designated stream to be delivered.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   When a Stream Data field has a length of 0, the offset in the STREAM</td><td> </td><td class="right">   When a Stream Data field has a length of 0, the offset in the STREAM</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame is the offset of the next byte that would be sent.</td><td> </td><td class="right">   frame is the offset of the next byte that would be sent.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The first byte in the stream has an offset of 0.  The largest offset</td><td> </td><td class="right">   The first byte in the stream has an offset of 0.  The largest offset</td><td class="lineno"></td></tr>
      <tr id="diff0551"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   delivered on a stream - the sum of the offset and data length - MUST</td><td> </td><td class="rblock">   delivered on a stream - the sum of the offset and data length -</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   be <span class="delete">less than 2^62.</span></td><td> </td><td class="rblock">   <span class="insert">cannot exceed 2^62-1, as it is not possible to provide flow control</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   credit for that data.  Receipt of a frame that exceeds this limit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   MUST be <span class="insert">treated as a connection error of type FRAME_ENCODING_ERROR or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   FLOW_CONTROL_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.9.  MAX_DATA Frame</td><td> </td><td class="right">19.9.  MAX_DATA Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The MAX_DATA frame (type=0x10) is used in flow control to inform the</td><td> </td><td class="right">   The MAX_DATA frame (type=0x10) is used in flow control to inform the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   peer of the maximum amount of data that can be sent on the connection</td><td> </td><td class="right">   peer of the maximum amount of data that can be sent on the connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   as a whole.</td><td> </td><td class="right">   as a whole.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0552"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The MAX_DATA frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The MAX_DATA frame is <span class="insert">shown in Figure 32.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0553"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">MAX_DATA Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x10,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Maximum Data <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                        Maximum Data <span class="delete">(i)                     ...</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                      Figure 32: MAX_DATA Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MAX_DATA frames contain the following fields:</td><td> </td><td class="right">   MAX_DATA frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Maximum Data:  A variable-length integer indicating the maximum</td><td> </td><td class="right">   Maximum Data:  A variable-length integer indicating the maximum</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      amount of data that can be sent on the entire connection, in units</td><td> </td><td class="right">      amount of data that can be sent on the entire connection, in units</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of bytes.</td><td> </td><td class="right">      of bytes.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   All data sent in STREAM frames counts toward this limit.  The sum of</td><td> </td><td class="right">   All data sent in STREAM frames counts toward this limit.  The sum of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the largest received offsets on all streams - including streams in</td><td> </td><td class="right">   the largest received offsets on all streams - including streams in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   terminal states - MUST NOT exceed the value advertised by a receiver.</td><td> </td><td class="right">   terminal states - MUST NOT exceed the value advertised by a receiver.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MUST terminate a connection with a FLOW_CONTROL_ERROR</td><td> </td><td class="right">   An endpoint MUST terminate a connection with a FLOW_CONTROL_ERROR</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   error if it receives more data than the maximum data value that it</td><td> </td><td class="right">   error if it receives more data than the maximum data value that it</td><td class="lineno"></td></tr>
      <tr id="diff0554"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   has sent, unless this is a result of a change in the initial <span class="delete">limits</span></td><td> </td><td class="rblock">   has sent, unless this is a result of a change in the initial <span class="insert">limits;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   (see</span> Section <span class="delete">7.3.1).</span></td><td> </td><td class="rblock"><span class="insert">   see</span> Section <span class="insert">7.4.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.10.  MAX_STREAM_DATA Frame</td><td> </td><td class="right">19.10.  MAX_STREAM_DATA Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The MAX_STREAM_DATA frame (type=0x11) is used in flow control to</td><td> </td><td class="right">   The MAX_STREAM_DATA frame (type=0x11) is used in flow control to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   inform a peer of the maximum amount of data that can be sent on a</td><td> </td><td class="right">   inform a peer of the maximum amount of data that can be sent on a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream.</td><td> </td><td class="right">   stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0555"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   A MAX_STREAM_DATA frame can be sent for streams in the Recv <span class="delete">state</span></td><td> </td><td class="rblock">   A MAX_STREAM_DATA frame can be sent for streams in the Recv <span class="insert">state;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   (see</span> Section <span class="delete">3.1).</span>  Receiving a MAX_STREAM_DATA frame for a locally-</td><td> </td><td class="rblock"><span class="insert">   see</span> Section <span class="insert">3.1.</span>  Receiving a MAX_STREAM_DATA frame for a locally-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   initiated stream that has not yet been created MUST be treated as a</td><td> </td><td class="right">   initiated stream that has not yet been created MUST be treated as a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection error of type STREAM_STATE_ERROR.  An endpoint that</td><td> </td><td class="right">   connection error of type STREAM_STATE_ERROR.  An endpoint that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   receives a MAX_STREAM_DATA frame for a receive-only stream MUST</td><td> </td><td class="right">   receives a MAX_STREAM_DATA frame for a receive-only stream MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   terminate the connection with error STREAM_STATE_ERROR.</td><td> </td><td class="right">   terminate the connection with error STREAM_STATE_ERROR.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0556"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The MAX_STREAM_DATA frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The MAX_STREAM_DATA frame is <span class="insert">shown in Figure 33.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0557"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">MAX_STREAM_DATA Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x11,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Stream ID <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                        Stream ID <span class="delete">(i)                        ...</span></td><td> </td><td class="rblock">     Maximum Stream Data <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                    Maximum Stream Data <span class="delete">(i)                  ...</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">                  Figure 33: MAX_STREAM_DATA Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MAX_STREAM_DATA frames contain the following fields:</td><td> </td><td class="right">   MAX_STREAM_DATA frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stream ID:  The stream ID of the stream that is affected encoded as a</td><td> </td><td class="right">   Stream ID:  The stream ID of the stream that is affected encoded as a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      variable-length integer.</td><td> </td><td class="right">      variable-length integer.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Maximum Stream Data:  A variable-length integer indicating the</td><td> </td><td class="right">   Maximum Stream Data:  A variable-length integer indicating the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      maximum amount of data that can be sent on the identified stream,</td><td> </td><td class="right">      maximum amount of data that can be sent on the identified stream,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      in units of bytes.</td><td> </td><td class="right">      in units of bytes.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-23" class="change"><td></td><th><small>skipping to change at</small><a href="#part-23"><em> page 107, line 40<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-23"><em> page 132, line 34<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream.  Loss or reordering can mean that the largest received offset</td><td> </td><td class="right">   stream.  Loss or reordering can mean that the largest received offset</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   on a stream can be greater than the total size of data received on</td><td> </td><td class="right">   on a stream can be greater than the total size of data received on</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that stream.  Receiving STREAM frames might not increase the largest</td><td> </td><td class="right">   that stream.  Receiving STREAM frames might not increase the largest</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   received offset.</td><td> </td><td class="right">   received offset.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The data sent on a stream MUST NOT exceed the largest maximum stream</td><td> </td><td class="right">   The data sent on a stream MUST NOT exceed the largest maximum stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   data value advertised by the receiver.  An endpoint MUST terminate a</td><td> </td><td class="right">   data value advertised by the receiver.  An endpoint MUST terminate a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection with a FLOW_CONTROL_ERROR error if it receives more data</td><td> </td><td class="right">   connection with a FLOW_CONTROL_ERROR error if it receives more data</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   than the largest maximum stream data that it has sent for the</td><td> </td><td class="right">   than the largest maximum stream data that it has sent for the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   affected stream, unless this is a result of a change in the initial</td><td> </td><td class="right">   affected stream, unless this is a result of a change in the initial</td><td class="lineno"></td></tr>
      <tr id="diff0558"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   limits<span class="delete"> (see Section 7.3.1)</span>.</td><td> </td><td class="rblock">   limits<span class="insert">; see Section 7.4.1</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.11.  MAX_STREAMS Frames</td><td> </td><td class="right">19.11.  MAX_STREAMS Frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The MAX_STREAMS frames (type=0x12 and 0x13) inform the peer of the</td><td> </td><td class="right">   The MAX_STREAMS frames (type=0x12 and 0x13) inform the peer of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   cumulative number of streams of a given type it is permitted to open.</td><td> </td><td class="right">   cumulative number of streams of a given type it is permitted to open.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A MAX_STREAMS frame with a type of 0x12 applies to bidirectional</td><td> </td><td class="right">   A MAX_STREAMS frame with a type of 0x12 applies to bidirectional</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   streams, and a MAX_STREAMS frame with a type of 0x13 applies to</td><td> </td><td class="right">   streams, and a MAX_STREAMS frame with a type of 0x13 applies to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   unidirectional streams.</td><td> </td><td class="right">   unidirectional streams.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0559"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The MAX_STREAMS frames are <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The MAX_STREAMS frames are <span class="insert">shown in Figure 34;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0560"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">MAX_STREAMS Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x12..0x13,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Maximum Streams <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                     Maximum Streams <span class="delete">(i)                     ...</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                    Figure 34: MAX_STREAMS Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MAX_STREAMS frames contain the following fields:</td><td> </td><td class="right">   MAX_STREAMS frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Maximum Streams:  A count of the cumulative number of streams of the</td><td> </td><td class="right">   Maximum Streams:  A count of the cumulative number of streams of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      corresponding type that can be opened over the lifetime of the</td><td> </td><td class="right">      corresponding type that can be opened over the lifetime of the</td><td class="lineno"></td></tr>
      <tr id="diff0561"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      connection.</td><td> </td><td class="rblock">      connection.  <span class="insert">This value cannot exceed 2^60, as it is not possible</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      to encode stream IDs larger than 2^62-1.  Receipt of a frame that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      permits opening of a stream larger than this limit MUST be treated</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      as a FRAME_ENCODING_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Loss or reordering can cause a MAX_STREAMS frame to be received which</td><td> </td><td class="right">   Loss or reordering can cause a MAX_STREAMS frame to be received which</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   states a lower stream limit than an endpoint has previously received.</td><td> </td><td class="right">   states a lower stream limit than an endpoint has previously received.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MAX_STREAMS frames which do not increase the stream limit MUST be</td><td> </td><td class="right">   MAX_STREAMS frames which do not increase the stream limit MUST be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ignored.</td><td> </td><td class="right">   ignored.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MUST NOT open more streams than permitted by the current</td><td> </td><td class="right">   An endpoint MUST NOT open more streams than permitted by the current</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream limit set by its peer.  For instance, a server that receives a</td><td> </td><td class="right">   stream limit set by its peer.  For instance, a server that receives a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   unidirectional stream limit of 3 is permitted to open stream 3, 7,</td><td> </td><td class="right">   unidirectional stream limit of 3 is permitted to open stream 3, 7,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and 11, but not stream 15.  An endpoint MUST terminate a connection</td><td> </td><td class="right">   and 11, but not stream 15.  An endpoint MUST terminate a connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-24" class="change"><td></td><th><small>skipping to change at</small><a href="#part-24"><em> page 108, line 37<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-24"><em> page 133, line 34<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   permitted.</td><td> </td><td class="right">   permitted.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Note that these frames (and the corresponding transport parameters)</td><td> </td><td class="right">   Note that these frames (and the corresponding transport parameters)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   do not describe the number of streams that can be opened</td><td> </td><td class="right">   do not describe the number of streams that can be opened</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   concurrently.  The limit includes streams that have been closed as</td><td> </td><td class="right">   concurrently.  The limit includes streams that have been closed as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   well as those that are open.</td><td> </td><td class="right">   well as those that are open.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.12.  DATA_BLOCKED Frame</td><td> </td><td class="right">19.12.  DATA_BLOCKED Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A sender SHOULD send a DATA_BLOCKED frame (type=0x14) when it wishes</td><td> </td><td class="right">   A sender SHOULD send a DATA_BLOCKED frame (type=0x14) when it wishes</td><td class="lineno"></td></tr>
      <tr id="diff0562"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to send data, but is unable to due to connection-level flow <span class="delete">control</span></td><td> </td><td class="rblock">   to send data, but is unable to due to connection-level flow <span class="insert">control;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   (see</span> Section <span class="delete">4).</span>  DATA_BLOCKED frames can be used as input to tuning</td><td> </td><td class="rblock"><span class="insert">   see</span> Section <span class="insert">4.</span>  DATA_BLOCKED frames can be used as input to tuning of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   of flow control <span class="delete">algorithms (see</span> Section <span class="delete">4.2).</span></td><td> </td><td class="rblock">   flow control <span class="insert">algorithms; see</span> Section <span class="insert">4.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0563"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The DATA_BLOCKED frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The DATA_BLOCKED frame is <span class="insert">shown in Figure 35.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0564"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">DATA_BLOCKED Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type</span> (i) <span class="insert">= 0x14,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Maximum Data (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                       Data Limit</span> (i)                        <span class="delete">...</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                    Figure 35: DATA_BLOCKED Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   DATA_BLOCKED frames contain the following fields:</td><td> </td><td class="right">   DATA_BLOCKED frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0565"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Data Limit</span>:  A variable-length integer indicating the connection-</td><td> </td><td class="rblock">   <span class="insert">Maximum Data</span>:  A variable-length integer indicating the connection-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      level limit at which blocking occurred.</td><td> </td><td class="right">      level limit at which blocking occurred.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.13.  STREAM_DATA_BLOCKED Frame</td><td> </td><td class="right">19.13.  STREAM_DATA_BLOCKED Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A sender SHOULD send a STREAM_DATA_BLOCKED frame (type=0x15) when it</td><td> </td><td class="right">   A sender SHOULD send a STREAM_DATA_BLOCKED frame (type=0x15) when it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   wishes to send data, but is unable to due to stream-level flow</td><td> </td><td class="right">   wishes to send data, but is unable to due to stream-level flow</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   control.  This frame is analogous to DATA_BLOCKED (Section 19.12).</td><td> </td><td class="right">   control.  This frame is analogous to DATA_BLOCKED (Section 19.12).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint that receives a STREAM_DATA_BLOCKED frame for a send-only</td><td> </td><td class="right">   An endpoint that receives a STREAM_DATA_BLOCKED frame for a send-only</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream MUST terminate the connection with error STREAM_STATE_ERROR.</td><td> </td><td class="right">   stream MUST terminate the connection with error STREAM_STATE_ERROR.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0566"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The STREAM_DATA_BLOCKED frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The STREAM_DATA_BLOCKED frame is <span class="insert">shown in Figure 36.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0567"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">STREAM_DATA_BLOCKED Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x15,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Stream ID <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                        Stream ID <span class="delete">(i)                        ...</span></td><td> </td><td class="rblock"><span class="insert">     Maximum</span> Stream Data <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                    Stream Data <span class="delete">Limit (i)                    ...</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">                Figure 36: STREAM_DATA_BLOCKED Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STREAM_DATA_BLOCKED frames contain the following fields:</td><td> </td><td class="right">   STREAM_DATA_BLOCKED frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stream ID:  A variable-length integer indicating the stream which is</td><td> </td><td class="right">   Stream ID:  A variable-length integer indicating the stream which is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      flow control blocked.</td><td> </td><td class="right">      flow control blocked.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0568"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Stream Data Limit</span>:  A variable-length integer indicating the offset</td><td> </td><td class="rblock">   <span class="insert">Maximum Stream Data</span>:  A variable-length integer indicating the offset</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of the stream at which the blocking occurred.</td><td> </td><td class="right">      of the stream at which the blocking occurred.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.14.  STREAMS_BLOCKED Frames</td><td> </td><td class="right">19.14.  STREAMS_BLOCKED Frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A sender SHOULD send a STREAMS_BLOCKED frame (type=0x16 or 0x17) when</td><td> </td><td class="right">   A sender SHOULD send a STREAMS_BLOCKED frame (type=0x16 or 0x17) when</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   it wishes to open a stream, but is unable to due to the maximum</td><td> </td><td class="right">   it wishes to open a stream, but is unable to due to the maximum</td><td class="lineno"></td></tr>
      <tr id="diff0569"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   stream limit set by its peer<span class="delete"> (see Section 19.11)</span>.  A STREAMS_BLOCKED</td><td> </td><td class="rblock">   stream limit set by its peer<span class="insert">; see Section 19.11</span>.  A STREAMS_BLOCKED</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame of type 0x16 is used to indicate reaching the bidirectional</td><td> </td><td class="right">   frame of type 0x16 is used to indicate reaching the bidirectional</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   stream limit, and a STREAMS_BLOCKED frame of type 0x17 indicates</td><td> </td><td class="right">   stream limit, and a STREAMS_BLOCKED frame of type 0x17 indicates</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   reaching the unidirectional stream limit.</td><td> </td><td class="right">   reaching the unidirectional stream limit.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A STREAMS_BLOCKED frame does not open the stream, but informs the</td><td> </td><td class="right">   A STREAMS_BLOCKED frame does not open the stream, but informs the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   peer that a new stream was needed and the stream limit prevented the</td><td> </td><td class="right">   peer that a new stream was needed and the stream limit prevented the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   creation of the stream.</td><td> </td><td class="right">   creation of the stream.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0570"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The STREAMS_BLOCKED frames are <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The STREAMS_BLOCKED frames are <span class="insert">shown in Figure 37.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   STREAMS_BLOCKED Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x16..0x17,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Maximum Streams (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                  Figure 37: STREAMS_BLOCKED Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0571"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                        Stream Limit (i)                     ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STREAMS_BLOCKED frames contain the following fields:</td><td> </td><td class="right">   STREAMS_BLOCKED frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0572"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Stream Limit:</span>  A variable-length integer indicating the <span class="delete">stream limit</span></td><td> </td><td class="rblock">   <span class="insert">Maximum Streams:</span>  A variable-length integer indicating the <span class="insert">maximum</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      at the time the frame was sent.</td><td> </td><td class="rblock"><span class="insert">      number of streams allowed</span> at the time the frame was sent.  <span class="insert">This</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      value cannot exceed 2^60, as it is not possible to encode stream</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      IDs larger than 2^62-1.  Receipt of a frame that encodes a larger</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      stream ID MUST be treated as a STREAM_LIMIT_ERROR or a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      FRAME_ENCODING_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.15.  NEW_CONNECTION_ID Frame</td><td> </td><td class="right">19.15.  NEW_CONNECTION_ID Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint sends a NEW_CONNECTION_ID frame (type=0x18) to provide</td><td> </td><td class="right">   An endpoint sends a NEW_CONNECTION_ID frame (type=0x18) to provide</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   its peer with alternative connection IDs that can be used to break</td><td> </td><td class="right">   its peer with alternative connection IDs that can be used to break</td><td class="lineno"></td></tr>
      <tr id="diff0573"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   linkability when migrating connections<span class="delete"> (see Section 9.5)</span>.</td><td> </td><td class="rblock">   linkability when migrating connections<span class="insert">; see Section 9.5</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0574"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The NEW_CONNECTION_ID frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The NEW_CONNECTION_ID frame is <span class="insert">shown in Figure 38.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0575"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">NEW_CONNECTION_ID Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x18,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Sequence Number <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                      Sequence Number <span class="delete">(i)                    ...</span></td><td> </td><td class="rblock"><span class="insert">     Retire Prior To (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Length <span class="insert">(8),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>   Length <span class="delete">(8)  |                                               |</span></td><td> </td><td class="rblock">     Connection ID <span class="insert">(8..160),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+</span>       Connection ID <span class="delete">(32..144)                 +</span></td><td> </td><td class="rblock">     Stateless Reset Token <span class="insert">(128),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                             ...</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                               |</span></td><td> </td><td class="rblock"><span class="insert">                 Figure 38: NEW_CONNECTION_ID Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +                                                               +</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +</span>                   Stateless Reset Token <span class="delete">(128)                 +</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +                                                               +</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   NEW_CONNECTION_ID frames contain the following fields:</td><td> </td><td class="right">   NEW_CONNECTION_ID frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Sequence Number:  The sequence number assigned to the connection ID</td><td> </td><td class="right">   Sequence Number:  The sequence number assigned to the connection ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      by the sender.  See Section 5.1.1.</td><td> </td><td class="right">      by the sender.  See Section 5.1.1.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0576"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Retire Prior To:  A variable-length integer indicating which</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      connection IDs should be retired; see Section 5.1.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Length:  An 8-bit unsigned integer containing the length of the</td><td> </td><td class="right">   Length:  An 8-bit unsigned integer containing the length of the</td><td class="lineno"></td></tr>
      <tr id="diff0577"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      connection ID.  Values less than <span class="delete">4 and greater than 18</span> are invalid</td><td> </td><td class="rblock">      connection ID.  Values less than <span class="insert">1 and greater than 20</span> are invalid</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      and MUST be treated as a connection error of type</td><td> </td><td class="right">      and MUST be treated as a connection error of type</td><td class="lineno"></td></tr>
      <tr id="diff0578"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">PROTOCOL_VIOLATION</span>.</td><td> </td><td class="rblock">      <span class="insert">FRAME_ENCODING_ERROR</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Connection ID:  A connection ID of the specified length.</td><td> </td><td class="right">   Connection ID:  A connection ID of the specified length.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stateless Reset Token:  A 128-bit value that will be used for a</td><td> </td><td class="right">   Stateless Reset Token:  A 128-bit value that will be used for a</td><td class="lineno"></td></tr>
      <tr id="diff0579"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      stateless reset when the associated connection ID is <span class="delete">used (see</span></td><td> </td><td class="rblock">      stateless reset when the associated connection ID is <span class="insert">used; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      Section <span class="delete">10.4).</span></td><td> </td><td class="rblock">      Section <span class="insert">10.4.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint MUST NOT send this frame if it currently requires that</td><td> </td><td class="right">   An endpoint MUST NOT send this frame if it currently requires that</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   its peer send packets with a zero-length Destination Connection ID.</td><td> </td><td class="right">   its peer send packets with a zero-length Destination Connection ID.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Changing the length of a connection ID to or from zero-length makes</td><td> </td><td class="right">   Changing the length of a connection ID to or from zero-length makes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   it difficult to identify when the value of the connection ID changed.</td><td> </td><td class="right">   it difficult to identify when the value of the connection ID changed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint that is sending packets with a zero-length Destination</td><td> </td><td class="right">   An endpoint that is sending packets with a zero-length Destination</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Connection ID MUST treat receipt of a NEW_CONNECTION_ID frame as a</td><td> </td><td class="right">   Connection ID MUST treat receipt of a NEW_CONNECTION_ID frame as a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection error of type PROTOCOL_VIOLATION.</td><td> </td><td class="right">   connection error of type PROTOCOL_VIOLATION.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Transmission errors, timeouts and retransmissions might cause the</td><td> </td><td class="right">   Transmission errors, timeouts and retransmissions might cause the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-25" class="change"><td></td><th><small>skipping to change at</small><a href="#part-25"><em> page 111, line 25<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-25"><em> page 136, line 25<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   of the same frame multiple times MUST NOT be treated as a connection</td><td> </td><td class="right">   of the same frame multiple times MUST NOT be treated as a connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   error.  A receiver can use the sequence number supplied in the</td><td> </td><td class="right">   error.  A receiver can use the sequence number supplied in the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   NEW_CONNECTION_ID frame to identify new connection IDs from old ones.</td><td> </td><td class="right">   NEW_CONNECTION_ID frame to identify new connection IDs from old ones.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If an endpoint receives a NEW_CONNECTION_ID frame that repeats a</td><td> </td><td class="right">   If an endpoint receives a NEW_CONNECTION_ID frame that repeats a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   previously issued connection ID with a different Stateless Reset</td><td> </td><td class="right">   previously issued connection ID with a different Stateless Reset</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Token or a different sequence number, or if a sequence number is used</td><td> </td><td class="right">   Token or a different sequence number, or if a sequence number is used</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   for different connection IDs, the endpoint MAY treat that receipt as</td><td> </td><td class="right">   for different connection IDs, the endpoint MAY treat that receipt as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a connection error of type PROTOCOL_VIOLATION.</td><td> </td><td class="right">   a connection error of type PROTOCOL_VIOLATION.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0580"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">The Retire Prior To field counts connection IDs established during</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection setup and the preferred_address transport parameter; see</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 5.1.2.  The Retire Prior To field MUST be less than or equal</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to the Sequence Number field.  Receiving a value greater than the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Sequence Number MUST be treated as a connection error of type</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   FRAME_ENCODING_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Once a sender indicates a Retire Prior To value, smaller values sent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in subsequent NEW_CONNECTION_ID frames have no effect.  A receiver</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   MUST ignore any Retire Prior To fields that do not increase the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   largest received Retire Prior To value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An endpoint that receives a NEW_CONNECTION_ID frame with a sequence</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   number smaller than the Retire Prior To field of a previously</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   received NEW_CONNECTION_ID frame MUST send a corresponding</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   RETIRE_CONNECTION_ID frame that retires the newly received connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ID, unless it has already done so for that sequence number.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.16.  RETIRE_CONNECTION_ID Frame</td><td> </td><td class="right">19.16.  RETIRE_CONNECTION_ID Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint sends a RETIRE_CONNECTION_ID frame (type=0x19) to</td><td> </td><td class="right">   An endpoint sends a RETIRE_CONNECTION_ID frame (type=0x19) to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   indicate that it will no longer use a connection ID that was issued</td><td> </td><td class="right">   indicate that it will no longer use a connection ID that was issued</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   by its peer.  This may include the connection ID provided during the</td><td> </td><td class="right">   by its peer.  This may include the connection ID provided during the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   handshake.  Sending a RETIRE_CONNECTION_ID frame also serves as a</td><td> </td><td class="right">   handshake.  Sending a RETIRE_CONNECTION_ID frame also serves as a</td><td class="lineno"></td></tr>
      <tr id="diff0581"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   request to the peer to send additional connection IDs for future <span class="delete">use</span></td><td> </td><td class="rblock">   request to the peer to send additional connection IDs for future <span class="insert">use;</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   (see</span> Section <span class="delete">5.1).</span>  New connection IDs can be delivered to a peer</td><td> </td><td class="rblock"><span class="insert">   see</span> Section <span class="insert">5.1.</span>  New connection IDs can be delivered to a peer using</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   using the NEW_CONNECTION_ID frame (Section 19.15).</td><td> </td><td class="rblock">   the NEW_CONNECTION_ID frame (Section 19.15).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Retiring a connection ID invalidates the stateless reset token</td><td> </td><td class="right">   Retiring a connection ID invalidates the stateless reset token</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   associated with that connection ID.</td><td> </td><td class="right">   associated with that connection ID.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0582"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The RETIRE_CONNECTION_ID frame is <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The RETIRE_CONNECTION_ID frame is <span class="insert">shown in Figure 39.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0583"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">RETIRE_CONNECTION_ID Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x19,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Sequence Number <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                      Sequence Number <span class="delete">(i)                    ...</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                Figure 39: RETIRE_CONNECTION_ID Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   RETIRE_CONNECTION_ID frames contain the following fields:</td><td> </td><td class="right">   RETIRE_CONNECTION_ID frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Sequence Number:  The sequence number of the connection ID being</td><td> </td><td class="right">   Sequence Number:  The sequence number of the connection ID being</td><td class="lineno"></td></tr>
      <tr id="diff0584"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      retired<span class="delete">.  S</span>ee Section 5.1.2.</td><td> </td><td class="rblock">      retired<span class="insert">; s</span>ee Section 5.1.2.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Receipt of a RETIRE_CONNECTION_ID frame containing a sequence number</td><td> </td><td class="right">   Receipt of a RETIRE_CONNECTION_ID frame containing a sequence number</td><td class="lineno"></td></tr>
      <tr id="diff0585"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   greater than any previously sent to the peer M<span class="delete">AY</span> be treated as a</td><td> </td><td class="rblock">   greater than any previously sent to the peer M<span class="insert">UST</span> be treated as a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection error of type PROTOCOL_VIOLATION.</td><td> </td><td class="right">   connection error of type PROTOCOL_VIOLATION.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0586"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">The sequence number specified in a RETIRE_CONNECTION_ID frame MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   NOT refer to the Destination Connection ID field of the packet in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   which the frame is contained.  The peer MAY treat this as a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection error of type FRAME_ENCODING_ERROR.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint cannot send this frame if it was provided with a zero-</td><td> </td><td class="right">   An endpoint cannot send this frame if it was provided with a zero-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   length connection ID by its peer.  An endpoint that provides a zero-</td><td> </td><td class="right">   length connection ID by its peer.  An endpoint that provides a zero-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   length connection ID MUST treat receipt of a RETIRE_CONNECTION_ID</td><td> </td><td class="right">   length connection ID MUST treat receipt of a RETIRE_CONNECTION_ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame as a connection error of type PROTOCOL_VIOLATION.</td><td> </td><td class="right">   frame as a connection error of type PROTOCOL_VIOLATION.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.17.  PATH_CHALLENGE Frame</td><td> </td><td class="right">19.17.  PATH_CHALLENGE Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Endpoints can use PATH_CHALLENGE frames (type=0x1a) to check</td><td> </td><td class="right">   Endpoints can use PATH_CHALLENGE frames (type=0x1a) to check</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   reachability to the peer and for path validation during connection</td><td> </td><td class="right">   reachability to the peer and for path validation during connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   migration.</td><td> </td><td class="right">   migration.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0587"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The PATH_CHALLENGE frame<span class="delete">s are as follows:</span></td><td> </td><td class="rblock">   The PATH_CHALLENGE frame<span class="insert"> is shown in Figure 40.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0588"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">PATH_CHALLENGE Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x1a,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Data <span class="insert">(64),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                               |</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +</span>                           Data <span class="delete">(64)                           +</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |                                                               |</span></td><td> </td><td class="rblock"><span class="insert">                   Figure 40: PATH_CHALLENGE Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   PATH_CHALLENGE frames contain the following fields:</td><td> </td><td class="right">   PATH_CHALLENGE frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Data:  This 8-byte field contains arbitrary data.</td><td> </td><td class="right">   Data:  This 8-byte field contains arbitrary data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A PATH_CHALLENGE frame containing 8 bytes that are hard to guess is</td><td> </td><td class="right">   A PATH_CHALLENGE frame containing 8 bytes that are hard to guess is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sufficient to ensure that it is easier to receive the packet than it</td><td> </td><td class="right">   sufficient to ensure that it is easier to receive the packet than it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   is to guess the value correctly.</td><td> </td><td class="right">   is to guess the value correctly.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The recipient of this frame MUST generate a PATH_RESPONSE frame</td><td> </td><td class="right">   The recipient of this frame MUST generate a PATH_RESPONSE frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 19.18) containing the same Data.</td><td> </td><td class="right">   (Section 19.18) containing the same Data.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.18.  PATH_RESPONSE Frame</td><td> </td><td class="right">19.18.  PATH_RESPONSE Frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The PATH_RESPONSE frame (type=0x1b) is sent in response to a</td><td> </td><td class="right">   The PATH_RESPONSE frame (type=0x1b) is sent in response to a</td><td class="lineno"></td></tr>
      <tr id="diff0589"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   PATH_CHALLENGE frame.  Its <span class="delete">format</span> is identical to the PATH_CHALLENGE</td><td> </td><td class="rblock">   PATH_CHALLENGE frame.  Its <span class="insert">format, shown in Figure 41</span> is identical to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   frame (Section 19.17).</td><td> </td><td class="rblock">   the PATH_CHALLENGE frame (Section 19.17).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">PATH_RESPONSE Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x1b,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Data (64),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                   Figure 41: PATH_RESPONSE Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If the content of a PATH_RESPONSE frame does not match the content of</td><td> </td><td class="right">   If the content of a PATH_RESPONSE frame does not match the content of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a PATH_CHALLENGE frame previously sent by the endpoint, the endpoint</td><td> </td><td class="right">   a PATH_CHALLENGE frame previously sent by the endpoint, the endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   MAY generate a connection error of type PROTOCOL_VIOLATION.</td><td> </td><td class="right">   MAY generate a connection error of type PROTOCOL_VIOLATION.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">19.19.  CONNECTION_CLOSE Frames</td><td> </td><td class="right">19.19.  CONNECTION_CLOSE Frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint sends a CONNECTION_CLOSE frame (type=0x1c or 0x1d) to</td><td> </td><td class="right">   An endpoint sends a CONNECTION_CLOSE frame (type=0x1c or 0x1d) to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   notify its peer that the connection is being closed.  The</td><td> </td><td class="right">   notify its peer that the connection is being closed.  The</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   CONNECTION_CLOSE with a frame type of 0x1c is used to signal errors</td><td> </td><td class="right">   CONNECTION_CLOSE with a frame type of 0x1c is used to signal errors</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   at only the QUIC layer, or the absence of errors (with the NO_ERROR</td><td> </td><td class="right">   at only the QUIC layer, or the absence of errors (with the NO_ERROR</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   code).  The CONNECTION_CLOSE frame with a type of 0x1d is used to</td><td> </td><td class="right">   code).  The CONNECTION_CLOSE frame with a type of 0x1d is used to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   signal an error with the application that uses QUIC.</td><td> </td><td class="right">   signal an error with the application that uses QUIC.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If there are open streams that haven't been explicitly closed, they</td><td> </td><td class="right">   If there are open streams that haven't been explicitly closed, they</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   are implicitly closed when the connection is closed.</td><td> </td><td class="right">   are implicitly closed when the connection is closed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0590"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The CONNECTION_CLOSE frames are <span class="delete">as follows:</span></td><td> </td><td class="rblock">   The CONNECTION_CLOSE frames are <span class="insert">shown in Figure 42.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0591"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">    <span class="delete">0                   1                   2                   3</span></td><td> </td><td class="rblock">   <span class="insert">CONNECTION_CLOSE</span> Frame <span class="insert">{</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock">     Type (i) <span class="insert">= 0x1c..0x1d,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">     Error Code (i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |           Error Code (16)     |      [</span> Frame Type (i) <span class="delete">]     ...</span></td><td> </td><td class="rblock"><span class="insert">     [Frame Type (i)],</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock">     Reason Phrase Length <span class="insert">(i),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                    Reason Phrase Length <span class="delete">(i)                 ...</span></td><td> </td><td class="rblock">     Reason Phrase <span class="insert">(..),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |</span>                        Reason Phrase <span class="delete">(*)                    ...</span></td><td> </td><td class="rblock"><span class="insert">                  Figure 42: CONNECTION_CLOSE Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   CONNECTION_CLOSE frames contain the following fields:</td><td> </td><td class="right">   CONNECTION_CLOSE frames contain the following fields:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0592"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Error Code:  A <span class="delete">16-bit</span> error code which indicates the reason for</td><td> </td><td class="rblock">   Error Code:  A <span class="insert">variable length integer</span> error code which indicates the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      closing this connection.  A CONNECTION_CLOSE frame of type 0x1c</td><td> </td><td class="rblock">      reason for closing this connection.  A CONNECTION_CLOSE frame of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      uses codes from the space defined in Section 20.  A</td><td> </td><td class="rblock">      type 0x1c uses codes from the space defined in Section 20.  A</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      CONNECTION_CLOSE frame of type 0x1d uses codes from the</td><td> </td><td class="right">      CONNECTION_CLOSE frame of type 0x1d uses codes from the</td><td class="lineno"></td></tr>
      <tr id="diff0593"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      application protocol error code space<span class="delete">, see Section 20.1</span></td><td> </td><td class="rblock">      application protocol error code space<span class="insert">; see Section 20.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Frame Type:  A variable-length integer encoding the type of frame</td><td> </td><td class="right">   Frame Type:  A variable-length integer encoding the type of frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      that triggered the error.  A value of 0 (equivalent to the mention</td><td> </td><td class="right">      that triggered the error.  A value of 0 (equivalent to the mention</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of the PADDING frame) is used when the frame type is unknown.  The</td><td> </td><td class="right">      of the PADDING frame) is used when the frame type is unknown.  The</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      application-specific variant of CONNECTION_CLOSE (type 0x1d) does</td><td> </td><td class="right">      application-specific variant of CONNECTION_CLOSE (type 0x1d) does</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      not include this field.</td><td> </td><td class="right">      not include this field.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Reason Phrase Length:  A variable-length integer specifying the</td><td> </td><td class="right">   Reason Phrase Length:  A variable-length integer specifying the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      length of the reason phrase in bytes.  Because a CONNECTION_CLOSE</td><td> </td><td class="right">      length of the reason phrase in bytes.  Because a CONNECTION_CLOSE</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      frame cannot be split between packets, any limits on packet size</td><td> </td><td class="right">      frame cannot be split between packets, any limits on packet size</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      will also limit the space available for a reason phrase.</td><td> </td><td class="right">      will also limit the space available for a reason phrase.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Reason Phrase:  A human-readable explanation for why the connection</td><td> </td><td class="right">   Reason Phrase:  A human-readable explanation for why the connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      was closed.  This can be zero length if the sender chooses to not</td><td> </td><td class="right">      was closed.  This can be zero length if the sender chooses to not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      give details beyond the Error Code.  This SHOULD be a UTF-8</td><td> </td><td class="right">      give details beyond the Error Code.  This SHOULD be a UTF-8</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      encoded string [RFC3629].</td><td> </td><td class="right">      encoded string [RFC3629].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0594"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">19.20.  Extension Frames</td><td> </td><td class="rblock">   <span class="insert">The application-specific variant of CONNECTION_CLOSE (type 0x1d) can</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   only be sent using 0-RTT or 1-RTT packets; see Section 4 of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [QUIC-TLS].  When an application wishes to abandon a connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   during the handshake, an endpoint can send a CONNECTION_CLOSE frame</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (type 0x1c) with an error code of APPLICATION_ERROR in an Initial or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   a Handshake packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">19.20.  <span class="insert">HANDSHAKE_DONE frame</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The server uses the HANDSHAKE_DONE frame (type=0x1e) to signal</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   confirmation of the handshake to the client.  As shown in Figure 43,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   a HANDSHAKE_DONE frame has no content.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   HANDSHAKE_DONE Frame {</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Type (i) = 0x1e,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   }</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                   Figure 43: HANDSHAKE_DONE Frame Format</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A HANDSHAKE_DONE frame can only be sent by the server.  Servers MUST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   NOT send a HANDSHAKE_DONE frame before completing the handshake.  A</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server MUST treat receipt of a HANDSHAKE_DONE frame as a connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   error of type PROTOCOL_VIOLATION.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">19.21.</span>  Extension Frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   QUIC frames do not use a self-describing encoding.  An endpoint</td><td> </td><td class="right">   QUIC frames do not use a self-describing encoding.  An endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   therefore needs to understand the syntax of all frames before it can</td><td> </td><td class="right">   therefore needs to understand the syntax of all frames before it can</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   successfully process a packet.  This allows for efficient encoding of</td><td> </td><td class="right">   successfully process a packet.  This allows for efficient encoding of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frames, but it means that an endpoint cannot send a frame of a type</td><td> </td><td class="right">   frames, but it means that an endpoint cannot send a frame of a type</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that is unknown to its peer.</td><td> </td><td class="right">   that is unknown to its peer.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An extension to QUIC that wishes to use a new type of frame MUST</td><td> </td><td class="right">   An extension to QUIC that wishes to use a new type of frame MUST</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   first ensure that a peer is able to understand the frame.  An</td><td> </td><td class="right">   first ensure that a peer is able to understand the frame.  An</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint can use a transport parameter to signal its willingness to</td><td> </td><td class="right">   endpoint can use a transport parameter to signal its willingness to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   receive one or more extension frame types with the one transport</td><td> </td><td class="right">   receive one or more extension frame types with the one transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   parameter.</td><td> </td><td class="right">   parameter.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0595"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Extensions that modify or replace core protocol functionality</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (including frame types) will be difficult to combine with other</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   extensions which modify or replace the same functionality unless the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   behavior of the combination is explicitly defined.  Such extensions</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   SHOULD define their interaction with previously-defined extensions</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   modifying the same protocol components.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Extension frames MUST be congestion controlled and MUST cause an ACK</td><td> </td><td class="right">   Extension frames MUST be congestion controlled and MUST cause an ACK</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   frame to be sent.  The exception is extension frames that replace or</td><td> </td><td class="right">   frame to be sent.  The exception is extension frames that replace or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   supplement the ACK frame.  Extension frames are not included in flow</td><td> </td><td class="right">   supplement the ACK frame.  Extension frames are not included in flow</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   control unless specified in the extension.</td><td> </td><td class="right">   control unless specified in the extension.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0596"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   An IANA registry is used to manage the assignment of frame <span class="delete">types,</span> see</td><td> </td><td class="rblock">   An IANA registry is used to manage the assignment of frame <span class="insert">types;</span> see</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section <span class="delete">22.2.</span></td><td> </td><td class="rblock">   Section <span class="insert">22.3.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">20.  Transport Error Codes</td><td> </td><td class="right">20.  Transport Error Codes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0597"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   QUIC error codes are <span class="delete">16</span>-bit unsigned integers.</td><td> </td><td class="rblock">   QUIC error codes are <span class="insert">62</span>-bit unsigned integers.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This section lists the defined QUIC transport error codes that may be</td><td> </td><td class="right">   This section lists the defined QUIC transport error codes that may be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   used in a CONNECTION_CLOSE frame.  These errors apply to the entire</td><td> </td><td class="right">   used in a CONNECTION_CLOSE frame.  These errors apply to the entire</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection.</td><td> </td><td class="right">   connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   NO_ERROR (0x0):  An endpoint uses this with CONNECTION_CLOSE to</td><td> </td><td class="right">   NO_ERROR (0x0):  An endpoint uses this with CONNECTION_CLOSE to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      signal that the connection is being closed abruptly in the absence</td><td> </td><td class="right">      signal that the connection is being closed abruptly in the absence</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of any error.</td><td> </td><td class="right">      of any error.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   INTERNAL_ERROR (0x1):  The endpoint encountered an internal error and</td><td> </td><td class="right">   INTERNAL_ERROR (0x1):  The endpoint encountered an internal error and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      cannot continue with the connection.</td><td> </td><td class="right">      cannot continue with the connection.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0598"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">SERVER_BUSY</span> (0x2):  The server <span class="delete">is currently busy and does not</span> accept</td><td> </td><td class="rblock">   <span class="insert">CONNECTION_REFUSED</span> (0x2):  The server <span class="insert">refused to</span> accept <span class="insert">a</span> new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">any</span> new <span class="delete">connections.</span></td><td> </td><td class="rblock">      <span class="insert">connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   FLOW_CONTROL_ERROR (0x3):  An endpoint received more data than it</td><td> </td><td class="right">   FLOW_CONTROL_ERROR (0x3):  An endpoint received more data than it</td><td class="lineno"></td></tr>
      <tr id="diff0599"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      permitted in its advertised data limits<span class="delete"> (see Section 4)</span>.</td><td> </td><td class="rblock">      permitted in its advertised data limits<span class="insert">; see Section 4</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STREAM_LIMIT_ERROR (0x4):  An endpoint received a frame for a stream</td><td> </td><td class="right">   STREAM_LIMIT_ERROR (0x4):  An endpoint received a frame for a stream</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      identifier that exceeded its advertised stream limit for the</td><td> </td><td class="right">      identifier that exceeded its advertised stream limit for the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      corresponding stream type.</td><td> </td><td class="right">      corresponding stream type.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   STREAM_STATE_ERROR (0x5):  An endpoint received a frame for a stream</td><td> </td><td class="right">   STREAM_STATE_ERROR (0x5):  An endpoint received a frame for a stream</td><td class="lineno"></td></tr>
      <tr id="diff0600"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      that was not in a state that permitted that frame<span class="delete"> (see Section 3)</span>.</td><td> </td><td class="rblock">      that was not in a state that permitted that frame<span class="insert">; see Section 3</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   FINAL_SIZE_ERROR (0x6):  An endpoint received a STREAM frame</td><td> </td><td class="right">   FINAL_SIZE_ERROR (0x6):  An endpoint received a STREAM frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      containing data that exceeded the previously established final</td><td> </td><td class="right">      containing data that exceeded the previously established final</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      size.  Or an endpoint received a STREAM frame or a RESET_STREAM</td><td> </td><td class="right">      size.  Or an endpoint received a STREAM frame or a RESET_STREAM</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      frame containing a final size that was lower than the size of</td><td> </td><td class="right">      frame containing a final size that was lower than the size of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      stream data that was already received.  Or an endpoint received a</td><td> </td><td class="right">      stream data that was already received.  Or an endpoint received a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      STREAM frame or a RESET_STREAM frame containing a different final</td><td> </td><td class="right">      STREAM frame or a RESET_STREAM frame containing a different final</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      size to the one already established.</td><td> </td><td class="right">      size to the one already established.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   FRAME_ENCODING_ERROR (0x7):  An endpoint received a frame that was</td><td> </td><td class="right">   FRAME_ENCODING_ERROR (0x7):  An endpoint received a frame that was</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      badly formatted.  For instance, a frame of an unknown type, or an</td><td> </td><td class="right">      badly formatted.  For instance, a frame of an unknown type, or an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      ACK frame that has more acknowledgment ranges than the remainder</td><td> </td><td class="right">      ACK frame that has more acknowledgment ranges than the remainder</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of the packet could carry.</td><td> </td><td class="right">      of the packet could carry.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   TRANSPORT_PARAMETER_ERROR (0x8):  An endpoint received transport</td><td> </td><td class="right">   TRANSPORT_PARAMETER_ERROR (0x8):  An endpoint received transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      parameters that were badly formatted, included an invalid value,</td><td> </td><td class="right">      parameters that were badly formatted, included an invalid value,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      was absent even though it is mandatory, was present though it is</td><td> </td><td class="right">      was absent even though it is mandatory, was present though it is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      forbidden, or is otherwise in error.</td><td> </td><td class="right">      forbidden, or is otherwise in error.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0601"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">VERSION_NEGOTIATION_ERROR</span> (0x9):  <span class="delete">An endpoint received transport</span></td><td> </td><td class="rblock">   <span class="insert">CONNECTION_ID_LIMIT_ERROR</span> (0x9):  <span class="insert">The number of connection IDs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      parameters that contained version negotiation parameters that</span></td><td> </td><td class="rblock"><span class="insert">      provided by</span> the <span class="insert">peer exceeds the advertised</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      disagreed with</span> the <span class="delete">version negotiation that it performed.  This</span></td><td> </td><td class="rblock"><span class="insert">      active_connection_id_limit.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      error code indicates a potential version downgrade attack.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   PROTOCOL_VIOLATION (0xA):  An endpoint detected an error with</td><td> </td><td class="right">   PROTOCOL_VIOLATION (0xA):  An endpoint detected an error with</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      protocol compliance that was not covered by more specific error</td><td> </td><td class="right">      protocol compliance that was not covered by more specific error</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      codes.</td><td> </td><td class="right">      codes.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0602"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">INVALID_MIGRATION (0xC):</span>  A <span class="delete">peer has migrated to</span> a <span class="delete">different network</span></td><td> </td><td class="rblock">   <span class="insert">INVALID_TOKEN (0xB):</span>  A <span class="insert">server received a Retry Token in</span> a <span class="insert">client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      when</span> the endpoint <span class="delete">had disabled migration.</span></td><td> </td><td class="rblock"><span class="insert">      Initial that is invalid.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   APPLICATION_ERROR (0xC):  The application or application protocol</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      caused</span> the <span class="insert">connection to be closed.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   CRYPTO_BUFFER_EXCEEDED (0xD):  An</span> endpoint <span class="insert">has received more data in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      CRYPTO frames than it can buffer.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   CRYPTO_ERROR (0x1XX):  The cryptographic handshake failed.  A range</td><td> </td><td class="right">   CRYPTO_ERROR (0x1XX):  The cryptographic handshake failed.  A range</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of 256 values is reserved for carrying error codes specific to the</td><td> </td><td class="right">      of 256 values is reserved for carrying error codes specific to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      cryptographic handshake that is used.  Codes for errors occurring</td><td> </td><td class="right">      cryptographic handshake that is used.  Codes for errors occurring</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      when TLS is used for the crypto handshake are described in</td><td> </td><td class="right">      when TLS is used for the crypto handshake are described in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Section 4.8 of [QUIC-TLS].</td><td> </td><td class="right">      Section 4.8 of [QUIC-TLS].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0603"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   See Section <span class="delete">22.3</span> for details of registering new error codes.</td><td> </td><td class="rblock">   See Section <span class="insert">22.4</span> for details of registering new error <span class="insert">codes.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In defining these error codes, several principles are applied.  Error</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   conditions that might require specific action on the part of a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   recipient are given unique codes.  Errors that represent common</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   conditions are given specific codes.  Absent either of these</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   conditions, error codes are used to identify a general function of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the stack, like flow control or transport parameter handling.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Finally, generic errors are provided for conditions where</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   implementations are unable or unwilling to use more specific</span> codes.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">20.1.  Application Protocol Error Codes</td><td> </td><td class="right">20.1.  Application Protocol Error Codes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0604"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Application protocol error codes are <span class="delete">16-bit</span> unsigned integers, but</td><td> </td><td class="rblock">   Application protocol error codes are <span class="insert">62-bit</span> unsigned integers, but</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the management of application error codes <span class="delete">are</span> left to application</td><td> </td><td class="rblock">   the management of application error codes <span class="insert">is</span> left to application</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protocols.  Application protocol error codes are used for the</td><td> </td><td class="right">   protocols.  Application protocol error codes are used for the</td><td class="lineno"></td></tr>
      <tr id="diff0605"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   RESET_STREAM frame (Section <span class="delete">19.4)</span> and the CONNECTION_CLOSE frame with</td><td> </td><td class="rblock">   RESET_STREAM frame (Section <span class="insert">19.4), the STOP_SENDING frame</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a type of 0x1d (Section 19.19).</td><td> </td><td class="rblock"><span class="insert">   (Section 19.5),</span> and the CONNECTION_CLOSE frame with a type of 0x1d</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   (Section 19.19).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">21.  Security Considerations</td><td> </td><td class="right">21.  Security Considerations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">21.1.  Handshake Denial of Service</td><td> </td><td class="right">21.1.  Handshake Denial of Service</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   As an encrypted and authenticated transport QUIC provides a range of</td><td> </td><td class="right">   As an encrypted and authenticated transport QUIC provides a range of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protections against denial of service.  Once the cryptographic</td><td> </td><td class="right">   protections against denial of service.  Once the cryptographic</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   handshake is complete, QUIC endpoints discard most packets that are</td><td> </td><td class="right">   handshake is complete, QUIC endpoints discard most packets that are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   not authenticated, greatly limiting the ability of an attacker to</td><td> </td><td class="right">   not authenticated, greatly limiting the ability of an attacker to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   interfere with existing connections.</td><td> </td><td class="right">   interfere with existing connections.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Once a connection is established QUIC endpoints might accept some</td><td> </td><td class="right">   Once a connection is established QUIC endpoints might accept some</td><td class="lineno"></td></tr>
      <tr id="diff0606"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   unauthenticated ICMP packets (see Section <span class="delete">14.2),</span> but the use of these</td><td> </td><td class="rblock">   unauthenticated ICMP packets (see Section <span class="insert">14.2.1),</span> but the use of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets is extremely limited.  The only other type of packet that an</td><td> </td><td class="rblock">   these packets is extremely limited.  The only other type of packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   endpoint might accept is a stateless reset (Section 10.4) which</td><td> </td><td class="rblock">   that an endpoint might accept is a stateless reset (Section 10.4)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   relies on the token being kept secret until it is used.</td><td> </td><td class="rblock">   which relies on the token being kept secret until it is used.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   During the creation of a connection, QUIC only provides protection</td><td> </td><td class="right">   During the creation of a connection, QUIC only provides protection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   against attack from off the network path.  All QUIC packets contain</td><td> </td><td class="right">   against attack from off the network path.  All QUIC packets contain</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   proof that the recipient saw a preceding packet from its peer.</td><td> </td><td class="right">   proof that the recipient saw a preceding packet from its peer.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0607"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The first mechanism used is</span> the <span class="delete">source and destination connection</span></td><td> </td><td class="rblock">   <span class="insert">Addresses cannot change during</span> the <span class="insert">handshake, so endpoints can</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   IDs, which are required to match those set by a peer.  Except for an</span></td><td> </td><td class="rblock"><span class="insert">   discard</span> packets that <span class="insert">are received on</span> a <span class="insert">different network path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Initial and stateless reset packets, an endpoint only accepts</span> packets</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that <span class="delete">include a destination connection that matches</span> a <span class="delete">connection ID</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the endpoint previously chose.  This is the only protection offered</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   for Version Negotiation packets.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0608"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">destination connection</span> ID in an Initial packet is selected by a</td><td> </td><td class="rblock">   The <span class="insert">Source and Destination Connection</span> ID <span class="insert">fields are the primary means</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   client to be unpredictable, which serves an additional purpose.  The</td><td> </td><td class="rblock"><span class="insert">   of protection against off-path attack during the handshake.  These</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   packets that carry the cryptographic handshake are protected with a</td><td> </td><td class="rblock"><span class="insert">   are required to match those set by a peer.  Except for an Initial and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   key that is derived from this connection ID and salt specific to the</td><td> </td><td class="rblock"><span class="insert">   stateless reset packets, an endpoint only accepts packets that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   QUIC version.  This allows endpoints to use the same process for</td><td> </td><td class="rblock"><span class="insert">   include a Destination Connection ID field that matches a value the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   endpoint previously chose.  This is the only protection offered for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Version Negotiation packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The Destination Connection ID field</span> in an Initial packet is selected</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   by a client to be unpredictable, which serves an additional purpose.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   The packets that carry the cryptographic handshake are protected with</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   a key that is derived from this connection ID and salt specific to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   the QUIC version.  This allows endpoints to use the same process for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authenticating packets that they receive as they use after the</td><td> </td><td class="right">   authenticating packets that they receive as they use after the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   cryptographic handshake completes.  Packets that cannot be</td><td> </td><td class="right">   cryptographic handshake completes.  Packets that cannot be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authenticated are discarded.  Protecting packets in this fashion</td><td> </td><td class="right">   authenticated are discarded.  Protecting packets in this fashion</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provides a strong assurance that the sender of the packet saw the</td><td> </td><td class="right">   provides a strong assurance that the sender of the packet saw the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Initial packet and understood it.</td><td> </td><td class="right">   Initial packet and understood it.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   These protections are not intended to be effective against an</td><td> </td><td class="right">   These protections are not intended to be effective against an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   attacker that is able to receive QUIC packets prior to the connection</td><td> </td><td class="right">   attacker that is able to receive QUIC packets prior to the connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   being established.  Such an attacker can potentially send packets</td><td> </td><td class="right">   being established.  Such an attacker can potentially send packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that will be accepted by QUIC endpoints.  This version of QUIC</td><td> </td><td class="right">   that will be accepted by QUIC endpoints.  This version of QUIC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   attempts to detect this sort of attack, but it expects that endpoints</td><td> </td><td class="right">   attempts to detect this sort of attack, but it expects that endpoints</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   will fail to establish a connection rather than recovering.  For the</td><td> </td><td class="right">   will fail to establish a connection rather than recovering.  For the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   most part, the cryptographic handshake protocol [QUIC-TLS] is</td><td> </td><td class="right">   most part, the cryptographic handshake protocol [QUIC-TLS] is</td><td class="lineno"></td></tr>
      <tr id="diff0609"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   responsible for detecting tampering during the <span class="delete">handshake, though</span></td><td> </td><td class="rblock">   responsible for detecting tampering during the <span class="insert">handshake.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   additional validation is required for version negotiation (see</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Section 7.3.3).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Endpoints are permitted to use other methods to detect and attempt to</td><td> </td><td class="right">   Endpoints are permitted to use other methods to detect and attempt to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   recover from interference with the handshake.  Invalid packets may be</td><td> </td><td class="right">   recover from interference with the handshake.  Invalid packets may be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   identified and discarded using other methods, but no specific method</td><td> </td><td class="right">   identified and discarded using other methods, but no specific method</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   is mandated in this document.</td><td> </td><td class="right">   is mandated in this document.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">21.2.  Amplification Attack</td><td> </td><td class="right">21.2.  Amplification Attack</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An attacker might be able to receive an address validation token</td><td> </td><td class="right">   An attacker might be able to receive an address validation token</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 8) from a server and then release the IP address it used to</td><td> </td><td class="right">   (Section 8) from a server and then release the IP address it used to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   acquire that token.  At a later time, the attacker may initiate a</td><td> </td><td class="right">   acquire that token.  At a later time, the attacker may initiate a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0-RTT connection with a server by spoofing this same address, which</td><td> </td><td class="right">   0-RTT connection with a server by spoofing this same address, which</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   might now address a different (victim) endpoint.  The attacker can</td><td> </td><td class="right">   might now address a different (victim) endpoint.  The attacker can</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   thus potentially cause the server to send an initial congestion</td><td> </td><td class="right">   thus potentially cause the server to send an initial congestion</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   window's worth of data towards the victim.</td><td> </td><td class="right">   window's worth of data towards the victim.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Servers SHOULD provide mitigations for this attack by limiting the</td><td> </td><td class="right">   Servers SHOULD provide mitigations for this attack by limiting the</td><td class="lineno"></td></tr>
      <tr id="diff0610"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   usage and lifetime of address validation tokens<span class="delete"> (see Section 8.1.2)</span>.</td><td> </td><td class="rblock">   usage and lifetime of address validation tokens<span class="insert">; see Section 8.1.3</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">21.3.  Optimistic ACK Attack</td><td> </td><td class="right">21.3.  Optimistic ACK Attack</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An endpoint that acknowledges packets it has not received might cause</td><td> </td><td class="right">   An endpoint that acknowledges packets it has not received might cause</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   a congestion controller to permit sending at rates beyond what the</td><td> </td><td class="right">   a congestion controller to permit sending at rates beyond what the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   network supports.  An endpoint MAY skip packet numbers when sending</td><td> </td><td class="right">   network supports.  An endpoint MAY skip packet numbers when sending</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packets to detect this behavior.  An endpoint can then immediately</td><td> </td><td class="right">   packets to detect this behavior.  An endpoint can then immediately</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   close the connection with a connection error of type</td><td> </td><td class="right">   close the connection with a connection error of type</td><td class="lineno"></td></tr>
      <tr id="diff0611"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   PROTOCOL_VIOLATION<span class="delete"> (see Section 10.3)</span>.</td><td> </td><td class="rblock">   PROTOCOL_VIOLATION<span class="insert">; see Section 10.3</span>.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">21.4.  Slowloris Attacks</td><td> </td><td class="right">21.4.  Slowloris Attacks</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The attacks commonly known as Slowloris [SLOWLORIS] try to keep many</td><td> </td><td class="right">   The attacks commonly known as Slowloris [SLOWLORIS] try to keep many</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connections to the target endpoint open and hold them open as long as</td><td> </td><td class="right">   connections to the target endpoint open and hold them open as long as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   possible.  These attacks can be executed against a QUIC endpoint by</td><td> </td><td class="right">   possible.  These attacks can be executed against a QUIC endpoint by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   generating the minimum amount of activity necessary to avoid being</td><td> </td><td class="right">   generating the minimum amount of activity necessary to avoid being</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   closed for inactivity.  This might involve sending small amounts of</td><td> </td><td class="right">   closed for inactivity.  This might involve sending small amounts of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   data, gradually opening flow control windows in order to control the</td><td> </td><td class="right">   data, gradually opening flow control windows in order to control the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   sender rate, or manufacturing ACK frames that simulate a high loss</td><td> </td><td class="right">   sender rate, or manufacturing ACK frames that simulate a high loss</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-26" class="change"><td></td><th><small>skipping to change at</small><a href="#part-26"><em> page 118, line 37<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-26"><em> page 145, line 20<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">21.6.  Stream Commitment Attack</td><td> </td><td class="right">21.6.  Stream Commitment Attack</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An adversarial endpoint can open lots of streams, exhausting state on</td><td> </td><td class="right">   An adversarial endpoint can open lots of streams, exhausting state on</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   an endpoint.  The adversarial endpoint could repeat the process on a</td><td> </td><td class="right">   an endpoint.  The adversarial endpoint could repeat the process on a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   large number of connections, in a manner similar to SYN flooding</td><td> </td><td class="right">   large number of connections, in a manner similar to SYN flooding</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   attacks in TCP.</td><td> </td><td class="right">   attacks in TCP.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Normally, clients will open streams sequentially, as explained in</td><td> </td><td class="right">   Normally, clients will open streams sequentially, as explained in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Section 2.1.  However, when several streams are initiated at short</td><td> </td><td class="right">   Section 2.1.  However, when several streams are initiated at short</td><td class="lineno"></td></tr>
      <tr id="diff0612"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   intervals, <span class="delete">transmission error</span> may cause STREAM <span class="delete">DATA</span> frames <span class="delete">opening</span></td><td> </td><td class="rblock">   intervals, <span class="insert">loss or reordering</span> may cause STREAM frames <span class="insert">that open</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   streams to be received out of sequence.  <span class="delete">A</span> receiver is <span class="delete">obligated</span> to</td><td> </td><td class="rblock">   streams to be received out of sequence.  <span class="insert">On receiving a higher-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   open intervening streams <span class="delete">if a higher-numbered stream ID is received.</span></td><td> </td><td class="rblock"><span class="insert">   numbered stream ID, a</span> receiver is <span class="insert">required</span> to open <span class="insert">all</span> intervening</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Thus, on a new connection, opening stream <span class="delete">2000001</span> opens 1 million</td><td> </td><td class="rblock">   streams <span class="insert">of the same type; see Section 3.2.</span>  Thus, on a new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">streams, as required by the specification.</span></td><td> </td><td class="rblock">   connection, opening stream <span class="insert">4000000</span> opens 1 million <span class="insert">and 1 client-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   initiated bidirectional streams.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0613"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The number of active streams is limited by the <span class="delete">concurrent stream</span></td><td> </td><td class="rblock">   The number of active streams is limited by the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   limit</span> transport <span class="delete">parameter,</span> as explained in Section 4.5.  If chosen</td><td> </td><td class="rblock">   <span class="insert">initial_max_streams_bidi and initial_max_streams_uni</span> transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   judiciously, <span class="delete">this limit mitigates</span> the effect of the stream commitment</td><td> </td><td class="rblock">   <span class="insert">parameters,</span> as explained in Section 4.5.  If chosen judiciously,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   attack.  However, setting the limit too low could affect performance</td><td> </td><td class="rblock">   <span class="insert">these limits mitigate</span> the effect of the stream commitment attack.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   when applications expect to open large number of streams.</td><td> </td><td class="rblock">   However, setting the limit too low could affect performance when</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   applications expect to open large number of streams.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0614"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">21.7.  Explicit Congestion Notification Attacks</td><td> </td><td class="rblock">21.7.  <span class="insert">Peer Denial of Service</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   QUIC and TLS both contain frames or messages that have legitimate</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   uses in some contexts, but that can be abused to cause a peer to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   expend processing resources without having any observable impact on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the state of the connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Messages can also be used to change and revert state in small or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   inconsequential ways, such as by sending small increments to flow</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   control limits.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If processing costs are disproportionately large in comparison to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   bandwidth consumption or effect on state, then this could allow a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   malicious peer to exhaust processing capacity.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   While there are legitimate uses for all messages, implementations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   SHOULD track cost of processing relative to progress and treat</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   excessive quantities of any non-productive packets as indicative of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   an attack.  Endpoints MAY respond to this condition with a connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   error, or by dropping packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.8.</span>  Explicit Congestion Notification Attacks</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An on-path attacker could manipulate the value of ECN codepoints in</td><td> </td><td class="right">   An on-path attacker could manipulate the value of ECN codepoints in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the IP header to influence the sender's rate.  [RFC3168] discusses</td><td> </td><td class="right">   the IP header to influence the sender's rate.  [RFC3168] discusses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   manipulations and their effects in more detail.</td><td> </td><td class="right">   manipulations and their effects in more detail.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   An on-the-side attacker can duplicate and send packets with modified</td><td> </td><td class="right">   An on-the-side attacker can duplicate and send packets with modified</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ECN codepoints to affect the sender's rate.  If duplicate packets are</td><td> </td><td class="right">   ECN codepoints to affect the sender's rate.  If duplicate packets are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   discarded by a receiver, an off-path attacker will need to race the</td><td> </td><td class="right">   discarded by a receiver, an off-path attacker will need to race the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   duplicate packet against the original to be successful in this</td><td> </td><td class="right">   duplicate packet against the original to be successful in this</td><td class="lineno"></td></tr>
      <tr id="diff0615"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   attack.  Therefore, QUIC <span class="delete">receivers</span> ignore ECN <span class="delete">codepoints set</span> in</td><td> </td><td class="rblock">   attack.  Therefore, QUIC <span class="insert">endpoints</span> ignore <span class="insert">the</span> ECN <span class="insert">codepoint field on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">duplicate packets (see</span> Section <span class="delete">13.3).</span></td><td> </td><td class="rblock"><span class="insert">   an IP packet unless at least one QUIC packet</span> in <span class="insert">that IP packet is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   successfully processed; see</span> Section <span class="insert">13.4.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0616"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">21.<span class="delete">8</span>.  Stateless Reset Oracle</td><td> </td><td class="rblock">21.<span class="insert">9</span>.  Stateless Reset Oracle</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Stateless resets create a possible denial of service attack analogous</td><td> </td><td class="right">   Stateless resets create a possible denial of service attack analogous</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to a TCP reset injection.  This attack is possible if an attacker is</td><td> </td><td class="right">   to a TCP reset injection.  This attack is possible if an attacker is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   able to cause a stateless reset token to be generated for a</td><td> </td><td class="right">   able to cause a stateless reset token to be generated for a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection with a selected connection ID.  An attacker that can cause</td><td> </td><td class="right">   connection with a selected connection ID.  An attacker that can cause</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   this token to be generated can reset an active connection with the</td><td> </td><td class="right">   this token to be generated can reset an active connection with the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   same connection ID.</td><td> </td><td class="right">   same connection ID.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If a packet can be routed to different instances that share a static</td><td> </td><td class="right">   If a packet can be routed to different instances that share a static</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   key, for example by changing an IP address or port, then an attacker</td><td> </td><td class="right">   key, for example by changing an IP address or port, then an attacker</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-27" class="change"><td></td><th><small>skipping to change at</small><a href="#part-27"><em> page 119, line 45<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-27"><em> page 147, line 5<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   In the case of a cluster that uses dynamic load balancing, it's</td><td> </td><td class="right">   In the case of a cluster that uses dynamic load balancing, it's</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   possible that a change in load balancer configuration could happen</td><td> </td><td class="right">   possible that a change in load balancer configuration could happen</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   while an active instance retains connection state; even if an</td><td> </td><td class="right">   while an active instance retains connection state; even if an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   instance retains connection state, the change in routing and</td><td> </td><td class="right">   instance retains connection state, the change in routing and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   resulting stateless reset will result in the connection being</td><td> </td><td class="right">   resulting stateless reset will result in the connection being</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   terminated.  If there is no chance in the packet being routed to the</td><td> </td><td class="right">   terminated.  If there is no chance in the packet being routed to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   correct instance, it is better to send a stateless reset than wait</td><td> </td><td class="right">   correct instance, it is better to send a stateless reset than wait</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   for connections to time out.  However, this is acceptable only if the</td><td> </td><td class="right">   for connections to time out.  However, this is acceptable only if the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   routing cannot be influenced by an attacker.</td><td> </td><td class="right">   routing cannot be influenced by an attacker.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0617"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.10.  Version Downgrade</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This document defines QUIC Version Negotiation packets in Section 6,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   which can be used to negotiate the QUIC version used between two</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   endpoints.  However, this document does not specify how this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   negotiation will be performed between this version and subsequent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   future versions.  In particular, Version Negotiation packets do not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   contain any mechanism to prevent version downgrade attacks.  Future</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   versions of QUIC that use Version Negotiation packets MUST define a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   mechanism that is robust against version downgrade attacks.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.11.  Targeted Attacks by Routing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Deployments should limit the ability of an attacker to target a new</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection to a particular server instance.  This means that client-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   controlled fields, such as the initial Destination Connection ID used</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   on Initial and 0-RTT packets SHOULD NOT be used by themselves to make</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   routing decisions.  Ideally, routing decisions are made independently</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of client-selected values; a Source Connection ID can be selected to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   route later packets to the same server.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.  Overview of Security Properties</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A complete security analysis of QUIC is outside the scope of this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   document.  This section provides an informal description of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   desired security properties as an aid to implementors and to help</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   guide protocol analysis.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   QUIC assumes the threat model described in [SEC-CONS] and provides</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   protections against many of the attacks that arise from that model.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   For this purpose, attacks are divided into passive and active</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attacks.  Passive attackers have the capability to read packets from</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the network, while active attackers also have the capability to write</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets into the network.  However, a passive attack may involve an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attacker with the ability to cause a routing change or other</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   modification in the path taken by packets that comprise a connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Attackers are additionally categorized as either on-path attackers or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   off-path attackers; see Section 3.5 of [SEC-CONS].  An on-path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attacker can read, modify, or remove any packet it observes such that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   it no longer reaches its destination, while an off-path attacker</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   observes the packets, but cannot prevent the original packet from</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   reaching its intended destination.  An off-path attacker can also</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transmit arbitrary packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Properties of the handshake, protected packets, and connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   migration are considered separately.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.1.  Handshake</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The QUIC handshake incorporates the TLS 1.3 handshake and inherits</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the cryptographic properties described in Appendix E.1 of [TLS13].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Many of the security properties of QUIC depend on the TLS handshake</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   providing these properties.  Any attack on the TLS handshake could</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   affect QUIC.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Any attack on the TLS handshake that compromises the secrecy or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   uniqueness of session keys affects other security guarantees provided</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   by QUIC that depends on these keys.  For instance, migration</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (Section 9) depends on the efficacy of confidentiality protections,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   both for the negotiation of keys using the TLS handshake and for QUIC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet protection, to avoid linkability across network paths.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An attack on the integrity of the TLS handshake might allow an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attacker to affect the selection of application protocol or QUIC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   version.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In addition to the properties provided by TLS, the QUIC handshake</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provides some defense against DoS attacks on the handshake.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.1.1.  Anti-Amplification</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Address validation (Section 8) is used to verify that an entity that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   claims a given address is able to receive packets at that address.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Address validation limits amplification attack targets to addresses</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   for which an attacker is either on-path or off-path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Prior to validation, endpoints are limited in what they are able to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   send.  During the handshake, a server cannot send more than three</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   times the data it receives; clients that initiate new connections or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   migrate to a new network path are limited.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.1.2.  Server-Side DoS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Computing the server's first flight for a full handshake is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   potentially expensive, requiring both a signature and a key exchange</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   computation.  In order to prevent computational DoS attacks, the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Retry packet provides a cheap token exchange mechanism which allows</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   servers to validate a client's IP address prior to doing any</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   expensive computations at the cost of a single round trip.  After a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   successful handshake, servers can issue new tokens to a client which</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   will allow new connection establishment without incurring this cost.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.1.3.  On-Path Handshake Termination</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An on-path or off-path attacker can force a handshake to fail by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   replacing or racing Initial packets.  Once valid Initial packets have</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   been exchanged, subsequent Handshake packets are protected with the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   handshake keys and an on-path attacker cannot force handshake failure</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   other than by dropping packets to cause endpoints to abandon the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attempt.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An on-path attacker can also replace the addresses of packets on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   either side and therefore cause the client or server to have an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   incorrect view of the remote addresses.  Such an attack is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   indistinguishable from the functions performed by a NAT.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.1.4.  Parameter Negotiation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The entire handshake is cryptographically protected, with the Initial</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets being encrypted with per-version keys and the Handshake and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   later packets being encrypted with keys derived from the TLS key</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   exchange.  Further, parameter negotiation is folded into the TLS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transcript and thus provides the same integrity guarantees as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ordinary TLS negotiation.  An attacker can observe the client's</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transport parameters (as long as it knows the version-specific keys)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   but cannot observe the server's transport parameters and cannot</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   influence parameter negotiation.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Connection IDs are unencrypted but integrity protected in all</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This version of QUIC does not incorporate a version negotiation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   mechanism; implementations of incompatible versions will simply fail</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to establish a connection.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.2.  Protected Packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Packet protection (Section 12.1) provides authentication and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   encryption of all packets except Version Negotiation packets, though</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Initial and Retry packets have limited encryption and authentication</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   based on version-specific keys; see [QUIC-TLS] for more details.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This section considers passive and active attacks against protected</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Both on-path and off-path attackers can mount a passive attack in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   which they save observed packets for an offline attack against packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   protection at a future time; this is true for any observer of any</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet on any network.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A blind attacker, one who injects packets without being able to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   observe valid packets for a connection, is unlikely to be successful,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   since packet protection ensures that valid packets are only generated</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   by endpoints which possess the key material established during the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   handshake; see Section 7 and Section 21.12.1.  Similarly, any active</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attacker that observes packets and attempts to insert new data or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   modify existing data in those packets should not be able to generate</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets deemed valid by the receiving endpoint.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A spoofing attack, in which an active attacker rewrites unprotected</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   parts of a packet that it forwards or injects, such as the source or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   destination address, is only effective if the attacker can forward</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets to the original endpoint.  Packet protection ensures that the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet payloads can only be processed by the endpoints that completed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the handshake, and invalid packets are ignored by those endpoints.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An attacker can also modify the boundaries between packets and UDP</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   datagrams, causing multiple packets to be coalesced into a single</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   datagram, or splitting coalesced packets into multiple datagrams.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Aside from datagrams containing Initial packets, which require</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   padding, modification of how packets are arranged in datagrams has no</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   functional effect on a connection, although it might change some</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   performance characteristics.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.3.  Connection Migration</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Connection Migration (Section 9) provides endpoints with the ability</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to transition between IP addresses and ports on multiple paths, using</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   one path at a time for transmission and receipt of non-probing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   frames.  Path validation (Section 8.2) establishes that a peer is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   both willing and able to receive packets sent on a particular path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This helps reduce the effects of address spoofing by limiting the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   number of packets sent to a spoofed address.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This section describes the intended security properties of connection</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   migration when under various types of DoS attacks.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.3.1.  On-Path Active Attacks</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An attacker that can cause a packet it observes to no longer reach</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   its intended destination is considered an on-path attacker.  When an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attacker is present between a client and server, endpoints are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   required to send packets through the attacker to establish</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connectivity on a given path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An on-path attacker can:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Inspect packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Modify IP and UDP packet headers</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Inject new packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Delay packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Reorder packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Drop packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Split and merge datagrams along packet boundaries</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An on-path attacker cannot:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Modify an authenticated portion of a packet and cause the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      recipient to accept that packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An on-path attacker has the opportunity to modify the packets that it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   observes, however any modifications to an authenticated portion of a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packet will cause it to be dropped by the receiving endpoint as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   invalid, as packet payloads are both authenticated and encrypted.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In the presence of an on-path attacker, QUIC aims to provide the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   following properties:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1.  An on-path attacker can prevent use of a path for a connection,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       causing it to fail if it cannot use a different path that does</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       not contain the attacker.  This can be achieved by dropping all</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       packets, modifying them so that they fail to decrypt, or other</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       methods.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   2.  An on-path attacker can prevent migration to a new path for which</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       the attacker is also on-path by causing path validation to fail</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       on the new path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   3.  An on-path attacker cannot prevent a client from migrating to a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       path for which the attacker is not on-path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   4.  An on-path attacker can reduce the throughput of a connection by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       delaying packets or dropping them.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   5.  An on-path attacker cannot cause an endpoint to accept a packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       for which it has modified an authenticated portion of that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       packet.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.3.2.  Off-Path Active Attacks</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An off-path attacker is not directly on the path between a client and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server, but could be able to obtain copies of some or all packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   sent between the client and the server.  It is also able to send</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   copies of those packets to either endpoint.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An off-path attacker can:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Inspect packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Inject new packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Reorder injected packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An off-path attacker cannot:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Modify any part of a packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Delay packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Drop packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Reorder original packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An off-path attacker can modify packets that it has observed and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   inject them back into the network, potentially with spoofed source</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   and destination addresses.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   For the purposes of this discussion, it is assumed that an off-path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attacker has the ability to observe, modify, and re-inject a packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   into the network that will reach the destination endpoint prior to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the arrival of the original packet observed by the attacker.  In</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   other words, an attacker has the ability to consistently "win" a race</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   with the legitimate packets between the endpoints, potentially</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   causing the original packet to be ignored by the recipient.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   It is also assumed that an attacker has the resources necessary to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   affect NAT state, potentially both causing an endpoint to lose its</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   NAT binding, and an attacker to obtain the same port for use with its</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   traffic.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In the presence of an off-path attacker, QUIC aims to provide the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   following properties:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1.  An off-path attacker can race packets and attempt to become a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       "limited" on-path attacker.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   2.  An off-path attacker can cause path validation to succeed for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       forwarded packets with the source address listed as the off-path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       attacker as long as it can provide improved connectivity between</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       the client and the server.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   3.  An off-path attacker cannot cause a connection to close once the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       handshake has completed.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   4.  An off-path attacker cannot cause migration to a new path to fail</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       if it cannot observe the new path.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   5.  An off-path attacker can become a limited on-path attacker during</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       migration to a new path for which it is also an off-path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       attacker.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   6.  An off-path attacker can become a limited on-path attacker by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       affecting shared NAT state such that it sends packets to the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       server from the same IP address and port that the client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       originally used.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">21.12.3.3.  Limited On-Path Active Attacks</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A limited on-path attacker is an off-path attacker that has offered</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   improved routing of packets by duplicating and forwarding original</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets between the server and the client, causing those packets to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   arrive before the original copies such that the original packets are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   dropped by the destination endpoint.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A limited on-path attacker differs from an on-path attacker in that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   it is not on the original path between endpoints, and therefore the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   original packets sent by an endpoint are still reaching their</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   destination.  This means that a future failure to route copied</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   packets to the destination faster than their original path will not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   prevent the original packets from reaching the destination.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A limited on-path attacker can:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Inspect packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Inject new packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Modify unencrypted packet headers</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Reorder packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A limited on-path attacker cannot:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Delay packets so that they arrive later than packets sent on the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      original path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Drop packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Modify the authenticated and encrypted portion of a packet and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      cause the recipient to accept that packet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A limited on-path attacker can only delay packets up to the point</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that the original packets arrive before the duplicate packets,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   meaning that it cannot offer routing with worse latency than the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   original path.  If a limited on-path attacker drops packets, the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   original copy will still arrive at the destination endpoint.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In the presence of a limited on-path attacker, QUIC aims to provide</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the following properties:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1.  A limited on-path attacker cannot cause a connection to close</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       once the handshake has completed.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   2.  A limited on-path attacker cannot cause an idle connection to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       close if the client is first to resume activity.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   3.  A limited on-path attacker can cause an idle connection to be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       deemed lost if the server is the first to resume activity.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Note that these guarantees are the same guarantees provided for any</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   NAT, for the same reasons.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">22.  IANA Considerations</td><td> </td><td class="right">22.  IANA Considerations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0618"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">22.1.  <span class="delete">QUIC Transport Parameter Registry</span></td><td> </td><td class="rblock">   <span class="insert">This document establishes several registries for the management of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   codepoints in QUIC.  These registries operate on a common set of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   policies as defined in Section</span> 22.1.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0619"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">IANA [SHALL add/has added] a registry</span> for <span class="delete">"QUIC Transport Parameters"</span></td><td> </td><td class="rblock"><span class="insert">22.1.  Registration Policies</span> for <span class="insert">QUIC Registries</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   under a "QUIC Protocol" heading.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0620"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The "QUIC Transport Parameters" registry governs a 16-bit space.</span></td><td> </td><td class="rblock">   <span class="insert">All QUIC registries allow for both provisional and permanent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This <span class="delete">space is split into two spaces</span> that are <span class="delete">governed by different</span></td><td> </td><td class="rblock"><span class="insert">   registration of codepoints.</span>  This <span class="insert">section documents policies</span> that are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   policies.  Values with the first byte in the range 0x00</span> to <span class="delete">0xfe (in</span></td><td> </td><td class="rblock">   <span class="insert">common</span> to <span class="insert">these registries.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   hexadecimal) are assigned via the Specification Required policy</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC8126].  Values with the first byte 0xff are reserved for Private</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Use [RFC8126].</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0621"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Registrations MUST include the following fields:</span></td><td> </td><td class="rblock"><span class="insert">22.1.1.  Provisional Registrations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0622"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Value:  The numeric value</span> of the <span class="delete">assignment (registrations will</span> be</td><td> </td><td class="rblock">   <span class="insert">Provisional registration of codepoints are intended to allow for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">between 0x0000</span> and <span class="delete">0xfeff).</span></td><td> </td><td class="rblock"><span class="insert">   private use and experimentation with extensions to QUIC.  Provisional</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   registrations only require the inclusion</span> of the <span class="insert">codepoint value and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   contact information.  However, provisional registrations could</span> be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">reclaimed</span> and <span class="insert">reassigned for another purpose.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0623"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Parameter Name:  A short mnemonic</span> for the <span class="delete">parameter.</span></td><td> </td><td class="rblock">   <span class="insert">Provisional registrations require Expert Review, as defined in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 4.5 of [RFC8126].  Designated expert(s) are advised that only</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   registrations</span> for <span class="insert">an excessive proportion of remaining codepoint</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   space or the very first unassigned value (see Section 22.1.2) can be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   rejected.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Provisional registrations will include a date field that indicates</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   when the registration was last updated.  A request to update the date</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   on any provisional registration can be made without review from the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   designated expert(s).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   All QUIC registries include</span> the <span class="insert">following fields to support</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provisional registration:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Value:  The assigned codepoint.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Status:  "Permanent" or "Provisional".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Specification:  A reference to a publicly available specification for</td><td> </td><td class="right">   Specification:  A reference to a publicly available specification for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the value.</td><td> </td><td class="right">      the value.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0624"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">nominated</span> expert(s) verify that a specification exists and is</td><td> </td><td class="rblock">   <span class="insert">Date:</span>  The <span class="insert">date of last update to the registration.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Contact:  Contact details for the registrant.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Notes:  Supplementary notes about the registration.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Provisional registrations MAY omit the Specification and Notes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   fields, plus any additional fields that might be required for a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   permanent registration.  The Date field is not required as part of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   requesting a registration as it is set to the date the registration</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   is created or updated.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">22.1.2.  Selecting Codepoints</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   New uses of codepoints from QUIC registries SHOULD use a randomly</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   selected codepoint that excludes both existing allocations and the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   first unallocated codepoint in the selected space.  Requests for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   multiple codepoints MAY use a contiguous range.  This minimizes the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   risk that differing semantics are attributed to the same codepoint by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   different implementations.  Use of the first codepoint in a range is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   intended for use by specifications that are developed through the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   standards process [STD] and its allocation MUST be negotiated with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   IANA before use.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   For codepoints that are encoded in variable-length integers</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (Section 16), such as frame types, codepoints that encode to four or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   eight bytes (that is, values 2^14 and above) SHOULD be used unless</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the usage is especially sensitive to having a longer encoding.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Applications to register codepoints in QUIC registries MAY include a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   codepoint as part of the registration.  IANA MUST allocate the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   selected codepoint unless that codepoint is already assigned or the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   codepoint is the first unallocated codepoint in the registry.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">22.1.3.  Reclaiming Provisional Codepoints</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A request might be made to remove an unused provisional registration</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   from the registry to reclaim space in a registry, or portion of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   registry (such as the 64-16383 range for codepoints that use</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   variable-length encodings).  This SHOULD be done only for the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   codepoints with the earliest recorded date and entries that have been</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   updated less than a year prior SHOULD NOT be reclaimed.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A request to remove a codepoint MUST be reviewed by the designated</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   expert(s).  The expert(s) MUST attempt to determine whether the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   codepoint is still in use.  Experts are advised to contact the listed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   contacts for the registration, plus as wide a set of protocol</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   implementers as possible in order to determine whether any use of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   codepoint is known.  The expert(s) are advised to allow at least four</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   weeks for responses.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If any use of the codepoints is identified by this search or a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   request to update the registration is made, the codepoint MUST NOT be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   reclaimed.  Instead, the date on the registration is updated.  A note</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   might be added for the registration recording relevant information</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that was learned.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If no use of the codepoint was identified and no request was made to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   update the registration, the codepoint MAY be removed from the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   registry.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This process also applies to requests to change a provisional</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   registration into a permanent registration, except that the goal is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   not to determine whether there is no use of the codepoint, but to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   determine that the registration is an accurate representation of any</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   deployed usage.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">22.1.4.  Permanent Registrations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Permanent registrations in QUIC registries use the Specification</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Required policy [RFC8126], unless otherwise specified.  The</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   designated</span> expert(s) verify that a specification exists and is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   readily accessible.  Expert(s) are encouraged to be biased towards</td><td> </td><td class="right">   readily accessible.  Expert(s) are encouraged to be biased towards</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   approving registrations unless they are abusive, frivolous, or</td><td> </td><td class="right">   approving registrations unless they are abusive, frivolous, or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   actively harmful (not merely aesthetically displeasing, or</td><td> </td><td class="right">   actively harmful (not merely aesthetically displeasing, or</td><td class="lineno"></td></tr>
      <tr id="diff0625"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   architecturally dubious).</td><td> </td><td class="rblock">   architecturally dubious).  <span class="insert">The creation of a registry MAY specify</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   additional constraints on permanent registrations.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The creation of a registries MAY identify a range of codepoints where</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   registrations are governed by a different registration policy.  For</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   instance, the registries for 62-bit codepoints in this document have</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   stricter policies for codepoints in the range from 0 to 63.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Any stricter requirements for permanent registrations do not prevent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provisional registrations for affected codepoints.  For instance, a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provisional registration for a frame type Section 22.3 of 61 could be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   requested.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   All registrations made by Standards Track publications MUST be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   permanent.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   All registrations in this document are assigned a permanent status</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   and list as contact both the IESG (ietf@ietf.org) and the QUIC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   working group (quic@ietf.org (mailto:quic@ietf.org)).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">22.2.  QUIC Transport Parameter Registry</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   IANA [SHALL add/has added] a registry for "QUIC Transport Parameters"</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   under a "QUIC" heading.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The "QUIC Transport Parameters" registry governs a 62-bit space.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This registry follows the registration policy from Section 22.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Permanent registrations in this registry are assigned using the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Specification Required policy [RFC8126].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In addition to the fields in Section 22.1.1, permanent registrations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in this registry MUST include the following fields:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Parameter Name:  A short mnemonic for the parameter.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The initial contents of this registry are shown in Table 6.</td><td> </td><td class="right">   The initial contents of this registry are shown in Table 6.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0626"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     <span class="delete">+--------+-------------------------------------+---------------+</span></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     | Value  | Parameter Name                      | Specification |</td><td> </td><td class="rblock">      | Value | Parameter Name                      | Specification |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     <span class="delete">+--------+-------------------------------------+---------------+</span></td><td> </td><td class="rblock">      <span class="insert">+=======+=====================================+===============+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     | <span class="delete">0x0000</span> | <span class="delete">original_connection_id</span>              | Section <span class="delete">18.1</span>  |</td><td> </td><td class="rblock">      | <span class="insert">0x00</span>  | <span class="insert">original_destination_connection_id</span>  | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     |        |                                     <span class="delete">|               |</span></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     | 0x0001 | idle_timeout</span>                        | Section <span class="delete">18.1  |</span></td><td> </td><td class="rblock">      | <span class="insert">0x01</span>  | <span class="insert">max_idle_timeout</span>                    | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     |</span>        |                                     |               <span class="delete">|</span></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     | 0x0002</span> | stateless_reset_token               | Section <span class="delete">18.1  |</span></td><td> </td><td class="rblock">      | <span class="insert">0x02</span>  | stateless_reset_token               | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     |        |                                     |</span>               |</td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     | <span class="delete">0x0003</span> | <span class="delete">max_packet_size</span>                     | Section <span class="delete">18.1</span>  |</td><td> </td><td class="rblock">      | <span class="insert">0x03</span>  | <span class="insert">max_udp_payload_size</span>                | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     |        <span class="delete">|                                     |               |</span></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     | 0x0004</span> | initial_max_data                    | Section <span class="delete">18.1  |</span></td><td> </td><td class="rblock">      | <span class="insert">0x04</span>  | initial_max_data                    | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     |</span>        |                                     |               <span class="delete">|</span></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     | 0x0005</span> | initial_max_stream_data_bidi_local  | Section <span class="delete">18.1  |</span></td><td> </td><td class="rblock">      | <span class="insert">0x05</span>  | initial_max_stream_data_bidi_local  | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     |        |                                     |</span>               |</td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     | <span class="delete">0x0006</span> | initial_max_stream_data_bidi_remote | Section <span class="delete">18.1</span>  |</td><td> </td><td class="rblock">      | <span class="insert">0x06</span>  | initial_max_stream_data_bidi_remote | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     |        <span class="delete">|                                     |               |</span></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     | 0x0007</span> | initial_max_stream_data_uni         | Section <span class="delete">18.1  |</span></td><td> </td><td class="rblock">      | <span class="insert">0x07</span>  | initial_max_stream_data_uni         | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     |</span>        |                                     |               <span class="delete">|</span></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     | 0x0008</span> | initial_max_streams_bidi            | Section <span class="delete">18.1  |</span></td><td> </td><td class="rblock">      | <span class="insert">0x08</span>  | initial_max_streams_bidi            | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     |        |                                     |</span>               |</td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     | <span class="delete">0x0009</span> | initial_max_streams_uni             | Section <span class="delete">18.1</span>  |</td><td> </td><td class="rblock">      | <span class="insert">0x09</span>  | initial_max_streams_uni             | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     |        <span class="delete">|                                     |               |</span></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     | 0x000a</span> | ack_delay_exponent                  | Section <span class="delete">18.1</span>  |</td><td> </td><td class="rblock">      | <span class="insert">0x0a</span>  | ack_delay_exponent                  | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     |        |                                     |               |</td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     | <span class="delete">0x000b</span> | <span class="delete">max_ack_delay</span>                       | Section <span class="delete">18.1</span>  |</td><td> </td><td class="rblock">      | <span class="insert">0x0b</span>  | <span class="insert">max_ack_delay</span>                       | <span class="insert">Section 18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     |        |                                     |               |</td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     | <span class="delete">0x000c</span> | <span class="delete">disable_migration</span>                   | Section <span class="delete">18.1</span>  |</td><td> </td><td class="rblock">      | <span class="insert">0x0c</span>  | <span class="insert">disable_active_migration</span>            | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     |        |                                     |               |</td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     | <span class="delete">0x000d</span> | <span class="delete">preferred_address</span>                   | Section <span class="delete">18.1</span>  |</td><td> </td><td class="rblock">      | <span class="insert">0x0d</span>  | <span class="insert">preferred_address</span>                   | <span class="insert">Section 18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     <span class="delete">+--------+-------------------------------------+---------------+</span></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      | <span class="insert">0x0e</span>  | <span class="insert">active_connection_id_limit</span>          | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      | <span class="insert">0x0f</span>  | <span class="insert">initial_source_connection_id</span>        | <span class="insert">Section 18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      | <span class="insert">0x10</span>  | <span class="insert">retry_source_connection_id</span>          | Section <span class="insert">18.2</span>  |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">      <span class="insert">+-------+-------------------------------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0627"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">            Table 6: Initial QUIC Transport Parameters Entries</td><td> </td><td class="rblock">            <span class="insert"> </span>Table 6: Initial QUIC Transport Parameters Entries</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0628"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">22.2.  QUIC Frame Type Registry</span></td><td> </td><td class="rblock">   <span class="insert">Additionally, each value of the format "31 * N + 27" for integer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   values of N (that is, 27, 58, 89, ...) are reserved and MUST NOT be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   assigned by IANA.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0629"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">IANA [SHALL add/has added] a registry for "QUIC</span> Frame <span class="delete">Types" under a</span></td><td> </td><td class="rblock"><span class="insert">22.3.  QUIC</span> Frame <span class="insert">Type Registry</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   "QUIC Protocol" heading.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0630"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The</span> "QUIC Frame Types" <span class="delete">registry governs</span> a <span class="delete">62-bit space.  This space</span></td><td> </td><td class="rblock">   <span class="insert">IANA [SHALL add/has added] a registry for</span> "QUIC Frame Types" <span class="insert">under</span> a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   is split into three spaces that are governed by different policies.</span></td><td> </td><td class="rblock">   <span class="insert">"QUIC" heading.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Values between 0x00 and 0x3f (in hexadecimal) are assigned via the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Standards Action or IESG Review policies [RFC8126].  Values from 0x40</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   to 0x3fff operate on the Specification Required policy [RFC8126].</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   All other values are assigned to Private Use [RFC8126].</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0631"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Registrations MUST include</span> the <span class="delete">following fields:</span></td><td> </td><td class="rblock">   <span class="insert">The "QUIC Frame Types" registry governs a 62-bit space.  This</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   registry follows</span> the <span class="insert">registration policy from Section 22.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Permanent registrations in this registry are assigned using the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Specification Required policy [RFC8126], except for values between</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   0x00 and 0x3f (in hexadecimal; inclusive), which are assigned using</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Standards Action or IESG Approval as defined in Section 4.9 and 4.10</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of [RFC8126].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0632"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Value:  The numeric value of</span> the <span class="delete">assignment (registrations will be</span></td><td> </td><td class="rblock">   <span class="insert">In addition to</span> the <span class="insert">fields in Section 22.1.1, permanent registrations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      between 0x00 and 0x3fff).  A range of values MAY be assigned.</span></td><td> </td><td class="rblock"><span class="insert">   in this registry MUST include the following fields:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Frame Name:  A short mnemonic for the frame type.</td><td> </td><td class="right">   Frame Name:  A short mnemonic for the frame type.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0633"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Specification:  A reference</span> to <span class="delete">a publicly available specification for</span></td><td> </td><td class="rblock">   <span class="insert">In addition</span> to the <span class="insert">advice in Section 22.1, specifications</span> for new</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      the <span class="delete">value.</span></td><td> </td><td class="rblock">   <span class="insert">permanent</span> registrations <span class="insert">SHOULD</span> describe the means by which an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock">   endpoint might determine that it can send the identified type of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   The nominated expert(s) verify that a specification exists and is</span></td><td> </td><td class="rblock">   frame.  An accompanying transport parameter registration is expected</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   readily accessible.  Specifications</span> for new registrations <span class="delete">need to</span></td><td> </td><td class="rblock">   for most <span class="insert">registrations; see Section 22.2.  Specifications for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   describe the means by which an endpoint might determine that it can</td><td> </td><td class="rblock"><span class="insert">   permanent registrations also</span> needs to describe the format and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   send the identified type of frame.  An accompanying transport</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   parameter registration <span class="delete">(see Section 22.1)</span> is expected for most</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">registrations.  The specification</span> needs to describe the format and</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   assigned semantics of any fields in the frame.</td><td> </td><td class="right">   assigned semantics of any fields in the frame.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0634"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Expert(s) are encouraged to be biased towards approving registrations</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   unless they are abusive, frivolous, or actively harmful (not merely</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   aesthetically displeasing, or architecturally dubious).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The initial contents of this registry are tabulated in Table 3.</td><td> </td><td class="right">   The initial contents of this registry are tabulated in Table 3.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0635"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">22.<span class="delete">3</span>.  QUIC Transport Error Codes Registry</td><td> </td><td class="rblock">22.<span class="insert">4</span>.  QUIC Transport Error Codes Registry</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   IANA [SHALL add/has added] a registry for "QUIC Transport Error</td><td> </td><td class="right">   IANA [SHALL add/has added] a registry for "QUIC Transport Error</td><td class="lineno"></td></tr>
      <tr id="diff0636"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Codes" under a <span class="delete">"QUIC Protocol"</span> heading.</td><td> </td><td class="rblock">   Codes" under a <span class="insert">"QUIC"</span> heading.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The "QUIC Transport Error Codes" registry governs a 16-bit space.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   This space is split into two spaces that are governed by different</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   policies.  Values with the first byte in the range 0x00 to 0xfe (in</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   hexadecimal) are assigned via the Specification Required policy</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC8126].  Values with the first byte 0xff are reserved for Private</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Use [RFC8126].</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0637"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Registrations MUST include</span> the <span class="delete">following fields:</span></td><td> </td><td class="rblock">   <span class="insert">The "QUIC Transport Error Codes" registry governs a 62-bit space.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This space is split into three spaces that are governed by different</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   policies.  Permanent registrations in this registry are assigned</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   using</span> the <span class="insert">Specification Required policy [RFC8126], except for values</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   between 0x00 and 0x3f (in hexadecimal; inclusive), which are assigned</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   using Standards Action or IESG Approval as defined in Section 4.9 and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   4.10 of [RFC8126].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0638"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Value:  The numeric value of</span> the <span class="delete">assignment (registrations will be</span></td><td> </td><td class="rblock">   <span class="insert">In addition to</span> the <span class="insert">fields in Section 22.1.1, permanent registrations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      between 0x0000 and 0xfeff).</span></td><td> </td><td class="rblock"><span class="insert">   in this registry MUST include the following fields:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Code:  A short mnemonic for the parameter.</td><td> </td><td class="right">   Code:  A short mnemonic for the parameter.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Description:  A brief description of the error code semantics, which</td><td> </td><td class="right">   Description:  A brief description of the error code semantics, which</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      MAY be a summary if a specification reference is provided.</td><td> </td><td class="right">      MAY be a summary if a specification reference is provided.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0639"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Specification:  A reference to a publicly available specification for</span></td><td> </td><td class="rblock">   The initial contents of this registry are shown in Table 7.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      the value.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The initial contents of this registry are shown in Table 7.  <span class="delete">Values</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   from 0xFF00 to 0xFFFF are reserved for Private Use [RFC8126].</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   +------+---------------------------+----------------+---------------+</td><td> </td><td class="right">   +------+---------------------------+----------------+---------------+</td><td class="lineno"></td></tr>
      <tr id="diff0640"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">| Valu</span> | Error                     | Description    | Specification |</td><td> </td><td class="rblock">   <span class="insert">|Value</span> | Error                     | Description    | Specification |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">| e    |                           |                |               |</span></td><td> </td><td class="rblock">   <span class="insert">+======+===========================+================+===============+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   +------+---------------------------+----------------+---------------+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   | 0x0  | NO_ERROR                  | No error       | Section 20    |</td><td> </td><td class="right">   | 0x0  | NO_ERROR                  | No error       | Section 20    |</td><td class="lineno"></td></tr>
      <tr id="diff0641"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|      |                           |                |               |</span></td><td> </td><td class="rblock">   <span class="insert">+------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   | 0x1  | INTERNAL_ERROR            | Implementation | Section 20    |</td><td> </td><td class="right">   | 0x1  | INTERNAL_ERROR            | Implementation | Section 20    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   |      |                           | error          |               |</td><td> </td><td class="right">   |      |                           | error          |               |</td><td class="lineno"></td></tr>
      <tr id="diff0642"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|      |                           |                |               |</span></td><td> </td><td class="rblock">   <span class="insert">+------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | 0x2  | <span class="delete">SERVER_BUSY               | Server         |</span> Section 20    |</td><td> </td><td class="rblock">   | 0x2  | <span class="insert">CONNECTION_REFUSED_ERROR  |Server refuses a|</span> Section 20    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   |      |                           | <span class="delete">currently busy |               |</span></td><td> </td><td class="rblock">   |      |                           | <span class="insert">connection</span>     |               |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |      |                           |</span>                |               |</td><td> </td><td class="rblock">   <span class="insert">+------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   | 0x3  | FLOW_CONTROL_ERROR        | Flow control   | Section 20    |</td><td> </td><td class="right">   | 0x3  | FLOW_CONTROL_ERROR        | Flow control   | Section 20    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   |      |                           | error          |               |</td><td> </td><td class="right">   |      |                           | error          |               |</td><td class="lineno"></td></tr>
      <tr id="diff0643"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|      |                           |                |               |</span></td><td> </td><td class="rblock">   <span class="insert">+------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | 0x4  | STREAM_LIMIT_ERROR        <span class="delete">| Too</span> many       <span class="delete">|</span> Section 20    |</td><td> </td><td class="rblock">   | 0x4  | STREAM_LIMIT_ERROR        <span class="insert">|Too</span> many <span class="insert">streams|</span> Section 20    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   |      |                           | <span class="delete">streams</span> opened |               |</td><td> </td><td class="rblock">   |      |                           | opened         |               |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|      |                           |                |               |</span></td><td> </td><td class="rblock">   <span class="insert">+------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   | 0x5  | STREAM_STATE_ERROR        | Frame received | Section 20    |</td><td> </td><td class="right">   | 0x5  | STREAM_STATE_ERROR        | Frame received | Section 20    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   |      |                           | in invalid     |               |</td><td> </td><td class="right">   |      |                           | in invalid     |               |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   |      |                           | stream state   |               |</td><td> </td><td class="right">   |      |                           | stream state   |               |</td><td class="lineno"></td></tr>
      <tr id="diff0644"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|      |                           |                |               |</span></td><td> </td><td class="rblock">   <span class="insert">+------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | 0x6  | FINAL_SIZE_ERROR          <span class="delete">| Change</span> to      | Section 20    |</td><td> </td><td class="rblock">   | 0x6  | FINAL_SIZE_ERROR          <span class="insert">|Change</span> to <span class="insert">final</span> | Section 20    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   |      |                           | <span class="delete">final</span> size     |               |</td><td> </td><td class="rblock">   |      |                           | size           |               |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|      |                           |                |               |</span></td><td> </td><td class="rblock">   <span class="insert">+------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   | 0x7  | FRAME_ENCODING_ERROR      | Frame encoding | Section 20    |</td><td> </td><td class="right">   | 0x7  | FRAME_ENCODING_ERROR      | Frame encoding | Section 20    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   |      |                           | error          |               |</td><td> </td><td class="right">   |      |                           | error          |               |</td><td class="lineno"></td></tr>
      <tr id="diff0645"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|      |                           |                |               |</span></td><td> </td><td class="rblock">   <span class="insert">+------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   | 0x8  | TRANSPORT_PARAMETER_ERROR | Error in       | Section 20    |</td><td> </td><td class="right">   | 0x8  | TRANSPORT_PARAMETER_ERROR | Error in       | Section 20    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   |      |                           | transport      |               |</td><td> </td><td class="right">   |      |                           | transport      |               |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   |      |                           | parameters     |               |</td><td> </td><td class="right">   |      |                           | parameters     |               |</td><td class="lineno"></td></tr>
      <tr id="diff0646"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|      |                           |                |               |</span></td><td> </td><td class="rblock">   <span class="insert">+------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | 0x9  | <span class="delete">VERSION_NEGOTIATION_ERROR</span> | <span class="delete">Version</span>        | Section 20    |</td><td> </td><td class="rblock">   | 0x9  | <span class="insert">CONNECTION_ID_LIMIT_ERROR</span> | <span class="insert">Too many</span>       | Section 20    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   |      |                           | <span class="delete">negotiation    |               |</span></td><td> </td><td class="rblock">   |      |                           | <span class="insert">connection IDs</span> |               |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |      |                           | failure</span>        |               |</td><td> </td><td class="rblock">   |      |                           | <span class="insert">received</span>       |               |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   |      |                           |                |               |</td><td> </td><td class="rblock">   <span class="insert">+------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   | 0xA  | PROTOCOL_VIOLATION        <span class="delete">| Generic        |</span> Section 20    <span class="delete">|</span></td><td> </td><td class="rblock">   | 0xA  | PROTOCOL_VIOLATION        <span class="insert">|Generic protocol|</span> Section 20    |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |      |                           | protocol       |</span>               |</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   |      |                           | violation      |               |</td><td> </td><td class="right">   |      |                           | violation      |               |</td><td class="lineno"></td></tr>
      <tr id="diff0647"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">|      |                           |                |               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   | 0xC  | INVALID_MIGRATION         | Violated       | Section 20    |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |      |                           | disabled       |               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   |      |                           | migration      |               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   +------+---------------------------+----------------+---------------+</td><td> </td><td class="right">   +------+---------------------------+----------------+---------------+</td><td class="lineno"></td></tr>
      <tr id="diff0648"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock">   <span class="insert">| 0xB  | INVALID_TOKEN             | Invalid Token  | Section 20    |</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   |      |                           | Received       |               |</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   +------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   | 0xC  | APPLICATION_ERROR         | Application    | Section 20    |</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   |      |                           | error          |               |</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   +------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   | 0xD  | CRYPTO_BUFFER_EXCEEDED    | CRYPTO data    | Section 20    |</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   |      |                           | buffer         |               |</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   |      |                           | overflowed     |               |</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   +------+---------------------------+----------------+---------------+</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">            Table 7: Initial QUIC Transport Error Codes Entries</td><td> </td><td class="right">            Table 7: Initial QUIC Transport Error Codes Entries</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">23.  References</td><td> </td><td class="right">23.  References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">23.1.  Normative References</td><td> </td><td class="right">23.1.  Normative References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0649"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   [DPLPMTUD]</td><td> </td><td class="rblock">   [DPLPMTUD] Fairhurst, G., Jones, T., Tuexen, M., Ruengeler, <span class="insert">I., and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              Fairhurst, G., Jones, T., Tuexen, M., <span class="delete">and I.</span> Ruengeler,</td><td> </td><td class="rblock"><span class="insert">              T. Voelker,</span> "Packetization Layer Path MTU Discovery for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              "Packetization Layer Path MTU Discovery for Datagram</td><td> </td><td class="rblock">              Datagram Transports", <span class="insert">Work</span> in <span class="insert">Progress, Internet-Draft,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              Transports", <span class="delete">draft-ietf-tsvwg-datagram-plpmtud-06 (work</span> in</td><td> </td><td class="rblock"><span class="insert">              draft-ietf-tsvwg-datagram-plpmtud-21, 12 May 2020,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              <span class="delete">progress), November 2018.</span></td><td> </td><td class="rblock"><span class="insert">              &lt;http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              datagram-plpmtud-21.txt&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [IPv4]     Postel, J., "Internet Protocol", STD 5, RFC 791,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.17487/RFC0791, September 1981,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc791&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [QUIC-RECOVERY]</td><td> </td><td class="right">   [QUIC-RECOVERY]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Iyengar, J., Ed. and I. Swett, Ed., "QUIC Loss Detection</td><td> </td><td class="right">              Iyengar, J., Ed. and I. Swett, Ed., "QUIC Loss Detection</td><td class="lineno"></td></tr>
      <tr id="diff0650"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              and Congestion Control", <span class="delete">draft-ietf-quic-recovery-18 (work</span></td><td> </td><td class="rblock">              and Congestion Control", <span class="insert">Work</span> in <span class="insert">Progress, Internet-Draft,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              in <span class="delete">progress), January 2019.</span></td><td> </td><td class="rblock"><span class="insert">              draft-ietf-quic-recovery-29, 10 June 2020,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://tools.ietf.org/html/draft-ietf-quic-recovery-29&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0651"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   [QUIC-TLS]</td><td> </td><td class="rblock">   [QUIC-TLS] Thomson, M., Ed. and S. Turner, Ed., "Using Transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              Thomson, M., Ed. and S. Turner, Ed., "Using Transport</td><td> </td><td class="rblock">              Layer Security (TLS) to Secure QUIC", <span class="insert">Work</span> in <span class="insert">Progress,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              Layer Security (TLS) to Secure QUIC", <span class="delete">draft-ietf-quic-</span></td><td> </td><td class="rblock"><span class="insert">              Internet-Draft, draft-ietf-quic-tls-29, 10 June 2020,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              tls-18 (work</span> in <span class="delete">progress), January 2019.</span></td><td> </td><td class="rblock"><span class="insert">              &lt;https://tools.ietf.org/html/draft-ietf-quic-tls-29&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0652"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   [RFC1191]  Mogul, <span class="delete">J.</span> and <span class="delete">S.</span> Deering, "Path MTU discovery", RFC 1191,</td><td> </td><td class="rblock">   [RFC1191]  Mogul, <span class="insert">J.C.</span> and <span class="insert">S.E.</span> Deering, "Path MTU discovery",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              DOI 10.17487/RFC1191, November 1990,</td><td> </td><td class="rblock">              RFC 1191, DOI 10.17487/RFC1191, November 1990,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc1191&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc1191&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td> </td><td class="right">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Requirement Levels", BCP 14, RFC 2119,</td><td> </td><td class="right">              Requirement Levels", BCP 14, RFC 2119,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC2119, March 1997,</td><td> </td><td class="right">              DOI 10.17487/RFC2119, March 1997,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc2119&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc2119&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC3168]  Ramakrishnan, K., Floyd, S., and D. Black, "The Addition</td><td> </td><td class="right">   [RFC3168]  Ramakrishnan, K., Floyd, S., and D. Black, "The Addition</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              of Explicit Congestion Notification (ECN) to IP",</td><td> </td><td class="right">              of Explicit Congestion Notification (ECN) to IP",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              RFC 3168, DOI 10.17487/RFC3168, September 2001,</td><td> </td><td class="right">              RFC 3168, DOI 10.17487/RFC3168, September 2001,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-28" class="change"><td></td><th><small>skipping to change at</small><a href="#part-28"><em> page 126, line 5<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-28"><em> page 162, line 14<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC4086]  Eastlake 3rd, D., Schiller, J., and S. Crocker,</td><td> </td><td class="right">   [RFC4086]  Eastlake 3rd, D., Schiller, J., and S. Crocker,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              "Randomness Requirements for Security", BCP 106, RFC 4086,</td><td> </td><td class="right">              "Randomness Requirements for Security", BCP 106, RFC 4086,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC4086, June 2005,</td><td> </td><td class="right">              DOI 10.17487/RFC4086, June 2005,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc4086&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc4086&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC5116]  McGrew, D., "An Interface and Algorithms for Authenticated</td><td> </td><td class="right">   [RFC5116]  McGrew, D., "An Interface and Algorithms for Authenticated</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Encryption", RFC 5116, DOI 10.17487/RFC5116, January 2008,</td><td> </td><td class="right">              Encryption", RFC 5116, DOI 10.17487/RFC5116, January 2008,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc5116&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc5116&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0653"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC6437]  Amante, S., Carpenter, B., Jiang, S., and J. Rajahalme,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              "IPv6 Flow Label Specification", RFC 6437,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.17487/RFC6437, November 2011,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc6437&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8085]  Eggert, L., Fairhurst, G., and G. Shepherd, "UDP Usage</td><td> </td><td class="right">   [RFC8085]  Eggert, L., Fairhurst, G., and G. Shepherd, "UDP Usage</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Guidelines", BCP 145, RFC 8085, DOI 10.17487/RFC8085,</td><td> </td><td class="right">              Guidelines", BCP 145, RFC 8085, DOI 10.17487/RFC8085,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              March 2017, &lt;https://www.rfc-editor.org/info/rfc8085&gt;.</td><td> </td><td class="right">              March 2017, &lt;https://www.rfc-editor.org/info/rfc8085&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for</td><td> </td><td class="right">   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Writing an IANA Considerations Section in RFCs", BCP 26,</td><td> </td><td class="right">              Writing an IANA Considerations Section in RFCs", BCP 26,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              RFC 8126, DOI 10.17487/RFC8126, June 2017,</td><td> </td><td class="right">              RFC 8126, DOI 10.17487/RFC8126, June 2017,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8126&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8126&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC</td><td> </td><td class="right">   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-29" class="change"><td></td><th><small>skipping to change at</small><a href="#part-29"><em> page 126, line 28<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-29"><em> page 162, line 42<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8201]  McCann, J., Deering, S., Mogul, J., and R. Hinden, Ed.,</td><td> </td><td class="right">   [RFC8201]  McCann, J., Deering, S., Mogul, J., and R. Hinden, Ed.,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              "Path MTU Discovery for IP version 6", STD 87, RFC 8201,</td><td> </td><td class="right">              "Path MTU Discovery for IP version 6", STD 87, RFC 8201,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC8201, July 2017,</td><td> </td><td class="right">              DOI 10.17487/RFC8201, July 2017,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8201&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8201&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8311]  Black, D., "Relaxing Restrictions on Explicit Congestion</td><td> </td><td class="right">   [RFC8311]  Black, D., "Relaxing Restrictions on Explicit Congestion</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Notification (ECN) Experimentation", RFC 8311,</td><td> </td><td class="right">              Notification (ECN) Experimentation", RFC 8311,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC8311, January 2018,</td><td> </td><td class="right">              DOI 10.17487/RFC8311, January 2018,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8311&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8311&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0654"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">[SPIN]     Trammell, B. and M. Kuehlewind, "The QUIC Latency Spin</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Bit", draft-ietf-quic-spin-exp-01 (work in progress),</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              October 2018.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [TLS13]    Rescorla, E., "The Transport Layer Security (TLS) Protocol</td><td> </td><td class="right">   [TLS13]    Rescorla, E., "The Transport Layer Security (TLS) Protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Version 1.3", RFC 8446, DOI 10.17487/RFC8446, August 2018,</td><td> </td><td class="right">              Version 1.3", RFC 8446, DOI 10.17487/RFC8446, August 2018,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8446&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8446&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">23.2.  Informative References</td><td> </td><td class="right">23.2.  Informative References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0655"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[ALTSVC]   Nottingham, M., McManus, P., and J. Reschke, "HTTP</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Alternative Services", RFC 7838, DOI 10.17487/RFC7838,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              April 2016, &lt;https://www.rfc-editor.org/info/rfc7838&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [EARLY-DESIGN]</td><td> </td><td class="right">   [EARLY-DESIGN]</td><td class="lineno"></td></tr>
      <tr id="diff0656"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              Roskind, J., "QUIC: Multiplexed Transport Over UDP",</td><td> </td><td class="rblock">              Roskind, J., "QUIC: Multiplexed Transport Over UDP",<span class="insert"> 2</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              December 2013, &lt;https://goo.gl/dMVtFi&gt;.</td><td> </td><td class="right">              December 2013, &lt;https://goo.gl/dMVtFi&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [HTTP2]    Belshe, M., Peon, R., and M. Thomson, Ed., "Hypertext</td><td> </td><td class="right">   [HTTP2]    Belshe, M., Peon, R., and M. Thomson, Ed., "Hypertext</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Transfer Protocol Version 2 (HTTP/2)", RFC 7540,</td><td> </td><td class="right">              Transfer Protocol Version 2 (HTTP/2)", RFC 7540,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC7540, May 2015,</td><td> </td><td class="right">              DOI 10.17487/RFC7540, May 2015,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc7540&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc7540&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [QUIC-INVARIANTS]</td><td> </td><td class="right">   [QUIC-INVARIANTS]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Thomson, M., "Version-Independent Properties of QUIC",</td><td> </td><td class="right">              Thomson, M., "Version-Independent Properties of QUIC",</td><td class="lineno"></td></tr>
      <tr id="diff0657"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              <span class="delete">draft-ietf-quic-invariants-03 (work</span> in <span class="delete">progress),</span> January</td><td> </td><td class="rblock">              <span class="insert">Work</span> in <span class="insert">Progress, Internet-Draft, draft-ietf-quic-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              <span class="delete">2019.</span></td><td> </td><td class="rblock"><span class="insert">              invariants-09, 10 June 2020, &lt;https://tools.ietf.org/html/</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              draft-ietf-quic-invariants-09&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [QUIC-MANAGEABILITY]</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Kuehlewind, M. and B. Trammell, "Manageability of the QUIC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Transport Protocol", Work in Progress, Internet-Draft,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              draft-ietf-quic-manageability-06, 6</span> January <span class="insert">2020,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;http://www.ietf.org/internet-drafts/draft-ietf-quic-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              manageability-06.txt&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC1812]  Baker, F., Ed., "Requirements for IP Version 4 Routers",</td><td> </td><td class="right">   [RFC1812]  Baker, F., Ed., "Requirements for IP Version 4 Routers",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              RFC 1812, DOI 10.17487/RFC1812, June 1995,</td><td> </td><td class="right">              RFC 1812, DOI 10.17487/RFC1812, June 1995,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc1812&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc1812&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC2018]  Mathis, M., Mahdavi, J., Floyd, S., and A. Romanow, "TCP</td><td> </td><td class="right">   [RFC2018]  Mathis, M., Mahdavi, J., Floyd, S., and A. Romanow, "TCP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Selective Acknowledgment Options", RFC 2018,</td><td> </td><td class="right">              Selective Acknowledgment Options", RFC 2018,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC2018, October 1996,</td><td> </td><td class="right">              DOI 10.17487/RFC2018, October 1996,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc2018&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc2018&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC2104]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-</td><td> </td><td class="right">   [RFC2104]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Hashing for Message Authentication", RFC 2104,</td><td> </td><td class="right">              Hashing for Message Authentication", RFC 2104,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC2104, February 1997,</td><td> </td><td class="right">              DOI 10.17487/RFC2104, February 1997,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc2104&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc2104&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0658"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">[RFC2360]  Scott,</span> G., <span class="delete">"Guide for Internet Standards Writers",</span> BCP <span class="delete">22,</span></td><td> </td><td class="rblock">   <span class="insert">[RFC3449]  Balakrishnan, H., Padmanabhan, V., Fairhurst,</span> G., <span class="insert">and M.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              RFC <span class="delete">2360,</span> DOI <span class="delete">10.17487/RFC2360, June 1998,</span></td><td> </td><td class="rblock"><span class="insert">              Sooriyabandara, "TCP Performance Implications of Network</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              &lt;https://www.rfc-editor.org/info/rfc2360&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              Path Asymmetry",</span> BCP <span class="insert">69,</span> RFC <span class="insert">3449,</span> DOI <span class="insert">10.17487/RFC3449,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock">              December <span class="insert">2002, &lt;https://www.rfc-editor.org/info/rfc3449&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC4303]  Kent, S., "IP Encapsulating Security Payload (ESP)",</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              RFC 4303, DOI 10.17487/RFC4303,</span> December <span class="delete">2005,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              &lt;https://www.rfc-editor.org/info/rfc4303&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC4443]  Conta, A., Deering, S., and M. Gupta, Ed., "Internet</td><td> </td><td class="right">   [RFC4443]  Conta, A., Deering, S., and M. Gupta, Ed., "Internet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Control Message Protocol (ICMPv6) for the Internet</td><td> </td><td class="right">              Control Message Protocol (ICMPv6) for the Internet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Protocol Version 6 (IPv6) Specification", STD 89,</td><td> </td><td class="right">              Protocol Version 6 (IPv6) Specification", STD 89,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              RFC 4443, DOI 10.17487/RFC4443, March 2006,</td><td> </td><td class="right">              RFC 4443, DOI 10.17487/RFC4443, March 2006,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc4443&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc4443&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC4787]  Audet, F., Ed. and C. Jennings, "Network Address</td><td> </td><td class="right">   [RFC4787]  Audet, F., Ed. and C. Jennings, "Network Address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Translation (NAT) Behavioral Requirements for Unicast</td><td> </td><td class="right">              Translation (NAT) Behavioral Requirements for Unicast</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              UDP", BCP 127, RFC 4787, DOI 10.17487/RFC4787, January</td><td> </td><td class="right">              UDP", BCP 127, RFC 4787, DOI 10.17487/RFC4787, January</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              2007, &lt;https://www.rfc-editor.org/info/rfc4787&gt;.</td><td> </td><td class="right">              2007, &lt;https://www.rfc-editor.org/info/rfc4787&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0659"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC5681]  Allman, M., Paxson, V., and E. Blanton, "TCP Congestion</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Control", RFC 5681, DOI 10.17487/RFC5681, September 2009,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc5681&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC5869]  Krawczyk, H. and P. Eronen, "HMAC-based Extract-and-Expand</td><td> </td><td class="right">   [RFC5869]  Krawczyk, H. and P. Eronen, "HMAC-based Extract-and-Expand</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Key Derivation Function (HKDF)", RFC 5869,</td><td> </td><td class="right">              Key Derivation Function (HKDF)", RFC 5869,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC5869, May 2010,</td><td> </td><td class="right">              DOI 10.17487/RFC5869, May 2010,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc5869&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc5869&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC7301]  Friedl, S., Popov, A., Langley, A., and E. Stephan,</td><td> </td><td class="right">   [RFC7301]  Friedl, S., Popov, A., Langley, A., and E. Stephan,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              "Transport Layer Security (TLS) Application-Layer Protocol</td><td> </td><td class="right">              "Transport Layer Security (TLS) Application-Layer Protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Negotiation Extension", RFC 7301, DOI 10.17487/RFC7301,</td><td> </td><td class="right">              Negotiation Extension", RFC 7301, DOI 10.17487/RFC7301,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              July 2014, &lt;https://www.rfc-editor.org/info/rfc7301&gt;.</td><td> </td><td class="right">              July 2014, &lt;https://www.rfc-editor.org/info/rfc7301&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8200]  Deering, S. and R. Hinden, "Internet Protocol, Version 6</td><td> </td><td class="right">   [RFC8200]  Deering, S. and R. Hinden, "Internet Protocol, Version 6</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              (IPv6) Specification", STD 86, RFC 8200,</td><td> </td><td class="right">              (IPv6) Specification", STD 86, RFC 8200,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC8200, July 2017,</td><td> </td><td class="right">              DOI 10.17487/RFC8200, July 2017,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8200&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8200&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0660"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[SEC-CONS] Rescorla, E. and B. Korver, "Guidelines for Writing RFC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Text on Security Considerations", BCP 72, RFC 3552,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.17487/RFC3552, July 2003,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc3552&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [SLOWLORIS]</td><td> </td><td class="right">   [SLOWLORIS]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              RSnake Hansen, R., "Welcome to Slowloris...", June 2009,</td><td> </td><td class="right">              RSnake Hansen, R., "Welcome to Slowloris...", June 2009,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://web.archive.org/web/20150315054838/</td><td> </td><td class="right">              &lt;https://web.archive.org/web/20150315054838/</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              http://ha.ckers.org/slowloris/&gt;.</td><td> </td><td class="right">              http://ha.ckers.org/slowloris/&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0661"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[STD]      Bradner, S., "The Internet Standards Process -- Revision</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              3", BCP 9, RFC 2026, DOI 10.17487/RFC2026, October 1996,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc2026&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Appendix A.  Sample Packet Number Decoding Algorithm</td><td> </td><td class="right">Appendix A.  Sample Packet Number Decoding Algorithm</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0662"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">following pseudo-code</span> shows how an implementation can decode</td><td> </td><td class="rblock">   The <span class="insert">pseudo-code in Figure 44</span> shows how an implementation can decode</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   packet numbers after header protection has been removed.</td><td> </td><td class="right">   packet numbers after header protection has been removed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   DecodePacketNumber(largest_pn, truncated_pn, pn_nbits):</td><td> </td><td class="right">   DecodePacketNumber(largest_pn, truncated_pn, pn_nbits):</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      expected_pn  = largest_pn + 1</td><td> </td><td class="right">      expected_pn  = largest_pn + 1</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      pn_win       = 1 &lt;&lt; pn_nbits</td><td> </td><td class="right">      pn_win       = 1 &lt;&lt; pn_nbits</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      pn_hwin      = pn_win / 2</td><td> </td><td class="right">      pn_hwin      = pn_win / 2</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      pn_mask      = pn_win - 1</td><td> </td><td class="right">      pn_mask      = pn_win - 1</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      // The incoming packet number should be greater than</td><td> </td><td class="right">      // The incoming packet number should be greater than</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      // expected_pn - pn_hwin and less than or equal to</td><td> </td><td class="right">      // expected_pn - pn_hwin and less than or equal to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      // expected_pn + pn_hwin</td><td> </td><td class="right">      // expected_pn + pn_hwin</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      //</td><td> </td><td class="right">      //</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      // This means we can't just strip the trailing bits from</td><td> </td><td class="right">      // This means we can't just strip the trailing bits from</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      // expected_pn and add the truncated_pn because that might</td><td> </td><td class="right">      // expected_pn and add the truncated_pn because that might</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      // yield a value outside the window.</td><td> </td><td class="right">      // yield a value outside the window.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      //</td><td> </td><td class="right">      //</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      // The following code calculates a candidate value and</td><td> </td><td class="right">      // The following code calculates a candidate value and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      // makes sure it's within the packet number window.</td><td> </td><td class="right">      // makes sure it's within the packet number window.</td><td class="lineno"></td></tr>
      <tr id="diff0663"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      // Note the extra checks to prevent overflow and underflow.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      candidate_pn = (expected_pn &amp; ~pn_mask) | truncated_pn</td><td> </td><td class="right">      candidate_pn = (expected_pn &amp; ~pn_mask) | truncated_pn</td><td class="lineno"></td></tr>
      <tr id="diff0664"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      if candidate_pn &lt;= expected_pn - <span class="delete">pn_hwin:</span></td><td> </td><td class="rblock">      if candidate_pn &lt;= expected_pn - <span class="insert">pn_hwin and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">         candidate_pn &lt; (1 &lt;&lt; 62) - pn_win:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         return candidate_pn + pn_win</td><td> </td><td class="right">         return candidate_pn + pn_win</td><td class="lineno"></td></tr>
      <tr id="diff0665"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">// Note the extra check for underflow when candidate_pn</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      // is near zero.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      if candidate_pn &gt; expected_pn + pn_hwin and</td><td> </td><td class="right">      if candidate_pn &gt; expected_pn + pn_hwin and</td><td class="lineno"></td></tr>
      <tr id="diff0666"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">         candidate_pn &gt; pn_win:</td><td> </td><td class="rblock">         candidate_pn &gt;<span class="insert">=</span> pn_win:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         return candidate_pn - pn_win</td><td> </td><td class="right">         return candidate_pn - pn_win</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      return candidate_pn</td><td> </td><td class="right">      return candidate_pn</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0667"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">Appendix B.  Change Log</td><td> </td><td class="rblock">             <span class="insert">Figure 44: Sample Packet Number Decoding Algorithm</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">Appendix B.  <span class="insert">Sample ECN Validation Algorithm</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Each time an endpoint commences sending on a new network path, it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   determines whether the path supports ECN; see Section 13.4.  If the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   path supports ECN, the goal is to use ECN.  Endpoints might also</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   periodically reassess a path that was determined to not support ECN.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This section describes one method for testing new paths.  This</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   algorithm is intended to show how a path might be tested for ECN</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   support.  Endpoints can implement different methods.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The path is assigned an ECN state that is one of "testing",</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   "unknown", "failed", or "capable".  On paths with a "testing" or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   "capable" state the endpoint sends packets with an ECT marking, by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   default ECT(0); otherwise, the endpoint sends unmarked packets.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   To start testing a path, the ECN state is set to "testing" and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   existing ECN counts are remembered as a baseline.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The testing period runs for a number of packets or round-trip times,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   as determined by the endpoint.  The goal is not to limit the duration</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of the testing period, but to ensure that enough marked packets are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   sent for received ECN counts to provide a clear indication of how the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   path treats marked packets.  Section 13.4.2.2 suggests limiting this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to 10 packets or 3 round-trip times.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   After the testing period ends, the ECN state for the path becomes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   "unknown".  From the "unknown" state, successful validation of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ECN counts an ACK frame (see Section 13.4.2.2) causes the ECN state</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   for the path to become "capable", unless no marked packet has been</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledged.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If validation of ECN counts fails at any time, the ECN state for the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   affected path becomes "failed".  An endpoint can also mark the ECN</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   state for a path as "failed" if marked packets are all declared lost</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   or if they are all CE marked.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Following this algorithm ensures that ECN is rarely disabled for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   paths that properly support ECN.  Any path that incorrectly modifies</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   markings will cause ECN to be disabled.  For those rare cases where</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   marked packets are discarded by the path, the short duration of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   testing period limits the number of losses incurred.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">Appendix C.</span>  Change Log</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      *RFC Editor's Note:* Please remove this section prior to</td><td> </td><td class="right">      *RFC Editor's Note:* Please remove this section prior to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      publication of a final version of this document.</td><td> </td><td class="right">      publication of a final version of this document.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Issue and pull request numbers are listed with a leading octothorp.</td><td> </td><td class="right">   Issue and pull request numbers are listed with a leading octothorp.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0668"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.1.  Since draft-ietf-quic-transport-17</span></td><td> </td><td class="rblock"><span class="insert">C.1.  Since draft-ietf-quic-transport-28</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0669"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Stream-related errors</span> now <span class="delete">use STREAM_STATE_ERROR (#2305)</span></td><td> </td><td class="rblock">   <span class="insert">*  Made SERVER_BUSY error (0x2) more generic,</span> now <span class="insert">CONNECTION_REFUSED</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3709, #3690, #3694)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0670"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Endpoints discard initial keys as soon as handshake keys are</td><td> </td><td class="rblock">   <span class="insert">*  Allow TRANSPORT_PARAMETER_ERROR when validating connection IDs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3703, #3691)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Integrate QUIC-specific language from draft-ietf-tsvwg-datagram-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      plpmtud (#3695, #3702)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  disable_active_migration does not apply to the addresses offered</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      in server_preferred_address (#3608, #3670)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.2.  Since draft-ietf-quic-transport-27</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Allowed CONNECTION_CLOSE in any packet number space, with a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      requirement to use a new transport-level error for application-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      specific errors in Initial and Handshake packets (#3430, #3435,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #3440)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Clearer requirements for address validation (#2125, #3327)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Security analysis of handshake and migration (#2143, #2387, #2925)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  The entire payload of a datagram is used when counting bytes for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      mitigating amplification attacks (#3333, #3470)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Connection IDs can be used at any time, including in the handshake</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3348, #3560, #3438, #3565)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Only one ACK should be sent for each instance of reordering</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3357, #3361)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Remove text allowing a server to proceed with a bad Retry token</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3396, #3398)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Ignore active_connection_id_limit with a zero-length connection ID</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3427, #3426)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Require active_connection_id_limit be remembered for 0-RTT (#3423,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #3425)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Require ack_delay not be remembered for 0-RTT (#3433, #3545)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Redefined max_packet_size to max_udp_datagram_size (#3471, #3473)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Guidance on limiting outstanding attempts to retire connection IDs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3489, #3509, #3557, #3547)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Restored text on dropping bogus Version Negotiation packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3532, #3533)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Clarified that largest acknowledged needs to be saved, but not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      necessarily signaled in all cases (#3541, #3581)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Addressed linkability risk with the use of preferred_address</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3559, #3563)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Added authentication of handshake connection IDs (#3439, #3499)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Opening a stream in the wrong direction is an error (#3527)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.3.  Since draft-ietf-quic-transport-26</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Change format of transport parameters to use varints (#3294,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #3169)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.4.  Since draft-ietf-quic-transport-25</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Define the use of CONNECTION_CLOSE prior to establishing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      connection state (#3269, #3297, #3292)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Allow use of address validation tokens after client address</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      changes (#3307, #3308)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Define the timer for address validation (#2910, #3339)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.5.  Since draft-ietf-quic-transport-24</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Added HANDSHAKE_DONE to signal handshake confirmation (#2863,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #3142, #3145)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Add integrity check to Retry packets (#3014, #3274, #3120)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Specify handling of reordered NEW_CONNECTION_ID frames (#3194,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #3202)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Require checking of sequence numbers in RETIRE_CONNECTION_ID</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3037, #3036)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  active_connection_id_limit is enforced (#3193, #3197, #3200,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #3201)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Correct overflow in packet number decode algorithm (#3187, #3188)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Allow use of CRYPTO_BUFFER_EXCEEDED for CRYPTO frame errors</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3258, #3186)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Define applicability and scope of NEW_TOKEN (#3150, #3152, #3155,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #3156)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Tokens from Retry and NEW_TOKEN must be differentiated (#3127,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #3128)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Allow CONNECTION_CLOSE in response to invalid token (#3168, #3107)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Treat an invalid CONNECTION_CLOSE as an invalid frame (#2475,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #3230, #3231)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Throttle when sending CONNECTION_CLOSE after discarding state</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3095, #3157)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Application-variant of CONNECTION_CLOSE can only be sent in 0-RTT</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      or 1-RTT packets (#3158, #3164)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Advise sending while blocked to avoid idle timeout (#2744, #3266)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Define error codes for invalid frames (#3027, #3042)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Idle timeout is symmetric (#2602, #3099)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Prohibit IP fragmentation (#3243, #3280)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Define the use of provisional registration for all registries</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3109, #3020, #3102, #3170)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Packets on one path must not adjust values for a different path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#2909, #3139)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.6.  Since draft-ietf-quic-transport-23</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Allow ClientHello to span multiple packets (#2928, #3045)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Client Initial size constraints apply to UDP datagram payload</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#3053, #3051)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Stateless reset changes (#2152, #2993)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      -  tokens need to be compared in constant time</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      -  detection uses UDP datagrams, not packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      -  tokens cannot be reused (#2785, #2968)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Clearer rules for sharing of UDP ports and use of connection IDs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      when doing so (#2844, #2851)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  A new connection ID is necessary when responding to migration</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#2778, #2969)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Stronger requirements for connection ID retirement (#3046, #3096)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  NEW_TOKEN cannot be empty (#2978, #2977)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  PING can be sent at any encryption level (#3034, #3035)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  CONNECTION_CLOSE is not ack-eliciting (#3097, #3098)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Frame encoding error conditions updated (#3027, #3042)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Non-ack-eliciting packets cannot be sent in response to non-ack-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      eliciting packets (#3100, #3104)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Servers have to change connection IDs in Retry (#2837, #3147)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.7.  Since draft-ietf-quic-transport-22</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Rules for preventing correlation by connection ID tightened</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#2084, #2929)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Clarified use of CONNECTION_CLOSE in Handshake packets (#2151,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2541, #2688)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Discourage regressions of largest acknowledged in ACK (#2205,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2752)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Improved robustness of validation process for ECN counts (#2534,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2752)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Require endpoints to ignore spurious migration attempts (#2342,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2893)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Transport parameter for disabling migration clarified to allow NAT</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      rebinding (#2389, #2893)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Document principles for defining new error codes (#2388, #2880)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Reserve transport parameters for greasing (#2550, #2873)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  A maximum ACK delay of 0 is used for handshake packet number</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      spaces (#2646, #2638)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Improved rules for use of congestion control state on new paths</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#2685, #2918)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Removed recommendation to coordinate spin for multiple connections</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      that share a path (#2763, #2882)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Allow smaller stateless resets and recommend a smaller minimum on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      packets that might trigger a stateless reset (#2770, #2869, #2927,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #3007).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Provide guidance around the interface to QUIC as used by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      application protocols (#2805, #2857)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Frames other than STREAM can cause STREAM_LIMIT_ERROR (#2825,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2826)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Tighter rules about processing of rejected 0-RTT packets (#2829,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2840, #2841)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Explanation of the effect of Retry on 0-RTT packets (#2842, #2852)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Cryptographic handshake needs to provide server transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      parameter encryption (#2920, #2921)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Moved ACK generation guidance from recovery draft to transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      draft (#1860, #2916).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.8.  Since draft-ietf-quic-transport-21</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Connection ID lengths are now one octet, but limited in version 1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      to 20 octets of length (#2736, #2749)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.9.  Since draft-ietf-quic-transport-20</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Error codes are encoded as variable-length integers (#2672, #2680)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  NEW_CONNECTION_ID includes a request to retire old connection IDs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#2645, #2769)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Tighter rules for generating and explicitly eliciting ACK frames</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#2546, #2794)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Recommend having only one packet per encryption level in a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      datagram (#2308, #2747)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  More normative language about use of stateless reset (#2471,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2574)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Allow reuse of stateless reset tokens (#2732, #2733)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Allow, but not require, enforcing non-duplicate transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      parameters (#2689, #2691)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Added an active_connection_id_limit transport parameter (#1994,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #1998)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  max_ack_delay transport parameter defaults to 0 (#2638, #2646)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  When sending 0-RTT, only remembered transport parameters apply</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#2458, #2360, #2466, #2461)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Define handshake completion and confirmation; define clearer rules</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      when it encryption keys should be discarded (#2214, #2267, #2673)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Prohibit path migration prior to handshake confirmation (#2309,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2370)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  PATH_RESPONSE no longer needs to be received on the validated path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#2582, #2580, #2579, #2637)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  PATH_RESPONSE frames are not stored and retransmitted (#2724,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2729)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Document hack for enabling routing of ICMP when doing PMTU probing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#1243, #2402)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.10.  Since draft-ietf-quic-transport-19</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Refine discussion of 0-RTT transport parameters (#2467, #2464)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Fewer transport parameters need to be remembered for 0-RTT (#2624,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2467)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Spin bit text incorporated (#2564)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Close the connection when maximum stream ID in MAX_STREAMS exceeds</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      2^62 - 1 (#2499, #2487)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  New connection ID required for intentional migration (#2414,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      #2413)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Connection ID issuance can be rate-limited (#2436, #2428)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  The "QUIC bit" is ignored in Version Negotiation (#2400, #2561)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Initial packets from clients need to be padded to 1200 unless a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Handshake packet is sent as well (#2522, #2523)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  CRYPTO frames can be discarded if too much data is buffered</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#1834, #2524)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Stateless reset uses a short header packet (#2599, #2600)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.11.  Since draft-ietf-quic-transport-18</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Removed version negotiation; version negotiation, including</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      authentication of the result, will be addressed in the next</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      version of QUIC (#1773, #2313)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Added discussion of the use of IPv6 flow labels (#2348, #2399)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  A connection ID can't be retired in a packet that uses that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      connection ID (#2101, #2420)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Idle timeout transport parameter is in milliseconds (from seconds)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (#2453, #2454)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Endpoints are required to use new connection IDs when they use new</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      network paths (#2413, #2414)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Increased the set of permissible frames in 0-RTT (#2344, #2355)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">C.12.  Since draft-ietf-quic-transport-17</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Stream-related errors now use STREAM_STATE_ERROR (#2305)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  Endpoints discard initial keys as soon as handshake keys are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      available (#1951, #2045)</td><td> </td><td class="right">      available (#1951, #2045)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0671"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Expanded conditions for ignoring ICMP packet too big messages</td><td> </td><td class="rblock">   <span class="insert">*</span>  Expanded conditions for ignoring ICMP packet too big messages</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#2108, #2161)</td><td> </td><td class="right">      (#2108, #2161)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0672"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Remove rate control from PATH_CHALLENGE/PATH_RESPONSE (#2129,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Remove rate control from PATH_CHALLENGE/PATH_RESPONSE (#2129,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #2241)</td><td> </td><td class="right">      #2241)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0673"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Endpoints are permitted to discard malformed initial packets</td><td> </td><td class="rblock">   <span class="insert">*</span>  Endpoints are permitted to discard malformed initial packets</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#2141)</td><td> </td><td class="right">      (#2141)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0674"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clarified ECN implementation and usage requirements (#2156, #2201)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clarified ECN implementation and usage requirements (#2156, #2201)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0675"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Disable ECN count verification for packets that arrive out of</td><td> </td><td class="rblock">   <span class="insert">*</span>  Disable ECN count verification for packets that arrive out of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      order (#2198, #2215)</td><td> </td><td class="right">      order (#2198, #2215)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0676"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Use Probe Timeout (PTO) instead of RTO (#2206, #2238)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Use Probe Timeout (PTO) instead of RTO (#2206, #2238)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0677"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Loosen constraints on retransmission of ACK ranges (#2199, #2245)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Loosen constraints on retransmission of ACK ranges (#2199, #2245)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0678"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Limit Retry and Version Negotiation to once per datagram (#2259,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Limit Retry and Version Negotiation to once per datagram (#2259,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #2303)</td><td> </td><td class="right">      #2303)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0679"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Set a maximum value for max_ack_delay transport parameter (#2282,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Set a maximum value for max_ack_delay transport parameter (#2282,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #2301)</td><td> </td><td class="right">      #2301)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0680"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Allow server preferred address for both IPv4 and IPv6 (#2122,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Allow server preferred address for both IPv4 and IPv6 (#2122,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #2296)</td><td> </td><td class="right">      #2296)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0681"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Corrected requirements for migration to a preferred address</td><td> </td><td class="rblock">   <span class="insert">*</span>  Corrected requirements for migration to a preferred address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#2146, #2349)</td><td> </td><td class="right">      (#2146, #2349)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0682"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.2.  Since draft-ietf-quic-transport-16</span></td><td> </td><td class="rblock"><span class="insert">   *  ACK of non-existent packet is illegal (#2298, #2302)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0683"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  Stream limits are defined as counts, not maximums (#1850, #1906)</span></td><td> </td><td class="rblock"><span class="insert">C.13.  Since draft-ietf-quic-transport-16</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0684"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Require amplification attack defense after closing (#1905, #1911</span>)</td><td> </td><td class="rblock">   <span class="insert">*  Stream limits are defined as counts, not maximums (#1850, #1906</span>)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0685"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Remove reservation of application error code 0 for STOPPING</td><td> </td><td class="rblock">   <span class="insert">*  Require amplification attack defense after closing (#1905, #1911)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  Remove reservation of application error code 0 for STOPPING</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#1804, #1922)</td><td> </td><td class="right">      (#1804, #1922)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0686"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Renumbered frames (#1945)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Renumbered frames (#1945)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0687"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Renumbered transport parameters (#1946)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Renumbered transport parameters (#1946)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0688"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Numeric transport parameters are expressed as varints (#1608,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Numeric transport parameters are expressed as varints (#1608,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #1947, #1955)</td><td> </td><td class="right">      #1947, #1955)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0689"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Reorder the NEW_CONNECTION_ID frame (#1952, #1963)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Reorder the NEW_CONNECTION_ID frame (#1952, #1963)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Rework the first byte (#2006)</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0690"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">   *  Fix the 0x40 bit</span></td><td> </td><td class="rblock">   <span class="insert">*  Rework the first byte (#2006)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0691"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*  Change type values for long header</span></td><td> </td><td class="rblock">      <span class="insert">-  Fix the 0x40 bit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0692"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*  Add spin bit to short header (#631, #1988)</span></td><td> </td><td class="rblock">      <span class="insert">-  Change type values for long header</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0693"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*  Encrypt the remainder of the first byte (#1322</span>)</td><td> </td><td class="rblock">      <span class="insert">-  Add spin bit to short header (#631, #1988</span>)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0694"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*  Move packet number length to first byte</span></td><td> </td><td class="rblock">      <span class="insert">-  Encrypt the remainder of the first byte (#1322)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0695"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*  Move ODCIL to first byte of retry packets</span></td><td> </td><td class="rblock">      <span class="insert">-  Move packet number length to first byte</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0696"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*  Simplify packet number protection (#1575)</span></td><td> </td><td class="rblock">      <span class="insert">-  Move ODCIL to first byte of retry packets</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0697"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Allow STOP_SENDING to open a remote bidirectional stream (#1797,</td><td> </td><td class="rblock">      <span class="insert">-  Simplify packet number protection (#1575)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  Allow STOP_SENDING to open a remote bidirectional stream (#1797,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #2013)</td><td> </td><td class="right">      #2013)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0698"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Added mitigation for off-path migration attacks (#1278, #1749,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Added mitigation for off-path migration attacks (#1278, #1749,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #2033)</td><td> </td><td class="right">      #2033)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0699"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Don't let the PMTU to drop below 1280 (#2063, #2069)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Don't let the PMTU to drop below 1280 (#2063, #2069)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Require peers to replace retired connection IDs (#2085)</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0700"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Servers are required to ignore Version Negotiation packets (#2088)</td><td> </td><td class="rblock">   <span class="insert">*  Require peers to replace retired connection IDs (#2085)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  Servers are required to ignore Version Negotiation packets (#2088)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0701"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Tokens are repeated in all Initial packets (#2089)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Tokens are repeated in all Initial packets (#2089)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0702"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clarified how PING frames are sent after loss (#2094)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clarified how PING frames are sent after loss (#2094)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0703"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Initial keys are discarded once Handshake are available (#1951,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Initial keys are discarded once Handshake are available (#1951,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #2045)</td><td> </td><td class="right">      #2045)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0704"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  ICMP PTB validation clarifications (#2161, #2109, #2108)</td><td> </td><td class="rblock">   <span class="insert">*</span>  ICMP PTB validation clarifications (#2161, #2109, #2108)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0705"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.3</span>.  Since draft-ietf-quic-transport-15</td><td> </td><td class="rblock"><span class="insert">C.14</span>.  Since draft-ietf-quic-transport-15</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Substantial editorial reorganization; no technical changes.</td><td> </td><td class="right">   Substantial editorial reorganization; no technical changes.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0706"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.4</span>.  Since draft-ietf-quic-transport-14</td><td> </td><td class="rblock"><span class="insert">C.15</span>.  Since draft-ietf-quic-transport-14</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0707"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Merge ACK and ACK_ECN (#1778, #1801)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Merge ACK and ACK_ECN (#1778, #1801)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0708"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Explicitly communicate max_ack_delay (#981, #1781)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Explicitly communicate max_ack_delay (#981, #1781)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Validate original connection ID after Retry packets (#1710, #1486,</td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">*</span>  Validate original connection ID after Retry packets (#1710, #1486,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #1793)</td><td> </td><td class="right">      #1793)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0709"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Idle timeout is optional and has no specified maximum (#1765)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Idle timeout is optional and has no specified maximum (#1765)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0710"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Update connection ID handling; add RETIRE_CONNECTION_ID type</td><td> </td><td class="rblock">   <span class="insert">*</span>  Update connection ID handling; add RETIRE_CONNECTION_ID type</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#1464, #1468, #1483, #1484, #1486, #1495, #1729, #1742, #1799,</td><td> </td><td class="right">      (#1464, #1468, #1483, #1484, #1486, #1495, #1729, #1742, #1799,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #1821)</td><td> </td><td class="right">      #1821)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0711"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Include a Token in all Initial packets (#1649, #1794)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Include a Token in all Initial packets (#1649, #1794)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0712"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Prevent handshake deadlock (#1764, #1824)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Prevent handshake deadlock (#1764, #1824)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0713"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.5</span>.  Since draft-ietf-quic-transport-13</td><td> </td><td class="rblock"><span class="insert">C.16</span>.  Since draft-ietf-quic-transport-13</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0714"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Streams open when higher-numbered streams of the same type open</td><td> </td><td class="rblock">   <span class="insert">*</span>  Streams open when higher-numbered streams of the same type open</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#1342, #1549)</td><td> </td><td class="right">      (#1342, #1549)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0715"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Split initial stream flow control limit into 3 transport</td><td> </td><td class="rblock">   <span class="insert">*</span>  Split initial stream flow control limit into 3 transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      parameters (#1016, #1542)</td><td> </td><td class="right">      parameters (#1016, #1542)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0716"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  All flow control transport parameters are optional (#1610)</td><td> </td><td class="rblock">   <span class="insert">*</span>  All flow control transport parameters are optional (#1610)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Removed UNSOLICITED_PATH_RESPONSE error code (#1265, #1539)</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0717"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Permit stateless reset in response to any packet (#1348, #1553</span>)</td><td> </td><td class="rblock">   <span class="insert">*  Removed UNSOLICITED_PATH_RESPONSE error code (#1265, #1539</span>)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0718"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Recommended defense against stateless reset spoofing (#1386,</td><td> </td><td class="rblock">   <span class="insert">*  Permit stateless reset in response to any packet (#1348, #1553)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  Recommended defense against stateless reset spoofing (#1386,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #1554)</td><td> </td><td class="right">      #1554)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0719"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Prevent infinite stateless reset exchanges (#1443, #1627)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Prevent infinite stateless reset exchanges (#1443, #1627)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0720"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Forbid processing of the same packet number twice (#1405, #1624)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Forbid processing of the same packet number twice (#1405, #1624)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0721"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Added a packet number decoding example (#1493)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Added a packet number decoding example (#1493)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0722"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  More precisely define idle timeout (#1429, #1614, #1652)</td><td> </td><td class="rblock">   <span class="insert">*</span>  More precisely define idle timeout (#1429, #1614, #1652)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0723"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Corrected format of Retry packet and prevented looping (#1492,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Corrected format of Retry packet and prevented looping (#1492,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #1451, #1448, #1498)</td><td> </td><td class="right">      #1451, #1448, #1498)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0724"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Permit 0-RTT after receiving Version Negotiation or Retry (#1507,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Permit 0-RTT after receiving Version Negotiation or Retry (#1507,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #1514, #1621)</td><td> </td><td class="right">      #1514, #1621)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0725"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Permit Retry in response to 0-RTT (#1547, #1552)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Permit Retry in response to 0-RTT (#1547, #1552)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0726"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Looser verification of ECN counters to account for ACK loss</td><td> </td><td class="rblock">   <span class="insert">*</span>  Looser verification of ECN counters to account for ACK loss</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#1555, #1481, #1565)</td><td> </td><td class="right">      (#1555, #1481, #1565)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0727"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Remove frame type field from APPLICATION_CLOSE (#1508, #1528)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Remove frame type field from APPLICATION_CLOSE (#1508, #1528)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0728"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.6</span>.  Since draft-ietf-quic-transport-12</td><td> </td><td class="rblock"><span class="insert">C.17</span>.  Since draft-ietf-quic-transport-12</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0729"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Changes to integration of the TLS handshake (#829, #1018, #1094,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Changes to integration of the TLS handshake (#829, #1018, #1094,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #1165, #1190, #1233, #1242, #1252, #1450, #1458)</td><td> </td><td class="right">      #1165, #1190, #1233, #1242, #1252, #1450, #1458)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0730"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  The cryptographic handshake uses CRYPTO frames, not stream 0</td><td> </td><td class="rblock">      <span class="insert">-</span>  The cryptographic handshake uses CRYPTO frames, not stream 0</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0731"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  QUIC packet protection is used in place of TLS record</td><td> </td><td class="rblock">      <span class="insert">-</span>  QUIC packet protection is used in place of TLS record</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         protection</td><td> </td><td class="right">         protection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0732"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Separate QUIC packet number spaces are used for the handshake</td><td> </td><td class="rblock">      <span class="insert">-</span>  Separate QUIC packet number spaces are used for the handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0733"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Changed Retry to be independent of the cryptographic handshake</td><td> </td><td class="rblock">      <span class="insert">-</span>  Changed Retry to be independent of the cryptographic handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0734"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Added NEW_TOKEN frame and Token fields to Initial packet</td><td> </td><td class="rblock">      <span class="insert">-</span>  Added NEW_TOKEN frame and Token fields to Initial packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0735"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Limit the use of HelloRetryRequest to address TLS needs (like</td><td> </td><td class="rblock">      <span class="insert">-</span>  Limit the use of HelloRetryRequest to address TLS needs (like</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         key shares)</td><td> </td><td class="right">         key shares)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0736"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Enable server to transition connections to a preferred address</td><td> </td><td class="rblock">   <span class="insert">*</span>  Enable server to transition connections to a preferred address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#560, #1251, #1373)</td><td> </td><td class="right">      (#560, #1251, #1373)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0737"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Added ECN feedback mechanisms and handling; new ACK_ECN frame</td><td> </td><td class="rblock">   <span class="insert">*</span>  Added ECN feedback mechanisms and handling; new ACK_ECN frame</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#804, #805, #1372)</td><td> </td><td class="right">      (#804, #805, #1372)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0738"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Changed rules and recommendations for use of new connection IDs</td><td> </td><td class="rblock">   <span class="insert">*</span>  Changed rules and recommendations for use of new connection IDs</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#1258, #1264, #1276, #1280, #1419, #1452, #1453, #1465)</td><td> </td><td class="right">      (#1258, #1264, #1276, #1280, #1419, #1452, #1453, #1465)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0739"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Added a transport parameter to disable intentional connection</td><td> </td><td class="rblock">   <span class="insert">*</span>  Added a transport parameter to disable intentional connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      migration (#1271, #1447)</td><td> </td><td class="right">      migration (#1271, #1447)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0740"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Packets from different connection ID can't be coalesced (#1287,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Packets from different connection ID can't be coalesced (#1287,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #1423)</td><td> </td><td class="right">      #1423)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0741"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Fixed sampling method for packet number encryption; the length</td><td> </td><td class="rblock">   <span class="insert">*</span>  Fixed sampling method for packet number encryption; the length</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      field in long headers includes the packet number field in addition</td><td> </td><td class="right">      field in long headers includes the packet number field in addition</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      to the packet payload (#1387, #1389)</td><td> </td><td class="right">      to the packet payload (#1387, #1389)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0742"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Stateless Reset is now symmetric and subject to size constraints</td><td> </td><td class="rblock">   <span class="insert">*</span>  Stateless Reset is now symmetric and subject to size constraints</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#466, #1346)</td><td> </td><td class="right">      (#466, #1346)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0743"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Added frame type extension mechanism (#58, #1473)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Added frame type extension mechanism (#58, #1473)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0744"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.7</span>.  Since draft-ietf-quic-transport-11</td><td> </td><td class="rblock"><span class="insert">C.18</span>.  Since draft-ietf-quic-transport-11</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0745"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Enable server to transition connections to a preferred address</td><td> </td><td class="rblock">   <span class="insert">*</span>  Enable server to transition connections to a preferred address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#560, #1251)</td><td> </td><td class="right">      (#560, #1251)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0746"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Packet numbers are encrypted (#1174, #1043, #1048, #1034, #850,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Packet numbers are encrypted (#1174, #1043, #1048, #1034, #850,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #990, #734, #1317, #1267, #1079)</td><td> </td><td class="right">      #990, #734, #1317, #1267, #1079)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0747"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Packet numbers use a variable-length encoding (#989, #1334)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Packet numbers use a variable-length encoding (#989, #1334)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0748"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  STREAM frames can now be empty (#1350)</td><td> </td><td class="rblock">   <span class="insert">*</span>  STREAM frames can now be empty (#1350)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0749"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.8</span>.  Since draft-ietf-quic-transport-10</td><td> </td><td class="rblock"><span class="insert">C.19</span>.  Since draft-ietf-quic-transport-10</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0750"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Swap payload length and packed number fields in long header</td><td> </td><td class="rblock">   <span class="insert">*</span>  Swap payload length and packed number fields in long header</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#1294)</td><td> </td><td class="right">      (#1294)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0751"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clarified that CONNECTION_CLOSE is allowed in Handshake packet</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clarified that CONNECTION_CLOSE is allowed in Handshake packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#1274)</td><td> </td><td class="right">      (#1274)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0752"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Spin bit reserved (#1283)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Spin bit reserved (#1283)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Coalescing multiple QUIC packets in a UDP datagram (#1262, #1285)</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0753"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  A more complete connection migration (#1249</span>)</td><td> </td><td class="rblock">   <span class="insert">*  Coalescing multiple QUIC packets in a UDP datagram (#1262, #1285</span>)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0754"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Refine opportunistic ACK defense text (#305, #1030, #1185</span>)</td><td> </td><td class="rblock">   <span class="insert">*  A more complete connection migration (#1249</span>)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0755"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  A Stateless Reset Token isn't mandatory (#818, #1191</span>)</td><td> </td><td class="rblock">   <span class="insert">*  Refine opportunistic ACK defense text (#305, #1030, #1185</span>)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0756"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Removed implicit stream opening (#896, #1193)</td><td> </td><td class="rblock">   <span class="insert">*  A Stateless Reset Token isn't mandatory (#818, #1191)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  Removed implicit stream opening (#896, #1193)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0757"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  An empty STREAM frame can be used to open a stream without sending</td><td> </td><td class="rblock">   <span class="insert">*</span>  An empty STREAM frame can be used to open a stream without sending</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      data (#901, #1194)</td><td> </td><td class="right">      data (#901, #1194)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0758"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Define stream counts in transport parameters rather than a maximum</td><td> </td><td class="rblock">   <span class="insert">*</span>  Define stream counts in transport parameters rather than a maximum</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      stream ID (#1023, #1065)</td><td> </td><td class="right">      stream ID (#1023, #1065)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0759"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  STOP_SENDING is now prohibited before streams are used (#1050)</td><td> </td><td class="rblock">   <span class="insert">*</span>  STOP_SENDING is now prohibited before streams are used (#1050)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0760"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Recommend including ACK in Retry packets and allow PADDING (#1067,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Recommend including ACK in Retry packets and allow PADDING (#1067,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #882)</td><td> </td><td class="right">      #882)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0761"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Endpoints now become closing after an idle timeout (#1178, #1179)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Endpoints now become closing after an idle timeout (#1178, #1179)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0762"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Remove implication that Version Negotiation is sent when a packet</td><td> </td><td class="rblock">   <span class="insert">*</span>  Remove implication that Version Negotiation is sent when a packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      of the wrong version is received (#1197)</td><td> </td><td class="right">      of the wrong version is received (#1197)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0763"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.9</span>.  Since draft-ietf-quic-transport-09</td><td> </td><td class="rblock"><span class="insert">C.20</span>.  Since draft-ietf-quic-transport-09</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0764"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Added PATH_CHALLENGE and PATH_RESPONSE frames to replace PING with</td><td> </td><td class="rblock">   <span class="insert">*</span>  Added PATH_CHALLENGE and PATH_RESPONSE frames to replace PING with</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Data and PONG frame.  Changed ACK frame type from 0x0e to 0x0d.</td><td> </td><td class="right">      Data and PONG frame.  Changed ACK frame type from 0x0e to 0x0d.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#1091, #725, #1086)</td><td> </td><td class="right">      (#1091, #725, #1086)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0765"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  A server can now only send 3 packets without validating the client</td><td> </td><td class="rblock">   <span class="insert">*</span>  A server can now only send 3 packets without validating the client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      address (#38, #1090)</td><td> </td><td class="right">      address (#38, #1090)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0766"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Delivery order of stream data is no longer strongly specified</td><td> </td><td class="rblock">   <span class="insert">*</span>  Delivery order of stream data is no longer strongly specified</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#252, #1070)</td><td> </td><td class="right">      (#252, #1070)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0767"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Rework of packet handling and version negotiation (#1038)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Rework of packet handling and version negotiation (#1038)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0768"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Stream 0 is now exempt from flow control until the handshake</td><td> </td><td class="rblock">   <span class="insert">*</span>  Stream 0 is now exempt from flow control until the handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      completes (#1074, #725, #825, #1082)</td><td> </td><td class="right">      completes (#1074, #725, #825, #1082)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0769"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Improved retransmission rules for all frame types: information is</td><td> </td><td class="rblock">   <span class="insert">*</span>  Improved retransmission rules for all frame types: information is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      retransmitted, not packets or frames (#463, #765, #1095, #1053)</td><td> </td><td class="right">      retransmitted, not packets or frames (#463, #765, #1095, #1053)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0770"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Added an error code for server busy signals (#1137)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Added an error code for server busy signals (#1137)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0771"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Endpoints now set the connection ID that their peer uses.</td><td> </td><td class="rblock">   <span class="insert">*</span>  Endpoints now set the connection ID that their peer uses.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Connection IDs are variable length.  Removed the</td><td> </td><td class="right">      Connection IDs are variable length.  Removed the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      omit_connection_id transport parameter and the corresponding short</td><td> </td><td class="right">      omit_connection_id transport parameter and the corresponding short</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      header flag. (#1089, #1052, #1146, #821, #745, #821, #1166, #1151)</td><td> </td><td class="right">      header flag. (#1089, #1052, #1146, #821, #745, #821, #1166, #1151)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0772"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.10</span>.  Since draft-ietf-quic-transport-08</td><td> </td><td class="rblock"><span class="insert">C.21</span>.  Since draft-ietf-quic-transport-08</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0773"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clarified requirements for BLOCKED usage (#65, #924)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clarified requirements for BLOCKED usage (#65, #924)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0774"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  BLOCKED frame now includes reason for blocking (#452, #924, #927,</td><td> </td><td class="rblock">   <span class="insert">*</span>  BLOCKED frame now includes reason for blocking (#452, #924, #927,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #928)</td><td> </td><td class="right">      #928)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0775"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  GAP limitation in ACK Frame (#613)</td><td> </td><td class="rblock">   <span class="insert">*</span>  GAP limitation in ACK Frame (#613)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0776"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Improved PMTUD description (#614, #1036)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Improved PMTUD description (#614, #1036)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0777"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clarified stream state machine (#634, #662, #743, #894)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clarified stream state machine (#634, #662, #743, #894)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0778"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Reserved versions don't need to be generated deterministically</td><td> </td><td class="rblock">   <span class="insert">*</span>  Reserved versions don't need to be generated deterministically</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#831, #931)</td><td> </td><td class="right">      (#831, #931)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0779"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  You don't always need the draining period (#871)</td><td> </td><td class="rblock">   <span class="insert">*</span>  You don't always need the draining period (#871)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0780"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Stateless reset clarified as version-specific (#930, #986)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Stateless reset clarified as version-specific (#930, #986)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  initial_max_stream_id_x transport parameters are optional (#970,</td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">*</span>  initial_max_stream_id_x transport parameters are optional (#970,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #971)</td><td> </td><td class="right">      #971)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0781"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Ack Delay assumes a default value during the handshake (#1007,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Ack Delay assumes a default value during the handshake (#1007,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #1009)</td><td> </td><td class="right">      #1009)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0782"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Removed transport parameters from NewSessionTicket (#1015)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Removed transport parameters from NewSessionTicket (#1015)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0783"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.11</span>.  Since draft-ietf-quic-transport-07</td><td> </td><td class="rblock"><span class="insert">C.22</span>.  Since draft-ietf-quic-transport-07</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0784"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The long header now has version before packet number (#926, #939)</td><td> </td><td class="rblock">   <span class="insert">*</span>  The long header now has version before packet number (#926, #939)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0785"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Rename and consolidate packet types (#846, #822, #847)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Rename and consolidate packet types (#846, #822, #847)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0786"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Packet types are assigned new codepoints and the Connection ID</td><td> </td><td class="rblock">   <span class="insert">*</span>  Packet types are assigned new codepoints and the Connection ID</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Flag is inverted (#426, #956)</td><td> </td><td class="right">      Flag is inverted (#426, #956)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0787"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Removed type for Version Negotiation and use Version 0 (#963,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Removed type for Version Negotiation and use Version 0 (#963,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #968)</td><td> </td><td class="right">      #968)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0788"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Streams are split into unidirectional and bidirectional (#643,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Streams are split into unidirectional and bidirectional (#643,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #656, #720, #872, #175, #885)</td><td> </td><td class="right">      #656, #720, #872, #175, #885)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0789"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Stream limits now have separate uni- and bi-directional</td><td> </td><td class="rblock">      <span class="insert">-</span>  Stream limits now have separate uni- and bi-directional</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         transport parameters (#909, #958)</td><td> </td><td class="right">         transport parameters (#909, #958)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0790"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Stream limit transport parameters are now optional and default</td><td> </td><td class="rblock">      <span class="insert">-</span>  Stream limit transport parameters are now optional and default</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         to 0 (#970, #971)</td><td> </td><td class="right">         to 0 (#970, #971)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0791"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The stream state machine has been split into read and write (#634,</td><td> </td><td class="rblock">   <span class="insert">*</span>  The stream state machine has been split into read and write (#634,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #894)</td><td> </td><td class="right">      #894)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0792"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Employ variable-length integer encodings throughout (#595)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Employ variable-length integer encodings throughout (#595)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0793"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Improvements to connection close</td><td> </td><td class="rblock">   <span class="insert">*</span>  Improvements to connection close</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0794"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Added distinct closing and draining states (#899, #871)</td><td> </td><td class="rblock">      <span class="insert">-</span>  Added distinct closing and draining states (#899, #871)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0795"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Draining period can terminate early (#869, #870)</td><td> </td><td class="rblock">      <span class="insert">-</span>  Draining period can terminate early (#869, #870)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0796"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Clarifications about stateless reset (#889, #890)</td><td> </td><td class="rblock">      <span class="insert">-</span>  Clarifications about stateless reset (#889, #890)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0797"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Address validation for connection migration (#161, #732, #878)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Address validation for connection migration (#161, #732, #878)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0798"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clearly defined retransmission rules for BLOCKED (#452, #65, #924)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clearly defined retransmission rules for BLOCKED (#452, #65, #924)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0799"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  negotiated_version is sent in server transport parameters (#710,</td><td> </td><td class="rblock">   <span class="insert">*</span>  negotiated_version is sent in server transport parameters (#710,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #959)</td><td> </td><td class="right">      #959)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0800"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Increased the range over which packet numbers are randomized</td><td> </td><td class="rblock">   <span class="insert">*</span>  Increased the range over which packet numbers are randomized</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#864, #850, #964)</td><td> </td><td class="right">      (#864, #850, #964)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0801"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.12</span>.  Since draft-ietf-quic-transport-06</td><td> </td><td class="rblock"><span class="insert">C.23</span>.  Since draft-ietf-quic-transport-06</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0802"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Replaced FNV-1a with AES-GCM for all "Cleartext" packets (#554)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Replaced FNV-1a with AES-GCM for all "Cleartext" packets (#554)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0803"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Split error code space between application and transport (#485)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Split error code space between application and transport (#485)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0804"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Stateless reset token moved to end (#820)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Stateless reset token moved to end (#820)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0805"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  1-RTT-protected long header types removed (#848)</td><td> </td><td class="rblock">   <span class="insert">*</span>  1-RTT-protected long header types removed (#848)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0806"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  No acknowledgments during draining period (#852)</td><td> </td><td class="rblock">   <span class="insert">*</span>  No acknowledgments during draining period (#852)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0807"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Remove "application close" as a separate close type (#854)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Remove "application close" as a separate close type (#854)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0808"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Remove timestamps from the ACK frame (#841)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Remove timestamps from the ACK frame (#841)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0809"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Require transport parameters to only appear once (#792)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Require transport parameters to only appear once (#792)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0810"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.13</span>.  Since draft-ietf-quic-transport-05</td><td> </td><td class="rblock"><span class="insert">C.24</span>.  Since draft-ietf-quic-transport-05</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0811"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Stateless token is server-only (#726)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Stateless token is server-only (#726)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0812"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Refactor section on connection termination (#733, #748, #328,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Refactor section on connection termination (#733, #748, #328,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #177)</td><td> </td><td class="right">      #177)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0813"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Limit size of Version Negotiation packet (#585)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Limit size of Version Negotiation packet (#585)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0814"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clarify when and what to ack (#736)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clarify when and what to ack (#736)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0815"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Renamed STREAM_ID_NEEDED to STREAM_ID_BLOCKED</td><td> </td><td class="rblock">   <span class="insert">*</span>  Renamed STREAM_ID_NEEDED to STREAM_ID_BLOCKED</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0816"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clarify Keep-alive requirements (#729)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clarify Keep-alive requirements (#729)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0817"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.14</span>.  Since draft-ietf-quic-transport-04</td><td> </td><td class="rblock"><span class="insert">C.25</span>.  Since draft-ietf-quic-transport-04</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0818"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Introduce STOP_SENDING frame, RESET_STREAM only resets in one</td><td> </td><td class="rblock">   <span class="insert">*</span>  Introduce STOP_SENDING frame, RESET_STREAM only resets in one</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      direction (#165)</td><td> </td><td class="right">      direction (#165)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0819"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Removed GOAWAY; application protocols are responsible for graceful</td><td> </td><td class="rblock">   <span class="insert">*</span>  Removed GOAWAY; application protocols are responsible for graceful</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      shutdown (#696)</td><td> </td><td class="right">      shutdown (#696)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0820"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Reduced the number of error codes (#96, #177, #184, #211)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Reduced the number of error codes (#96, #177, #184, #211)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0821"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Version validation fields can't move or change (#121)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Version validation fields can't move or change (#121)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Removed versions from the transport parameters in a</td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">*</span>  Removed versions from the transport parameters in a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      NewSessionTicket message (#547)</td><td> </td><td class="right">      NewSessionTicket message (#547)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0822"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clarify the meaning of "bytes in flight" (#550)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clarify the meaning of "bytes in flight" (#550)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0823"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Public reset is now stateless reset and not visible to the path</td><td> </td><td class="rblock">   <span class="insert">*</span>  Public reset is now stateless reset and not visible to the path</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#215)</td><td> </td><td class="right">      (#215)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0824"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Reordered bits and fields in STREAM frame (#620)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Reordered bits and fields in STREAM frame (#620)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0825"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clarifications to the stream state machine (#572, #571)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clarifications to the stream state machine (#572, #571)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0826"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Increased the maximum length of the Largest Acknowledged field in</td><td> </td><td class="rblock">   <span class="insert">*</span>  Increased the maximum length of the Largest Acknowledged field in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      ACK frames to 64 bits (#629)</td><td> </td><td class="right">      ACK frames to 64 bits (#629)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0827"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  truncate_connection_id is renamed to omit_connection_id (#659)</td><td> </td><td class="rblock">   <span class="insert">*</span>  truncate_connection_id is renamed to omit_connection_id (#659)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0828"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  CONNECTION_CLOSE terminates the connection like TCP RST (#330,</td><td> </td><td class="rblock">   <span class="insert">*</span>  CONNECTION_CLOSE terminates the connection like TCP RST (#330,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #328)</td><td> </td><td class="right">      #328)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0829"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Update labels used in HKDF-Expand-Label to match TLS 1.3 (#642)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Update labels used in HKDF-Expand-Label to match TLS 1.3 (#642)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0830"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.15</span>.  Since draft-ietf-quic-transport-03</td><td> </td><td class="rblock"><span class="insert">C.26</span>.  Since draft-ietf-quic-transport-03</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0831"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Change STREAM and RESET_STREAM layout</td><td> </td><td class="rblock">   <span class="insert">*</span>  Change STREAM and RESET_STREAM layout</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0832"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Add MAX_STREAM_ID settings</td><td> </td><td class="rblock">   <span class="insert">*</span>  Add MAX_STREAM_ID settings</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0833"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.16</span>.  Since draft-ietf-quic-transport-02</td><td> </td><td class="rblock"><span class="insert">C.27</span>.  Since draft-ietf-quic-transport-02</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0834"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The size of the initial packet payload has a fixed minimum (#267,</td><td> </td><td class="rblock">   <span class="insert">*</span>  The size of the initial packet payload has a fixed minimum (#267,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #472)</td><td> </td><td class="right">      #472)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0835"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Define when Version Negotiation packets are ignored (#284, #294,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Define when Version Negotiation packets are ignored (#284, #294,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #241, #143, #474)</td><td> </td><td class="right">      #241, #143, #474)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0836"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The 64-bit FNV-1a algorithm is used for integrity protection of</td><td> </td><td class="rblock">   <span class="insert">*</span>  The 64-bit FNV-1a algorithm is used for integrity protection of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      unprotected packets (#167, #480, #481, #517)</td><td> </td><td class="right">      unprotected packets (#167, #480, #481, #517)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0837"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Rework initial packet types to change how the connection ID is</td><td> </td><td class="rblock">   <span class="insert">*</span>  Rework initial packet types to change how the connection ID is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      chosen (#482, #442, #493)</td><td> </td><td class="right">      chosen (#482, #442, #493)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0838"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  No timestamps are forbidden in unprotected packets (#542, #429)</td><td> </td><td class="rblock">   <span class="insert">*</span>  No timestamps are forbidden in unprotected packets (#542, #429)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0839"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Cryptographic handshake is now on stream 0 (#456)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Cryptographic handshake is now on stream 0 (#456)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0840"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Remove congestion control exemption for cryptographic handshake</td><td> </td><td class="rblock">   <span class="insert">*</span>  Remove congestion control exemption for cryptographic handshake</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#248, #476)</td><td> </td><td class="right">      (#248, #476)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0841"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Version 1 of QUIC uses TLS; a new version is needed to use a</td><td> </td><td class="rblock">   <span class="insert">*</span>  Version 1 of QUIC uses TLS; a new version is needed to use a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      different handshake protocol (#516)</td><td> </td><td class="right">      different handshake protocol (#516)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0842"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  STREAM frames have a reduced number of offset lengths (#543, #430)</td><td> </td><td class="rblock">   <span class="insert">*</span>  STREAM frames have a reduced number of offset lengths (#543, #430)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0843"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Split some frames into separate connection- and stream- level</td><td> </td><td class="rblock">   <span class="insert">*</span>  Split some frames into separate connection- and stream- level</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      frames (#443)</td><td> </td><td class="right">      frames (#443)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0844"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  WINDOW_UPDATE split into MAX_DATA and MAX_STREAM_DATA (#450)</td><td> </td><td class="rblock">      <span class="insert">-</span>  WINDOW_UPDATE split into MAX_DATA and MAX_STREAM_DATA (#450)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0845"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  BLOCKED split to match WINDOW_UPDATE split (#454)</td><td> </td><td class="rblock">      <span class="insert">-</span>  BLOCKED split to match WINDOW_UPDATE split (#454)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0846"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  Define STREAM_ID_NEEDED frame (#455)</td><td> </td><td class="rblock">      <span class="insert">-</span>  Define STREAM_ID_NEEDED frame (#455)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0847"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  A NEW_CONNECTION_ID frame supports connection migration without</td><td> </td><td class="rblock">   <span class="insert">*</span>  A NEW_CONNECTION_ID frame supports connection migration without</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      linkability (#232, #491, #496)</td><td> </td><td class="right">      linkability (#232, #491, #496)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0848"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Transport parameters for 0-RTT are retained from a previous</td><td> </td><td class="rblock">   <span class="insert">*</span>  Transport parameters for 0-RTT are retained from a previous</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      connection (#405, #513, #512)</td><td> </td><td class="right">      connection (#405, #513, #512)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0849"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">*</span>  A client in 0-RTT no longer required to reset excess streams</td><td> </td><td class="rblock">      <span class="insert">-</span>  A client in 0-RTT no longer required to reset excess streams</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">         (#425, #479)</td><td> </td><td class="right">         (#425, #479)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0850"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Expanded security considerations (#440, #444, #445, #448)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Expanded security considerations (#440, #444, #445, #448)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.17.  Since draft-ietf-quic-transport-01</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0851"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Defined short and long packet headers (#40, #148, #361)</td><td> </td><td class="rblock"><span class="insert">C.28.  Since draft-ietf-quic-transport-01</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  Defined short and long packet headers (#40, #148, #361)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0852"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Defined a versioning scheme and stable fields (#51, #361)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Defined a versioning scheme and stable fields (#51, #361)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0853"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Define reserved version values for "greasing" negotiation (#112,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Define reserved version values for "greasing" negotiation (#112,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #278)</td><td> </td><td class="right">      #278)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0854"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The initial packet number is randomized (#35, #283)</td><td> </td><td class="rblock">   <span class="insert">*</span>  The initial packet number is randomized (#35, #283)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0855"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Narrow the packet number encoding range requirement (#67, #286,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Narrow the packet number encoding range requirement (#67, #286,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #299, #323, #356)</td><td> </td><td class="right">      #299, #323, #356)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0856"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Defined client address validation (#52, #118, #120, #275)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Defined client address validation (#52, #118, #120, #275)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0857"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Define transport parameters as a TLS extension (#49, #122)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Define transport parameters as a TLS extension (#49, #122)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0858"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  SCUP and COPT parameters are no longer valid (#116, #117)</td><td> </td><td class="rblock">   <span class="insert">*</span>  SCUP and COPT parameters are no longer valid (#116, #117)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0859"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Transport parameters for 0-RTT are either remembered from before,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Transport parameters for 0-RTT are either remembered from before,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      or assume default values (#126)</td><td> </td><td class="right">      or assume default values (#126)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0860"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The server chooses connection IDs in its final flight (#119, #349,</td><td> </td><td class="rblock">   <span class="insert">*</span>  The server chooses connection IDs in its final flight (#119, #349,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #361)</td><td> </td><td class="right">      #361)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0861"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The server echoes the Connection ID and packet number fields when</td><td> </td><td class="rblock">   <span class="insert">*</span>  The server echoes the Connection ID and packet number fields when</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      sending a Version Negotiation packet (#133, #295, #244)</td><td> </td><td class="right">      sending a Version Negotiation packet (#133, #295, #244)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0862"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Defined a minimum packet size for the initial handshake packet</td><td> </td><td class="rblock">   <span class="insert">*</span>  Defined a minimum packet size for the initial handshake packet</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      from the client (#69, #136, #139, #164)</td><td> </td><td class="right">      from the client (#69, #136, #139, #164)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0863"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Path MTU Discovery (#64, #106)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Path MTU Discovery (#64, #106)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0864"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  The initial handshake packet from the client needs to fit in a</td><td> </td><td class="rblock">   <span class="insert">*</span>  The initial handshake packet from the client needs to fit in a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      single packet (#338)</td><td> </td><td class="right">      single packet (#338)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0865"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Forbid acknowledgment of packets containing only ACK and PADDING</td><td> </td><td class="rblock">   <span class="insert">*</span>  Forbid acknowledgment of packets containing only ACK and PADDING</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#291)</td><td> </td><td class="right">      (#291)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0866"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Require that frames are processed when packets are acknowledged</td><td> </td><td class="rblock">   <span class="insert">*</span>  Require that frames are processed when packets are acknowledged</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#381, #341)</td><td> </td><td class="right">      (#381, #341)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0867"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Removed the STOP_WAITING frame (#66)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Removed the STOP_WAITING frame (#66)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0868"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Don't require retransmission of old timestamps for lost ACK frames</td><td> </td><td class="rblock">   <span class="insert">*</span>  Don't require retransmission of old timestamps for lost ACK frames</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#308)</td><td> </td><td class="right">      (#308)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0869"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Clarified that frames are not retransmitted, but the information</td><td> </td><td class="rblock">   <span class="insert">*</span>  Clarified that frames are not retransmitted, but the information</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      in them can be (#157, #298)</td><td> </td><td class="right">      in them can be (#157, #298)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0870"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Error handling definitions (#335)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Error handling definitions (#335)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0871"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Split error codes into four sections (#74)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Split error codes into four sections (#74)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0872"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Forbid the use of Public Reset where CONNECTION_CLOSE is possible</td><td> </td><td class="rblock">   <span class="insert">*</span>  Forbid the use of Public Reset where CONNECTION_CLOSE is possible</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#289)</td><td> </td><td class="right">      (#289)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0873"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Define packet protection rules (#336)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Define packet protection rules (#336)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0874"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Require that stream be entirely delivered or reset, including</td><td> </td><td class="rblock">   <span class="insert">*</span>  Require that stream be entirely delivered or reset, including</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      acknowledgment of all STREAM frames or the RESET_STREAM, before it</td><td> </td><td class="right">      acknowledgment of all STREAM frames or the RESET_STREAM, before it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      closes (#381)</td><td> </td><td class="right">      closes (#381)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0875"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Remove stream reservation from state machine (#174, #280)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Remove stream reservation from state machine (#174, #280)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0876"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Only stream 1 does not contribute to connection-level flow control</td><td> </td><td class="rblock">   <span class="insert">*</span>  Only stream 1 does not contribute to connection-level flow control</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#204)</td><td> </td><td class="right">      (#204)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0877"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Stream 1 counts towards the maximum concurrent stream limit (#201,</td><td> </td><td class="rblock">   <span class="insert">*</span>  Stream 1 counts towards the maximum concurrent stream limit (#201,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      #282)</td><td> </td><td class="right">      #282)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0878"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Remove connection-level flow control exclusion for some streams</td><td> </td><td class="rblock">   <span class="insert">*</span>  Remove connection-level flow control exclusion for some streams</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (except 1) (#246)</td><td> </td><td class="right">      (except 1) (#246)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0879"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  RESET_STREAM affects connection-level flow control (#162, #163)</td><td> </td><td class="rblock">   <span class="insert">*</span>  RESET_STREAM affects connection-level flow control (#162, #163)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0880"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Flow control accounting uses the maximum data offset on each</td><td> </td><td class="rblock">   <span class="insert">*</span>  Flow control accounting uses the maximum data offset on each</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      stream, rather than bytes received (#378)</td><td> </td><td class="right">      stream, rather than bytes received (#378)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0881"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Moved length-determining fields to the start of STREAM and ACK</td><td> </td><td class="rblock">   <span class="insert">*</span>  Moved length-determining fields to the start of STREAM and ACK</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#168, #277)</td><td> </td><td class="right">      (#168, #277)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0882"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Added the ability to pad between frames (#158, #276)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Added the ability to pad between frames (#158, #276)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0883"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Remove error code and reason phrase from GOAWAY (#352, #355)</td><td> </td><td class="rblock">   <span class="insert">*</span>  Remove error code and reason phrase from GOAWAY (#352, #355)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0884"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  GOAWAY includes a final stream number for both directions (#347)</td><td> </td><td class="rblock">   <span class="insert">*</span>  GOAWAY includes a final stream number for both directions (#347)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0885"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Error codes for RESET_STREAM and CONNECTION_CLOSE are now at a</td><td> </td><td class="rblock">   <span class="insert">*</span>  Error codes for RESET_STREAM and CONNECTION_CLOSE are now at a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      consistent offset (#249)</td><td> </td><td class="right">      consistent offset (#249)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0886"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Defined priority as the responsibility of the application protocol</td><td> </td><td class="rblock">   <span class="insert">*</span>  Defined priority as the responsibility of the application protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      (#104, #303)</td><td> </td><td class="right">      (#104, #303)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0887"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.18</span>.  Since draft-ietf-quic-transport-00</td><td> </td><td class="rblock"><span class="insert">C.29</span>.  Since draft-ietf-quic-transport-00</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0888"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o</span>  Replaced DIVERSIFICATION_NONCE flag with KEY_PHASE flag</td><td> </td><td class="rblock">   <span class="insert">*</span>  Replaced DIVERSIFICATION_NONCE flag with KEY_PHASE flag</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">*  Defined versioning</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0889"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Defined versioning</span></td><td> </td><td class="rblock">   <span class="insert">*  Reworked description of packet and frame layout</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0890"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Reworked description of packet and frame layou</span>t</td><td> </td><td class="rblock">   <span class="insert">*  Error code space is divided into regions for each componen</span>t</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0891"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Error code space is divided into regions for each component</span></td><td> </td><td class="rblock">   <span class="insert">*  Use big endian for all numeric values</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0892"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  Use big endian for all numeric values</span></td><td> </td><td class="rblock"><span class="insert">C.30.  Since draft-hamilton-quic-transport-protocol-01</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0893"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">B.19.  Since draft-hamilton-quic-transport-protocol-01</span></td><td> </td><td class="rblock"><span class="insert">   *  Adopted as base for draft-ietf-quic-tls</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0894"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Adopted as base for draft-ietf-quic-tls</span></td><td> </td><td class="rblock">   <span class="insert">*  Updated authors/editors list</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0895"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Updated authors/editors list</span></td><td> </td><td class="rblock">   <span class="insert">*  Added IANA Considerations section</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0896"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Added IANA Considerations section</span></td><td> </td><td class="rblock">   <span class="insert">*  Moved Contributors and Acknowledgments to appendices</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0897"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  Moved Contributors and Acknowledgments to appendice</span>s</td><td> </td><td class="rblock"><span class="insert">Contributor</span>s</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0898"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">Acknowledgments</span></td><td> </td><td class="rblock">   <span class="insert">The original design and rationale behind this protocol draw</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   significantly from work by Jim Roskind [EARLY-DESIGN].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0899"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Special thanks are due to the following for helping shape pre-IETF</span></td><td> </td><td class="rblock">   <span class="insert">The IETF</span> QUIC <span class="insert">Working Group received an enormous amount of support</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   QUIC <span class="delete">and its deployment: Chris Bentzel, Misha Efimov, Roberto Peon,</span></td><td> </td><td class="rblock"><span class="insert">   from many people.  The following people provided substantive</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Alistair Riddoch, Siddharth Vijayakrishnan, and Assar Westerlund.</span></td><td> </td><td class="rblock"><span class="insert">   contributions to this document:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0900"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">This document has benefited immensely from various private</span></td><td> </td><td class="rblock">   <span class="insert">*  Alessandro Ghedini</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   discussions and public ones on the quic@ietf.org and proto-</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   quic@chromium.org mailing lists.  Our thanks to all.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0901"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">Contributors</span></td><td> </td><td class="rblock"><span class="insert">   *  Alyssa Wilk</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0902"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The original authors of this specification were Ryan Hamilton, Jana</span></td><td> </td><td class="rblock">   <span class="insert">*  Antoine Delignat-Lavaud</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Iyengar, Ian Swett, and Alyssa Wilk.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0903"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The original design and rationale behind this protocol draw</span></td><td> </td><td class="rblock">   <span class="insert">*  Brian Trammell</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   significantly from work by Jim Roskind [EARLY-DESIGN].  In</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   alphabetical order, the contributors to the pre-IETF QUIC project at</span></td><td> </td><td class="rblock"><span class="insert">   *  Christian Huitema</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Google are: Britt Cyr, Jeremy Dorfman, Ryan Hamilton, Jana Iyengar,</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Fedor Kouranov, Charles Krasic, Jo Kulik, Adam Langley, Jim Roskind,</span></td><td> </td><td class="rblock"><span class="insert">   *  Colin Perkins</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Robbie Shade, Satyam Shekhar, Cherie Shi,</span> Ian <span class="delete">Swett, Raman Tenneti,</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Victor <span class="delete">Vasiliev, Antonio Vicente, Patrik Westin, Alyssa Wilk, Dale</span></td><td> </td><td class="rblock"><span class="insert">   *  David Schinazi</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Worley, Fan Yang, Dan Zhang, Daniel Ziegler.</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Dmitri Tikhonov</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Eric Kinnear</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Eric Rescorla</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Gorry Fairhurst</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  Ian <span class="insert">Swett</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Igor Lubashev</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  奥 一穂 (Kazuho Oku)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Lucas Pardue</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Magnus Westerlund</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Marten Seemann</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Martin Duke</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Mike Bishop</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Mikkel Fahnøe Jørgensen</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Mirja Kühlewind</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Nick Banks</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Nick Harper</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Patrick McManus</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Roberto Peon</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Ryan Hamilton</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Subodh Iyengar</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Tatsuhiro Tsujikawa</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Ted Hardie</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Tom Jones</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *</span>  Victor <span class="insert">Vasiliev</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Authors' Addresses</td><td> </td><td class="right">Authors' Addresses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Jana Iyengar (editor)</td><td> </td><td class="right">   Jana Iyengar (editor)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Fastly</td><td> </td><td class="right">   Fastly</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: jri.ietf@gmail.com</td><td> </td><td class="right">   Email: jri.ietf@gmail.com</td><td class="lineno"></td></tr>
      <tr id="diff0904"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                                                                         </span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Martin Thomson (editor)</td><td> </td><td class="right">   Martin Thomson (editor)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Mozilla</td><td> </td><td class="right">   Mozilla</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: mt@lowentropy.net</td><td> </td><td class="right">   Email: mt@lowentropy.net</td><td class="lineno"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr id="end" bgcolor="gray"><th colspan="5" align="center">&nbsp;End of changes. 904 change blocks.&nbsp;</th></tr>
     <tr class="stats"><td></td><th><i>2602 lines changed or deleted</i></th><th><i> </i></th><th><i>4633 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" class="small" align="center"><br>This html diff was produced by rfcdiff 1.48. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/">http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </tbody></table>
   
   
</body></html>